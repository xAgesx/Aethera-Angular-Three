var Jj=Object.defineProperty,Qj=Object.defineProperties;var eG=Object.getOwnPropertyDescriptors;var u_=Object.getOwnPropertySymbols,tG=Object.getPrototypeOf,pN=Object.prototype.hasOwnProperty,mN=Object.prototype.propertyIsEnumerable,nG=Reflect.get;var fN=(n,e,t)=>e in n?Jj(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ae=(n,e)=>{for(var t in e||={})pN.call(e,t)&&fN(n,t,e[t]);if(u_)for(var t of u_(e))mN.call(e,t)&&fN(n,t,e[t]);return n},je=(n,e)=>Qj(n,eG(e));var Ix=(n,e)=>{var t={};for(var i in n)pN.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&u_)for(var i of u_(n))e.indexOf(i)<0&&mN.call(n,i)&&(t[i]=n[i]);return t};var Ua=(n,e,t)=>nG(tG(n),t,e);var U=(n,e,t)=>new Promise((i,r)=>{var s=c=>{try{a(t.next(c))}catch(l){r(l)}},o=c=>{try{a(t.throw(c))}catch(l){r(l)}},a=c=>c.done?i(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var Cx;function d_(){return Cx}function Bs(n){let e=Cx;return Cx=n,e}var gN=Symbol("NotFound");function ed(n){return n===gN||n?.name==="\u0275NotFound"}var ji=null,h_=!1,Mx=1,iG=null,Gi=Symbol("SIGNAL");function At(n){let e=ji;return ji=n,e}function g_(){return ji}var td={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function nd(n){if(h_)throw new Error("");if(ji===null)return;ji.consumerOnSignalRead(n);let e=ji.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=ji.recomputing;if(i&&(t=e!==void 0?e.nextProducer:ji.producers,t!==void 0&&t.producer===n)){ji.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===ji&&(!i||sG(r,ji)))return;let s=rd(ji),o={producer:n,consumer:ji,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};ji.producersTail=o,e!==void 0?e.nextProducer=o:ji.producers=o,s&&bN(n,o)}function _N(){Mx++}function __(n){if(!(rd(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Mx)){if(!n.producerMustRecompute(n)&&!zf(n)){m_(n);return}n.producerRecomputeValue(n),m_(n)}}function Ax(n){if(n.consumers===void 0)return;let e=h_;h_=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||rG(i)}}finally{h_=e}}function Dx(){return ji?.consumerAllowSignalWrites!==!1}function rG(n){n.dirty=!0,Ax(n),n.consumerMarkedDirty?.(n)}function m_(n){n.dirty=!1,n.lastCleanEpoch=Mx}function id(n){return n&&yN(n),At(n)}function yN(n){n.producersTail=void 0,n.recomputing=!0}function Bf(n,e){At(e),n&&vN(n)}function vN(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(rd(n))do t=Rx(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function zf(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(__(t),i!==t.version))return!0}return!1}function Hf(n){if(rd(n)){let e=n.producers;for(;e!==void 0;)e=Rx(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function bN(n,e){let t=n.consumersTail,i=rd(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)bN(r.producer,r)}function Rx(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!rd(e)){let s=e.producers;for(;s!==void 0;)s=Rx(s)}return t}function rd(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function y_(n){iG?.(n)}function sG(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function v_(n,e){return Object.is(n,e)}function b_(n,e){let t=Object.create(oG);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(__(t),nd(t),t.value===Uf)throw t.error;return t.value};return i[Gi]=t,y_(t),i}var f_=Symbol("UNSET"),p_=Symbol("COMPUTING"),Uf=Symbol("ERRORED"),oG=je(ae({},td),{value:f_,dirty:!0,error:null,equal:v_,kind:"computed",producerMustRecompute(n){return n.value===f_||n.value===p_},producerRecomputeValue(n){if(n.value===p_)throw new Error("");let e=n.value;n.value=p_;let t=id(n),i,r=!1;try{i=n.computation(),At(null),r=e!==f_&&e!==Uf&&i!==Uf&&n.equal(e,i)}catch(s){i=Uf,n.error=s}finally{Bf(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function aG(){throw new Error}var EN=aG;function wN(n){EN(n)}function Px(n){EN=n}var cG=null;function Nx(n,e){let t=Object.create(E_);t.value=n,e!==void 0&&(t.equal=e);let i=()=>xN(t);return i[Gi]=t,y_(t),[i,o=>sd(t,o),o=>Ox(t,o)]}function xN(n){return nd(n),n.value}function sd(n,e){Dx()||wN(n),n.equal(n.value,e)||(n.value=e,lG(n))}function Ox(n,e){Dx()||wN(n),sd(n,e(n.value))}var E_=je(ae({},td),{equal:v_,value:void 0,kind:"signal"});function lG(n){n.version++,_N(),Ax(n),cG?.(n)}function Tt(n){return typeof n=="function"}function od(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var w_=od(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function pl(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Hn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Tt(i))try{i()}catch(s){e=s instanceof w_?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{SN(s)}catch(o){e=e??[],o instanceof w_?e=[...e,...o.errors]:e.push(o)}}if(e)throw new w_(e)}}add(e){var t;if(e&&e!==this)if(this.closed)SN(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&pl(t,e)}remove(e){let{_finalizers:t}=this;t&&pl(t,e),e instanceof n&&e._removeParent(this)}};Hn.EMPTY=(()=>{let n=new Hn;return n.closed=!0,n})();var kx=Hn.EMPTY;function x_(n){return n instanceof Hn||n&&"closed"in n&&Tt(n.remove)&&Tt(n.add)&&Tt(n.unsubscribe)}function SN(n){Tt(n)?n():n.unsubscribe()}var fs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ad={setTimeout(n,e,...t){let{delegate:i}=ad;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ad;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function S_(n){ad.setTimeout(()=>{let{onUnhandledError:e}=fs;if(e)e(n);else throw n})}function jf(){}var TN=Lx("C",void 0,void 0);function IN(n){return Lx("E",void 0,n)}function CN(n){return Lx("N",n,void 0)}function Lx(n,e,t){return{kind:n,value:e,error:t}}var ml=null;function cd(n){if(fs.useDeprecatedSynchronousErrorHandling){let e=!ml;if(e&&(ml={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=ml;if(ml=null,t)throw i}}else n()}function MN(n){fs.useDeprecatedSynchronousErrorHandling&&ml&&(ml.errorThrown=!0,ml.error=n)}var gl=class extends Hn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,x_(e)&&e.add(this)):this.destination=hG}static create(e,t,i){return new ld(e,t,i)}next(e){this.isStopped?Vx(CN(e),this):this._next(e)}error(e){this.isStopped?Vx(IN(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Vx(TN,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},uG=Function.prototype.bind;function Fx(n,e){return uG.call(n,e)}var Ux=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){T_(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){T_(i)}else T_(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){T_(t)}}},ld=class extends gl{constructor(e,t,i){super();let r;if(Tt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&fs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Fx(e.next,s),error:e.error&&Fx(e.error,s),complete:e.complete&&Fx(e.complete,s)}):r=e}this.destination=new Ux(r)}};function T_(n){fs.useDeprecatedSynchronousErrorHandling?MN(n):S_(n)}function dG(n){throw n}function Vx(n,e){let{onStoppedNotification:t}=fs;t&&ad.setTimeout(()=>t(n,e))}var hG={closed:!0,next:jf,error:dG,complete:jf};var ud=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ar(n){return n}function I_(...n){return Bx(n)}function Bx(n){return n.length===0?Ar:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var bt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let s=pG(t)?t:new ld(t,i,r);return cd(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=AN(i),new i((r,s)=>{let o=new ld({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[ud](){return this}pipe(...t){return Bx(t)(this)}toPromise(t){return t=AN(t),new t((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function AN(n){var e;return(e=n??fs.Promise)!==null&&e!==void 0?e:Promise}function fG(n){return n&&Tt(n.next)&&Tt(n.error)&&Tt(n.complete)}function pG(n){return n&&n instanceof gl||fG(n)&&x_(n)}function zx(n){return Tt(n?.lift)}function Wt(n){return e=>{if(zx(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Vt(n,e,t,i,r){return new Hx(n,e,t,i,r)}var Hx=class extends gl{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function dd(){return Wt((n,e)=>{let t=null;n._refCount++;let i=Vt(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var hd=class extends bt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,zx(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Hn;let t=this.getSubject();e.add(this.source.subscribe(Vt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Hn.EMPTY)}return e}refCount(){return dd()(this)}};var DN=od(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ti=(()=>{class n extends bt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new C_(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new DN}next(t){cd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){cd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){cd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:s}=this;return i||r?kx:(this.currentObservers=null,s.push(t),new Hn(()=>{this.currentObservers=null,pl(s,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){let t=new bt;return t.source=this,t}}return n.create=(e,t)=>new C_(e,t),n})(),C_=class extends ti{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:kx}};var Ri=class extends ti{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var jx={now(){return(jx.delegate||Date).now()},delegate:void 0};var M_=class extends Hn{constructor(e,t){super()}schedule(e,t=0){return this}};var Gf={setInterval(n,e,...t){let{delegate:i}=Gf;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Gf;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var fd=class extends M_{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return Gf.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Gf.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,pl(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var pd=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};pd.now=jx.now;var md=class extends pd{constructor(e,t=pd.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var Gx=new md(fd);var A_=class extends fd{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return i!=null&&i>0||i==null&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}};var D_=class extends md{};var Wx=new D_(A_);var yr=new bt(n=>n.complete());function RN(n){return n&&Tt(n.schedule)}function PN(n){return n[n.length-1]}function R_(n){return Tt(PN(n))?n.pop():void 0}function Ba(n){return RN(PN(n))?n.pop():void 0}function $x(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function ON(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(d){o(d)}}function c(u){try{l(i.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}function NN(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _l(n){return this instanceof _l?(this.v=n,this):new _l(n)}function kN(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(p){return function(g){return Promise.resolve(g).then(p,d)}}function a(p,g){i[p]&&(r[p]=function(y){return new Promise(function(m,_){s.push([p,y,m,_])>1||c(p,y)})},g&&(r[p]=g(r[p])))}function c(p,g){try{l(i[p](g))}catch(y){h(s[0][3],y)}}function l(p){p.value instanceof _l?Promise.resolve(p.value.v).then(u,d):h(s[0][2],p)}function u(p){c("next",p)}function d(p){c("throw",p)}function h(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function LN(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof NN=="function"?NN(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var P_=n=>n&&typeof n.length=="number"&&typeof n!="function";function N_(n){return Tt(n?.then)}function O_(n){return Tt(n[ud])}function k_(n){return Symbol.asyncIterator&&Tt(n?.[Symbol.asyncIterator])}function L_(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function mG(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var F_=mG();function V_(n){return Tt(n?.[F_])}function U_(n){return kN(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield _l(t.read());if(r)return yield _l(void 0);yield yield _l(i)}}finally{t.releaseLock()}})}function B_(n){return Tt(n?.getReader)}function ni(n){if(n instanceof bt)return n;if(n!=null){if(O_(n))return gG(n);if(P_(n))return _G(n);if(N_(n))return yG(n);if(k_(n))return FN(n);if(V_(n))return vG(n);if(B_(n))return bG(n)}throw L_(n)}function gG(n){return new bt(e=>{let t=n[ud]();if(Tt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function _G(n){return new bt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function yG(n){return new bt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,S_)})}function vG(n){return new bt(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function FN(n){return new bt(e=>{EG(n,e).catch(t=>e.error(t))})}function bG(n){return FN(U_(n))}function EG(n,e){var t,i,r,s;return ON(this,void 0,void 0,function*(){try{for(t=LN(n);i=yield t.next(),!i.done;){let o=i.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function vr(n,e,t,i=0,r=!1){let s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function za(n,e=0){return Wt((t,i)=>{t.subscribe(Vt(i,r=>vr(i,n,()=>i.next(r),e),()=>vr(i,n,()=>i.complete(),e),r=>vr(i,n,()=>i.error(r),e)))})}function Ha(n,e=0){return Wt((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function VN(n,e){return ni(n).pipe(Ha(e),za(e))}function UN(n,e){return ni(n).pipe(Ha(e),za(e))}function BN(n,e){return new bt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function zN(n,e){return new bt(t=>{let i;return vr(t,e,()=>{i=n[F_](),vr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>Tt(i?.return)&&i.return()})}function z_(n,e){if(!n)throw new Error("Iterable cannot be null");return new bt(t=>{vr(t,e,()=>{let i=n[Symbol.asyncIterator]();vr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function HN(n,e){return z_(U_(n),e)}function jN(n,e){if(n!=null){if(O_(n))return VN(n,e);if(P_(n))return BN(n,e);if(N_(n))return UN(n,e);if(k_(n))return z_(n,e);if(V_(n))return zN(n,e);if(B_(n))return HN(n,e)}throw L_(n)}function Pn(n,e){return e?jN(n,e):ni(n)}function ut(...n){let e=Ba(n);return Pn(n,e)}function gd(n,e){let t=Tt(n)?n:()=>n,i=r=>r.error(t());return new bt(e?r=>e.schedule(i,0,r):i)}function qx(n){return!!n&&(n instanceof bt||Tt(n.lift)&&Tt(n.subscribe))}var Oo=od(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function gt(n,e){return Wt((t,i)=>{let r=0;t.subscribe(Vt(i,s=>{i.next(n.call(e,s,r++))}))})}var{isArray:wG}=Array;function xG(n,e){return wG(e)?n(...e):n(e)}function H_(n){return gt(e=>xG(n,e))}var{isArray:SG}=Array,{getPrototypeOf:TG,prototype:IG,keys:CG}=Object;function j_(n){if(n.length===1){let e=n[0];if(SG(e))return{args:e,keys:null};if(MG(e)){let t=CG(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function MG(n){return n&&typeof n=="object"&&TG(n)===IG}function G_(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function W_(...n){let e=Ba(n),t=R_(n),{args:i,keys:r}=j_(n);if(i.length===0)return Pn([],e);let s=new bt(AG(i,e,r?o=>G_(r,o):Ar));return t?s.pipe(H_(t)):s}function AG(n,e,t=Ar){return i=>{GN(e,()=>{let{length:r}=n,s=new Array(r),o=r,a=r;for(let c=0;c<r;c++)GN(e,()=>{let l=Pn(n[c],e),u=!1;l.subscribe(Vt(i,d=>{s[c]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function GN(n,e,t){n?vr(t,n,e):e()}function WN(n,e,t,i,r,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},p=y=>l<i?g(y):c.push(y),g=y=>{s&&e.next(y),l++;let m=!1;ni(t(y,u++)).subscribe(Vt(e,_=>{r?.(_),s?p(_):e.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<i;){let _=c.shift();o?vr(e,o,()=>g(_)):g(_)}h()}catch(_){e.error(_)}}))};return n.subscribe(Vt(e,p,()=>{d=!0,h()})),()=>{a?.()}}function hi(n,e,t=1/0){return Tt(e)?hi((i,r)=>gt((s,o)=>e(i,s,r,o))(ni(n(i,r))),t):(typeof e=="number"&&(t=e),Wt((i,r)=>WN(i,r,n,t)))}function $N(n=1/0){return hi(Ar,n)}function qN(){return $N(1)}function _d(...n){return qN()(Pn(n,Ba(n)))}function Wf(n){return new bt(e=>{ni(n()).subscribe(e)})}function Xx(...n){let e=R_(n),{args:t,keys:i}=j_(n),r=new bt(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;ni(t[u]).subscribe(Vt(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(i?G_(i,a):a),s.complete())}))}});return e?r.pipe(H_(e)):r}function rr(n,e){return Wt((t,i)=>{let r=0;t.subscribe(Vt(i,s=>n.call(e,s,r++)&&i.next(s)))})}function ja(n){return Wt((e,t)=>{let i=null,r=!1,s;i=e.subscribe(Vt(t,void 0,void 0,o=>{s=ni(n(o,ja(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function XN(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Vt(o,u=>{let d=l++;c=a?n(c,u,d):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}function Ga(n,e){return Tt(e)?hi(n,e,1):hi(n,1)}function Wa(n){return Wt((e,t)=>{let i=!1;e.subscribe(Vt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function $r(n){return n<=0?()=>yr:Wt((e,t)=>{let i=0;e.subscribe(Vt(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function $_(n=DG){return Wt((e,t)=>{let i=!1;e.subscribe(Vt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function DG(){return new Oo}function yl(n){return Wt((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function ko(n,e){let t=arguments.length>=2;return i=>i.pipe(n?rr((r,s)=>n(r,s,i)):Ar,$r(1),t?Wa(e):$_(()=>new Oo))}function yd(n){return n<=0?()=>yr:Wt((e,t)=>{let i=[];e.subscribe(Vt(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Yx(n,e){let t=arguments.length>=2;return i=>i.pipe(n?rr((r,s)=>n(r,s,i)):Ar,yd(1),t?Wa(e):$_(()=>new Oo))}function q_(n,e){return Wt(XN(n,e,arguments.length>=2,!0))}function X_(...n){let e=Ba(n);return Wt((t,i)=>{(e?_d(n,t,e):_d(n,t)).subscribe(i)})}function Wi(n,e){return Wt((t,i)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&i.complete();t.subscribe(Vt(i,c=>{r?.unsubscribe();let l=0,u=s++;ni(n(c,u)).subscribe(r=Vt(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Y_(n){return Wt((e,t)=>{ni(n).subscribe(Vt(t,()=>t.complete(),jf)),!t.closed&&e.subscribe(t)})}function vi(n,e,t){let i=Tt(n)||e||t?{next:n,error:e,complete:t}:n;return i?Wt((r,s)=>{var o;(o=i.subscribe)===null||o===void 0||o.call(i);let a=!0;r.subscribe(Vt(s,c=>{var l;(l=i.next)===null||l===void 0||l.call(i,c),s.next(c)},()=>{var c;a=!1,(c=i.complete)===null||c===void 0||c.call(i),s.complete()},c=>{var l;a=!1,(l=i.error)===null||l===void 0||l.call(i,c),s.error(c)},()=>{var c,l;a&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(l=i.finalize)===null||l===void 0||l.call(i)}))}):Ar}function YN(n){let e=At(null);try{return n()}finally{At(e)}}var bl=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},cS=new bl("20.3.9");var Q_="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",we=class extends Error{code;constructor(e,t){super(Sl(e,t)),this.code=e}};function RG(n){return`NG0${Math.abs(n)}`}function Sl(n,e){return`${RG(n)}${e?": "+e:""}`}var Tl=globalThis;function on(n){for(let e in n)if(n[e]===on)return e;throw Error("")}function JN(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Fo(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Fo).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function lS(n,e){return n?e?`${n} ${e}`:n:e||""}var PG=on({__forward_ref__:on});function Rr(n){return n.__forward_ref__=Rr,n.toString=function(){return Fo(this())},n}function Pi(n){return uS(n)?n():n}function uS(n){return typeof n=="function"&&n.hasOwnProperty(PG)&&n.__forward_ref__===Rr}function ke(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function qr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Yf(n){return NG(n,ey)}function dS(n){return Yf(n)!==null}function NG(n,e){return n.hasOwnProperty(e)&&n[e]||null}function OG(n){let e=n?.[ey]??null;return e||null}function Zx(n){return n&&n.hasOwnProperty(Z_)?n[Z_]:null}var ey=on({\u0275prov:on}),Z_=on({\u0275inj:on}),Re=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ke({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function hS(n){return n&&!!n.\u0275providers}var fS=on({\u0275cmp:on}),pS=on({\u0275dir:on}),mS=on({\u0275pipe:on}),gS=on({\u0275mod:on}),qf=on({\u0275fac:on}),Il=on({__NG_ELEMENT_ID__:on}),KN=on({__NG_ENV_ID__:on});function Kf(n){return typeof n=="string"?n:n==null?"":String(n)}function QN(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Kf(n)}var eO=on({ngErrorCode:on}),kG=on({ngErrorMessage:on}),LG=on({ngTokenPath:on});function _S(n,e){return tO("",-200,e)}function ty(n,e){throw new we(-201,!1)}function tO(n,e,t){let i=new we(e,n);return i[eO]=e,i[kG]=n,t&&(i[LG]=t),i}function FG(n){return n[eO]}var Jx;function nO(){return Jx}function sr(n){let e=Jx;return Jx=n,e}function yS(n,e,t){let i=Yf(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;ty(n,"Injector")}var VG={},vl=VG,Qx="__NG_DI_FLAG__",eS=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=El(t)||0;try{return this.injector.get(e,i&8?null:vl,i)}catch(r){if(ed(r))return r;throw r}}};function UG(n,e=0){let t=d_();if(t===void 0)throw new we(-203,!1);if(t===null)return yS(n,void 0,e);{let i=BG(e),r=t.retrieve(n,i);if(ed(r)){if(i.optional)return null;throw r}return r}}function Qe(n,e=0){return(nO()||UG)(Pi(n),e)}function ie(n,e){return Qe(n,El(e))}function El(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function BG(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function tS(n){let e=[];for(let t=0;t<n.length;t++){let i=Pi(n[t]);if(Array.isArray(i)){if(i.length===0)throw new we(900,!1);let r,s=0;for(let o=0;o<i.length;o++){let a=i[o],c=zG(a);typeof c=="number"?c===-1?r=a.token:s|=c:r=a}e.push(Qe(r,s))}else e.push(Qe(i))}return e}function iO(n,e){return n[Qx]=e,n.prototype[Qx]=e,n}function zG(n){return n[Qx]}function $a(n,e){let t=n.hasOwnProperty(qf);return t?n[qf]:null}function rO(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function sO(n){return n.flat(Number.POSITIVE_INFINITY)}function ny(n,e){n.forEach(t=>Array.isArray(t)?ny(t,e):e(t))}function vS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Zf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function oO(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let s=r-2;n[r]=n[s],r--}n[e]=t,n[e+1]=i}}function aO(n,e,t){let i=bd(n,e);return i>=0?n[i|1]=t:(i=~i,oO(n,i,e,t)),i}function iy(n,e){let t=bd(n,e);if(t>=0)return n[t|1]}function bd(n,e){return HG(n,e,1)}function HG(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}var Xa={},Dr=[],Uo=new Re(""),bS=new Re("",-1),ES=new Re(""),Xf=class{get(e,t=vl){if(t===vl){let r=tO("",-201);throw r.name="\u0275NotFound",r}return t}};function wS(n){return n[gS]||null}function Ya(n){return n[fS]||null}function xS(n){return n[pS]||null}function cO(n){return n[mS]||null}function or(n){return{\u0275providers:n}}function lO(n){return or([{provide:Uo,multi:!0,useValue:n}])}function uO(...n){return{\u0275providers:SS(!0,n),\u0275fromNgModule:!0}}function SS(n,...e){let t=[],i=new Set,r,s=o=>{t.push(o)};return ny(e,o=>{let a=o;J_(a,s,[],i)&&(r||=[],r.push(a))}),r!==void 0&&dO(r,s),t}function dO(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];TS(r,s=>{e(s,i)})}}function J_(n,e,t,i){if(n=Pi(n),!n)return!1;let r=null,s=Zx(n),o=!s&&Ya(n);if(!s&&!o){let c=n.ngModule;if(s=Zx(c),s)r=c;else return!1}else{if(o&&!o.standalone)return!1;r=n}let a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)J_(l,e,t,i)}}else if(s){if(s.imports!=null&&!a){i.add(r);let l;try{ny(s.imports,u=>{J_(u,e,t,i)&&(l||=[],l.push(u))})}finally{}l!==void 0&&dO(l,e)}if(!a){let l=$a(r)||(()=>new r);e({provide:r,useFactory:l,deps:Dr},r),e({provide:ES,useValue:r,multi:!0},r),e({provide:Uo,useValue:()=>Qe(r),multi:!0},r)}let c=s.providers;if(c!=null&&!a){let l=n;TS(c,u=>{e(u,l)})}}else return!1;return r!==n&&n.providers!==void 0}function TS(n,e){for(let t of n)hS(t)&&(t=t.\u0275providers),Array.isArray(t)?TS(t,e):e(t)}var jG=on({provide:String,useValue:on});function hO(n){return n!==null&&typeof n=="object"&&jG in n}function GG(n){return!!(n&&n.useExisting)}function WG(n){return!!(n&&n.useFactory)}function wl(n){return typeof n=="function"}function fO(n){return!!n.useClass}var Jf=new Re(""),K_={},ZN={},Kx;function Qf(){return Kx===void 0&&(Kx=new Xf),Kx}var Xn=class{},xl=class extends Xn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,iS(e,o=>this.processProvider(o)),this.records.set(bS,vd(void 0,this)),r.has("environment")&&this.records.set(Xn,vd(void 0,this));let s=this.records.get(Jf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(ES,Dr,{self:!0}))}retrieve(e,t){let i=El(t)||0;try{return this.get(e,vl,i)}catch(r){if(ed(r))return r;throw r}}destroy(){$f(this),this._destroyed=!0;let e=At(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),At(e)}}onDestroy(e){return $f(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){$f(this);let t=Bs(this),i=sr(void 0),r;try{return e()}finally{Bs(t),sr(i)}}get(e,t=vl,i){if($f(this),e.hasOwnProperty(KN))return e[KN](this);let r=El(i),s,o=Bs(this),a=sr(void 0);try{if(!(r&4)){let l=this.records.get(e);if(l===void 0){let u=KG(e)&&Yf(e);u&&this.injectableDefInScope(u)?l=vd(nS(e),K_):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,r)}let c=r&2?Qf():this.parent;return t=r&8&&t===vl?null:t,c.get(e,t)}catch(c){let l=FG(c);throw l===-200||l===-201?new we(l,null):c}finally{sr(a),Bs(o)}}resolveInjectorInitializers(){let e=At(null),t=Bs(this),i=sr(void 0),r;try{let s=this.get(Uo,Dr,{self:!0});for(let o of s)o()}finally{Bs(t),sr(i),At(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Fo(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Pi(e);let t=wl(e)?e:Pi(e&&e.provide),i=qG(e);if(!wl(e)&&e.multi===!0){let r=this.records.get(t);r||(r=vd(void 0,K_,!0),r.factory=()=>tS(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=At(null);try{if(t.value===ZN)throw _S(Fo(e));return t.value===K_&&(t.value=ZN,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&YG(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{At(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Pi(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function nS(n){let e=Yf(n),t=e!==null?e.factory:$a(n);if(t!==null)return t;if(n instanceof Re)throw new we(204,!1);if(n instanceof Function)return $G(n);throw new we(204,!1)}function $G(n){if(n.length>0)throw new we(204,!1);let t=OG(n);return t!==null?()=>t.factory(n):()=>new n}function qG(n){if(hO(n))return vd(void 0,n.useValue);{let e=IS(n);return vd(e,K_)}}function IS(n,e,t){let i;if(wl(n)){let r=Pi(n);return $a(r)||nS(r)}else if(hO(n))i=()=>Pi(n.useValue);else if(WG(n))i=()=>n.useFactory(...tS(n.deps||[]));else if(GG(n))i=(r,s)=>Qe(Pi(n.useExisting),s!==void 0&&s&8?8:void 0);else{let r=Pi(n&&(n.useClass||n.provide));if(XG(n))i=()=>new r(...tS(n.deps));else return $a(r)||nS(r)}return i}function $f(n){if(n.destroyed)throw new we(205,!1)}function vd(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function XG(n){return!!n.deps}function YG(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function KG(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function iS(n,e){for(let t of n)Array.isArray(t)?iS(t,e):t&&hS(t)?iS(t.\u0275providers,e):e(t)}function Yn(n,e){let t;n instanceof xl?($f(n),t=n):t=new eS(n);let i,r=Bs(t),s=sr(void 0);try{return e()}finally{Bs(r),sr(s)}}function pO(){return nO()!==void 0||d_()!=null}var ms=0,ht=1,yt=2,bi=3,Xr=4,Yr=5,ep=6,Ed=7,$i=8,Ka=9,zs=10,On=11,wd=12,CS=13,Cl=14,Kr=15,Za=16,Ml=17,Hs=18,tp=19,MS=20,Lo=21,ry=22,np=23,Pr=24,Al=25,ip=26,Ei=27,mO=1;var Ja=7,rp=8,Dl=9,ar=10;function js(n){return Array.isArray(n)&&typeof n[mO]=="object"}function gs(n){return Array.isArray(n)&&n[mO]===!0}function AS(n){return(n.flags&4)!==0}function Qa(n){return n.componentOffset>-1}function sp(n){return(n.flags&1)===1}function Gs(n){return!!n.template}function xd(n){return(n[yt]&512)!==0}function Rl(n){return(n[yt]&256)===256}var DS="svg",gO="math";function Zr(n){for(;Array.isArray(n);)n=n[ms];return n}function RS(n,e){return Zr(e[n])}function _s(n,e){return Zr(e[n.index])}function sy(n,e){return n.data[e]}function oy(n,e){return n[e]}function PS(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Jr(n,e){let t=e[n];return js(t)?t:t[ms]}function _O(n){return(n[yt]&4)===4}function ay(n){return(n[yt]&128)===128}function yO(n){return gs(n[bi])}function Pl(n,e){return e==null?null:n[e]}function NS(n){n[Ml]=0}function OS(n){n[yt]&1024||(n[yt]|=1024,ay(n)&&Sd(n))}function vO(n,e){for(;n>0;)e=e[Cl],n--;return e}function op(n){return!!(n[yt]&9216||n[Pr]?.dirty)}function cy(n){n[zs].changeDetectionScheduler?.notify(8),n[yt]&64&&(n[yt]|=1024),op(n)&&Sd(n)}function Sd(n){n[zs].changeDetectionScheduler?.notify(0);let e=qa(n);for(;e!==null&&!(e[yt]&8192||(e[yt]|=8192,!ay(e)));)e=qa(e)}function kS(n,e){if(Rl(n))throw new we(911,!1);n[Lo]===null&&(n[Lo]=[]),n[Lo].push(e)}function bO(n,e){if(n[Lo]===null)return;let t=n[Lo].indexOf(e);t!==-1&&n[Lo].splice(t,1)}function qa(n){let e=n[bi];return gs(e)?e[bi]:e}function LS(n){return n[Ed]??=[]}function FS(n){return n.cleanup??=[]}function EO(n,e,t,i){let r=LS(e);r.push(t),n.firstCreatePass&&FS(n).push(i,r.length-1)}var Dt={lFrame:kO(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var rS=!1;function wO(){return Dt.lFrame.elementDepthCount}function xO(){Dt.lFrame.elementDepthCount++}function VS(){Dt.lFrame.elementDepthCount--}function US(){return Dt.bindingsEnabled}function SO(){return Dt.skipHydrationRootTNode!==null}function BS(n){return Dt.skipHydrationRootTNode===n}function zS(){Dt.skipHydrationRootTNode=null}function Ut(){return Dt.lFrame.lView}function Ni(){return Dt.lFrame.tView}function Ze(n){return Dt.lFrame.contextLView=n,n[$i]}function Je(n){return Dt.lFrame.contextLView=null,n}function Oi(){let n=HS();for(;n!==null&&n.type===64;)n=n.parent;return n}function HS(){return Dt.lFrame.currentTNode}function TO(){let n=Dt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Td(n,e){let t=Dt.lFrame;t.currentTNode=n,t.isParent=e}function jS(){return Dt.lFrame.isParent}function IO(){Dt.lFrame.isParent=!1}function CO(){return Dt.lFrame.contextLView}function GS(){return rS}function WS(n){let e=rS;return rS=n,e}function ly(){let n=Dt.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function MO(n){return Dt.lFrame.bindingIndex=n}function ap(){return Dt.lFrame.bindingIndex++}function AO(n){let e=Dt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function DO(){return Dt.lFrame.inI18n}function RO(n,e){let t=Dt.lFrame;t.bindingIndex=t.bindingRootIndex=n,uy(e)}function PO(){return Dt.lFrame.currentDirectiveIndex}function uy(n){Dt.lFrame.currentDirectiveIndex=n}function NO(n){let e=Dt.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function $S(){return Dt.lFrame.currentQueryIndex}function dy(n){Dt.lFrame.currentQueryIndex=n}function ZG(n){let e=n[ht];return e.type===2?e.declTNode:e.type===1?n[Yr]:null}function qS(n,e,t){if(t&4){let r=e,s=n;for(;r=r.parent,r===null&&!(t&1);)if(r=ZG(s),r===null||(s=s[Cl],r.type&10))break;if(r===null)return!1;e=r,n=s}let i=Dt.lFrame=OO();return i.currentTNode=e,i.lView=n,!0}function hy(n){let e=OO(),t=n[ht];Dt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function OO(){let n=Dt.lFrame,e=n===null?null:n.child;return e===null?kO(n):e}function kO(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function LO(){let n=Dt.lFrame;return Dt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var XS=LO;function fy(){let n=LO();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function FO(n){return(Dt.lFrame.contextLView=vO(n,Dt.lFrame.contextLView))[$i]}function Nl(){return Dt.lFrame.selectedIndex}function ec(n){Dt.lFrame.selectedIndex=n}function py(){let n=Dt.lFrame;return sy(n.tView,n.selectedIndex)}function cr(){Dt.lFrame.currentNamespace=DS}function Ol(){JG()}function JG(){Dt.lFrame.currentNamespace=null}function VO(){return Dt.lFrame.currentNamespace}var UO=!0;function my(){return UO}function gy(n){UO=n}function sS(n,e=null,t=null,i){let r=YS(n,e,t,i);return r.resolveInjectorInitializers(),r}function YS(n,e=null,t=null,i,r=new Set){let s=[t||Dr,uO(n)];return i=i||(typeof n=="object"?void 0:Fo(n)),new xl(s,e||Qf(),i||null,r)}var Nn=class n{static THROW_IF_NOT_FOUND=vl;static NULL=new Xf;static create(e,t){if(Array.isArray(e))return sS({name:""},t,e,"");{let i=e.name??"";return sS({name:i},e.parent,e.providers,i)}}static \u0275prov=ke({token:n,providedIn:"any",factory:()=>Qe(bS)});static __NG_ELEMENT_ID__=-1},ii=new Re(""),Qr=(()=>{class n{static __NG_ELEMENT_ID__=QG;static __NG_ENV_ID__=t=>t}return n})(),oS=class extends Qr{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Rl(this._lView)}onDestroy(e){let t=this._lView;return kS(t,e),()=>bO(t,e)}};function QG(){return new oS(Ut())}var ps=class{_console=console;handleError(e){this._console.error("ERROR",e)}},lr=new Re("",{providedIn:"root",factory:()=>{let n=ie(Xn),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(ps),e.handleError(t))}}}),BO={provide:Uo,useValue:()=>void ie(ps),multi:!0},eW=new Re("",{providedIn:"root",factory:()=>{let n=ie(ii).defaultView;if(!n)return;let e=ie(lr),t=s=>{e(s.reason),s.preventDefault()},i=s=>{s.error?e(s.error):e(new Error(s.message,{cause:s})),s.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),ie(Qr).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function KS(){return or([lO(()=>void ie(eW))])}function ZS(n){return typeof n=="function"&&n[Gi]!==void 0}function Kn(n,e){let[t,i,r]=Nx(n,e?.equal),s=t,o=s[Gi];return s.set=i,s.update=r,s.asReadonly=zO.bind(s),s}function zO(){let n=this[Gi];if(n.readonlyFn===void 0){let e=()=>this();e[Gi]=n,n.readonlyFn=e}return n.readonlyFn}function JS(n){return ZS(n)&&typeof n.set=="function"}var _y=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=tW}return n})();function tW(){return new _y(Ut(),Oi())}var Vo=class{},cp=new Re("",{providedIn:"root",factory:()=>!1});var QS=new Re(""),eT=new Re(""),Ws=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Ri(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new bt(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=ke({token:n,providedIn:"root",factory:()=>new n})}return n})(),tc=(()=>{class n{internalPendingTasks=ie(Ws);scheduler=ie(Vo);errorHandler=ie(lr);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=ke({token:n,providedIn:"root",factory:()=>new n})}return n})();function lp(...n){}var tT=(()=>{class n{static \u0275prov=ke({token:n,providedIn:"root",factory:()=>new aS})}return n})(),aS=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function Nd(n){return{toString:n}.toString()}var yy="__parameters__";function aW(n){return function(...t){if(n){let i=n(...t);for(let r in i)this[r]=i[r]}}}function cW(n,e,t){return Nd(()=>{let i=aW(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(yy)?c[yy]:Object.defineProperty(c,yy,{value:[]})[yy];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return r.prototype.ngMetadataName=n,r.annotationCls=r,r})}var Nr=iO(cW("Optional"),8);function lW(n){return typeof n=="function"}var Iy=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function yk(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Xs=(()=>{let n=()=>vk;return n.ngInherit=!0,n})();function vk(n){return n.type.prototype.ngOnChanges&&(n.setInput=dW),uW}function uW(){let n=Ek(this),e=n?.current;if(e){let t=n.previous;if(t===Xa)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function dW(n,e,t,i,r){let s=this.declaredInputs[i],o=Ek(n)||hW(n,{previous:Xa,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Iy(l&&l.currentValue,t,c===Xa),yk(n,e,r,t)}var bk="__ngSimpleChanges__";function Ek(n){return n[bk]||null}function hW(n,e){return n[bk]=e}var HO=[];var dn=function(n,e=null,t){for(let i=0;i<HO.length;i++){let r=HO[i];r(n,e,t)}};function fW(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){let o=vk(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function wk(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function Ey(n,e,t){xk(n,e,3,t)}function wy(n,e,t,i){(n[yt]&3)===t&&xk(n,e,t,i)}function nT(n,e){let t=n[yt];(t&3)===e&&(t&=16383,t+=1,n[yt]=t)}function xk(n,e,t,i){let r=i!==void 0?n[Ml]&65535:0,s=i??-1,o=e.length-1,a=0;for(let c=r;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],i!=null&&a>=i)break}else e[c]<0&&(n[Ml]+=65536),(a<s||s==-1)&&(pW(n,t,e,c),n[Ml]=(n[Ml]&4294901760)+c+2),c++}function jO(n,e){dn(4,n,e);let t=At(null);try{e.call(n)}finally{At(t),dn(5,n,e)}}function pW(n,e,t,i){let r=t[i]<0,s=t[i+1],o=r?-t[i]:t[i],a=n[o];r?n[yt]>>14<n[Ml]>>16&&(n[yt]&3)===e&&(n[yt]+=16384,jO(a,s)):jO(a,s)}var Cd=-1,Ll=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function mW(n){return(n.flags&8)!==0}function gW(n){return(n.flags&16)!==0}function _W(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{let s=r,o=t[++i];vW(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function yW(n){return n===3||n===4||n===6}function vW(n){return n.charCodeAt(0)===64}function Md(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?GO(n,t,r,null,e[++i]):GO(n,t,r,null,null))}}return n}function GO(n,e,t,i,r){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){r!==null&&(n[s+1]=r);return}s++,r!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r)}function Sk(n){return n!==Cd}function Cy(n){return n&32767}function bW(n){return n>>16}function My(n,e){let t=bW(n),i=e;for(;t>0;)i=i[Cl],t--;return i}var hT=!0;function Ay(n){let e=hT;return hT=n,e}var EW=256,Tk=EW-1,Ik=5,wW=0,$s={};function xW(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Il)&&(i=t[Il]),i==null&&(i=t[Il]=wW++);let r=i&Tk,s=1<<r;e.data[n+(r>>Ik)]|=s}function Dy(n,e){let t=Ck(n,e);if(t!==-1)return t;let i=e[ht];i.firstCreatePass&&(n.injectorIndex=e.length,iT(i.data,n),iT(e,null),iT(i.blueprint,null));let r=FT(n,e),s=n.injectorIndex;if(Sk(r)){let o=Cy(r),a=My(r,e),c=a[ht].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function iT(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ck(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function FT(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=Pk(r),i===null)return Cd;if(t++,r=r[Cl],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Cd}function fT(n,e,t){xW(n,e,t)}function Mk(n,e,t){if(t&8||n!==void 0)return n;ty(e,"NodeInjector")}function Ak(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[Ka],s=sr(void 0);try{return r?r.get(e,i,t&8):yS(e,i,t&8)}finally{sr(s)}}return Mk(i,e,t)}function Dk(n,e,t,i=0,r){if(n!==null){if(e[yt]&2048&&!(i&2)){let o=CW(n,e,t,i,$s);if(o!==$s)return o}let s=Rk(n,e,t,i,$s);if(s!==$s)return s}return Ak(e,t,i,r)}function Rk(n,e,t,i,r){let s=TW(t);if(typeof s=="function"){if(!qS(e,n,i))return i&1?Mk(r,t,i):Ak(e,t,i,r);try{let o;if(o=s(i),o==null&&!(i&8))ty(t);else return o}finally{XS()}}else if(typeof s=="number"){let o=null,a=Ck(n,e),c=Cd,l=i&1?e[Kr][Yr]:null;for((a===-1||i&4)&&(c=a===-1?FT(n,e):e[a+8],c===Cd||!$O(i,!1)?a=-1:(o=e[ht],a=Cy(c),e=My(c,e)));a!==-1;){let u=e[ht];if(WO(s,a,u.data)){let d=SW(a,e,t,o,i,l);if(d!==$s)return d}c=e[a+8],c!==Cd&&$O(i,e[ht].data[a+8]===l)&&WO(s,a,e)?(o=u,a=Cy(c),e=My(c,e)):a=-1}}return r}function SW(n,e,t,i,r,s){let o=e[ht],a=o.data[n+8],c=i==null?Qa(a)&&hT:i!=o&&(a.type&3)!==0,l=r&1&&s===a,u=xy(a,o,t,c,l);return u!==null?hp(e,o,u,a,r):$s}function xy(n,e,t,i,r){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,u=s>>20,d=i?a:a+u,h=r?a+u:l;for(let p=d;p<h;p++){let g=o[p];if(p<c&&t===g||p>=c&&g.type===t)return p}if(r){let p=o[c];if(p&&Gs(p)&&p.type===t)return c}return null}function hp(n,e,t,i,r){let s=n[t],o=e.data;if(s instanceof Ll){let a=s;if(a.resolving){let p=QN(o[t]);throw _S(p)}let c=Ay(a.canSeeViewProviders);a.resolving=!0;let l=o[t].type||o[t],u,d=a.injectImpl?sr(a.injectImpl):null,h=qS(n,i,0);try{s=n[t]=a.factory(void 0,r,o,n,i),e.firstCreatePass&&t>=i.directiveStart&&fW(t,o[t],e)}finally{d!==null&&sr(d),Ay(c),a.resolving=!1,XS()}}return s}function TW(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Il)?n[Il]:void 0;return typeof e=="number"?e>=0?e&Tk:IW:e}function WO(n,e,t){let i=1<<n;return!!(t[e+(n>>Ik)]&i)}function $O(n,e){return!(n&2)&&!(n&1&&e)}var kl=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Dk(this._tNode,this._lView,e,El(i),t)}};function IW(){return new kl(Oi(),Ut())}function zo(n){return Nd(()=>{let e=n.prototype.constructor,t=e[qf]||pT(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let s=r[qf]||pT(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function pT(n){return uS(n)?()=>{let e=pT(Pi(n));return e&&e()}:$a(n)}function CW(n,e,t,i,r){let s=n,o=e;for(;s!==null&&o!==null&&o[yt]&2048&&!xd(o);){let a=Rk(s,o,t,i|2,$s);if(a!==$s)return a;let c=s.parent;if(!c){let l=o[MS];if(l){let u=l.get(t,$s,i);if(u!==$s)return u}c=Pk(o),o=o[Cl]}s=c}return r}function Pk(n){let e=n[ht],t=e.type;return t===2?e.declTNode:t===1?n[Yr]:null}function MW(){return Od(Oi(),Ut())}function Od(n,e){return new es(_s(n,e))}var es=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=MW}return n})();function AW(n){return n instanceof es?n.nativeElement:n}function DW(){return this._results[Symbol.iterator]()}var Ry=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new ti}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=sO(e);(this._changesDetected=!rO(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=DW};function Nk(n){return(n.flags&128)===128}var VT=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(VT||{}),Ok=new Map,RW=0;function PW(){return RW++}function NW(n){Ok.set(n[tp],n)}function mT(n){Ok.delete(n[tp])}var qO="__ngContext__";function Ad(n,e){js(e)?(n[qO]=e[tp],NW(e)):n[qO]=e}function kk(n){return Fk(n[wd])}function Lk(n){return Fk(n[Xr])}function Fk(n){for(;n!==null&&!gs(n);)n=n[Xr];return n}var gT;function UT(n){gT=n}function Vk(){if(gT!==void 0)return gT;if(typeof document<"u")return document;throw new we(210,!1)}var Gy=new Re("",{providedIn:"root",factory:()=>OW}),OW="ng",Wy=new Re(""),sc=new Re("",{providedIn:"platform",factory:()=>"unknown"});var $y=new Re("",{providedIn:"root",factory:()=>Vk().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var kW="h",LW="b";var Uk=!1,Bk=new Re("",{providedIn:"root",factory:()=>Uk});var FW=(n,e,t,i)=>{};function VW(n,e,t,i){FW(n,e,t,i)}function BT(n){return(n.flags&32)===32}var UW=()=>null;function zk(n,e,t=!1){return UW(n,e,t)}function Hk(n,e){let t=n.contentQueries;if(t!==null){let i=At(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=n.data[o];dy(s),a.contentQueries(2,e[o],o)}}}finally{At(i)}}}function _T(n,e,t){dy(0);let i=At(null);try{e(n,t)}finally{At(i)}}function jk(n,e,t){if(AS(e)){let i=At(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{At(i)}}}var Bo=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Bo||{});var Py=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Q_})`}};function zT(n){return n instanceof Py?n.changingThisBreaksApplicationSecurity:n}function Gk(n,e){let t=Wk(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Q_})`)}return t===e}function Wk(n){return n instanceof Py&&n.getTypeName()||null}var BW=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function $k(n){return n=String(n),n.match(BW)?n:"unsafe:"+n}var HT=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(HT||{});function Ys(n){let e=zW();return e?e.sanitize(HT.URL,n)||"":Gk(n,"URL")?zT(n):$k(Kf(n))}function zW(){let n=Ut();return n&&n[zs].sanitizer}function kd(n){return n.ownerDocument.defaultView}function qk(n){return n instanceof Function?n():n}function HW(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}var Xk="ng-template";function jW(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&HW(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(jT(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function jT(n){return n.type===4&&n.value!==Xk}function GW(n,e,t){let i=n.type===4&&!t?Xk:n.value;return e===i}function WW(n,e,t){let i=4,r=n.attrs,s=r!==null?XW(r):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!ys(i)&&!ys(c))return!1;if(o&&ys(c))continue;o=!1,i=c|i&1;continue}if(!o)if(i&4){if(i=2|i&1,c!==""&&!GW(n,c,t)||c===""&&e.length===1){if(ys(i))return!1;o=!0}}else if(i&8){if(r===null||!jW(n,r,c,t)){if(ys(i))return!1;o=!0}}else{let l=e[++a],u=$W(c,r,jT(n),t);if(u===-1){if(ys(i))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=r[u+1].toLowerCase(),i&2&&l!==d){if(ys(i))return!1;o=!0}}}}return ys(i)||o}function ys(n){return(n&1)===0}function $W(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===n)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return YW(e,n)}function qW(n,e,t=!1){for(let i=0;i<e.length;i++)if(WW(n,e[i],t))return!0;return!1}function XW(n){for(let e=0;e<n.length;e++){let t=n[e];if(yW(t))return e}return n.length}function YW(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function XO(n,e){return n?":not("+e.trim()+")":e}function KW(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(i&2){let a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+o:i&4&&(r+=" "+o);else r!==""&&!ys(o)&&(e+=XO(s,r),r=""),i=o,s=s||!ys(i);t++}return r!==""&&(e+=XO(s,r)),e}function ZW(n){return n.map(KW).join(",")}function JW(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let s=n[i];if(typeof s=="string")r===2?s!==""&&e.push(s,n[++i]):r===8&&t.push(s);else{if(!ys(r))break;r=s}i++}return t.length&&e.push(1,...t),e}var Ks={};function QW(n,e){return n.createText(e)}function e6(n,e,t){n.setValue(e,t)}function Yk(n,e,t){return n.createElement(e,t)}function Ny(n,e,t,i,r){n.insertBefore(e,t,i,r)}function Kk(n,e,t){n.appendChild(e,t)}function YO(n,e,t,i,r){i!==null?Ny(n,e,t,i,r):Kk(n,e,t)}function t6(n,e,t,i){n.removeChild(null,e,t,i)}function n6(n,e,t){n.setAttribute(e,"style",t)}function i6(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Zk(n,e,t){let{mergedAttrs:i,classes:r,styles:s}=t;i!==null&&_W(n,e,i),r!==null&&i6(n,e,r),s!==null&&n6(n,e,s)}function GT(n,e,t,i,r,s,o,a,c,l,u){let d=Ei+i,h=d+r,p=r6(d,h),g=typeof l=="function"?l():l;return p[ht]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:g,incompleteFirstPass:!1,ssrId:u}}function r6(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ks);return t}function s6(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=GT(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function WT(n,e,t,i,r,s,o,a,c,l,u){let d=e.blueprint.slice();return d[ms]=r,d[yt]=i|4|128|8|64|1024,(l!==null||n&&n[yt]&2048)&&(d[yt]|=2048),NS(d),d[bi]=d[Cl]=n,d[$i]=t,d[zs]=o||n&&n[zs],d[On]=a||n&&n[On],d[Ka]=c||n&&n[Ka]||null,d[Yr]=s,d[tp]=PW(),d[ep]=u,d[MS]=l,d[Kr]=e.type==2?n[Kr]:d,d}function o6(n,e,t){let i=_s(e,n),r=s6(t),s=n[zs].rendererFactory,o=$T(n,WT(n,r,null,Jk(t),i,e,null,s.createRenderer(i,t),null,null,null));return n[e.index]=o}function Jk(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function Qk(n,e,t,i){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function $T(n,e){return n[wd]?n[CS][Xr]=e:n[wd]=e,n[CS]=e,e}function $(n=1){eL(Ni(),Ut(),Nl()+n,!1)}function eL(n,e,t,i){if(!i)if((e[yt]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Ey(e,s,t)}else{let s=n.preOrderHooks;s!==null&&wy(e,s,0,t)}ec(t)}var qy=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(qy||{});function yT(n,e,t,i){let r=At(null);try{let[s,o,a]=n.inputs[t],c=null;(o&qy.SignalBased)!==0&&(c=e[s][Gi]),c!==null&&c.transformFn!==void 0?i=c.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,c,i,t,s):yk(e,c,s,i)}finally{At(r)}}var qs=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(qs||{}),a6;function qT(n,e){return a6(n,e)}var Dd=new Set,Xy=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Xy||{}),Bl=new Re(""),KO=new Set;function gp(n){KO.has(n)||(KO.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var tL=!1,vT=class extends ti{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,pO()&&(this.destroyRef=ie(Qr,{optional:!0})??void 0,this.pendingTasks=ie(Ws,{optional:!0})??void 0)}emit(e){let t=At(null);try{super.next(e)}finally{At(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof Hn&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},_n=vT;function nL(n){let e,t;function i(){n=lp;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function ZO(n){return queueMicrotask(()=>n()),()=>{n=lp}}var XT="isAngularZone",Oy=XT+"_ID",c6=0,Bt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new _n(!1);onMicrotaskEmpty=new _n(!1);onStable=new _n(!1);onError=new _n(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=tL}=e;if(typeof Zone>"u")throw new we(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,d6(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(XT)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new we(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new we(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,l6,lp,lp);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},l6={};function YT(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function u6(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){nL(()=>{n.callbackScheduled=!1,bT(n),n.isCheckStableRunning=!0,YT(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),bT(n)}function d6(n){let e=()=>{u6(n)},t=c6++;n._inner=n._inner.fork({name:"angular",properties:{[XT]:!0,[Oy]:t,[Oy+t]:!0},onInvokeTask:(i,r,s,o,a,c)=>{if(h6(c))return i.invokeTask(s,o,a,c);try{return JO(n),i.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),QO(n)}},onInvoke:(i,r,s,o,a,c,l)=>{try{return JO(n),i.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!f6(c)&&e(),QO(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,bT(n),YT(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function bT(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function JO(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function QO(n){n._nesting--,YT(n)}var ky=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new _n;onMicrotaskEmpty=new _n;onStable=new _n;onError=new _n;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function h6(n){return iL(n,"__ignore_ng_zone__")}function f6(n){return iL(n,"__scheduler_tick__")}function iL(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var KT=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=ke({token:n,providedIn:"root",factory:()=>new n})}return n})(),rL=[0,1,2,3],sL=(()=>{class n{ngZone=ie(Bt);scheduler=ie(Vo);errorHandler=ie(ps,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){ie(Bl,{optional:!0})}execute(){let t=this.sequences.size>0;t&&dn(16),this.executing=!0;for(let i of rL)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let s=r.hooks[i];return s(r.pipelinedValue)},r.snapshot))}catch(s){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&dn(17)}register(t){let{view:i}=t;i!==void 0?((i[Al]??=[]).push(t),Sd(i),i[yt]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Xy.AFTER_NEXT_RENDER,t):t()}static \u0275prov=ke({token:n,providedIn:"root",factory:()=>new n})}return n})(),Ly=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,s,o=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=o,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Al];e&&(this.view[Al]=e.filter(t=>t!==this))}};function Yy(n,e){let t=e?.injector??ie(Nn);return gp("NgAfterNextRender"),m6(n,t,e,!0)}function p6(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function m6(n,e,t,i){let r=e.get(KT);r.impl??=e.get(sL);let s=e.get(Bl,null,{optional:!0}),o=t?.manualCleanup!==!0?e.get(Qr):null,a=e.get(_y,null,{optional:!0}),c=new Ly(r.impl,p6(n),a?.view,i,o,s?.snapshot(null));return r.impl.register(c),c}var g6=new Re("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function oL(n,e){let t=n.get(g6);if(Array.isArray(e))for(let i of e)t.queue.add(i);else t.queue.add(e);t.scheduler&&t.scheduler(n)}function _6(n,e){for(let[t,i]of e)oL(n,i.animateFns)}function ek(n,e,t,i){let r=n?.[ip]?.enter;e!==null&&r&&r.has(t.index)&&_6(i,r)}function Id(n,e,t,i,r,s,o,a){if(r!=null){let c,l=!1;gs(r)?c=r:js(r)&&(l=!0,r=r[ms]);let u=Zr(r);n===0&&i!==null?(ek(a,i,s,t),o==null?Kk(e,i,u):Ny(e,i,u,o||null,!0)):n===1&&i!==null?(ek(a,i,s,t),Ny(e,i,u,o||null,!0)):n===2?tk(a,s,t,d=>{t6(e,u,l,d)}):n===3&&tk(a,s,t,()=>{e.destroyNode(u)}),c!=null&&D6(e,n,t,c,s,i,o)}}function y6(n,e){aL(n,e),e[ms]=null,e[Yr]=null}function v6(n,e,t,i,r,s){i[ms]=r,i[Yr]=e,Ky(n,i,t,1,r,s)}function aL(n,e){e[zs].changeDetectionScheduler?.notify(9),Ky(n,e,e[On],2,null,null)}function b6(n){let e=n[wd];if(!e)return rT(n[ht],n);for(;e;){let t=null;if(js(e))t=e[wd];else{let i=e[ar];i&&(t=i)}if(!t){for(;e&&!e[Xr]&&e!==n;)js(e)&&rT(e[ht],e),e=e[bi];e===null&&(e=n),js(e)&&rT(e[ht],e),t=e&&e[Xr]}e=t}}function ZT(n,e){let t=n[Dl],i=t.indexOf(e);t.splice(i,1)}function cL(n,e){if(Rl(e))return;let t=e[On];t.destroyNode&&Ky(n,e,t,3,null,null),b6(e)}function rT(n,e){if(Rl(e))return;let t=At(null);try{e[yt]&=-129,e[yt]|=256,e[Pr]&&Hf(e[Pr]),x6(n,e),w6(n,e),e[ht].type===1&&e[On].destroy();let i=e[Za];if(i!==null&&gs(e[bi])){i!==e[bi]&&ZT(i,e);let r=e[Hs];r!==null&&r.detachView(n)}mT(e)}finally{At(t)}}function tk(n,e,t,i){let r=n?.[ip];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);if(r.skipLeaveAnimations)return r.skipLeaveAnimations=!1,i(!1);n&&Dd.add(n),oL(t,()=>{if(r.leave&&r.leave.has(e.index)){let o=r.leave.get(e.index),a=[];if(o)for(let c=0;c<o.animateFns.length;c++){let l=o.animateFns[c],{promise:u}=l();a.push(u)}r.running=Promise.allSettled(a),E6(n,i)}else n&&Dd.delete(n),i(!1)})}function E6(n,e){let t=n[ip]?.running;if(t){t.then(()=>{n[ip].running=void 0,Dd.delete(n),e(!0)});return}e(!1)}function w6(n,e){let t=n.cleanup,i=e[Ed];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?i[a]():i[-a].unsubscribe(),o+=2}else{let a=i[t[o+1]];t[o].call(a)}i!==null&&(e[Ed]=null);let r=e[Lo];if(r!==null){e[Lo]=null;for(let o=0;o<r.length;o++){let a=r[o];a()}}let s=e[np];if(s!==null){e[np]=null;for(let o of s)o.destroy()}}function x6(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Ll)){let s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],c=s[o+1];dn(4,a,c);try{c.call(a)}finally{dn(5,a,c)}}else{dn(4,r,s);try{s.call(r)}finally{dn(5,r,s)}}}}}function S6(n,e,t){return T6(n,e.parent,t)}function T6(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[ms];if(Qa(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Bo.None||r===Bo.Emulated)return null}return _s(i,t)}function I6(n,e,t){return M6(n,e,t)}function C6(n,e,t){return n.type&40?_s(n,t):null}var M6=C6,nk;function JT(n,e,t,i){let r=S6(n,i,e),s=e[On],o=i.parent||e[Yr],a=I6(o,i,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)YO(s,r,t[c],a,!1);else YO(s,r,t,a,!1);nk!==void 0&&nk(s,i,e,t,r)}function up(n,e){if(e!==null){let t=e.type;if(t&3)return _s(e,n);if(t&4)return ET(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return up(n,i);{let r=n[e.index];return gs(r)?ET(-1,r):Zr(r)}}else{if(t&128)return up(n,e.next);if(t&32)return qT(e,n)()||Zr(n[e.index]);{let i=lL(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=qa(n[Kr]);return up(r,i)}else return up(n,e.next)}}}return null}function lL(n,e){if(e!==null){let i=n[Kr][Yr],r=e.projection;return i.projection[r]}return null}function ET(n,e){let t=ar+n+1;if(t<e.length){let i=e[t],r=i[ht].firstChild;if(r!==null)return up(i,r)}return e[Ja]}function QT(n,e,t,i,r,s,o){for(;t!=null;){let a=i[Ka];if(t.type===128){t=t.next;continue}let c=i[t.index],l=t.type;if(o&&e===0&&(c&&Ad(Zr(c),i),t.flags|=2),!BT(t))if(l&8)QT(n,e,t.child,i,r,s,!1),Id(e,n,a,r,c,t,s,i);else if(l&32){let u=qT(t,i),d;for(;d=u();)Id(e,n,a,r,d,t,s,i);Id(e,n,a,r,c,t,s,i)}else l&16?A6(n,e,i,t,r,s):Id(e,n,a,r,c,t,s,i);t=o?t.projectionNext:t.next}}function Ky(n,e,t,i,r,s){QT(t,i,n.firstChild,e,r,s,!1)}function A6(n,e,t,i,r,s){let o=t[Kr],c=o[Yr].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Id(e,n,t[Ka],r,u,i,s,t)}else{let l=c,u=o[bi];Nk(i)&&(l.flags|=128),QT(n,e,l,u,r,s,!0)}}function D6(n,e,t,i,r,s,o){let a=i[Ja],c=Zr(i);a!==c&&Id(e,n,t,s,a,r,o);for(let l=ar;l<i.length;l++){let u=i[l];Ky(u[ht],u,n,e,s,a)}}function R6(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=i.indexOf("-")===-1?void 0:qs.DashCase;r==null?n.removeStyle(t,i,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=qs.Important),n.setStyle(t,i,r,s))}}function uL(n,e,t,i,r){let s=Nl(),o=i&2;try{ec(-1),o&&e.length>Ei&&eL(n,e,Ei,!1),dn(o?2:0,r,t),t(i,r)}finally{ec(s),dn(o?3:1,r,t)}}function eI(n,e,t){V6(n,e,t),(t.flags&64)===64&&U6(n,e,t)}function tI(n,e,t=_s){let i=e.localNames;if(i!==null){let r=e.index+1;for(let s=0;s<i.length;s+=2){let o=i[s+1],a=o===-1?t(e,n):n[o];n[r++]=a}}}function P6(n,e,t,i){let s=i.get(Bk,Uk)||t===Bo.ShadowDom,o=n.selectRootElement(e,s);return N6(o),o}function N6(n){O6(n)}var O6=()=>null;function k6(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function dL(n,e,t,i,r,s){let o=e[ht];if(nI(n,o,e,t,i)){Qa(n)&&F6(e,n.index);return}n.type&3&&(t=k6(t)),L6(n,e,t,i,r,s)}function L6(n,e,t,i,r,s){if(n.type&3){let o=_s(n,e);i=s!=null?s(i,n.value||"",t):i,r.setProperty(o,t,i)}else n.type&12}function F6(n,e){let t=Jr(e,n);t[yt]&16||(t[yt]|=64)}function V6(n,e,t){let i=t.directiveStart,r=t.directiveEnd;Qa(t)&&o6(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Dy(t,e);let s=t.initialInputs;for(let o=i;o<r;o++){let a=n.data[o],c=hp(e,n,o,t);if(Ad(c,e),s!==null&&j6(e,o-i,c,a,t,s),Gs(a)){let l=Jr(t.index,e);l[$i]=hp(e,n,o,t)}}}function U6(n,e,t){let i=t.directiveStart,r=t.directiveEnd,s=t.index,o=PO();try{ec(s);for(let a=i;a<r;a++){let c=n.data[a],l=e[a];uy(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&B6(c,l)}}finally{ec(-1),uy(o)}}function B6(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function hL(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let s=t[r];qW(e,s.selectors,!1)&&(i??=[],Gs(s)?i.unshift(s):i.push(s))}return i}function z6(n,e,t,i,r,s){let o=_s(n,e);H6(e[On],o,s,n.value,t,i,r)}function H6(n,e,t,i,r,s,o){if(s==null)n.removeAttribute(e,r,t);else{let a=o==null?Kf(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}function j6(n,e,t,i,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],l=o[a+1];yT(i,t,c,l)}}function fL(n,e,t,i,r){let s=Ei+t,o=e[ht],a=r(o,e,n,i,t);e[s]=a,Td(n,!0);let c=n.type===2;return c?(Zk(e[On],a,n),(wO()===0||sp(n))&&Ad(a,e),xO()):Ad(a,e),my()&&(!c||!BT(n))&&JT(o,e,a,n),n}function pL(n){let e=n;return jS()?IO():(e=e.parent,Td(e,!1)),e}function G6(n,e){let t=n[Ka];if(!t)return;let i;try{i=t.get(lr,null)}catch{i=null}i?.(e)}function nI(n,e,t,i,r){let s=n.inputs?.[i],o=n.hostDirectiveInputs?.[i],a=!1;if(o)for(let c=0;c<o.length;c+=2){let l=o[c],u=o[c+1],d=e.data[l];yT(d,t[l],u,r),a=!0}if(s)for(let c of s){let l=t[c],u=e.data[c];yT(u,l,i,r),a=!0}return a}function W6(n,e){let t=Jr(e,n),i=t[ht];$6(i,t);let r=t[ms];r!==null&&t[ep]===null&&(t[ep]=zk(r,t[Ka])),dn(18),iI(i,t,t[$i]),dn(19,t[$i])}function $6(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function iI(n,e,t){hy(e);try{let i=n.viewQuery;i!==null&&_T(1,i,t);let r=n.template;r!==null&&uL(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Hs]?.finishViewCreation(n),n.staticContentQueries&&Hk(n,e),n.staticViewQueries&&_T(2,n.viewQuery,t);let s=n.components;s!==null&&q6(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[yt]&=-5,fy()}}function q6(n,e){for(let t=0;t<e.length;t++)W6(n,e[t])}function X6(n,e,t,i){let r=At(null);try{let s=e.tView,a=n[yt]&4096?4096:16,c=WT(n,s,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),l=n[e.index];c[Za]=l;let u=n[Hs];return u!==null&&(c[Hs]=u.createEmbeddedView(s)),iI(s,c,t),c}finally{At(r)}}function ik(n,e){return!e||e.firstChild===null||Nk(n)}function fp(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&i.push(Zr(s)),gs(s)&&mL(s,i);let o=t.type;if(o&8)fp(n,e,t.child,i);else if(o&32){let a=qT(t,e),c;for(;c=a();)i.push(c)}else if(o&16){let a=lL(e,t);if(Array.isArray(a))i.push(...a);else{let c=qa(e[Kr]);fp(c[ht],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function mL(n,e){for(let t=ar;t<n.length;t++){let i=n[t],r=i[ht].firstChild;r!==null&&fp(i[ht],i,r,e)}n[Ja]!==n[ms]&&e.push(n[Ja])}function gL(n){if(n[Al]!==null){for(let e of n[Al])e.impl.addSequence(e);n[Al].length=0}}var _L=[];function Y6(n){return n[Pr]??K6(n)}function K6(n){let e=_L.pop()??Object.create(J6);return e.lView=n,e}function Z6(n){n.lView[Pr]!==n&&(n.lView=null,_L.push(n))}var J6=je(ae({},td),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Sd(n.lView)},consumerOnSignalRead(){this.lView[Pr]=this}});function Q6(n){let e=n[Pr]??Object.create(e8);return e.lView=n,e}var e8=je(ae({},td),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=qa(n.lView);for(;e&&!yL(e[ht]);)e=qa(e);e&&OS(e)},consumerOnSignalRead(){this.lView[Pr]=this}});function yL(n){return n.type!==2}function vL(n){if(n[np]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[np])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[yt]&8192)}}var t8=100;function bL(n,e=0){let i=n[zs].rendererFactory,r=!1;r||i.begin?.();try{n8(n,e)}finally{r||i.end?.()}}function n8(n,e){let t=GS();try{WS(!0),wT(n,e);let i=0;for(;op(n);){if(i===t8)throw new we(103,!1);i++,wT(n,1)}}finally{WS(t)}}function i8(n,e,t,i){if(Rl(e))return;let r=e[yt],s=!1,o=!1;hy(e);let a=!0,c=null,l=null;s||(yL(n)?(l=Y6(e),c=id(l)):g_()===null?(a=!1,l=Q6(e),c=id(l)):e[Pr]&&(Hf(e[Pr]),e[Pr]=null));try{NS(e),MO(n.bindingStartIndex),t!==null&&uL(n,e,t,2,i);let u=(r&3)===3;if(!s)if(u){let p=n.preOrderCheckHooks;p!==null&&Ey(e,p,null)}else{let p=n.preOrderHooks;p!==null&&wy(e,p,0,null),nT(e,0)}if(o||r8(e),vL(e),EL(e,0),n.contentQueries!==null&&Hk(n,e),!s)if(u){let p=n.contentCheckHooks;p!==null&&Ey(e,p)}else{let p=n.contentHooks;p!==null&&wy(e,p,1),nT(e,1)}o8(n,e);let d=n.components;d!==null&&xL(e,d,0);let h=n.viewQuery;if(h!==null&&_T(2,h,i),!s)if(u){let p=n.viewCheckHooks;p!==null&&Ey(e,p)}else{let p=n.viewHooks;p!==null&&wy(e,p,2),nT(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[ry]){for(let p of e[ry])p();e[ry]=null}s||(gL(e),e[yt]&=-73)}catch(u){throw s||Sd(e),u}finally{l!==null&&(Bf(l,c),a&&Z6(l)),fy()}}function EL(n,e){for(let t=kk(n);t!==null;t=Lk(t))for(let i=ar;i<t.length;i++){let r=t[i];wL(r,e)}}function r8(n){for(let e=kk(n);e!==null;e=Lk(e)){if(!(e[yt]&2))continue;let t=e[Dl];for(let i=0;i<t.length;i++){let r=t[i];OS(r)}}}function s8(n,e,t){dn(18);let i=Jr(e,n);wL(i,t),dn(19,i[$i])}function wL(n,e){ay(n)&&wT(n,e)}function wT(n,e){let i=n[ht],r=n[yt],s=n[Pr],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&zf(s)),o||=!1,s&&(s.dirty=!1),n[yt]&=-9217,o)i8(i,n,i.template,n[$i]);else if(r&8192){let a=At(null);try{vL(n),EL(n,1);let c=i.components;c!==null&&xL(n,c,1),gL(n)}finally{At(a)}}}function xL(n,e,t){for(let i=0;i<e.length;i++)s8(n,e[i],t)}function o8(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)ec(~r);else{let s=r,o=t[++i],a=t[++i];RO(o,s);let c=e[s];dn(24,c),a(2,c),dn(25,c)}}}finally{ec(-1)}}function rI(n,e){let t=GS()?64:1088;for(n[zs].changeDetectionScheduler?.notify(e);n;){n[yt]|=t;let i=qa(n);if(xd(n)&&!i)return n;n=i}return null}function SL(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function a8(n,e,t,i=!0){let r=e[ht];if(c8(r,e,n,t),i){let o=ET(t,n),a=e[On],c=a.parentNode(n[Ja]);c!==null&&v6(r,n[Yr],a,e,c,o)}let s=e[ep];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function xT(n,e){if(n.length<=ar)return;let t=ar+e,i=n[t];if(i){let r=i[Za];r!==null&&r!==n&&ZT(r,i),e>0&&(n[t-1][Xr]=i[Xr]);let s=Zf(n,ar+e);y6(i[ht],i);let o=s[Hs];o!==null&&o.detachView(s[ht]),i[bi]=null,i[Xr]=null,i[yt]&=-129}return i}function c8(n,e,t,i){let r=ar+i,s=t.length;i>0&&(t[r-1][Xr]=e),i<s-ar?(e[Xr]=t[r],vS(t,ar+i,e)):(t.push(e),e[Xr]=null),e[bi]=t;let o=e[Za];o!==null&&t!==o&&TL(o,e);let a=e[Hs];a!==null&&a.insertView(n),cy(e),e[yt]|=128}function TL(n,e){let t=n[Dl],i=e[bi];if(js(i))n[yt]|=2;else{let r=i[bi][Kr];e[Kr]!==r&&(n[yt]|=2)}t===null?n[Dl]=[e]:t.push(e)}var nc=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[ht];return fp(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[$i]}set context(e){this._lView[$i]=e}get destroyed(){return Rl(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[bi];if(gs(e)){let t=e[rp],i=t?t.indexOf(this):-1;i>-1&&(xT(e,i),Zf(t,i))}this._attachedToViewContainer=!1}cL(this._lView[ht],this._lView)}onDestroy(e){kS(this._lView,e)}markForCheck(){rI(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[yt]&=-129}reattach(){cy(this._lView),this._lView[yt]|=128}detectChanges(){this._lView[yt]|=1024,bL(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new we(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=xd(this._lView),t=this._lView[Za];t!==null&&!e&&ZT(t,this._lView),aL(this._lView[ht],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new we(902,!1);this._appRef=e;let t=xd(this._lView),i=this._lView[Za];i!==null&&!t&&TL(i,this._lView),cy(this._lView)}};var ic=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=l8;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let s=X6(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new nc(s)}}return n})();function l8(){return Zy(Oi(),Ut())}function Zy(n,e){return n.type&4?new ic(e,n,Od(n,e)):null}function Jy(n,e,t,i,r){let s=n.data[e];if(s===null)s=u8(n,e,t,i,r),DO()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=i,s.attrs=r;let o=TO();s.injectorIndex=o===null?-1:o.injectorIndex}return Td(s,!0),s}function u8(n,e,t,i,r){let s=HS(),o=jS(),a=o?s:s&&s.parent,c=n.data[e]=h8(n,a,t,e,i,r);return d8(n,c,s,o),c}function d8(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function h8(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return SO()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var E0e=new RegExp(`^(\\d+)*(${LW}|${kW})*(.*)`);var f8=()=>null;function rk(n,e){return f8(n,e)}var IL=class{},Qy=class{},ST=class{resolveComponentFactory(e){throw new we(917,!1)}},_p=class{static NULL=new ST},Fl=class{},vs=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>p8()}return n})();function p8(){let n=Ut(),e=Oi(),t=Jr(e.index,n);return(js(t)?t:n)[On]}var CL=(()=>{class n{static \u0275prov=ke({token:n,providedIn:"root",factory:()=>null})}return n})();var Sy={},TT=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,Sy,i);return r!==Sy||t===Sy?r:this.parentInjector.get(e,t,i)}};function Fy(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=lS(r,a);else if(s==2){let c=a,l=e[++o];i=lS(i,c+": "+l+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Ue(n,e=0){let t=Ut();if(t===null)return Qe(n,e);let i=Oi();return Dk(i,t,Pi(n),e)}function ML(n,e,t,i,r){let s=i===null?null:{"":-1},o=r(n,t);if(o!==null){let a=o,c=null,l=null;for(let u of o)if(u.resolveHostDirectives!==null){[a,c,l]=u.resolveHostDirectives(o);break}_8(n,e,t,a,s,c,l)}s!==null&&i!==null&&m8(t,i,s)}function m8(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new we(-301,!1);i.push(e[r],s)}}function g8(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function _8(n,e,t,i,r,s,o){let a=i.length,c=!1;for(let h=0;h<a;h++){let p=i[h];!c&&Gs(p)&&(c=!0,g8(n,t,h)),fT(Dy(t,e),n,p.type)}x8(t,n.data.length,a);for(let h=0;h<a;h++){let p=i[h];p.providersResolver&&p.providersResolver(p)}let l=!1,u=!1,d=Qk(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){let p=i[h];if(t.mergedAttrs=Md(t.mergedAttrs,p.hostAttrs),v8(n,t,e,d,p),w8(d,p,r),o!==null&&o.has(p)){let[y,m]=o.get(p);t.directiveToIndex.set(p.type,[d,y+t.directiveStart,m+t.directiveStart])}else(s===null||!s.has(p))&&t.directiveToIndex.set(p.type,d);p.contentQueries!==null&&(t.flags|=4),(p.hostBindings!==null||p.hostAttrs!==null||p.hostVars!==0)&&(t.flags|=64);let g=p.type.prototype;!l&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!u&&(g.ngOnChanges||g.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}y8(n,t,s)}function y8(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))sk(0,e,r,i),sk(1,e,r,i),ak(e,i,!1);else{let s=t.get(r);ok(0,e,s,i),ok(1,e,s,i),ak(e,i,!0)}}}function sk(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let s in r)if(r.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(i),AL(e,s)}}function ok(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let s in r)if(r.hasOwnProperty(s)){let o=r[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(i,s),AL(e,o)}}function AL(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function ak(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:s}=n;if(i===null||!t&&r===null||t&&s===null||jT(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<i.length;){let c=i[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&r.hasOwnProperty(c)){let l=r[c];for(let u of l)if(u===e){o??=[],o.push(c,i[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let l=s[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){o??=[],o.push(l[u+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function v8(n,e,t,i,r){n.data[i]=r;let s=r.factory||(r.factory=$a(r.type,!0)),o=new Ll(s,Gs(r),Ue,null);n.blueprint[i]=o,t[i]=o,b8(n,e,i,Qk(n,t,r.hostVars,Ks),r)}function b8(n,e,t,i,r){let s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;E8(o)!=a&&o.push(a),o.push(t,i,s)}}function E8(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function w8(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Gs(e)&&(t[""]=n)}}function x8(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function DL(n,e,t,i,r,s,o,a){let c=e[ht],l=c.consts,u=Pl(l,o),d=Jy(c,n,t,i,u);return s&&ML(c,e,d,Pl(l,a),r),d.mergedAttrs=Md(d.mergedAttrs,d.attrs),d.attrs!==null&&Fy(d,d.attrs,!1),d.mergedAttrs!==null&&Fy(d,d.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,d),d}function RL(n,e){wk(n,e),AS(e)&&n.queries.elementEnd(e)}function S8(n,e,t,i,r,s){let o=e.consts,a=Pl(o,r),c=Jy(e,n,t,i,a);if(c.mergedAttrs=Md(c.mergedAttrs,c.attrs),s!=null){let l=Pl(o,s);c.localNames=[];for(let u=0;u<l.length;u+=2)c.localNames.push(l[u],-1)}return c.attrs!==null&&Fy(c,c.attrs,!1),c.mergedAttrs!==null&&Fy(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function sI(n){return NL(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function PL(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function NL(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function oI(n,e,t){return n[e]=t}function T8(n,e){return n[e]}function rc(n,e,t){if(t===Ks)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function I8(n,e,t,i){let r=rc(n,e,t);return rc(n,e+1,i)||r}function Ty(n,e,t){return function i(r){let s=Qa(n)?Jr(n.index,e):e;rI(s,5);let o=e[$i],a=ck(e,o,t,r),c=i.__ngNextListenerFn__;for(;c;)a=ck(e,o,c,r)&&a,c=c.__ngNextListenerFn__;return a}}function ck(n,e,t,i){let r=At(null);try{return dn(6,e,t),t(i)!==!1}catch(s){return G6(n,s),!1}finally{dn(7,e,t),At(r)}}function OL(n,e,t,i,r,s,o,a){let c=sp(n),l=!1,u=null;if(!i&&c&&(u=M8(e,t,s,n.index)),u!==null){let d=u.__ngLastListenerFn__||u;d.__ngNextListenerFn__=o,u.__ngLastListenerFn__=o,l=!0}else{let d=_s(n,t),h=i?i(d):d;VW(t,h,s,a);let p=r.listen(h,s,a);if(!C8(s)){let g=i?y=>i(Zr(y[n.index])):n.index;kL(g,e,t,s,a,p,!1)}}return l}function C8(n){return n.startsWith("animation")||n.startsWith("transition")}function M8(n,e,t,i){let r=n.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===i){let a=e[Ed],c=r[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function kL(n,e,t,i,r,s,o){let a=e.firstCreatePass?FS(e):null,c=LS(t),l=c.length;c.push(r,s),a&&a.push(i,n,l,(l+1)*(o?-1:1))}function lk(n,e,t,i,r,s){let o=e[t],a=e[ht],l=a.data[t].outputs[i],d=o[l].subscribe(s);kL(n.index,a,e,r,s,d,!0)}var IT=Symbol("BINDING");var Vy=class extends _p{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Ya(e);return new Rd(t,this.ngModule)}};function A8(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],s={propName:t,templateName:e,isSignal:(i&qy.SignalBased)!==0};return r&&(s.transform=r),s})}function D8(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function R8(n,e,t){let i=e instanceof Xn?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new TT(t,i):t}function P8(n){let e=n.get(Fl,null);if(e===null)throw new we(407,!1);let t=n.get(CL,null),i=n.get(Vo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function N8(n,e){let t=LL(n);return Yk(e,t,t==="svg"?DS:t==="math"?gO:null)}function LL(n){return(n.selectors[0][0]||"div").toLowerCase()}var Rd=class extends Qy{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=A8(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=D8(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=ZW(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,s,o){dn(22);let a=At(null);try{let c=this.componentDef,l=O8(i,c,o,s),u=R8(c,r||this.ngModule,e),d=P8(u),h=d.rendererFactory.createRenderer(null,c),p=i?P6(h,i,c.encapsulation,u):N8(c,h),g=o?.some(uk)||s?.some(_=>typeof _!="function"&&_.bindings.some(uk)),y=WT(null,l,null,512|Jk(c),null,null,d,h,u,null,zk(p,u,!0));y[Ei]=p,hy(y);let m=null;try{let _=DL(Ei,y,2,"#host",()=>l.directiveRegistry,!0,0);Zk(h,p,_),Ad(p,y),eI(l,y,_),jk(l,_,y),RL(l,_),t!==void 0&&L8(_,this.ngContentSelectors,t),m=Jr(_.index,y),y[$i]=m[$i],iI(l,y,null)}catch(_){throw m!==null&&mT(m),mT(y),_}finally{dn(23),fy()}return new Uy(this.componentType,y,!!g)}finally{At(a)}}};function O8(n,e,t,i){let r=n?["ng-version","20.3.9"]:JW(e.selectors[0]),s=null,o=null,a=0;if(t)for(let u of t)a+=u[IT].requiredVars,u.create&&(u.targetIdx=0,(s??=[]).push(u)),u.update&&(u.targetIdx=0,(o??=[]).push(u));if(i)for(let u=0;u<i.length;u++){let d=i[u];if(typeof d!="function")for(let h of d.bindings){a+=h[IT].requiredVars;let p=u+1;h.create&&(h.targetIdx=p,(s??=[]).push(h)),h.update&&(h.targetIdx=p,(o??=[]).push(h))}}let c=[e];if(i)for(let u of i){let d=typeof u=="function"?u:u.type,h=xS(d);c.push(h)}return GT(0,null,k8(s,o),1,a,c,null,null,null,[r],null)}function k8(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function uk(n){let e=n[IT].kind;return e==="input"||e==="twoWay"}var Uy=class extends IL{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=sy(t[ht],Ei),this.location=Od(this._tNode,t),this.instance=Jr(this._tNode.index,t)[$i],this.hostView=this.changeDetectorRef=new nc(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,s=nI(i,r[ht],r,e,t);this.previousInputValues.set(e,t);let o=Jr(i.index,r);rI(o,1)}get injector(){return new kl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function L8(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let s=t[r];i.push(s!=null&&s.length?Array.from(s):null)}}var Ho=(()=>{class n{static __NG_ELEMENT_ID__=F8}return n})();function F8(){let n=Oi();return VL(n,Ut())}var V8=Ho,FL=class extends V8{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Od(this._hostTNode,this._hostLView)}get injector(){return new kl(this._hostTNode,this._hostLView)}get parentInjector(){let e=FT(this._hostTNode,this._hostLView);if(Sk(e)){let t=My(e,this._hostLView),i=Cy(e),r=t[ht].data[i+8];return new kl(r,t)}else return new kl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=dk(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ar}createEmbeddedView(e,t,i){let r,s;typeof i=="number"?r=i:i!=null&&(r=i.index,s=i.injector);let o=rk(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,ik(this._hostTNode,o)),a}createComponent(e,t,i,r,s,o,a){let c=e&&!lW(e),l;if(c)l=t;else{let m=t||{};l=m.index,i=m.injector,r=m.projectableNodes,s=m.environmentInjector||m.ngModuleRef,o=m.directives,a=m.bindings}let u=c?e:new Rd(Ya(e)),d=i||this.parentInjector;if(!s&&u.ngModule==null){let _=(c?d:this.parentInjector).get(Xn,null);_&&(s=_)}let h=Ya(u.componentType??{}),p=rk(this._lContainer,h?.id??null),g=p?.firstChild??null,y=u.create(d,r,g,s,o,a);return this.insertImpl(y.hostView,l,ik(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(yO(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[bi],l=new FL(c,c[Yr],c[bi]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return a8(o,r,s,i),e.attachToViewContainerRef(),vS(sT(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=dk(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=xT(this._lContainer,t);i&&(Zf(sT(this._lContainer),t),cL(i[ht],i))}detach(e){let t=this._adjustIndex(e,-1),i=xT(this._lContainer,t);return i&&Zf(sT(this._lContainer),t)!=null?new nc(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function dk(n){return n[rp]}function sT(n){return n[rp]||(n[rp]=[])}function VL(n,e){let t,i=e[n.index];return gs(i)?t=i:(t=SL(i,e,null,n),e[n.index]=t,$T(e,t)),B8(t,e,n,i),new FL(t,n,e)}function U8(n,e){let t=n[On],i=t.createComment(""),r=_s(e,n),s=t.parentNode(r);return Ny(t,s,i,t.nextSibling(r),!1),i}var B8=j8,z8=()=>!1;function H8(n,e,t){return z8(n,e,t)}function j8(n,e,t,i){if(n[Ja])return;let r;t.type&8?r=Zr(i):r=U8(e,t),n[Ja]=r}var CT=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},MT=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)aI(e,t).matches!==null&&this.queries[t].setDirty()}},AT=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=Z8(e):this.predicate=e}},DT=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,t!==null?t.push(s):t=[s])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},RT=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let s=i[r];this.matchTNodeWithReadOption(e,t,G8(t,s)),this.matchTNodeWithReadOption(e,t,xy(t,e,s,!1,!1))}else i===ic?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,xy(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===es||r===Ho||r===ic&&t.type&4)this.addMatch(t.index,-2);else{let s=xy(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function G8(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function W8(n,e){return n.type&11?Od(n,e):n.type&4?Zy(n,e):null}function $8(n,e,t,i){return t===-1?W8(e,n):t===-2?q8(n,e,i):hp(n,n[ht],t,e)}function q8(n,e,t){if(t===es)return Od(e,n);if(t===ic)return Zy(e,n);if(t===Ho)return VL(e,n)}function UL(n,e,t,i){let r=e[Hs].queries[i];if(r.matches===null){let s=n.data,o=t.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let u=s[l];a.push($8(e,u,o[c+1],t.metadata.read))}}r.matches=a}return r.matches}function PT(n,e,t,i){let r=n.queries.getByIndex(t),s=r.matches;if(s!==null){let o=UL(n,e,r,t);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)i.push(o[a/2]);else{let l=s[a+1],u=e[-c];for(let d=ar;d<u.length;d++){let h=u[d];h[Za]===h[bi]&&PT(h[ht],h,l,i)}if(u[Dl]!==null){let d=u[Dl];for(let h=0;h<d.length;h++){let p=d[h];PT(p[ht],p,l,i)}}}}}return i}function X8(n,e){return n[Hs].queries[e].queryList}function Y8(n,e,t){let i=new Ry((t&4)===4);return EO(n,e,i,i.destroy),(e[Hs]??=new MT).queries.push(new CT(i))-1}function K8(n,e,t){let i=Ni();return i.firstCreatePass&&(J8(i,new AT(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),Y8(i,Ut(),e)}function Z8(n){return n.split(",").map(e=>e.trim())}function J8(n,e,t){n.queries===null&&(n.queries=new DT),n.queries.track(new RT(e,t))}function aI(n,e){return n.queries.getByIndex(e)}function Q8(n,e){let t=n[ht],i=aI(t,e);return i.crossesNgTemplate?PT(t,n,e,[]):UL(t,n,i,e)}var Vl=class{},ev=class{};var By=class extends Vl{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Vy(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let s=wS(e);this._bootstrapComponents=qk(s.bootstrap),this._r3Injector=YS(e,t,[{provide:Vl,useValue:this},{provide:_p,useValue:this.componentFactoryResolver},...i],Fo(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},zy=class extends ev{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new By(this.moduleType,e,[])}};var pp=class extends Vl{injector;componentFactoryResolver=new Vy(this);instance=null;constructor(e){super();let t=new xl([...e.providers,{provide:Vl,useValue:this},{provide:_p,useValue:this.componentFactoryResolver}],e.parent||Qf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function yp(n,e,t=null){return new pp({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var e$=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=SS(!1,t.type),r=i.length>0?yp([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ke({token:n,providedIn:"environment",factory:()=>new n(Qe(Xn))})}return n})();function kn(n){return Nd(()=>{let e=BL(n),t=je(ae({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===VT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(e$).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Bo.Emulated,styles:n.styles||Dr,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&gp("NgStandalone"),zL(t);let i=n.dependencies;return t.directiveDefs=hk(i,t$),t.pipeDefs=hk(i,cO),t.id=r$(t),t})}function t$(n){return Ya(n)||xS(n)}function bs(n){return Nd(()=>({type:n.type,bootstrap:n.bootstrap||Dr,declarations:n.declarations||Dr,imports:n.imports||Dr,exports:n.exports||Dr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function n$(n,e){if(n==null)return Xa;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],s,o,a,c;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s,c=r[3]||null):(s=r,o=r,a=qy.None,c=null),t[s]=[i,a,c],e[s]=o}return t}function i$(n){if(n==null)return Xa;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function An(n){return Nd(()=>{let e=BL(n);return zL(e),e})}function vp(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function BL(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Xa,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Dr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:n$(n.inputs,e),outputs:i$(n.outputs),debugInfo:null}}function zL(n){n.features?.forEach(e=>e(n))}function hk(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let s=e(r);s!==null&&i.push(s)}return i}:null}function r$(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of i.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function s$(n){return Object.getPrototypeOf(n.prototype).constructor}function br(n){let e=s$(n.type),t=!0,i=[n];for(;e;){let r;if(Gs(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new we(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let o=n;o.inputs=oT(n.inputs),o.declaredInputs=oT(n.declaredInputs),o.outputs=oT(n.outputs);let a=r.hostBindings;a&&u$(n,a);let c=r.viewQuery,l=r.contentQueries;if(c&&c$(n,c),l&&l$(n,l),o$(n,r),JN(n.outputs,r.outputs),Gs(r)&&r.data.animation){let u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}let s=r.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===br&&(t=!1)}}e=Object.getPrototypeOf(e)}a$(i)}function o$(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function a$(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Md(r.hostAttrs,t=Md(t,r.hostAttrs))}}function oT(n){return n===Xa?{}:n===Dr?[]:n}function c$(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function l$(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,s)=>{e(i,r,s),t(i,r,s)}:n.contentQueries=e}function u$(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function d$(n,e,t,i,r,s,o,a){if(t.firstCreatePass){n.mergedAttrs=Md(n.mergedAttrs,n.attrs);let u=n.tView=GT(2,n,r,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),u.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Td(n,!1);let c=f$(t,e,n,i);my()&&JT(t,e,c,n),Ad(c,e);let l=SL(c,e,c,n);e[i+Ei]=l,$T(e,l),H8(l,n,e)}function h$(n,e,t,i,r,s,o,a,c,l,u){let d=t+Ei,h;return e.firstCreatePass?(h=Jy(e,d,4,o||null,a||null),US()&&ML(e,n,h,Pl(e.consts,l),hL),wk(e,h)):h=e.data[d],d$(h,n,e,t,i,r,s,c),sp(h)&&eI(e,n,h),l!=null&&tI(n,h,u),h}function lt(n,e,t,i,r,s,o,a){let c=Ut(),l=Ni(),u=Pl(l.consts,s);return h$(c,l,n,e,t,i,r,u,void 0,o,a),lt}var f$=p$;function p$(n,e,t,i){return gy(!0),e[On].createComment("")}var cI=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var lI=new Re("");function jo(n){return!!n&&typeof n.then=="function"}function tv(n){return!!n&&typeof n.subscribe=="function"}var HL=new Re("");var uI=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=ie(HL,{optional:!0})??[];injector=ie(Nn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let s=Yn(this.injector,r);if(jo(s))t.push(s);else if(tv(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nv=new Re("");function jL(){Px(()=>{let n="";throw new we(600,n)})}function GL(n){return n.isBoundToModule}var m$=10;var Go=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=ie(lr);afterRenderManager=ie(KT);zonelessEnabled=ie(cp);rootEffectScheduler=ie(tT);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new ti;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=ie(Ws);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(gt(t=>!t))}constructor(){ie(Bl,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=ie(Xn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Nn.NULL){return this._injector.get(Bt).run(()=>{dn(10);let o=t instanceof Qy;if(!this._injector.get(uI).done){let g="";throw new we(405,g)}let c;o?c=t:c=this._injector.get(_p).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let l=GL(c)?void 0:this._injector.get(Vl),u=i||c.selector,d=c.create(r,[],u,l),h=d.location.nativeElement,p=d.injector.get(lI,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),dp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),dn(11,d),d})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){dn(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Xy.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new we(101,!1);let t=At(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,At(t),this.afterTick.next(),dn(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Fl,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<m$;)dn(14),this.synchronizeOnce(),dn(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!op(r))continue;let s=i&&!this.zonelessEnabled?0:1;bL(r,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>op(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;dp(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(nv,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>dp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new we(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function iv(n,e,t,i){let r=Ut(),s=ap();if(rc(r,s,e)){let o=Ni(),a=py();z6(a,r,n,e,t,i)}return iv}var M0e=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function ye(n,e,t){let i=Ut(),r=ap();if(rc(i,r,e)){let s=Ni(),o=py();dL(o,i,n,e,i[On],t)}return ye}function fk(n,e,t,i,r){nI(e,n,t,r?"class":"style",i)}function F(n,e,t,i){let r=Ut(),s=r[ht],o=n+Ei,a=s.firstCreatePass?DL(o,r,2,e,hL,US(),t,i):s.data[o];if(fL(a,r,n,e,WL),sp(a)){let c=r[ht];eI(c,r,a),jk(c,a,r)}return i!=null&&tI(r,a),F}function B(){let n=Ni(),e=Oi(),t=pL(e);return n.firstCreatePass&&RL(n,t),BS(t)&&zS(),VS(),t.classesWithoutHost!=null&&mW(t)&&fk(n,t,Ut(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&gW(t)&&fk(n,t,Ut(),t.stylesWithoutHost,!1),B}function Ce(n,e,t,i){return F(n,e,t,i),B(),Ce}function Zn(n,e,t,i){let r=Ut(),s=r[ht],o=n+Ei,a=s.firstCreatePass?S8(o,s,2,e,t,i):s.data[o];return fL(a,r,n,e,WL),i!=null&&tI(r,a),Zn}function ri(){let n=Oi(),e=pL(n);return BS(e)&&zS(),VS(),ri}function Zs(n,e,t,i){return Zn(n,e,t,i),ri(),Zs}var WL=(n,e,t,i,r)=>(gy(!0),Yk(e[On],i,VO()));function rn(){return Ut()}var vy=void 0;function g$(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var _$=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],vy,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],vy,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",vy,"{1} 'at' {0}",vy],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",g$],aT={};function Or(n){let e=y$(n),t=pk(e);if(t)return t;let i=e.split("-")[0];if(t=pk(i),t)return t;if(i==="en")return _$;throw new we(701,!1)}function pk(n){return n in aT||(aT[n]=Tl.ng&&Tl.ng.common&&Tl.ng.common.locales&&Tl.ng.common.locales[n]),aT[n]}var Jn=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(Jn||{});function y$(n){return n.toLowerCase().replace(/_/g,"-")}var bp="en-US";var v$=bp;function $L(n){typeof n=="string"&&(v$=n.toLowerCase().replace(/_/g,"-"))}function Pe(n,e,t){let i=Ut(),r=Ni(),s=Oi();return qL(r,i,i[On],s,n,e,t),Pe}function Ld(n,e,t){let i=Ut(),r=Ni(),s=Oi();return(s.type&3||t)&&OL(s,r,i,t,i[On],n,e,Ty(s,i,e)),Ld}function qL(n,e,t,i,r,s,o){let a=!0,c=null;if((i.type&3||o)&&(c??=Ty(i,e,s),OL(i,n,e,o,t,r,s,c)&&(a=!1)),a){let l=i.outputs?.[r],u=i.hostDirectiveOutputs?.[r];if(u&&u.length)for(let d=0;d<u.length;d+=2){let h=u[d],p=u[d+1];c??=Ty(i,e,s),lk(i,e,h,p,r,c)}if(l&&l.length)for(let d of l)c??=Ty(i,e,s),lk(i,e,d,r,r,c)}}function xe(n=1){return FO(n)}function Js(n,e,t){K8(n,e,t)}function Qs(n){let e=Ut(),t=Ni(),i=$S();dy(i+1);let r=aI(t,i);if(n.dirty&&_O(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let s=Q8(e,i);n.reset(s,AW),n.notifyOnChanges()}return!0}return!1}function eo(){return X8(Ut(),$S())}function qi(n){let e=CO();return oy(e,Ei+n)}function by(n,e){return n<<17|e<<2}function Ul(n){return n>>17&32767}function b$(n){return(n&2)==2}function E$(n,e){return n&131071|e<<17}function NT(n){return n|2}function Pd(n){return(n&131068)>>2}function cT(n,e){return n&-131069|e<<2}function w$(n){return(n&1)===1}function OT(n){return n|1}function x$(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Ul(o),c=Pd(o);n[i]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||bd(d,u)>0)&&(l=!0)}else u=t;if(r)if(c!==0){let h=Ul(n[a+1]);n[i+1]=by(h,a),h!==0&&(n[h+1]=cT(n[h+1],i)),n[a+1]=E$(n[a+1],i)}else n[i+1]=by(a,0),a!==0&&(n[a+1]=cT(n[a+1],i)),a=i;else n[i+1]=by(c,0),a===0?a=i:n[c+1]=cT(n[c+1],i),c=i;l&&(n[i+1]=NT(n[i+1])),mk(n,u,i,!0),mk(n,u,i,!1),S$(e,u,n,i,s),o=by(a,c),s?e.classBindings=o:e.styleBindings=o}function S$(n,e,t,i,r){let s=r?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&bd(s,e)>=0&&(t[i+1]=OT(t[i+1]))}function mk(n,e,t,i){let r=n[t+1],s=e===null,o=i?Ul(r):Pd(r),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],l=n[o+1];T$(c,e)&&(a=!0,n[o+1]=i?OT(l):NT(l)),o=i?Ul(l):Pd(l)}a&&(n[t+1]=i?NT(r):OT(r))}function T$(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?bd(n,e)>=0:!1}function ur(n,e,t){return XL(n,e,t,!1),ur}function yn(n,e){return XL(n,e,null,!0),yn}function XL(n,e,t,i){let r=Ut(),s=Ni(),o=AO(2);if(s.firstUpdatePass&&C$(s,n,o,i),e!==Ks&&rc(r,o,e)){let a=s.data[Nl()];P$(s,a,r,r[On],n,r[o+1]=N$(e,t),i,o)}}function I$(n,e){return e>=n.expandoStartIndex}function C$(n,e,t,i){let r=n.data;if(r[t+1]===null){let s=r[Nl()],o=I$(n,t);O$(s,i)&&e===null&&!o&&(e=!1),e=M$(r,s,e,i),x$(r,s,e,t,o,i)}}function M$(n,e,t,i){let r=NO(n),s=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=lT(null,n,e,t,i),t=mp(t,e.attrs,i),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==r)if(t=lT(r,n,e,t,i),s===null){let c=A$(n,e,i);c!==void 0&&Array.isArray(c)&&(c=lT(null,n,e,c[1],i),c=mp(c,e.attrs,i),D$(n,e,i,c))}else s=R$(n,e,i)}return s!==void 0&&(i?e.residualClasses=s:e.residualStyles=s),t}function A$(n,e,t){let i=t?e.classBindings:e.styleBindings;if(Pd(i)!==0)return n[Ul(i)]}function D$(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[Ul(r)]=i}function R$(n,e,t){let i,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=n[s].hostAttrs;i=mp(i,o,t)}return mp(i,e.attrs,t)}function lT(n,e,t,i,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],i=mp(i,s.hostAttrs,r),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function mp(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),aO(n,o,t?!0:e[++s]))}return n===void 0?null:n}function P$(n,e,t,i,r,s,o,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],u=w$(l)?gk(c,e,t,r,Pd(l),o):void 0;if(!Hy(u)){Hy(s)||b$(l)&&(s=gk(c,null,t,r,a,o));let d=RS(Nl(),t);R6(i,o,d,r,s)}}function gk(n,e,t,i,r,s){let o=e===null,a;for(;r>0;){let c=n[r],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=t[r+1];h===Ks&&(h=d?Dr:void 0);let p=d?iy(h,i):u===i?h:void 0;if(l&&!Hy(p)&&(p=iy(c,i)),Hy(p)&&(a=p,o))return a;let g=n[r+1];r=o?Ul(g):Pd(g)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=iy(c,i))}return a}function Hy(n){return n!==void 0}function N$(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Fo(zT(n)))),n}function O$(n,e){return(n.flags&(e?8:16))!==0}function j(n,e=""){let t=Ut(),i=Ni(),r=n+Ei,s=i.firstCreatePass?Jy(i,r,1,e,null):i.data[r],o=k$(i,t,s,e,n);t[r]=o,my()&&JT(i,t,o,s),Td(s,!1)}var k$=(n,e,t,i,r)=>(gy(!0),QW(e[On],i));function L$(n,e,t,i=""){return rc(n,ap(),t)?e+Kf(t)+i:Ks}function ft(n){return vn("",n),ft}function vn(n,e,t){let i=Ut(),r=L$(i,n,e,t);return r!==Ks&&F$(i,Nl(),r),vn}function F$(n,e,t){let i=RS(e,n);e6(n[On],i,t)}function Wo(n,e,t){JS(e)&&(e=e());let i=Ut(),r=ap();if(rc(i,r,e)){let s=Ni(),o=py();dL(o,i,n,e,i[On],t)}return Wo}function oc(n,e){let t=JS(n);return t&&n.set(e),t}function $o(n,e){let t=Ut(),i=Ni(),r=Oi();return qL(i,t,t[On],r,n,e),$o}function V$(n,e,t){let i=Ni();if(i.firstCreatePass){let r=Gs(n);kT(t,i.data,i.blueprint,r,!0),kT(e,i.data,i.blueprint,r,!1)}}function kT(n,e,t,i,r){if(n=Pi(n),Array.isArray(n))for(let s=0;s<n.length;s++)kT(n[s],e,t,i,r);else{let s=Ni(),o=Ut(),a=Oi(),c=wl(n)?n:Pi(n.provide),l=IS(n),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(wl(n)||!n.multi){let p=new Ll(l,r,Ue,null),g=dT(c,e,r?u:u+h,d);g===-1?(fT(Dy(a,o),s,c),uT(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(p),o.push(p)):(t[g]=p,o[g]=p)}else{let p=dT(c,e,u+h,d),g=dT(c,e,u,u+h),y=p>=0&&t[p],m=g>=0&&t[g];if(r&&!m||!r&&!y){fT(Dy(a,o),s,c);let _=z$(r?B$:U$,t.length,r,i,l,n);!r&&m&&(t[g].providerFactory=_),uT(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(_),o.push(_)}else{let _=YL(t[r?g:p],l,!r&&i);uT(s,n,p>-1?p:g,_)}!r&&i&&m&&t[g].componentProviders++}}}function uT(n,e,t,i){let r=wl(e),s=fO(e);if(r||s){let c=(s?Pi(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let u=l.indexOf(t);u===-1?l.push(t,[i,c]):l[u+1].push(i,c)}else l.push(t,c)}}}function YL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function dT(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function U$(n,e,t,i,r){return LT(this.multi,[])}function B$(n,e,t,i,r){let s=this.multi,o;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=hp(i,i[ht],this.providerFactory.index,r);o=c.slice(0,a),LT(s,o);for(let l=a;l<c.length;l++)o.push(c[l])}else o=[],LT(s,o);return o}function LT(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function z$(n,e,t,i,r,s){let o=new Ll(n,t,Ue,null);return o.multi=[],o.index=e,o.componentProviders=0,YL(o,r,i&&!t),o}function to(n,e=[]){return t=>{t.providersResolver=(i,r)=>V$(i,r?r(n):n,e)}}function rv(n,e,t){let i=ly()+n,r=Ut();return r[i]===Ks?oI(r,i,t?e.call(t):e()):T8(r,i)}function KL(n,e){let t=n[e];return t===Ks?void 0:t}function H$(n,e,t,i,r,s){let o=e+t;return rc(n,o,r)?oI(n,o+1,s?i.call(s,r):i(r)):KL(n,o+1)}function j$(n,e,t,i,r,s,o){let a=e+t;return I8(n,a,r,s)?oI(n,a+2,o?i.call(o,r,s):i(r,s)):KL(n,a+2)}function qo(n,e){let t=Ni(),i,r=n+Ei;t.firstCreatePass?(i=G$(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let s=i.factory||(i.factory=$a(i.type,!0)),o,a=sr(Ue);try{let c=Ay(!1),l=s();return Ay(c),PS(t,Ut(),r,l),l}finally{sr(a)}}function G$(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function Fd(n,e,t){let i=n+Ei,r=Ut(),s=oy(r,i);return ZL(r,i)?H$(r,ly(),e,s.transform,t,s):s.transform(t)}function Ep(n,e,t,i){let r=n+Ei,s=Ut(),o=oy(s,r);return ZL(s,r)?j$(s,ly(),e,o.transform,t,i,o):o.transform(t,i)}function ZL(n,e){return n[ht].data[e].pure}function dI(n,e){return Zy(n,e)}var jy=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},hI=(()=>{class n{compileModuleSync(t){return new zy(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=wS(t),s=qk(r.declarations).reduce((o,a)=>{let c=Ya(a);return c&&o.push(new Rd(c)),o},[]);return new jy(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var W$=(()=>{class n{zone=ie(Bt);changeDetectionScheduler=ie(Vo);applicationRef=ie(Go);applicationErrorHandler=ie(lr);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),JL=new Re("",{factory:()=>!1});function fI({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Bt(je(ae({},mI()),{scheduleInRootZone:t})),[{provide:Bt,useFactory:n},{provide:Uo,multi:!0,useFactory:()=>{let i=ie(W$,{optional:!0});return()=>i.initialize()}},{provide:Uo,multi:!0,useFactory:()=>{let i=ie($$);return()=>{i.initialize()}}},e===!0?{provide:QS,useValue:!0}:[],{provide:eT,useValue:t??tL},{provide:lr,useFactory:()=>{let i=ie(Bt),r=ie(Xn),s;return o=>{i.runOutsideAngular(()=>{r.destroyed&&!s?setTimeout(()=>{throw o}):(s??=r.get(ps),s.handleError(o))})}}}]}function pI(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,i=fI({ngZoneFactory:()=>{let r=mI(n);return r.scheduleInRootZone=t,r.shouldCoalesceEventChangeDetection&&gp("NgZone_CoalesceEvent"),new Bt(r)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return or([{provide:JL,useValue:!0},{provide:cp,useValue:!1},i])}function mI(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var $$=(()=>{class n{subscription=new Hn;initialized=!1;zone=ie(Bt);pendingTasks=ie(Ws);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Bt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Bt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var QL=(()=>{class n{applicationErrorHandler=ie(lr);appRef=ie(Go);taskService=ie(Ws);ngZone=ie(Bt);zonelessEnabled=ie(cp);tracing=ie(Bl,{optional:!0});disableScheduling=ie(QS,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Hn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Oy):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ie(eT,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof ky||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?ZO:nL;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Oy+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,ZO(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function q$(){return typeof $localize<"u"&&$localize.locale||bp}var wp=new Re("",{providedIn:"root",factory:()=>ie(wp,{optional:!0,skipSelf:!0})||q$()});function fi(n){return YN(n)}function Vd(n,e){return b_(n,e?.equal)}var eF=class{[Gi];constructor(e){this[Gi]=e}destroy(){this[Gi].destroy()}};var rF=Symbol("InputSignalNode#UNSET"),a9=je(ae({},E_),{transformFn:void 0,applyValueToInputSignal(n,e){sd(n,e)}});function sF(n,e){let t=Object.create(a9);t.value=n,t.transformFn=e?.transform;function i(){if(nd(t),t.value===rF){let r=null;throw new we(-950,r)}return t.value}return i[Gi]=t,i}var c9=new Re("");c9.__NG_ELEMENT_ID__=n=>{let e=Oi();if(e===null)throw new we(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new we(204,!1)};function tF(n,e){return sF(n,e)}function l9(n){return sF(rF,n)}var oF=(tF.required=l9,tF);var gI=new Re(""),u9=new Re("");function xp(n){return!n.moduleRef}function d9(n){let e=xp(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Bt);return t.run(()=>{xp(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(lr),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),xp(n)){let s=()=>e.destroy(),o=n.platformInjector.get(gI);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(gI);o.add(s),n.moduleRef.onDestroy(()=>{dp(n.allPlatformModules,n.moduleRef),r.unsubscribe(),o.delete(s)})}return f9(i,t,()=>{let s=e.get(Ws),o=s.add(),a=e.get(uI);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(wp,bp);if($L(c||bp),!e.get(u9,!0))return xp(n)?e.get(Go):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(xp(n)){let u=e.get(Go);return n.rootComponent!==void 0&&u.bootstrap(n.rootComponent),u}else return h9?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var h9;function f9(n,e,t){try{let i=t();return jo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var sv=null;function p9(n=[],e){return Nn.create({name:e,providers:[{provide:Jf,useValue:"platform"},{provide:gI,useValue:new Set([()=>sv=null])},...n]})}function m9(n=[]){if(sv)return sv;let e=p9(n);return sv=e,jL(),g9(e),e}function g9(n){let e=n.get(Wy,null);Yn(n,()=>{e?.forEach(t=>t())})}function EI(){return!1}var zl=(()=>{class n{static __NG_ELEMENT_ID__=_9}return n})();function _9(n){return y9(Oi(),Ut(),(n&16)===16)}function y9(n,e,t){if(Qa(n)&&!t){let i=Jr(n.index,e);return new nc(i,i)}else if(n.type&175){let i=e[Kr];return new nc(i,e)}return null}var _I=class{constructor(){}supports(e){return sI(e)}create(e){return new yI(e)}},v9=(n,e)=>e,yI=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||v9}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){let o=!i||t&&t.currentIndex<nF(i,r,s)?t:i,a=nF(o,r,s),c=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,o.previousIndex==null)r++;else{s||(s=[]);let l=a-r,u=c-r;if(l!=u){for(let h=0;h<l;h++){let p=h<s.length?s[h]:s[h]=0,g=p+h;u<=g&&g<l&&(s[h]=p+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!sI(e))throw new we(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),i=!0):(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else r=0,PL(e,a=>{o=this._trackByFn(r,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new vI(t,i),s,r)),e}_verifyReinsertion(e,t,i,r){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return s!==null?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,s=e._nextRemoved;return r===null?this._removalsHead=s:r._nextRemoved=s,s===null?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new ov),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new ov),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},vI=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},bI=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},ov=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new bI,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function nF(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function iF(){return new wI([new _I])}var wI=(()=>{class n{factories;static \u0275prov=ke({token:n,providedIn:"root",factory:iF});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=ie(n,{optional:!0,skipSelf:!0});return n.create(t,i||iF())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new we(901,!1)}}return n})();function aF(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;dn(8);try{let s=r?.injector??m9(i),o=[fI({}),{provide:Vo,useExisting:QL},BO,...t||[]],a=new pp({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return d9({r3Injector:a.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{dn(9)}}function av(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var uF=null;function ts(){return uF}function xI(n){uF??=n}var Sp=class{},SI=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(dF),providedIn:"platform"})}return n})();var dF=(()=>{class n extends SI{_location;_history;_doc=ie(ii);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ts().getBaseHref(this._doc)}onPopState(t){let i=ts().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=ts().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function hF(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function cF(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ac(n){return n&&n[0]!=="?"?`?${n}`:n}var cv=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(pF),providedIn:"root"})}return n})(),fF=new Re(""),pF=(()=>{class n extends cv{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ie(ii).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return hF(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ac(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+ac(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+ac(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Qe(SI),Qe(fF,8))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ud=(()=>{class n{_subject=new ti;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=w9(cF(lF(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ac(i))}normalize(t){return n.stripTrailingSlash(E9(this._basePath,lF(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ac(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ac(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ac;static joinWithSlash=hF;static stripTrailingSlash=cF;static \u0275fac=function(i){return new(i||n)(Qe(cv))};static \u0275prov=ke({token:n,factory:()=>b9(),providedIn:"root"})}return n})();function b9(){return new Ud(Qe(cv))}function E9(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function lF(n){return n.replace(/\/index.html$/,"")}function w9(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Xi=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Xi||{}),mn=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(mn||{}),Er=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(Er||{}),Ko={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function vF(n){return Or(n)[Jn.LocaleId]}function bF(n,e,t){let i=Or(n),r=[i[Jn.DayPeriodsFormat],i[Jn.DayPeriodsStandalone]],s=ns(r,e);return ns(s,t)}function EF(n,e,t){let i=Or(n),r=[i[Jn.DaysFormat],i[Jn.DaysStandalone]],s=ns(r,e);return ns(s,t)}function wF(n,e,t){let i=Or(n),r=[i[Jn.MonthsFormat],i[Jn.MonthsStandalone]],s=ns(r,e);return ns(s,t)}function xF(n,e){let i=Or(n)[Jn.Eras];return ns(i,e)}function Tp(n,e){let t=Or(n);return ns(t[Jn.DateFormat],e)}function Ip(n,e){let t=Or(n);return ns(t[Jn.TimeFormat],e)}function Cp(n,e){let i=Or(n)[Jn.DateTimeFormat];return ns(i,e)}function Mp(n,e){let t=Or(n),i=t[Jn.NumberSymbols][e];if(typeof i>"u"){if(e===Ko.CurrencyDecimal)return t[Jn.NumberSymbols][Ko.Decimal];if(e===Ko.CurrencyGroup)return t[Jn.NumberSymbols][Ko.Group]}return i}function SF(n){if(!n[Jn.ExtraData])throw new we(2303,!1)}function TF(n){let e=Or(n);return SF(e),(e[Jn.ExtraData][2]||[]).map(i=>typeof i=="string"?TI(i):[TI(i[0]),TI(i[1])])}function IF(n,e,t){let i=Or(n);SF(i);let r=[i[Jn.ExtraData][0],i[Jn.ExtraData][1]],s=ns(r,e)||[];return ns(s,t)||[]}function ns(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new we(2304,!1)}function TI(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var x9=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,lv={},S9=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function CF(n,e,t,i){let r=N9(n);e=Yo(t,e)||e;let o=[],a;for(;e;)if(a=S9.exec(e),a){o=o.concat(a.slice(1));let u=o.pop();if(!u)break;e=u}else{o.push(e);break}let c=r.getTimezoneOffset();i&&(c=AF(i,c),r=P9(r,i));let l="";return o.forEach(u=>{let d=D9(u);l+=d?d(r,t,c):u==="''"?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function pv(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Yo(n,e){let t=vF(n);if(lv[t]??={},lv[t][e])return lv[t][e];let i="";switch(e){case"shortDate":i=Tp(n,Er.Short);break;case"mediumDate":i=Tp(n,Er.Medium);break;case"longDate":i=Tp(n,Er.Long);break;case"fullDate":i=Tp(n,Er.Full);break;case"shortTime":i=Ip(n,Er.Short);break;case"mediumTime":i=Ip(n,Er.Medium);break;case"longTime":i=Ip(n,Er.Long);break;case"fullTime":i=Ip(n,Er.Full);break;case"short":let r=Yo(n,"shortTime"),s=Yo(n,"shortDate");i=uv(Cp(n,Er.Short),[r,s]);break;case"medium":let o=Yo(n,"mediumTime"),a=Yo(n,"mediumDate");i=uv(Cp(n,Er.Medium),[o,a]);break;case"long":let c=Yo(n,"longTime"),l=Yo(n,"longDate");i=uv(Cp(n,Er.Long),[c,l]);break;case"full":let u=Yo(n,"fullTime"),d=Yo(n,"fullDate");i=uv(Cp(n,Er.Full),[u,d]);break}return i&&(lv[t][e]=i),i}function uv(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Es(n,e,t="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return i&&(o=o.slice(o.length-e)),s+o}function T9(n,e){return Es(n,3).substring(0,e)}function si(n,e,t=0,i=!1,r=!1){return function(s,o){let a=I9(n,s);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return T9(a,e);let c=Mp(o,Ko.MinusSign);return Es(a,e,c,i,r)}}function I9(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new we(2301,!1)}}function xn(n,e,t=Xi.Format,i=!1){return function(r,s){return C9(r,s,n,e,t,i)}}function C9(n,e,t,i,r,s){switch(t){case 2:return wF(e,r,i)[n.getMonth()];case 1:return EF(e,r,i)[n.getDay()];case 0:let o=n.getHours(),a=n.getMinutes();if(s){let l=TF(e),u=IF(e,r,i),d=l.findIndex(h=>{if(Array.isArray(h)){let[p,g]=h,y=o>=p.hours&&a>=p.minutes,m=o<g.hours||o===g.hours&&a<g.minutes;if(p.hours<g.hours){if(y&&m)return!0}else if(y||m)return!0}else if(h.hours===o&&h.minutes===a)return!0;return!1});if(d!==-1)return u[d]}return bF(e,r,i)[o<12?0:1];case 3:return xF(e,i)[n.getFullYear()<=0?0:1];default:let c=t;throw new we(2302,!1)}}function dv(n){return function(e,t,i){let r=-1*i,s=Mp(t,Ko.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Es(o,2,s)+Es(Math.abs(r%60),2,s);case 1:return"GMT"+(r>=0?"+":"")+Es(o,1,s);case 2:return"GMT"+(r>=0?"+":"")+Es(o,2,s)+":"+Es(Math.abs(r%60),2,s);case 3:return i===0?"Z":(r>=0?"+":"")+Es(o,2,s)+":"+Es(Math.abs(r%60),2,s);default:throw new we(2310,!1)}}}var M9=0,fv=4;function A9(n){let e=pv(n,M9,1).getDay();return pv(n,0,1+(e<=fv?fv:fv+7)-e)}function MF(n){let e=n.getDay(),t=e===0?-3:fv-e;return pv(n.getFullYear(),n.getMonth(),n.getDate()+t)}function II(n,e=!1){return function(t,i){let r;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();r=1+Math.floor((o+s)/7)}else{let s=MF(t),o=A9(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return Es(r,n,Mp(i,Ko.MinusSign))}}function hv(n,e=!1){return function(t,i){let s=MF(t).getFullYear();return Es(s,n,Mp(i,Ko.MinusSign),e)}}var CI={};function D9(n){if(CI[n])return CI[n];let e;switch(n){case"G":case"GG":case"GGG":e=xn(3,mn.Abbreviated);break;case"GGGG":e=xn(3,mn.Wide);break;case"GGGGG":e=xn(3,mn.Narrow);break;case"y":e=si(0,1,0,!1,!0);break;case"yy":e=si(0,2,0,!0,!0);break;case"yyy":e=si(0,3,0,!1,!0);break;case"yyyy":e=si(0,4,0,!1,!0);break;case"Y":e=hv(1);break;case"YY":e=hv(2,!0);break;case"YYY":e=hv(3);break;case"YYYY":e=hv(4);break;case"M":case"L":e=si(1,1,1);break;case"MM":case"LL":e=si(1,2,1);break;case"MMM":e=xn(2,mn.Abbreviated);break;case"MMMM":e=xn(2,mn.Wide);break;case"MMMMM":e=xn(2,mn.Narrow);break;case"LLL":e=xn(2,mn.Abbreviated,Xi.Standalone);break;case"LLLL":e=xn(2,mn.Wide,Xi.Standalone);break;case"LLLLL":e=xn(2,mn.Narrow,Xi.Standalone);break;case"w":e=II(1);break;case"ww":e=II(2);break;case"W":e=II(1,!0);break;case"d":e=si(2,1);break;case"dd":e=si(2,2);break;case"c":case"cc":e=si(7,1);break;case"ccc":e=xn(1,mn.Abbreviated,Xi.Standalone);break;case"cccc":e=xn(1,mn.Wide,Xi.Standalone);break;case"ccccc":e=xn(1,mn.Narrow,Xi.Standalone);break;case"cccccc":e=xn(1,mn.Short,Xi.Standalone);break;case"E":case"EE":case"EEE":e=xn(1,mn.Abbreviated);break;case"EEEE":e=xn(1,mn.Wide);break;case"EEEEE":e=xn(1,mn.Narrow);break;case"EEEEEE":e=xn(1,mn.Short);break;case"a":case"aa":case"aaa":e=xn(0,mn.Abbreviated);break;case"aaaa":e=xn(0,mn.Wide);break;case"aaaaa":e=xn(0,mn.Narrow);break;case"b":case"bb":case"bbb":e=xn(0,mn.Abbreviated,Xi.Standalone,!0);break;case"bbbb":e=xn(0,mn.Wide,Xi.Standalone,!0);break;case"bbbbb":e=xn(0,mn.Narrow,Xi.Standalone,!0);break;case"B":case"BB":case"BBB":e=xn(0,mn.Abbreviated,Xi.Format,!0);break;case"BBBB":e=xn(0,mn.Wide,Xi.Format,!0);break;case"BBBBB":e=xn(0,mn.Narrow,Xi.Format,!0);break;case"h":e=si(3,1,-12);break;case"hh":e=si(3,2,-12);break;case"H":e=si(3,1);break;case"HH":e=si(3,2);break;case"m":e=si(4,1);break;case"mm":e=si(4,2);break;case"s":e=si(5,1);break;case"ss":e=si(5,2);break;case"S":e=si(6,1);break;case"SS":e=si(6,2);break;case"SSS":e=si(6,3);break;case"Z":case"ZZ":case"ZZZ":e=dv(0);break;case"ZZZZZ":e=dv(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=dv(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=dv(2);break;default:return null}return CI[n]=e,e}function AF(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function R9(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function P9(n,e,t){let r=n.getTimezoneOffset(),s=AF(e,r);return R9(n,-1*(s-r))}function N9(n){if(mF(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,s=1,o=1]=n.split("-").map(a=>+a);return pv(r,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(x9))return O9(i)}let e=new Date(n);if(!mF(e))throw new we(2311,!1);return e}function O9(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-i,c=Number(n[6]||0),l=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,l),e}function mF(n){return n instanceof Date&&!isNaN(n.valueOf())}var MI=/\s+/,gF=[],ws=(()=>{class n{_ngEl;_renderer;initialClasses=gF;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(MI):gF}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(MI):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(MI).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(Ue(es),Ue(vs))};static \u0275dir=An({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var mv=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},cc=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new mv(r.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)i.remove(s===null?void 0:s);else if(s!==null){let a=i.get(s);i.move(a,o),_F(a,r)}});for(let r=0,s=i.length;r<s;r++){let a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let s=i.get(r.currentIndex);_F(s,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Ue(Ho),Ue(ic),Ue(wI))};static \u0275dir=An({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function _F(n,e){n.context.$implicit=e.item}var dr=(()=>{class n{_viewContainer;_context=new gv;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){yF(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){yF(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Ue(Ho),Ue(ic))};static \u0275dir=An({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),gv=class{$implicit=null;ngIf=null};function yF(n,e){if(n&&!n.createEmbeddedView)throw new we(2020,!1)}function RI(n,e){return new we(2100,!1)}var AI=class{createSubscription(e,t,i){return fi(()=>e.subscribe({next:t,error:i}))}dispose(e){fi(()=>e.unsubscribe())}},DI=class{createSubscription(e,t,i){return e.then(r=>t?.(r),r=>i?.(r)),{unsubscribe:()=>{t=null,i=null}}}dispose(e){e.unsubscribe()}},k9=new DI,L9=new AI,PI=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;applicationErrorHandler=ie(lr);constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i),i=>this.applicationErrorHandler(i))}_selectStrategy(t){if(jo(t))return k9;if(tv(t))return L9;throw RI(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(i){return new(i||n)(Ue(zl,16))};static \u0275pipe=vp({name:"async",type:n,pure:!1})}return n})();var F9=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g,NI=(()=>{class n{transform(t){if(t==null)return null;if(typeof t!="string")throw RI(n,t);return t.replace(F9,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=vp({name:"titlecase",type:n,pure:!0})}return n})();var V9="mediumDate",DF=new Re(""),RF=new Re(""),Ap=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,s){if(t==null||t===""||t!==t)return null;try{let o=i??this.defaultOptions?.dateFormat??V9,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return CF(t,o,s||this.locale,a)}catch(o){throw RI(n,o.message)}}static \u0275fac=function(i){return new(i||n)(Ue(wp,16),Ue(DF,24),Ue(RF,24))};static \u0275pipe=vp({name:"date",type:n,pure:!0})}return n})();var wi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=bs({type:n});static \u0275inj=qr({})}return n})();function Dp(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,s]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Hl=class{};var PF="browser";var Rp=class{_doc;constructor(e){this._doc=e}manager},_v=(()=>{class n extends Rp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,s){return t.addEventListener(i,r,s),()=>this.removeEventListener(t,i,r,s)}removeEventListener(t,i,r,s){return t.removeEventListener(i,r,s)}static \u0275fac=function(i){return new(i||n)(Qe(ii))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),vv=new Re(""),VI=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(o=>{o.manager=this});let r=t.filter(o=>!(o instanceof _v));this._plugins=r.slice().reverse();let s=t.find(o=>o instanceof _v);s&&this._plugins.push(s)}addEventListener(t,i,r,s){return this._findPluginFor(i).addEventListener(t,i,r,s)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new we(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Qe(vv),Qe(Bt))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),OI="ng-app-id";function NF(n){for(let e of n)e.remove()}function OF(n,e){let t=e.createElement("style");return t.textContent=n,t}function U9(n,e,t,i){let r=n.head?.querySelectorAll(`style[${OI}="${e}"],link[${OI}="${e}"]`);if(r)for(let s of r)s.removeAttribute(OI),s instanceof HTMLLinkElement?i.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function LI(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var UI=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,U9(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,OF);i?.forEach(r=>this.addUsage(r,this.external,LI))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let s=i.get(t);s?s.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(NF(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])NF(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,OF(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,LI(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Qe(ii),Qe(Gy),Qe($y,8),Qe(sc))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),kI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},BI=/%COMP%/g;var LF="%COMP%",B9=`_nghost-${LF}`,z9=`_ngcontent-${LF}`,H9=!0,j9=new Re("",{providedIn:"root",factory:()=>H9});function G9(n){return z9.replace(BI,n)}function W9(n){return B9.replace(BI,n)}function FF(n,e){return e.map(t=>t.replace(BI,n))}var zI=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,s,o,a,c,l=null,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=u,this.platformIsServer=!1,this.defaultRenderer=new Pp(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof yv?r.applyToHost(t):r instanceof Np&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,s=r.get(i.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,h=this.tracingService;switch(i.encapsulation){case Bo.Emulated:s=new yv(c,l,i,this.appId,u,o,a,d,h);break;case Bo.ShadowDom:return new FI(c,l,t,i,o,a,this.nonce,d,h);default:s=new Np(c,l,i,u,o,a,d,h);break}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Qe(VI),Qe(UI),Qe(Gy),Qe(j9),Qe(ii),Qe(sc),Qe(Bt),Qe($y),Qe(Bl,8))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),Pp=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,s){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(kI[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(kF(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(kF(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new we(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let s=kI[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=kI[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(qs.DashCase|qs.Important)?e.style.setProperty(t,i,r&qs.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&qs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=ts().getGlobalEventTarget(this.doc,e),!e))throw new we(5102,!1);let s=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function kF(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var FI=class extends Pp{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,s,o,a,c,l){super(e,s,o,c,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=FF(r.id,u);for(let h of u){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}let d=r.getExternalStyles?.();if(d)for(let h of d){let p=LI(h,s);a&&p.setAttribute("nonce",a),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Np=class extends Pp{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let u=i.styles;this.styles=l?FF(l,u):u,this.styleUrls=i.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&Dd.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},yv=class extends Np{contentAttr;hostAttr;constructor(e,t,i,r,s,o,a,c,l){let u=r+"-"+i.id;super(e,t,i,s,o,a,c,l,u),this.contentAttr=G9(u),this.hostAttr=W9(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var bv=class n extends Sp{supportsDOMEvents=!0;static makeCurrent(){xI(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=$9();return t==null?null:q9(t)}resetBaseElement(){Op=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Dp(document.cookie,e)}},Op=null;function $9(){return Op=Op||document.head.querySelector("base"),Op?Op.getAttribute("href"):null}function q9(n){return new URL(n,document.baseURI).pathname}var X9=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),VF=["alt","control","meta","shift"],Y9={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},K9={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},UF=(()=>{class n extends Rp{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,s){let o=n.parseEventName(i),a=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ts().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let s=n._normalizeKey(i.pop()),o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),VF.forEach(l=>{let u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,i.length!=0||s.length===0)return null;let c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=Y9[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),VF.forEach(o=>{if(o!==r){let a=K9[o];a(t)&&(s+=o+".")}}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Qe(ii))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})();function HI(n,e,t){let i=ae({rootComponent:n,platformRef:t?.platformRef},Z9(e));return aF(i)}function Z9(n){return{appProviders:[...nq,...n?.providers??[]],platformProviders:tq}}function J9(){bv.makeCurrent()}function Q9(){return new ps}function eq(){return UT(document),document}var tq=[{provide:sc,useValue:PF},{provide:Wy,useValue:J9,multi:!0},{provide:ii,useFactory:eq}];var nq=[{provide:Jf,useValue:"root"},{provide:ps,useFactory:Q9},{provide:vv,useClass:_v,multi:!0,deps:[ii]},{provide:vv,useClass:UF,multi:!0,deps:[ii]},zI,UI,VI,{provide:Fl,useExisting:zI},{provide:Hl,useClass:X9},[]];var Hd=class{},kp=class{},lc=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),s=t.slice(i+1).trim();this.addHeaderEntry(r,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var wv=class{encodeKey(e){return BF(e)}encodeValue(e){return BF(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function iq(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,a]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var rq=/%(\d[a-f0-9])/gi,sq={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function BF(n){return encodeURIComponent(n).replace(rq,(e,t)=>sq[t]??e)}function Ev(n){return`${n}`}var Zo=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new wv,e.fromString){if(e.fromObject)throw new we(2805,!1);this.map=iq(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(Ev):[Ev(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Ev(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(Ev(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var xv=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function oq(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function zF(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function HF(n){return typeof Blob<"u"&&n instanceof Blob}function jF(n){return typeof FormData<"u"&&n instanceof FormData}function aq(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var GF="Content-Type",WF="Accept",$F="X-Request-URL",qF="text/plain",XF="application/json",cq=`${XF}, ${qF}, */*`,Bd=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,r){this.url=t,this.method=e.toUpperCase();let s;if(oq(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s){if(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,this.keepalive=!!s.keepalive,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),s.priority&&(this.priority=s.priority),s.cache&&(this.cache=s.cache),s.credentials&&(this.credentials=s.credentials),typeof s.timeout=="number"){if(s.timeout<1||!Number.isInteger(s.timeout))throw new we(2822,"");this.timeout=s.timeout}s.mode&&(this.mode=s.mode),s.redirect&&(this.redirect=s.redirect),s.integrity&&(this.integrity=s.integrity),s.referrer&&(this.referrer=s.referrer),this.transferCache=s.transferCache}if(this.headers??=new lc,this.context??=new xv,!this.params)this.params=new Zo,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||zF(this.body)||HF(this.body)||jF(this.body)||aq(this.body)?this.body:this.body instanceof Zo?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||jF(this.body)?null:HF(this.body)?this.body.type||null:zF(this.body)?null:typeof this.body=="string"?qF:this.body instanceof Zo?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?XF:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.keepalive??this.keepalive,o=e.priority||this.priority,a=e.cache||this.cache,c=e.mode||this.mode,l=e.redirect||this.redirect,u=e.credentials||this.credentials,d=e.referrer||this.referrer,h=e.integrity||this.integrity,p=e.transferCache??this.transferCache,g=e.timeout??this.timeout,y=e.body!==void 0?e.body:this.body,m=e.withCredentials??this.withCredentials,_=e.reportProgress??this.reportProgress,I=e.headers||this.headers,M=e.params||this.params,C=e.context??this.context;return e.setHeaders!==void 0&&(I=Object.keys(e.setHeaders).reduce((P,N)=>P.set(N,e.setHeaders[N]),I)),e.setParams&&(M=Object.keys(e.setParams).reduce((P,N)=>P.set(N,e.setParams[N]),M)),new n(t,i,y,{params:M,headers:I,context:C,reportProgress:_,responseType:r,withCredentials:m,transferCache:p,keepalive:s,cache:a,priority:o,timeout:g,mode:c,redirect:l,credentials:u,referrer:d,integrity:h})}},Gl=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(Gl||{}),jd=class{headers;status;statusText;url;ok;type;redirected;constructor(e,t=200,i="OK"){this.headers=e.headers||new lc,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.ok=this.status>=200&&this.status<300}},Sv=class n extends jd{constructor(e={}){super(e)}type=Gl.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Lp=class n extends jd{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Gl.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected})}},zd=class extends jd{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},lq=200,uq=204;function jI(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var Gd=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Bd)s=t;else{let c;r.headers instanceof lc?c=r.headers:c=new lc(r.headers);let l;r.params&&(r.params instanceof Zo?l=r.params:l=new Zo({fromObject:r.params})),s=new Bd(t,i,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials,referrer:r.referrer,integrity:r.integrity,timeout:r.timeout})}let o=ut(s).pipe(Ga(c=>this.handler.handle(c)));if(t instanceof Bd||r.observe==="events")return o;let a=o.pipe(rr(c=>c instanceof Lp));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(gt(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new we(2806,!1);return c.body}));case"blob":return a.pipe(gt(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new we(2807,!1);return c.body}));case"text":return a.pipe(gt(c=>{if(c.body!==null&&typeof c.body!="string")throw new we(2808,!1);return c.body}));case"json":default:return a.pipe(gt(c=>c.body))}case"response":return a;default:throw new we(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Zo().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,jI(r,i))}post(t,i,r={}){return this.request("POST",t,jI(r,i))}put(t,i,r={}){return this.request("PUT",t,jI(r,i))}static \u0275fac=function(i){return new(i||n)(Qe(Hd))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})();var dq=new Re("");function hq(n,e){return e(n)}function fq(n,e,t){return(i,r)=>Yn(t,()=>e(i,s=>n(s,r)))}var YF=new Re(""),KF=new Re(""),ZF=new Re("",{providedIn:"root",factory:()=>!0});var Tv=(()=>{class n extends Hd{backend;injector;chain=null;pendingTasks=ie(tc);contributeToStability=ie(ZF);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(YF),...this.injector.get(KF,[])]));this.chain=i.reduceRight((r,s)=>fq(r,s,this.injector),hq)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(yl(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(Qe(kp),Qe(Xn))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})();var pq=/^\)\]\}',?\n/,mq=RegExp(`^${$F}:`,"m");function gq(n){return"responseURL"in n&&n.responseURL?n.responseURL:mq.test(n.getAllResponseHeaders())?n.getResponseHeader($F):null}var GI=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new we(-2800,!1);let i=this.xhrFactory;return ut(null).pipe(Wi(()=>new bt(s=>{let o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((m,_)=>o.setRequestHeader(m,_.join(","))),t.headers.has(WF)||o.setRequestHeader(WF,cq),!t.headers.has(GF)){let m=t.detectContentTypeHeader();m!==null&&o.setRequestHeader(GF,m)}if(t.timeout&&(o.timeout=t.timeout),t.responseType){let m=t.responseType.toLowerCase();o.responseType=m!=="json"?m:"text"}let a=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let m=o.statusText||"OK",_=new lc(o.getAllResponseHeaders()),I=gq(o)||t.url;return c=new Sv({headers:_,status:o.status,statusText:m,url:I}),c},u=()=>{let{headers:m,status:_,statusText:I,url:M}=l(),C=null;_!==uq&&(C=typeof o.response>"u"?o.responseText:o.response),_===0&&(_=C?lq:0);let P=_>=200&&_<300;if(t.responseType==="json"&&typeof C=="string"){let N=C;C=C.replace(pq,"");try{C=C!==""?JSON.parse(C):null}catch(S){C=N,P&&(P=!1,C={error:S,text:C})}}P?(s.next(new Lp({body:C,headers:m,status:_,statusText:I,url:M||void 0})),s.complete()):s.error(new zd({error:C,headers:m,status:_,statusText:I,url:M||void 0}))},d=m=>{let{url:_}=l(),I=new zd({error:m,status:o.status||0,statusText:o.statusText||"Unknown Error",url:_||void 0});s.error(I)},h=d;t.timeout&&(h=m=>{let{url:_}=l(),I=new zd({error:new DOMException("Request timed out","TimeoutError"),status:o.status||0,statusText:o.statusText||"Request timeout",url:_||void 0});s.error(I)});let p=!1,g=m=>{p||(s.next(l()),p=!0);let _={type:Gl.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(_.total=m.total),t.responseType==="text"&&o.responseText&&(_.partialText=o.responseText),s.next(_)},y=m=>{let _={type:Gl.UploadProgress,loaded:m.loaded};m.lengthComputable&&(_.total=m.total),s.next(_)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",h),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",g),a!==null&&o.upload&&o.upload.addEventListener("progress",y)),o.send(a),s.next({type:Gl.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",h),t.reportProgress&&(o.removeEventListener("progress",g),a!==null&&o.upload&&o.upload.removeEventListener("progress",y)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(i){return new(i||n)(Qe(Hl))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})(),JF=new Re(""),_q="XSRF-TOKEN",yq=new Re("",{providedIn:"root",factory:()=>_q}),vq="X-XSRF-TOKEN",bq=new Re("",{providedIn:"root",factory:()=>vq}),Fp=class{},Eq=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Dp(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(Qe(ii),Qe(yq))};static \u0275prov=ke({token:n,factory:n.\u0275fac})}return n})();function wq(n,e){let t=n.url.toLowerCase();if(!ie(JF)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let i=ie(Fp).getToken(),r=ie(bq);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}function WI(...n){let e=[Gd,GI,Tv,{provide:Hd,useExisting:Tv},{provide:kp,useFactory:()=>ie(dq,{optional:!0})??ie(GI)},{provide:YF,useValue:wq,multi:!0},{provide:JF,useValue:!0},{provide:Fp,useClass:Eq}];for(let t of n)e.push(...t.\u0275providers);return or(e)}var QF=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Qe(ii))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Et="primary",Jp=Symbol("RouteTitle"),KI=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ql(n){return new KI(n)}function a2(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],a=n[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Tq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!no(n[t],e[t]))return!1;return!0}function no(n,e){let t=n?ZI(n):void 0,i=e?ZI(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!c2(n[r],e[r]))return!1;return!0}function ZI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function c2(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}else return n===e}function l2(n){return n.length>0?n[n.length-1]:null}function ea(n){return qx(n)?n:jo(n)?Pn(Promise.resolve(n)):ut(n)}var Iq={exact:d2,subset:h2},u2={exact:Cq,subset:Mq,ignored:()=>!0};function e2(n,e,t){return Iq[t.paths](n.root,e.root,t.matrixParams)&&u2[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Cq(n,e){return no(n,e)}function d2(n,e,t){if(!Wl(n.segments,e.segments)||!Mv(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!d2(n.children[i],e.children[i],t))return!1;return!0}function Mq(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>c2(n[t],e[t]))}function h2(n,e,t){return f2(n,e,e.segments,t)}function f2(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!Wl(r,t)||e.hasChildren()||!Mv(r,t,i))}else if(n.segments.length===t.length){if(!Wl(n.segments,t)||!Mv(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!h2(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Wl(n.segments,r)||!Mv(n.segments,r,i)||!n.children[Et]?!1:f2(n.children[Et],e,s,i)}}function Mv(n,e,t){return e.every((i,r)=>u2[t](n[r].parameters,i.parameters))}var ro=class{root;queryParams;fragment;_queryParamMap;constructor(e=new sn([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=ql(this.queryParams),this._queryParamMap}toString(){return Rq.serialize(this)}},sn=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Av(this)}},uc=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ql(this.parameters),this._parameterMap}toString(){return m2(this)}};function Aq(n,e){return Wl(n,e)&&n.every((t,i)=>no(t.parameters,e[i].parameters))}function Wl(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function Dq(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Et&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Et&&(t=t.concat(e(r,i)))}),t}var Qp=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>new Xl,providedIn:"root"})}return n})(),Xl=class{parse(e){let t=new QI(e);return new ro(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Vp(e.root,!0)}`,i=Oq(e.queryParams),r=typeof e.fragment=="string"?`#${Pq(e.fragment)}`:"";return`${t}${i}${r}`}},Rq=new Xl;function Av(n){return n.segments.map(e=>m2(e)).join("/")}function Vp(n,e){if(!n.hasChildren())return Av(n);if(e){let t=n.children[Et]?Vp(n.children[Et],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Et&&i.push(`${r}:${Vp(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=Dq(n,(i,r)=>r===Et?[Vp(n.children[Et],!1)]:[`${r}:${Vp(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Et]!=null?`${Av(n)}/${t[0]}`:`${Av(n)}/(${t.join("//")})`}}function p2(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Iv(n){return p2(n).replace(/%3B/gi,";")}function Pq(n){return encodeURI(n)}function JI(n){return p2(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Dv(n){return decodeURIComponent(n)}function t2(n){return Dv(n.replace(/\+/g,"%20"))}function m2(n){return`${JI(n.path)}${Nq(n.parameters)}`}function Nq(n){return Object.entries(n).map(([e,t])=>`;${JI(e)}=${JI(t)}`).join("")}function Oq(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Iv(t)}=${Iv(r)}`).join("&"):`${Iv(t)}=${Iv(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var kq=/^[^\/()?;#]+/;function $I(n){let e=n.match(kq);return e?e[0]:""}var Lq=/^[^\/()?;=#]+/;function Fq(n){let e=n.match(Lq);return e?e[0]:""}var Vq=/^[^=?&#]+/;function Uq(n){let e=n.match(Vq);return e?e[0]:""}var Bq=/^[^&#]+/;function zq(n){let e=n.match(Bq);return e?e[0]:""}var QI=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new sn([],{}):new sn([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Et]=new sn(e,t)),i}parseSegment(){let e=$I(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new we(4009,!1);return this.capture(e),new uc(Dv(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Fq(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=$I(this.remaining);r&&(i=r,this.capture(i))}e[Dv(t)]=Dv(i)}parseQueryParam(e){let t=Uq(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=zq(this.remaining);o&&(i=o,this.capture(i))}let r=t2(t),s=t2(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=$I(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new we(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Et);let o=this.parseChildren();t[s??Et]=Object.keys(o).length===1&&o[Et]?o[Et]:new sn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new we(4011,!1)}};function g2(n){return n.segments.length>0?new sn([],{[Et]:n}):n}function _2(n){let e={};for(let[i,r]of Object.entries(n.children)){let s=_2(r);if(i===Et&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let t=new sn(n.segments,e);return Hq(t)}function Hq(n){if(n.numberOfChildren===1&&n.children[Et]){let e=n.children[Et];return new sn(n.segments.concat(e.segments),e.children)}return n}function Yd(n){return n instanceof ro}function y2(n,e,t=null,i=null){let r=v2(n);return b2(r,e,t,i)}function v2(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new sn(s.url,o);return s===n&&(e=a),a}let i=t(n.root),r=g2(i);return e??r}function b2(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return qI(r,r,r,t,i);let s=jq(e);if(s.toRoot())return qI(r,r,new sn([],{}),t,i);let o=Gq(s,r,n),a=o.processChildren?Bp(o.segmentGroup,o.index,s.commands):w2(o.segmentGroup,o.index,s.commands);return qI(r,o.segmentGroup,a,t,i)}function Rv(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function jp(n){return typeof n=="object"&&n!=null&&n.outlets}function qI(n,e,t,i,r){let s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;n===e?o=t:o=E2(n,e,t);let a=g2(_2(o));return new ro(a,s,r)}function E2(n,e,t){let i={};return Object.entries(n.children).forEach(([r,s])=>{s===e?i[r]=t:i[r]=E2(s,e,t)}),new sn(n.segments,i)}var Pv=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Rv(i[0]))throw new we(4003,!1);let r=i.find(jp);if(r&&r!==l2(i))throw new we(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function jq(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Pv(!0,0,n);let e=0,t=!1,i=n.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Pv(t,e,i)}var qd=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function Gq(n,e,t){if(n.isAbsolute)return new qd(e,!0,0);if(!t)return new qd(e,!1,NaN);if(t.parent===null)return new qd(t,!0,0);let i=Rv(n.commands[0])?0:1,r=t.segments.length-1+i;return Wq(t,r,n.numberOfDoubleDots)}function Wq(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new we(4005,!1);r=i.segments.length}return new qd(i,!1,r-s)}function $q(n){return jp(n[0])?n[0].outlets:{[Et]:n}}function w2(n,e,t){if(n??=new sn([],{}),n.segments.length===0&&n.hasChildren())return Bp(n,e,t);let i=qq(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let s=new sn(n.segments.slice(0,i.pathIndex),{});return s.children[Et]=new sn(n.segments.slice(i.pathIndex),n.children),Bp(s,0,r)}else return i.match&&r.length===0?new sn(n.segments,{}):i.match&&!n.hasChildren()?eC(n,e,t):i.match?Bp(n,0,r):eC(n,e,t)}function Bp(n,e,t){if(t.length===0)return new sn(n.segments,{});{let i=$q(t),r={};if(Object.keys(i).some(s=>s!==Et)&&n.children[Et]&&n.numberOfChildren===1&&n.children[Et].segments.length===0){let s=Bp(n.children[Et],e,t);return new sn(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=w2(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new sn(n.segments,r)}}function qq(n,e,t){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;let o=n.segments[r],a=t[i];if(jp(a))break;let c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!i2(c,l,o))return s;i+=2}else{if(!i2(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function eC(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(jp(s)){let c=Xq(s.outlets);return new sn(i,c)}if(r===0&&Rv(t[0])){let c=n.segments[e];i.push(new uc(c.path,n2(t[0]))),r++;continue}let o=jp(s)?s.outlets[Et]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Rv(a)?(i.push(new uc(o,n2(a))),r+=2):(i.push(new uc(o,{})),r++)}return new sn(i,{})}function Xq(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=eC(new sn([],{}),0,i))}),e}function n2(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function i2(n,e,t){return n==t.path&&no(e,t.parameters)}var zp="imperative",xi=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(xi||{}),Lr=class{id;url;constructor(e,t){this.id=e,this.url=t}},Yl=class extends Lr{type=xi.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Jo=class extends Lr{urlAfterRedirects;type=xi.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},hr=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(hr||{}),Gp=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Gp||{}),io=class extends Lr{reason;code;type=xi.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Qo=class extends Lr{reason;code;type=xi.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},Kd=class extends Lr{error;target;type=xi.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Wp=class extends Lr{urlAfterRedirects;state;type=xi.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nv=class extends Lr{urlAfterRedirects;state;type=xi.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ov=class extends Lr{urlAfterRedirects;state;shouldActivate;type=xi.GuardsCheckEnd;constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},kv=class extends Lr{urlAfterRedirects;state;type=xi.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lv=class extends Lr{urlAfterRedirects;state;type=xi.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fv=class{route;type=xi.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Vv=class{route;type=xi.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Uv=class{snapshot;type=xi.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bv=class{snapshot;type=xi.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zv=class{snapshot;type=xi.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hv=class{snapshot;type=xi.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var $p=class{},Zd=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function Yq(n){return!(n instanceof $p)&&!(n instanceof Zd)}function Kq(n,e){return n.providers&&!n._injector&&(n._injector=yp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function xs(n){return n.outlet||Et}function Zq(n,e){let t=n.filter(i=>xs(i)===e);return t.push(...n.filter(i=>xs(i)!==e)),t}function eh(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var jv=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return eh(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new th(this.rootInjector)}},th=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new jv(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Qe(Xn))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gv=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=tC(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=tC(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=nC(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return nC(e,this._root).map(t=>t.value)}};function tC(n,e){if(n===e.value)return e;for(let t of e.children){let i=tC(n,t);if(i)return i}return null}function nC(n,e){if(n===e.value)return[e];for(let t of e.children){let i=nC(n,t);if(i.length)return i.unshift(e),i}return[]}var kr=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function $d(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var qp=class extends Gv{snapshot;constructor(e,t){super(e),this.snapshot=t,uC(this,e)}toString(){return this.snapshot.toString()}};function x2(n){let e=Jq(n),t=new Ri([new uc("",{})]),i=new Ri({}),r=new Ri({}),s=new Ri({}),o=new Ri(""),a=new so(t,i,s,o,r,Et,n,e.root);return a.snapshot=e.root,new qp(new kr(a,[]),e)}function Jq(n){let e={},t={},i={},s=new $l([],e,i,"",t,Et,n,null,{});return new Xp("",new kr(s,[]))}var so=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(gt(l=>l[Jp]))??ut(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(gt(e=>ql(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(gt(e=>ql(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wv(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:ae(ae({},e.params),n.params),data:ae(ae({},e.data),n.data),resolve:ae(ae(ae(ae({},n.data),e.data),r?.data),n._resolvedData)}:i={params:ae({},n.params),data:ae({},n.data),resolve:ae(ae({},n.data),n._resolvedData??{})},r&&T2(r)&&(i.resolve[Jp]=r.title),i}var $l=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Jp]}constructor(e,t,i,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ql(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ql(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Xp=class extends Gv{url;constructor(e,t){super(t),this.url=e,uC(this,t)}toString(){return S2(this._root)}};function uC(n,e){e.value._routerState=n,e.children.forEach(t=>uC(n,t))}function S2(n){let e=n.children.length>0?` { ${n.children.map(S2).join(", ")} } `:"";return`${n.value}${e}`}function XI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,no(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),no(e.params,t.params)||n.paramsSubject.next(t.params),Tq(e.url,t.url)||n.urlSubject.next(t.url),no(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function iC(n,e){let t=no(n.params,e.params)&&Aq(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||iC(n.parent,e.parent))}function T2(n){return typeof n.title=="string"||n.title===null}var I2=new Re(""),Kl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Et;activateEvents=new _n;deactivateEvents=new _n;attachEvents=new _n;detachEvents=new _n;routerOutletData=oF();parentContexts=ie(th);location=ie(Ho);changeDetector=ie(zl);inputBinder=ie(Yv,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new we(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new we(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new we(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new we(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new rC(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(o,{index:r.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=An({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Xs]})}return n})(),rC=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===so?this.route:e===th?this.childContexts:e===I2?this.outletData:this.parent.get(e,t)}},Yv=new Re("");var dC=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=kn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&Ce(0,"router-outlet")},dependencies:[Kl],encapsulation:2})}return n})();function hC(n){let e=n.children&&n.children.map(hC),t=e?je(ae({},n),{children:e}):ae({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Et&&(t.component=dC),t}function Qq(n,e,t){let i=Yp(n,e._root,t?t._root:void 0);return new qp(i,e)}function Yp(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=e7(n,e,t);return new kr(i,r)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Yp(n,a)),o}}let i=t7(e.value),r=e.children.map(s=>Yp(n,s));return new kr(i,r)}}function e7(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Yp(n,i,r);return Yp(n,i)})}function t7(n){return new so(new Ri(n.url),new Ri(n.params),new Ri(n.queryParams),new Ri(n.fragment),new Ri(n.data),n.outlet,n.component,n)}var Jd=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},C2="ngNavigationCancelingError";function $v(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=Yd(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=M2(!1,hr.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function M2(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[C2]=!0,t.cancellationCode=e,t}function n7(n){return A2(n)&&Yd(n.url)}function A2(n){return!!n&&n[C2]}var i7=(n,e,t,i)=>gt(r=>(new sC(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),sC=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),XI(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=$d(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=$d(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=$d(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=$d(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Hv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Bv(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(XI(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),XI(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}},qv=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Xd=class{component;route;constructor(e,t){this.component=e,this.route=t}};function r7(n,e,t){let i=n._root,r=e?e._root:null;return Up(i,r,t,[i.value])}function s7(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function nh(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!dS(n)?n:e.get(n):i}function Up(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=$d(e);return n.children.forEach(o=>{o7(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Hp(a,t.getContext(o),r)),r}function o7(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=a7(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new qv(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Up(n,e,a?a.children:null,i,r):Up(n,e,t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Xd(a.outlet.component,o))}else o&&Hp(e,a,r),r.canActivateChecks.push(new qv(i)),s.component?Up(n,null,a?a.children:null,i,r):Up(n,null,t,i,r);return r}function a7(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Wl(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Wl(n.url,e.url)||!no(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!iC(n,e)||!no(n.queryParams,e.queryParams);case"paramsChange":default:return!iC(n,e)}}function Hp(n,e,t){let i=$d(n),r=n.value;Object.entries(i).forEach(([s,o])=>{r.component?e?Hp(o,e.children.getContext(s),t):Hp(o,null,t):Hp(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Xd(e.outlet.component,r)):t.canDeactivateChecks.push(new Xd(null,r)):t.canDeactivateChecks.push(new Xd(null,r))}function em(n){return typeof n=="function"}function c7(n){return typeof n=="boolean"}function l7(n){return n&&em(n.canLoad)}function u7(n){return n&&em(n.canActivate)}function d7(n){return n&&em(n.canActivateChild)}function h7(n){return n&&em(n.canDeactivate)}function f7(n){return n&&em(n.canMatch)}function D2(n){return n instanceof Oo||n?.name==="EmptyError"}var Cv=Symbol("INITIAL_VALUE");function Qd(){return Wi(n=>W_(n.map(e=>e.pipe($r(1),X_(Cv)))).pipe(gt(e=>{for(let t of e)if(t!==!0){if(t===Cv)return Cv;if(t===!1||p7(t))return t}return!0}),rr(e=>e!==Cv),$r(1)))}function p7(n){return Yd(n)||n instanceof Jd}function m7(n,e){return hi(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ut(je(ae({},t),{guardsResult:!0})):g7(o,i,r,n).pipe(hi(a=>a&&c7(a)?_7(i,s,n,e):ut(a)),gt(a=>je(ae({},t),{guardsResult:a})))})}function g7(n,e,t,i){return Pn(n).pipe(hi(r=>w7(r.component,r.route,t,e,i)),ko(r=>r!==!0,!0))}function _7(n,e,t,i){return Pn(e).pipe(Ga(r=>_d(v7(r.route.parent,i),y7(r.route,i),E7(n,r.path,t),b7(n,r.route,t))),ko(r=>r!==!0,!0))}function y7(n,e){return n!==null&&e&&e(new zv(n)),ut(!0)}function v7(n,e){return n!==null&&e&&e(new Uv(n)),ut(!0)}function b7(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return ut(!0);let r=i.map(s=>Wf(()=>{let o=eh(e)??t,a=nh(s,o),c=u7(a)?a.canActivate(e,n):Yn(o,()=>a(e,n));return ea(c).pipe(ko())}));return ut(r).pipe(Qd())}function E7(n,e,t){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>s7(o)).filter(o=>o!==null).map(o=>Wf(()=>{let a=o.guards.map(c=>{let l=eh(o.node)??t,u=nh(c,l),d=d7(u)?u.canActivateChild(i,n):Yn(l,()=>u(i,n));return ea(d).pipe(ko())});return ut(a).pipe(Qd())}));return ut(s).pipe(Qd())}function w7(n,e,t,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ut(!0);let o=s.map(a=>{let c=eh(e)??r,l=nh(a,c),u=h7(l)?l.canDeactivate(n,e,t,i):Yn(c,()=>l(n,e,t,i));return ea(u).pipe(ko())});return ut(o).pipe(Qd())}function x7(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return ut(!0);let s=r.map(o=>{let a=nh(o,n),c=l7(a)?a.canLoad(e,t):Yn(n,()=>a(e,t));return ea(c)});return ut(s).pipe(Qd(),R2(i))}function R2(n){return I_(vi(e=>{if(typeof e!="boolean")throw $v(n,e)}),gt(e=>e===!0))}function S7(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return ut(!0);let s=r.map(o=>{let a=nh(o,n),c=f7(a)?a.canMatch(e,t):Yn(n,()=>a(e,t));return ea(c)});return ut(s).pipe(Qd(),R2(i))}var Kp=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Zp=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Wd(n){return gd(new Kp(n))}function T7(n){return gd(new we(4e3,!1))}function I7(n){return gd(M2(!1,hr.GuardRejected))}var oC=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return ut(i);if(r.numberOfChildren>1||!r.children[Et])return T7(`${e.redirectTo}`);r=r.children[Et]}}applyRedirectCommands(e,t,i,r,s){return C7(t,r,s).pipe(gt(o=>{if(o instanceof ro)throw new Zp(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,i);if(o[0]==="/")throw new Zp(a);return a}))}applyRedirectCreateUrlTree(e,t,i,r){let s=this.createSegmentGroup(e,t.root,i,r);return new ro(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){let s=this.createSegments(e,t.segments,i,r),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new sn(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new we(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function C7(n,e,t){if(typeof n=="string")return ut(n);let i=n,{queryParams:r,fragment:s,routeConfig:o,url:a,outlet:c,params:l,data:u,title:d}=e;return ea(Yn(t,()=>i({params:l,data:u,queryParams:r,fragment:s,routeConfig:o,url:a,outlet:c,title:d})))}var aC={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function M7(n,e,t,i,r){let s=P2(n,e,t);return s.matched?(i=Kq(e,i),S7(i,e,t,r).pipe(gt(o=>o===!0?s:ae({},aC)))):ut(s)}function P2(n,e,t){if(e.path==="**")return A7(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?ae({},aC):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||a2)(t,n,e);if(!r)return ae({},aC);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?ae(ae({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function A7(n){return{matched:!0,parameters:n.length>0?l2(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function r2(n,e,t,i){return t.length>0&&P7(n,t,i)?{segmentGroup:new sn(e,R7(i,new sn(t,n.children))),slicedSegments:[]}:t.length===0&&N7(n,t,i)?{segmentGroup:new sn(n.segments,D7(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new sn(n.segments,n.children),slicedSegments:t}}function D7(n,e,t,i){let r={};for(let s of t)if(Kv(n,e,s)&&!i[xs(s)]){let o=new sn([],{});r[xs(s)]=o}return ae(ae({},i),r)}function R7(n,e){let t={};t[Et]=e;for(let i of n)if(i.path===""&&xs(i)!==Et){let r=new sn([],{});t[xs(i)]=r}return t}function P7(n,e,t){return t.some(i=>Kv(n,e,i)&&xs(i)!==Et)}function N7(n,e,t){return t.some(i=>Kv(n,e,i))}function Kv(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function O7(n,e,t){return e.length===0&&!n.children[t]}var cC=class{};function k7(n,e,t,i,r,s,o="emptyOnly"){return new lC(n,e,t,i,r,o,s).recognize()}var L7=31,lC=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new oC(this.urlSerializer,this.urlTree)}noMatchError(e){return new we(4002,`'${e.segmentGroup}'`)}recognize(){let e=r2(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(gt(({children:t,rootSnapshot:i})=>{let r=new kr(i,t),s=new Xp("",r),o=y2(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new $l([],Object.freeze({}),Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Et,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Et,t).pipe(gt(i=>({children:i,rootSnapshot:t})),ja(i=>{if(i instanceof Zp)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Kp?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,r,!0,s).pipe(gt(o=>o instanceof kr?[o]:[]))}processChildren(e,t,i,r){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return Pn(s).pipe(Ga(o=>{let a=i.children[o],c=Zq(t,o);return this.processSegmentGroup(e,c,a,o,r)}),q_((o,a)=>(o.push(...a),o)),Wa(null),Yx(),hi(o=>{if(o===null)return Wd(i);let a=N2(o);return F7(a),ut(a)}))}processSegment(e,t,i,r,s,o,a){return Pn(t).pipe(Ga(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,i,r,s,o,a).pipe(ja(l=>{if(l instanceof Kp)return ut(null);throw l}))),ko(c=>!!c),ja(c=>{if(D2(c))return O7(i,r,s)?ut(new cC):Wd(i);throw c}))}processSegmentAgainstRoute(e,t,i,r,s,o,a,c){return xs(i)!==o&&(o===Et||!Kv(r,s,i))?Wd(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o,c):Wd(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=P2(t,r,s);if(!c)return Wd(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>L7&&(this.allowRedirects=!1));let p=new $l(s,l,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,s2(r),xs(r),r.component??r._loadedComponent??null,r,o2(r)),g=Wv(p,a,this.paramsInheritanceStrategy);return p.params=Object.freeze(g.params),p.data=Object.freeze(g.data),this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,p,e).pipe(Wi(m=>this.applyRedirects.lineralizeSegments(r,m)),hi(m=>this.processSegment(e,i,t,m.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a=M7(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),a.pipe(Wi(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(Wi(({routes:l})=>{let u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:p}=c,g=new $l(h,d,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,s2(i),xs(i),i.component??i._loadedComponent??null,i,o2(i)),y=Wv(g,o,this.paramsInheritanceStrategy);g.params=Object.freeze(y.params),g.data=Object.freeze(y.data);let{segmentGroup:m,slicedSegments:_}=r2(t,h,p,l);if(_.length===0&&m.hasChildren())return this.processChildren(u,l,m,g).pipe(gt(M=>new kr(g,M)));if(l.length===0&&_.length===0)return ut(new kr(g,[]));let I=xs(i)===s;return this.processSegment(u,l,m,_,I?Et:s,!0,g).pipe(gt(M=>new kr(g,M instanceof kr?[M]:[])))}))):Wd(t)))}getChildConfig(e,t,i){return t.children?ut({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ut({routes:t._loadedRoutes,injector:t._loadedInjector}):x7(e,t,i,this.urlSerializer).pipe(hi(r=>r?this.configLoader.loadChildren(e,t).pipe(vi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):I7(t))):ut({routes:[],injector:e})}};function F7(n){n.sort((e,t)=>e.value.outlet===Et?-1:t.value.outlet===Et?1:e.value.outlet.localeCompare(t.value.outlet))}function V7(n){let e=n.value.routeConfig;return e&&e.path===""}function N2(n){let e=[],t=new Set;for(let i of n){if(!V7(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=N2(i.children);e.push(new kr(i.value,r))}return e.filter(i=>!t.has(i))}function s2(n){return n.data||{}}function o2(n){return n.resolve||{}}function U7(n,e,t,i,r,s){return hi(o=>k7(n,e,t,i,o.extractedUrl,r,s).pipe(gt(({state:a,tree:c})=>je(ae({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function B7(n,e){return hi(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ut(t);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of O2(c))o.add(l);let a=0;return Pn(o).pipe(Ga(c=>s.has(c)?z7(c,i,n,e):(c.data=Wv(c,c.parent,n).resolve,ut(void 0))),vi(()=>a++),yd(1),hi(c=>a===o.size?ut(t):yr))})}function O2(n){let e=n.children.map(t=>O2(t)).flat();return[n,...e]}function z7(n,e,t,i){let r=n.routeConfig,s=n._resolve;return r?.title!==void 0&&!T2(r)&&(s[Jp]=r.title),Wf(()=>(n.data=Wv(n,n.parent,t).resolve,H7(s,n,e,i).pipe(gt(o=>(n._resolvedData=o,n.data=ae(ae({},n.data),o),null)))))}function H7(n,e,t,i){let r=ZI(n);if(r.length===0)return ut({});let s={};return Pn(r).pipe(hi(o=>j7(n[o],e,t,i).pipe(ko(),vi(a=>{if(a instanceof Jd)throw $v(new Xl,a);s[o]=a}))),yd(1),gt(()=>s),ja(o=>D2(o)?yr:gd(o)))}function j7(n,e,t,i){let r=eh(e)??i,s=nh(n,r),o=s.resolve?s.resolve(e,t):Yn(r,()=>s(e,t));return ea(o)}function YI(n){return Wi(e=>{let t=n(e);return t?Pn(t).pipe(gt(()=>e)):ut(e)})}var fC=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Et);return i}getResolvedTitleForRoute(t){return t.data[Jp]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(k2),providedIn:"root"})}return n})(),k2=(()=>{class n extends fC{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Qe(QF))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),tm=new Re("",{providedIn:"root",factory:()=>({})}),nm=new Re(""),L2=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=ie(hI);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return ut(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=ea(Yn(t,()=>i.loadComponent())).pipe(gt(V2),Wi(U2),vi(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),yl(()=>{this.componentLoaders.delete(i)})),s=new hd(r,()=>new ti).pipe(dd());return this.componentLoaders.set(i,s),s}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ut({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=F2(i,this.compiler,t,this.onLoadEndListener).pipe(yl(()=>{this.childrenLoaders.delete(i)})),o=new hd(s,()=>new ti).pipe(dd());return this.childrenLoaders.set(i,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function F2(n,e,t,i){return ea(Yn(t,()=>n.loadChildren())).pipe(gt(V2),Wi(U2),hi(r=>r instanceof ev||Array.isArray(r)?ut(r):Pn(e.compileModuleAsync(r))),gt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(nm,[],{optional:!0,self:!0}).flat()),{routes:o.map(hC),injector:s}}))}function G7(n){return n&&typeof n=="object"&&"default"in n}function V2(n){return G7(n)?n.default:n}function U2(n){return ut(n)}var Zv=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(W7),providedIn:"root"})}return n})(),W7=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),B2=new Re("");var z2=new Re(""),H2=(()=>{class n{currentNavigation=Kn(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new ti;transitionAbortWithErrorSubject=new ti;configLoader=ie(L2);environmentInjector=ie(Xn);destroyRef=ie(Qr);urlSerializer=ie(Qp);rootContexts=ie(th);location=ie(Ud);inputBindingEnabled=ie(Yv,{optional:!0})!==null;titleStrategy=ie(fC);options=ie(tm,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=ie(Zv);createViewTransition=ie(B2,{optional:!0});navigationErrorHandler=ie(z2,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ut(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Fv(r)),i=r=>this.events.next(new Vv(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;fi(()=>{this.transitions?.next(je(ae({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(t){return this.transitions=new Ri(null),this.transitions.pipe(rr(i=>i!==null),Wi(i=>{let r=!1;return ut(i).pipe(Wi(s=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",hr.SupersededByNewNavigation),yr;this.currentTransition=i,this.currentNavigation.set({id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?je(ae({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>s.abortController.abort()});let o=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=s.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!o&&a!=="reload")return this.events.next(new Qo(s.id,this.urlSerializer.serialize(s.rawUrl),"",Gp.IgnoredSameUrlNavigation)),s.resolve(!1),yr;if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return ut(s).pipe(Wi(c=>(this.events.next(new Yl(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?yr:Promise.resolve(c))),U7(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),vi(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation.update(u=>(u.finalUrl=c.urlAfterRedirects,u));let l=new Wp(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}));if(o&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:c,extractedUrl:l,source:u,restoredState:d,extras:h}=s,p=new Yl(c,this.urlSerializer.serialize(l),u,d);this.events.next(p);let g=x2(this.rootComponentType).snapshot;return this.currentTransition=i=je(ae({},s),{targetSnapshot:g,urlAfterRedirects:l,extras:je(ae({},h),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(y=>(y.finalUrl=l,y)),ut(i)}else return this.events.next(new Qo(s.id,this.urlSerializer.serialize(s.extractedUrl),"",Gp.IgnoredByUrlHandlingStrategy)),s.resolve(!1),yr}),vi(s=>{let o=new Nv(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(o)}),gt(s=>(this.currentTransition=i=je(ae({},s),{guards:r7(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),i)),m7(this.environmentInjector,s=>this.events.next(s)),vi(s=>{if(i.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw $v(this.urlSerializer,s.guardsResult);let o=new Ov(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(o)}),rr(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",hr.GuardRejected),!1)),YI(s=>{if(s.guards.canActivateChecks.length!==0)return ut(s).pipe(vi(o=>{let a=new kv(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),Wi(o=>{let a=!1;return ut(o).pipe(B7(this.paramsInheritanceStrategy,this.environmentInjector),vi({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(o,"",hr.NoDataFromResolver)}}))}),vi(o=>{let a=new Lv(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}))}),YI(s=>{let o=a=>{let c=[];if(a.routeConfig?.loadComponent){let l=eh(a)??this.environmentInjector;c.push(this.configLoader.loadComponent(l,a.routeConfig).pipe(vi(u=>{a.component=u}),gt(()=>{})))}for(let l of a.children)c.push(...o(l));return c};return W_(o(s.targetSnapshot.root)).pipe(Wa(null),$r(1))}),YI(()=>this.afterPreactivation()),Wi(()=>{let{currentSnapshot:s,targetSnapshot:o}=i,a=this.createViewTransition?.(this.environmentInjector,s.root,o.root);return a?Pn(a).pipe(gt(()=>i)):ut(i)}),gt(s=>{let o=Qq(t.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=i=je(ae({},s),{targetRouterState:o}),this.currentNavigation.update(a=>(a.targetRouterState=o,a)),i}),vi(()=>{this.events.next(new $p)}),i7(this.rootContexts,t.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),$r(1),Y_(new bt(s=>{let o=i.abortController.signal,a=()=>s.next();return o.addEventListener("abort",a),()=>o.removeEventListener("abort",a)}).pipe(rr(()=>!r&&!i.targetRouterState),vi(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",hr.Aborted)}))),vi({next:s=>{r=!0,this.lastSuccessfulNavigation=fi(this.currentNavigation),this.events.next(new Jo(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{r=!0}}),Y_(this.transitionAbortWithErrorSubject.pipe(vi(s=>{throw s}))),yl(()=>{r||this.cancelNavigationTransition(i,"",hr.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),ja(s=>{if(this.destroyed)return i.resolve(!1),yr;if(r=!0,A2(s))this.events.next(new io(i.id,this.urlSerializer.serialize(i.extractedUrl),s.message,s.cancellationCode)),n7(s)?this.events.next(new Zd(s.url,s.navigationBehaviorOptions)):i.resolve(!1);else{let o=new Kd(i.id,this.urlSerializer.serialize(i.extractedUrl),s,i.targetSnapshot??void 0);try{let a=Yn(this.environmentInjector,()=>this.navigationErrorHandler?.(o));if(a instanceof Jd){let{message:c,cancellationCode:l}=$v(this.urlSerializer,a);this.events.next(new io(i.id,this.urlSerializer.serialize(i.extractedUrl),c,l)),this.events.next(new Zd(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(o),s}catch(a){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(a)}}return yr}))}))}cancelNavigationTransition(t,i,r){let s=new io(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=fi(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $7(n){return n!==zp}var j2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(q7),providedIn:"root"})}return n})(),Xv=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},q7=(()=>{class n extends Xv{static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),G2=(()=>{class n{urlSerializer=ie(Qp);options=ie(tm,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=ie(Ud);urlHandlingStrategy=ie(Zv);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ro;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,o=r??s;return o instanceof ro?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=x2(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:()=>ie(X7),providedIn:"root"})}return n})(),X7=(()=>{class n extends G2{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof Yl?this.updateStateMemento():t instanceof Qo?this.commitTransition(i):t instanceof Wp?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof $p?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof io&&t.code!==hr.SupersededByNewNavigation&&t.code!==hr.Redirect?this.restoreHistory(i):t instanceof Kd?this.restoreHistory(i,!0):t instanceof Jo&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:s,state:o}=i;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=ae(ae({},o),this.generateNgRouterState(r,a));this.location.replaceState(t,"",c)}else{let a=ae(ae({},o),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pC(n,e){n.events.pipe(rr(t=>t instanceof Jo||t instanceof io||t instanceof Kd||t instanceof Qo),gt(t=>t instanceof Jo||t instanceof Qo?0:(t instanceof io?t.code===hr.Redirect||t.code===hr.SupersededByNewNavigation:!1)?2:1),rr(t=>t!==2),$r(1)).subscribe(()=>{e()})}var Y7={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},K7={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Yi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=ie(cI);stateManager=ie(G2);options=ie(tm,{optional:!0})||{};pendingTasks=ie(Ws);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=ie(H2);urlSerializer=ie(Qp);location=ie(Ud);urlHandlingStrategy=ie(Zv);injector=ie(Xn);_events=new ti;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=ie(j2);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=ie(nm,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!ie(Yv,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Hn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,s=fi(this.navigationTransitions.currentNavigation);if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof io&&i.code!==hr.Redirect&&i.code!==hr.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Jo)this.navigated=!0;else if(i instanceof Zd){let o=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c=ae({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||$7(r.source)},o);this.scheduleNavigation(a,zp,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}Yq(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),zp,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let c=ae({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s).catch(c=>{this.disposed||this.injector.get(lr)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return fi(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(hC),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:o,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=ae(ae({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=r?r.snapshot:this.routerState.snapshot.root;d=v2(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return b2(d,t,u,l??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=Yd(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,zp,null,i)}navigate(t,i={skipLocationChange:!1}){return Z7(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Sl(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=ae({},Y7):i===!1?r=ae({},K7):r=i,Yd(t))return e2(this.currentUrlTree,t,r);let s=this.parseUrl(t);return e2(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(s!=null&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,h)=>{a=d,c=h});let u=this.pendingTasks.add();return pC(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Z7(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new we(4008,!1)}var Q7=new Re("");function mC(n,...e){return or([{provide:nm,multi:!0,useValue:n},[],{provide:so,useFactory:eX,deps:[Yi]},{provide:nv,multi:!0,useFactory:tX},e.map(t=>t.\u0275providers)])}function eX(n){return n.routerState.root}function tX(){let n=ie(Nn);return e=>{let t=n.get(Go);if(e!==t.components[0])return;let i=n.get(Yi),r=n.get(nX);n.get(iX)===1&&i.initialNavigation(),n.get(rX,null,{optional:!0})?.setUpPreloading(),n.get(Q7,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var nX=new Re("",{factory:()=>new ti}),iX=new Re("",{providedIn:"root",factory:()=>1});var rX=new Re("");var W2=()=>{};var X2=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},oX=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Jv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,l=c?n[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(h=64)),i.push(t[u],t[d],t[h],t[p])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(X2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):oX(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let l=r<n.length?t[n.charAt(r)]:64;++r;let d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||l==null||d==null)throw new yC;let h=s<<2|a>>4;if(i.push(h),l!==64){let p=a<<4&240|l>>2;if(i.push(p),d!==64){let g=l<<6&192|d;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},yC=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},aX=function(n){let e=X2(n);return Jv.encodeByteArray(e,!0)},rm=function(n){return aX(n).replace(/\./g,"")},Qv=function(n){try{return Jv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var cX=()=>bC().__FIREBASE_DEFAULTS__,lX=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uX=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Qv(n[1]);return e&&JSON.parse(e)},e0=()=>{try{return W2()||cX()||lX()||uX()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},EC=n=>{var e,t;return(t=(e=e0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Y2=n=>{let e=EC(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},wC=()=>{var n;return(n=e0())===null||n===void 0?void 0:n.config},xC=n=>{var e;return(e=e0())===null||e===void 0?void 0:e[`_${n}`]};var Zl=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function dc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function t0(n){return U(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function K2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[rm(JSON.stringify(t)),rm(JSON.stringify(o)),""].join(".")}var im={};function dX(){let n={prod:[],emulator:[]};for(let e of Object.keys(im))im[e]?n.emulator.push(e):n.prod.push(e);return n}function hX(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var $2=!1;function n0(n,e){if(typeof window>"u"||typeof document>"u"||!dc(window.location.host)||im[n]===e||im[n]||$2)return;im[n]=e;function t(h){return`__firebase__banner__${h}`}let i="__firebase__banner",s=dX().prod.length>0;function o(){let h=document.getElementById(i);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,p){h.setAttribute("width","24"),h.setAttribute("id",p),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function l(){let h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{$2=!0,o()},h}function u(h,p){h.setAttribute("id",p),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){let h=hX(i),p=t("text"),g=document.getElementById(p)||document.createElement("span"),y=t("learnmore"),m=document.getElementById(y)||document.createElement("a"),_=t("preprendIcon"),I=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){let M=h.element;a(M),u(m,y);let C=l();c(I,_),M.append(I,g,m,C),document.body.appendChild(M)}s?(g.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function Si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Z2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Si())}function fX(){var n;let e=(n=e0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function J2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q2(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tV(){let n=Si();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function nV(){return!fX()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sm(){try{return typeof indexedDB=="object"}catch{return!1}}function iV(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var pX="FirebaseError",Fr=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=pX,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ss.prototype.create)}},Ss=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?mX(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Fr(r,a,i)}};function mX(n,e){return n.replace(gX,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var gX=/\{\$([^}]+)}/g;function rV(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function oo(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],o=e[r];if(q2(s)&&q2(o)){if(!oo(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function q2(n){return n!==null&&typeof n=="object"}function om(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function sV(n,e){let t=new vC(n,e);return t.subscribe.bind(t)}var vC=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");_X(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=_C),r.error===void 0&&(r.error=_C),r.complete===void 0&&(r.complete=_C);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function _X(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function _C(){}var mAe=14400*1e3;function pi(n){return n&&n._delegate?n._delegate:n}var fr=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Jl="[DEFAULT]";var SC=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Zl;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vX(e))try{this.getOrInitializeService({instanceIdentifier:Jl})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Jl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return U(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Jl){return this.instances.has(e)}getOptions(e=Jl){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:yX(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Jl){return this.component?this.component.multipleInstances?e:Jl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yX(n){return n===Jl?void 0:n}function vX(n){return n.instantiationMode==="EAGER"}var i0=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new SC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var bX=[],Lt=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Lt||{}),EX={debug:Lt.DEBUG,verbose:Lt.VERBOSE,info:Lt.INFO,warn:Lt.WARN,error:Lt.ERROR,silent:Lt.SILENT},wX=Lt.INFO,xX={[Lt.DEBUG]:"log",[Lt.VERBOSE]:"log",[Lt.INFO]:"info",[Lt.WARN]:"warn",[Lt.ERROR]:"error"},SX=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=xX[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ao=class{constructor(e){this.name=e,this._logLevel=wX,this._logHandler=SX,this._userLogHandler=null,bX.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Lt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Lt.DEBUG,...e),this._logHandler(this,Lt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Lt.VERBOSE,...e),this._logHandler(this,Lt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Lt.INFO,...e),this._logHandler(this,Lt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Lt.WARN,...e),this._logHandler(this,Lt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Lt.ERROR,...e),this._logHandler(this,Lt.ERROR,...e)}};var TX=(n,e)=>e.some(t=>n instanceof t),oV,aV;function IX(){return oV||(oV=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CX(){return aV||(aV=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var cV=new WeakMap,IC=new WeakMap,lV=new WeakMap,TC=new WeakMap,MC=new WeakMap;function MX(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(co(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&cV.set(t,n)}).catch(()=>{}),MC.set(e,n),e}function AX(n){if(IC.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});IC.set(n,e)}var CC={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return IC.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lV.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uV(n){CC=n(CC)}function DX(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(r0(this),e,...t);return lV.set(i,e.sort?e.sort():[e]),co(i)}:CX().includes(n)?function(...e){return n.apply(r0(this),e),co(cV.get(this))}:function(...e){return co(n.apply(r0(this),e))}}function RX(n){return typeof n=="function"?DX(n):(n instanceof IDBTransaction&&AX(n),TX(n,IX())?new Proxy(n,CC):n)}function co(n){if(n instanceof IDBRequest)return MX(n);if(TC.has(n))return TC.get(n);let e=RX(n);return e!==n&&(TC.set(n,e),MC.set(e,n)),e}var r0=n=>MC.get(n);function hV(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(n,e),a=co(o);return i&&o.addEventListener("upgradeneeded",c=>{i(co(o.result),c.oldVersion,c.newVersion,co(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var PX=["get","getKey","getAll","getAllKeys","count"],NX=["put","add","delete","clear"],AC=new Map;function dV(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(AC.get(e))return AC.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=NX.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||PX.includes(t)))return;let s=function(o,...a){return U(this,null,function*(){let c=this.transaction(o,r?"readwrite":"readonly"),l=c.store;return i&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),r&&c.done]))[0]})};return AC.set(e,s),s}uV(n=>je(ae({},n),{get:(e,t,i)=>dV(e,t)||n.get(e,t,i),has:(e,t)=>!!dV(e,t)||n.has(e,t)}));var RC=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OX(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function OX(n){let e=n.getComponent();return e?.type==="VERSION"}var PC="@firebase/app",fV="0.13.2";var ta=new ao("@firebase/app"),kX="@firebase/app-compat",LX="@firebase/analytics-compat",FX="@firebase/analytics",VX="@firebase/app-check-compat",UX="@firebase/app-check",BX="@firebase/auth",zX="@firebase/auth-compat",HX="@firebase/database",jX="@firebase/data-connect",GX="@firebase/database-compat",WX="@firebase/functions",$X="@firebase/functions-compat",qX="@firebase/installations",XX="@firebase/installations-compat",YX="@firebase/messaging",KX="@firebase/messaging-compat",ZX="@firebase/performance",JX="@firebase/performance-compat",QX="@firebase/remote-config",eY="@firebase/remote-config-compat",tY="@firebase/storage",nY="@firebase/storage-compat",iY="@firebase/firestore",rY="@firebase/ai",sY="@firebase/firestore-compat",oY="firebase",aY="11.10.0";var NC="[DEFAULT]",cY={[PC]:"fire-core",[kX]:"fire-core-compat",[FX]:"fire-analytics",[LX]:"fire-analytics-compat",[UX]:"fire-app-check",[VX]:"fire-app-check-compat",[BX]:"fire-auth",[zX]:"fire-auth-compat",[HX]:"fire-rtdb",[jX]:"fire-data-connect",[GX]:"fire-rtdb-compat",[WX]:"fire-fn",[$X]:"fire-fn-compat",[qX]:"fire-iid",[XX]:"fire-iid-compat",[YX]:"fire-fcm",[KX]:"fire-fcm-compat",[ZX]:"fire-perf",[JX]:"fire-perf-compat",[QX]:"fire-rc",[eY]:"fire-rc-compat",[tY]:"fire-gcs",[nY]:"fire-gcs-compat",[iY]:"fire-fst",[sY]:"fire-fst-compat",[rY]:"fire-vertex","fire-js":"fire-js",[oY]:"fire-js-all"};var am=new Map,lY=new Map,OC=new Map;function pV(n,e){try{n.container.addComponent(e)}catch(t){ta.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ts(n){let e=n.name;if(OC.has(e))return ta.debug(`There were multiple attempts to register component ${e}.`),!1;OC.set(e,n);for(let t of am.values())pV(t,n);for(let t of lY.values())pV(t,n);return!0}function ih(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function is(n){return n==null?!1:n.settings!==void 0}var uY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hc=new Ss("app","Firebase",uY);var kC=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new fr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hc.create("app-deleted",{appName:this._name})}};var fc=aY;function VC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:NC,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw hc.create("bad-app-name",{appName:String(r)});if(t||(t=wC()),!t)throw hc.create("no-options");let s=am.get(r);if(s){if(oo(t,s.options)&&oo(i,s.config))return s;throw hc.create("duplicate-app",{appName:r})}let o=new i0(r);for(let c of OC.values())o.addComponent(c);let a=new kC(t,i,o);return am.set(r,a),a}function Ql(n=NC){let e=am.get(n);if(!e&&n===NC&&wC())return VC();if(!e)throw hc.create("no-app",{appName:n});return e}function s0(){return Array.from(am.values())}function jn(n,e,t){var i;let r=(i=cY[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ta.warn(a.join(" "));return}Ts(new fr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var dY="firebase-heartbeat-database",hY=1,cm="firebase-heartbeat-store",DC=null;function yV(){return DC||(DC=hV(dY,hY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(cm)}catch(t){console.warn(t)}}}}).catch(n=>{throw hc.create("idb-open",{originalErrorMessage:n.message})})),DC}function fY(n){return U(this,null,function*(){try{let t=(yield yV()).transaction(cm),i=yield t.objectStore(cm).get(vV(n));return yield t.done,i}catch(e){if(e instanceof Fr)ta.warn(e.message);else{let t=hc.create("idb-get",{originalErrorMessage:e?.message});ta.warn(t.message)}}})}function mV(n,e){return U(this,null,function*(){try{let i=(yield yV()).transaction(cm,"readwrite");yield i.objectStore(cm).put(e,vV(n)),yield i.done}catch(t){if(t instanceof Fr)ta.warn(t.message);else{let i=hc.create("idb-set",{originalErrorMessage:t?.message});ta.warn(i.message)}}})}function vV(n){return`${n.name}!${n.options.appId}`}var pY=1024,mY=30,LC=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new FC(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return U(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gV();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>mY){let o=_Y(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){ta.warn(i)}})}getHeartbeatsHeader(){return U(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=gV(),{heartbeatsToSend:i,unsentEntries:r}=gY(this._heartbeatsCache.heartbeats),s=rm(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ta.warn(t),""}})}};function gV(){return new Date().toISOString().substring(0,10)}function gY(n,e=pY){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),_V(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),_V(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var FC=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return U(this,null,function*(){return sm()?iV().then(()=>!0).catch(()=>!1):!1})}read(){return U(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield fY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return U(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return mV(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return U(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return mV(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function _V(n){return rm(JSON.stringify({version:2,heartbeats:n})).length}function _Y(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function yY(n){Ts(new fr("platform-logger",e=>new RC(e),"PRIVATE")),Ts(new fr("heartbeat",e=>new LC(e),"PRIVATE")),jn(PC,fV,n),jn(PC,fV,"esm2017"),jn("fire-js","")}yY("");var vY="firebase",bY="11.10.0";jn(vY,bY,"app");function bV(n){n===void 0&&(n=ie(Nn));let e=n.get(tc);return t=>new bt(i=>{let r=e.add(),s=!1;function o(){s||(r(),s=!0)}let a=t.subscribe({next:c=>{i.next(c),o()},complete:()=>{i.complete(),o()},error:c=>{i.error(c),o()}});return a.add(()=>{i.unsubscribe(),o()}),a})}var pc=new bl("ANGULARFIRE2_VERSION");function lm(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var sh=(n,e)=>{let t=e?[e]:s0(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},rh=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(rh||{}),EV=EI()&&typeof Zone<"u"?rh.WARN:rh.SILENT;var o0=class{zone;delegate;constructor(e,t=Wx){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r?r.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,i)}},mc=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=ie(Bt);this.outsideAngular=t.runOutsideAngular(()=>new o0(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new o0(typeof Zone>"u"?void 0:Zone.current,Gx))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wV=!1;function EY(n,e){!wV&&(EV>rh.SILENT||EI())&&(wV=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),EV>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function wY(n){let e=ie(Bt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function eu(n){let e=ie(Bt,{optional:!0});return e?e.run(()=>n()):n()}var xY=(n,e,t)=>(...i)=>(e&&setTimeout(e,0),Yn(t,()=>eu(()=>n.apply(void 0,i)))),pr=(n,e,t)=>(t||=e?rh.WARN:rh.VERBOSE,function(){let i,r=arguments,s,o,a;try{s=ie(mc),o=ie(tc),a=ie(Xn)}catch{return EY(n,t),n.apply(this,r)}for(let l=0;l<arguments.length;l++)typeof r[l]=="function"&&(e&&(i||=eu(()=>o.add())),r[l]=xY(r[l],i,a));let c=wY(()=>n.apply(this,r));return e?c instanceof bt?c.pipe(Ha(s.outsideAngular),za(s.insideAngular),bV(a)):c instanceof Promise?eu(()=>{let l=o.add();return new Promise((u,d)=>{c.then(h=>Yn(a,()=>eu(()=>u(h))),h=>Yn(a,()=>eu(()=>d(h)))).finally(l)})}):typeof c=="function"&&i?function(){return setTimeout(i,0),c.apply(this,arguments)}:eu(()=>c):c instanceof bt?c.pipe(Ha(s.outsideAngular),za(s.insideAngular)):eu(()=>c)});var na=class{constructor(e){return e}},tu=class{constructor(){return s0()}};function SY(n){return n&&n.length===1?n[0]:new na(Ql())}var UC=new Re("angularfire2._apps"),TY={provide:na,useFactory:SY,deps:[[new Nr,UC]]},IY={provide:tu,deps:[[new Nr,UC]]};function CY(n){return(e,t)=>{let i=t.get(sc);jn("angularfire",pc.full,"core"),jn("angularfire",pc.full,"app"),jn("angular",cS.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new na(r)}}function xV(n,...e){return or([TY,IY,{provide:UC,useFactory:CY(n),multi:!0,deps:[Bt,Nn,mc,...e]}])}var SV=pr(VC,!0);var MY=new Map,AY={activated:!1,tokenObservers:[]},DY={initialized:!1,enabled:!1};function Is(n){return MY.get(n)||Object.assign({},AY)}function MV(){return DY}var RY="https://content-firebaseappcheck.googleapis.com/v1";var PY="exchangeDebugToken",TV={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},yDe=1440*60*1e3;var HC=class{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return U(this,null,function*(){this.stop();try{this.pending=new Zl,this.pending.promise.catch(t=>{}),yield NY(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Zl,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function NY(n){return new Promise(e=>{setTimeout(e,n)})}var OY={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},gc=new Ss("appCheck","AppCheck",OY);function AV(n){if(!Is(n).activated)throw gc.create("use-before-activation",{appName:n.name})}function DV(i,r){return U(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let p=yield o.getHeartbeatsHeader();p&&(s["X-Firebase-Client"]=p)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(p){throw gc.create("fetch-network-error",{originalErrorMessage:p?.message})}if(c.status!==200)throw gc.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(p){throw gc.create("fetch-parse-error",{originalErrorMessage:p?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw gc.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:l.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function RV(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${RY}/projects/${t}/apps/${i}:${PY}?key=${r}`,body:{debug_token:e}}}var kY="firebase-app-check-database",LY=1,jC="firebase-app-check-store";var a0=null;function FY(){return a0||(a0=new Promise((n,e)=>{try{let t=indexedDB.open(kY,LY);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(gc.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(jC,{keyPath:"compositeKey"})}}}catch(t){e(gc.create("storage-open",{originalErrorMessage:t?.message}))}}),a0)}function VY(n,e){return UY(BY(n),e)}function UY(n,e){return U(this,null,function*(){let i=(yield FY()).transaction(jC,"readwrite"),s=i.objectStore(jC).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},i.onerror=c=>{var l;a(gc.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function BY(n){return`${n.options.appId}-${n.name}`}var um=new ao("@firebase/app-check");function BC(n,e){return sm()?VY(n,e).catch(t=>{um.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function PV(){return MV().enabled}function NV(){return U(this,null,function*(){let n=MV();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var zY={error:"UNKNOWN_ERROR"};function HY(n){return Jv.encodeString(JSON.stringify(n),!1)}function GC(n,e=!1,t=!1){return U(this,null,function*(){let i=n.app;AV(i);let r=Is(i),s=r.token,o;if(s&&!dm(s)&&(r.token=void 0,s=void 0),!s){let l=yield r.cachedTokenPromise;l&&(dm(l)?s=l:yield BC(i,void 0))}if(!e&&s&&dm(s))return{token:s.token};let a=!1;if(PV())try{r.exchangeTokenPromise||(r.exchangeTokenPromise=DV(RV(i,yield NV()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),a=!0);let l=yield r.exchangeTokenPromise;return yield BC(i,l),r.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?um.warn(l.message):t&&um.error(l),zC(l)}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),a=!0),s=yield Is(i).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?um.warn(l.message):t&&um.error(l),o=l}let c;return s?o?dm(s)?c={token:s.token,internalError:o}:c=zC(o):(c={token:s.token},r.token=s,yield BC(i,s)):c=zC(o),a&&$Y(i,c),c})}function jY(n){return U(this,null,function*(){let e=n.app;AV(e);let{provider:t}=Is(e);if(PV()){let i=yield NV(),{token:r}=yield DV(RV(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function GY(n,e,t,i){let{app:r}=n,s=Is(r),o={next:t,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&dm(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),IV(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>IV(n))}function OV(n,e){let t=Is(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function IV(n){let{app:e}=n,t=Is(e),i=t.tokenRefresher;i||(i=WY(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function WY(n){let{app:e}=n;return new HC(()=>U(null,null,function*(){let t=Is(e),i;if(t.token?i=yield GC(n,!0):i=yield GC(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=Is(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-300*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},TV.RETRIAL_MIN_WAIT,TV.RETRIAL_MAX_WAIT)}function $Y(n,e){let t=Is(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function dm(n){return n.expireTimeMillis-Date.now()>0}function zC(n){return{token:HY(zY),error:n}}var WC=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Is(this.app);for(let t of e)OV(this.app,t.next);return Promise.resolve()}};function qY(n,e){return new WC(n,e)}function XY(n){return{getToken:e=>GC(n,e),getLimitedUseToken:()=>jY(n),addTokenListener:e=>GY(n,"INTERNAL",e),removeTokenListener:e=>OV(n.app,e)}}var YY="@firebase/app-check",KY="0.10.1";var ZY="app-check",CV="app-check-internal";function JY(){Ts(new fr(ZY,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return qY(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(CV).initialize()})),Ts(new fr(CV,n=>{let e=n.getProvider("app-check").getImmediate();return XY(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),jn(YY,KY)}JY();var QY="app-check";var oh=class{constructor(){return sh(QY)}};var eK=["localhost","0.0.0.0","127.0.0.1"],RDe=typeof window<"u"&&eK.includes(window.location.hostname);function YV(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var KV=YV,ZV=new Ss("auth","Firebase",YV());var f0=new ao("@firebase/auth");function tK(n,...e){f0.logLevel<=Lt.WARN&&f0.warn(`Auth (${fc}): ${n}`,...e)}function l0(n,...e){f0.logLevel<=Lt.ERROR&&f0.error(`Auth (${fc}): ${n}`,...e)}function vc(n,...e){throw dM(n,...e)}function iu(n,...e){return dM(n,...e)}function JV(n,e,t){let i=Object.assign(Object.assign({},KV()),{[e]:t});return new Ss("auth","Firebase",i).create(e,{appName:n.name})}function nu(n){return JV(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dM(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ZV.create(n,...e)}function _t(n,e,...t){if(!n)throw dM(e,...t)}function ia(n){let e="INTERNAL ASSERTION FAILED: "+n;throw l0(e),new Error(e)}function bc(n,e){n||ia(e)}function YC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function nK(){return kV()==="http:"||kV()==="https:"}function kV(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function iK(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nK()||Q2()||"connection"in navigator)?navigator.onLine:!0}function rK(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ru=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,bc(t>e,"Short delay should be less than long delay!"),this.isMobile=Z2()||eV()}get(){return iK()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function hM(n,e){bc(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var p0=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ia("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ia("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ia("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var sK={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var oK=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aK=new ru(3e4,6e4);function fM(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function ah(s,o,a,c){return U(this,arguments,function*(n,e,t,i,r={}){return QV(n,r,()=>U(null,null,function*(){let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});let d=om(Object.assign({key:n.config.apiKey},u)).slice(1),h=yield n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);let p=Object.assign({method:e,headers:h},l);return J2()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&dc(n.emulatorConfig.host)&&(p.credentials="include"),p0.fetch()(yield eU(n,n.config.apiHost,t,d),p)}))})}function QV(n,e,t){return U(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},sK),e);try{let r=new KC(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw c0(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw c0(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw c0(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw c0(n,"user-disabled",o);let u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw JV(n,u,l);vc(n,u)}}catch(r){if(r instanceof Fr)throw r;vc(n,"network-request-failed",{message:String(r)})}})}function cK(s,o,a,c){return U(this,arguments,function*(n,e,t,i,r={}){let l=yield ah(n,e,t,i,r);return"mfaPendingCredential"in l&&vc(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function eU(n,e,t,i){return U(this,null,function*(){let r=`${e}${t}?${i}`,s=n,o=s.config.emulator?hM(n.config,r):`${n.config.apiScheme}://${r}`;return oK.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o})}var KC=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(iu(this.auth,"network-request-failed")),aK.get())})}};function c0(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=iu(n,e,i);return r.customData._tokenResponse=t,r}function lK(n,e){return U(this,null,function*(){return ah(n,"POST","/v1/accounts:delete",e)})}function m0(n,e){return U(this,null,function*(){return ah(n,"POST","/v1/accounts:lookup",e)})}function hm(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function pM(n,e=!1){return U(this,null,function*(){let t=pi(n),i=yield t.getIdToken(e),r=mM(i);_t(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:hm($C(r.auth_time)),issuedAtTime:hm($C(r.iat)),expirationTime:hm($C(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function $C(n){return Number(n)*1e3}function mM(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return l0("JWT malformed, contained fewer than 3 sections"),null;try{let r=Qv(t);return r?JSON.parse(r):(l0("Failed to decode base64 JWT payload"),null)}catch(r){return l0("Caught error parsing JWT payload as JSON",r?.toString()),null}}function LV(n){let e=mM(n);return _t(e,"internal-error"),_t(typeof e.exp<"u","internal-error"),_t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function pm(n,e,t=!1){return U(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof Fr&&uK(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function uK({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ZC=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>U(this,null,function*(){yield this.iteration()}),t)}iteration(){return U(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var mm=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hm(this.lastLoginAt),this.creationTime=hm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function g0(n){return U(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield pm(n,m0(t,{idToken:i}));_t(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?tU(s.providerUserInfo):[],a=dK(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,u=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new mm(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,d)})}function gM(n){return U(this,null,function*(){let e=pi(n);yield g0(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function dK(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function tU(n){return n.map(e=>{var{providerId:t}=e,i=$x(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function hK(n,e){return U(this,null,function*(){let t=yield QV(n,{},()=>U(null,null,function*(){let i=om({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=yield eU(n,r,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:i};return n.emulatorConfig&&dc(n.emulatorConfig.host)&&(c.credentials="include"),p0.fetch()(o,c)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function fK(n,e){return U(this,null,function*(){return ah(n,"POST","/v2/accounts:revokeToken",fM(n,e))})}var fm=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_t(e.idToken,"internal-error"),_t(typeof e.idToken<"u","internal-error"),_t(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_t(e.length!==0,"internal-error");let t=LV(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return U(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return U(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield hK(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new n;return i&&(_t(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(_t(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(_t(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ia("not implemented")}};function _c(n,e){_t(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var yc=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=$x(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ZC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new mm(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return U(this,null,function*(){let t=yield pm(this,this.stsTokenManager.getToken(this.auth,e));return _t(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return pM(this,e)}reload(){return gM(this)}_assign(e){this!==e&&(_t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){_t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return U(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield g0(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return U(this,null,function*(){if(is(this.auth.app))return Promise.reject(nu(this.auth));let e=yield this.getIdToken();return yield pm(this,lK(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,c,l,u;let d=(i=t.displayName)!==null&&i!==void 0?i:void 0,h=(r=t.email)!==null&&r!==void 0?r:void 0,p=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=t.photoURL)!==null&&o!==void 0?o:void 0,y=(a=t.tenantId)!==null&&a!==void 0?a:void 0,m=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,_=(l=t.createdAt)!==null&&l!==void 0?l:void 0,I=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:M,emailVerified:C,isAnonymous:P,providerData:N,stsTokenManager:S}=t;_t(M&&S,e,"internal-error");let w=fm.fromJSON(this.name,S);_t(typeof M=="string",e,"internal-error"),_c(d,e.name),_c(h,e.name),_t(typeof C=="boolean",e,"internal-error"),_t(typeof P=="boolean",e,"internal-error"),_c(p,e.name),_c(g,e.name),_c(y,e.name),_c(m,e.name),_c(_,e.name),_c(I,e.name);let b=new n({uid:M,auth:e,email:h,emailVerified:C,displayName:d,isAnonymous:P,photoURL:g,phoneNumber:p,tenantId:y,stsTokenManager:w,createdAt:_,lastLoginAt:I});return N&&Array.isArray(N)&&(b.providerData=N.map(E=>Object.assign({},E))),m&&(b._redirectEventId=m),b}static _fromIdTokenResponse(e,t,i=!1){return U(this,null,function*(){let r=new fm;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield g0(s),s})}static _fromGetAccountInfoResponse(e,t,i){return U(this,null,function*(){let r=t.users[0];_t(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?tU(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new fm;a.updateFromIdToken(i);let c=new n({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new mm(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var FV=new Map;function ra(n){bc(n instanceof Function,"Expected a class definition");let e=FV.get(n);return e?(bc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FV.set(n,e),e)}var pK=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return U(this,null,function*(){return!0})}_set(t,i){return U(this,null,function*(){this.storage[t]=i})}_get(t){return U(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return U(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),JC=pK;function u0(n,e,t){return`firebase:${n}:${e}:${t}`}var _0=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=u0(this.userKey,r.apiKey,s),this.fullPersistenceKey=u0("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return U(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield m0(this.auth,{idToken:e}).catch(()=>{});return t?yc._fromGetAccountInfoResponse(this.auth,t,e):null}return yc._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return U(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return U(this,null,function*(){if(!t.length)return new n(ra(JC),e,i);let r=(yield Promise.all(t.map(l=>U(null,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=r[0]||ra(JC),o=u0(i,e.config.apiKey,e.name),a=null;for(let l of t)try{let u=yield l._get(o);if(u){let d;if(typeof u=="string"){let h=yield m0(e,{idToken:u}).catch(()=>{});if(!h)break;d=yield yc._fromGetAccountInfoResponse(e,h,u)}else d=yc._fromJSON(e,u);l!==s&&(a=d),s=l;break}}catch{}let c=r.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,i):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>U(null,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,i))})}};function VV(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sU(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nU(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(aU(e))return"Blackberry";if(cU(e))return"Webos";if(iU(e))return"Safari";if((e.includes("chrome/")||rU(e))&&!e.includes("edge/"))return"Chrome";if(oU(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function nU(n=Si()){return/firefox\//i.test(n)}function iU(n=Si()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rU(n=Si()){return/crios\//i.test(n)}function sU(n=Si()){return/iemobile/i.test(n)}function oU(n=Si()){return/android/i.test(n)}function aU(n=Si()){return/blackberry/i.test(n)}function cU(n=Si()){return/webos/i.test(n)}function _M(n=Si()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mK(n=Si()){var e;return _M(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function gK(){return tV()&&document.documentMode===10}function lU(n=Si()){return _M(n)||oU(n)||cU(n)||aU(n)||/windows phone/i.test(n)||sU(n)}function uU(n,e=[]){let t;switch(n){case"Browser":t=VV(Si());break;case"Worker":t=`${VV(Si())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${fc}/${i}`}var QC=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return U(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function _K(t){return U(this,arguments,function*(n,e={}){return ah(n,"GET","/v2/passwordPolicy",fM(n,e))})}var yK=6,eM=class{constructor(e){var t,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:yK,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var tM=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new y0(this),this.idTokenSubscription=new y0(this),this.beforeStateQueue=new QC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZV,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ra(t)),this._initializationPromise=this.queue(()=>U(this,null,function*(){var i,r,s;if(!this._deleted&&(this.persistenceManager=yield _0.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return U(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return U(this,null,function*(){try{let t=yield m0(this,{idToken:e}),i=yield yc._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return U(this,null,function*(){var t;if(is(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _t(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return U(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return U(this,null,function*(){try{yield g0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=rK()}_delete(){return U(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return U(this,null,function*(){if(is(this.app))return Promise.reject(nu(this));let t=e?pi(e):null;return t&&_t(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return U(this,null,function*(){if(!this._deleted)return e&&_t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>U(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return U(this,null,function*(){return is(this.app)?Promise.reject(nu(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return is(this.app)?Promise.reject(nu(this)):this.queue(()=>U(this,null,function*(){yield this.assertedPersistence.setPersistence(ra(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return U(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return U(this,null,function*(){let e=yield _K(this),t=new eM(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ss("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return U(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield fK(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return U(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return U(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ra(e)||this._popupRedirectResolver;_t(t,this,"argument-error"),this.redirectPersistenceManager=yield _0.create(this,[ra(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return U(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>U(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return U(this,null,function*(){if(e===this.currentUser)return this.queue(()=>U(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_t(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return U(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uU(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return U(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return U(this,null,function*(){var e;if(is(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&tK(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function yM(n){return pi(n)}var y0=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=sV(t=>this.observer=t)}get next(){return _t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var vM={loadJS(){return U(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vK(n){vM=n}function bK(n){return vM.loadJS(n)}function EK(){return vM.gapiScript}function dU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function bM(n,e){let t=ih(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),s=t.getOptions();if(oo(s,e??{}))return r;vc(r,"already-initialized")}return t.initialize({options:e})}function wK(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ra);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function EM(n,e,t){let i=yM(n);_t(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,s=hU(e),{host:o,port:a}=xK(e),c=a===null?"":`:${a}`,l={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){_t(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),_t(oo(l,i.config.emulator)&&oo(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=l,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,dc(o)?(t0(`${s}//${o}${c}`),n0("Auth",!0)):r||SK()}function hU(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xK(n){let e=hU(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:UV(i.substr(s.length+1))}}else{let[s,o]=i.split(":");return{host:s,port:UV(o)}}}function UV(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function SK(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var v0=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ia("not implemented")}_getIdTokenResponse(e){return ia("not implemented")}_linkToIdToken(e,t){return ia("not implemented")}_getReauthenticationResolver(e){return ia("not implemented")}};function qC(n,e){return U(this,null,function*(){return cK(n,"POST","/v1/accounts:signInWithIdp",fM(n,e))})}var b0=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var nM=class extends b0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var gm=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return U(this,null,function*(){let s=yield yc._fromIdTokenResponse(e,i,r),o=BV(i);return new n({user:s,providerId:o,_tokenResponse:i,operationType:t})})}static _forOperation(e,t,i){return U(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=BV(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})})}};function BV(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var iM=class n extends Fr{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function fU(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?iM._fromErrorAndOperation(n,s,e,i):s})}function TK(n,e,t=!1){return U(this,null,function*(){let i=yield pm(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return gm._forOperation(n,"link",i)})}function IK(n,e,t=!1){return U(this,null,function*(){let{auth:i}=n;if(is(i.app))return Promise.reject(nu(i));let r="reauthenticate";try{let s=yield pm(n,fU(i,r,e,n),t);_t(s.idToken,i,"internal-error");let o=mM(s.idToken);_t(o,i,"internal-error");let{sub:a}=o;return _t(n.uid===a,i,"user-mismatch"),gm._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&vc(i,"user-mismatch"),s}})}function CK(n,e,t=!1){return U(this,null,function*(){if(is(n.app))return Promise.reject(nu(n));let i="signIn",r=yield fU(n,i,e),s=yield gm._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})}function wM(n,e,t,i){return pi(n).onIdTokenChanged(e,t,i)}function xM(n,e,t){return pi(n).beforeAuthStateChanged(e,t)}var E0="__sak";var w0=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(E0,"1"),this.storage.removeItem(E0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var MK=1e3,AK=10,DK=(()=>{class n extends w0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lU(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let r=t.key;i?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);gK()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,AK):s()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},MK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,i){return U(this,null,function*(){yield Ua(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i)})}_get(t){return U(this,null,function*(){let i=yield Ua(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i})}_remove(t){return U(this,null,function*(){yield Ua(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),pU=DK;var RK=(()=>{class n extends w0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),SM=RK;function PK(n){return Promise.all(n.map(e=>U(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var NK=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){return U(this,null,function*(){let i=t,{eventId:r,eventType:s,data:o}=i.data,a=this.handlersMap[s];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let c=Array.from(a).map(u=>U(this,null,function*(){return u(i.origin,o)})),l=yield PK(c);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function mU(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var rM=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){return U(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=mU("",20);r.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){let h=d;if(h.data.eventId===l)switch(h.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(h.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function lo(){return window}function OK(n){lo().location.href=n}function gU(){return typeof lo().WorkerGlobalScope<"u"&&typeof lo().importScripts=="function"}function kK(){return U(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function LK(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function FK(){return gU()?self:null}var _U="firebaseLocalStorageDb",VK=1,x0="firebaseLocalStorage",yU="fbase_key",su=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function T0(n,e){return n.transaction([x0],e?"readwrite":"readonly").objectStore(x0)}function UK(){let n=indexedDB.deleteDatabase(_U);return new su(n).toPromise()}function sM(){let n=indexedDB.open(_U,VK);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(x0,{keyPath:yU})}catch(r){t(r)}}),n.addEventListener("success",()=>U(null,null,function*(){let i=n.result;i.objectStoreNames.contains(x0)?e(i):(i.close(),yield UK(),e(yield sM()))}))})}function zV(n,e,t){return U(this,null,function*(){let i=T0(n,!0).put({[yU]:e,value:t});return new su(i).toPromise()})}function BK(n,e){return U(this,null,function*(){let t=T0(n,!1).get(e),i=yield new su(t).toPromise();return i===void 0?null:i.value})}function HV(n,e){let t=T0(n,!0).delete(e);return new su(t).toPromise()}var zK=800,HK=3,jK=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return U(this,null,function*(){return this.db?this.db:(this.db=yield sM(),this.db)})}_withRetries(t){return U(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r)}catch(r){if(i++>HK)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return U(this,null,function*(){return gU()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return U(this,null,function*(){this.receiver=NK._getInstance(FK()),this.receiver._subscribe("keyChanged",(t,i)=>U(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(t,i)=>U(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return U(this,null,function*(){var t,i;if(this.activeServiceWorker=yield kK(),!this.activeServiceWorker)return;this.sender=new rM(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return U(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||LK()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return U(this,null,function*(){try{if(!indexedDB)return!1;let t=yield sM();return yield zV(t,E0,"1"),yield HV(t,E0),!0}catch{}return!1})}_withPendingWrite(t){return U(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,i){return U(this,null,function*(){return this._withPendingWrite(()=>U(this,null,function*(){return yield this._withRetries(r=>zV(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)}))})}_get(t){return U(this,null,function*(){let i=yield this._withRetries(r=>BK(r,t));return this.localCache[t]=i,i})}_remove(t){return U(this,null,function*(){return this._withPendingWrite(()=>U(this,null,function*(){return yield this._withRetries(i=>HV(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return U(this,null,function*(){let t=yield this._withRetries(s=>{let o=T0(s,!1).getAll();return new su(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>U(this,null,function*(){return this._poll()}),zK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),vU=jK;var zDe=dU("rcb"),HDe=new ru(3e4,6e4);function GK(n,e){return e?ra(e):(_t(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var _m=class extends v0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qC(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qC(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qC(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function WK(n){return CK(n.auth,new _m(n),n.bypassAuthState)}function $K(n){let{auth:e,user:t}=n;return _t(t,e,"internal-error"),IK(t,new _m(n),n.bypassAuthState)}function qK(n){return U(this,null,function*(){let{auth:e,user:t}=n;return _t(t,e,"internal-error"),TK(t,new _m(n),n.bypassAuthState)})}var oM=class{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>U(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return U(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WK;case"linkViaPopup":case"linkViaRedirect":return qK;case"reauthViaPopup":case"reauthViaRedirect":return $K;default:vc(this.auth,"internal-error")}}resolve(e){bc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var jDe=new ru(2e3,1e4);var XK="pendingRedirect",d0=new Map,aM=class n extends oM{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){return U(this,null,function*(){let e=d0.get(this.auth._key());if(!e){try{let i=(yield YK(this.resolver,this.auth))?yield Ua(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}d0.set(this.auth._key(),e)}return this.bypassAuthState||d0.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return U(this,null,function*(){if(e.type==="signInViaRedirect")return Ua(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ua(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return U(this,null,function*(){})}cleanUp(){}};function YK(n,e){return U(this,null,function*(){let t=JK(e),i=ZK(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r})}function KK(n,e){d0.set(n._key(),e)}function ZK(n){return ra(n._redirectPersistence)}function JK(n){return u0(XK,n.config.apiKey,n.name)}function QK(n,e,t=!1){return U(this,null,function*(){if(is(n.app))return Promise.reject(nu(n));let i=yM(n),r=GK(i,e),o=yield new aM(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield i._persistUserIfCurrent(o.user),yield i._setRedirectUser(null,e)),o})}var eZ=600*1e3,cM=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tZ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!bU(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(iu(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eZ&&this.cachedEventUids.clear(),this.cachedEventUids.has(jV(e))}saveEventToCache(e){this.cachedEventUids.add(jV(e)),this.lastProcessedEventTime=Date.now()}};function jV(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bU({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function tZ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bU(n);default:return!1}}function nZ(t){return U(this,arguments,function*(n,e={}){return ah(n,"GET","/v1/projects",e)})}var iZ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rZ=/^https?/;function sZ(n){return U(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield nZ(n);for(let t of e)try{if(oZ(t))return}catch{}vc(n,"unauthorized-domain")})}function oZ(n){let e=YC(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!rZ.test(t))return!1;if(iZ.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var aZ=new ru(3e4,6e4);function GV(){let n=lo().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function cZ(n){return new Promise((e,t)=>{var i,r,s;function o(){GV(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{GV(),t(iu(n,"network-request-failed"))},timeout:aZ.get()})}if(!((r=(i=lo().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=lo().gapi)===null||s===void 0)&&s.load)o();else{let a=dU("iframefcb");return lo()[a]=()=>{gapi.load?o():t(iu(n,"network-request-failed"))},bK(`${EK()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw h0=null,e})}var h0=null;function lZ(n){return h0=h0||cZ(n),h0}var uZ=new ru(5e3,15e3),dZ="__/auth/iframe",hZ="emulator/auth/iframe",fZ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pZ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mZ(n){let e=n.config;_t(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?hM(e,hZ):`https://${n.config.authDomain}/${dZ}`,i={apiKey:e.apiKey,appName:n.name,v:fc},r=pZ.get(n.config.apiHost);r&&(i.eid=r);let s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${om(i).slice(1)}`}function gZ(n){return U(this,null,function*(){let e=yield lZ(n),t=lo().gapi;return _t(t,n,"internal-error"),e.open({where:document.body,url:mZ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fZ,dontclear:!0},i=>new Promise((r,s)=>U(null,null,function*(){yield i.restyle({setHideOnLeave:!1});let o=iu(n,"network-request-failed"),a=lo().setTimeout(()=>{s(o)},uZ.get());function c(){lo().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})})))})}var _Z={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yZ=500,vZ=600,bZ="_blank",EZ="http://localhost",S0=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function wZ(n,e,t,i=yZ,r=vZ){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",c=Object.assign(Object.assign({},_Z),{width:i.toString(),height:r.toString(),top:s,left:o}),l=Si().toLowerCase();t&&(a=rU(l)?bZ:t),nU(l)&&(e=e||EZ,c.scrollbars="yes");let u=Object.entries(c).reduce((h,[p,g])=>`${h}${p}=${g},`,"");if(mK(l)&&a!=="_self")return xZ(e||"",a),new S0(null);let d=window.open(e||"",a,u);_t(d,n,"popup-blocked");try{d.focus()}catch{}return new S0(d)}function xZ(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var SZ="__/auth/handler",TZ="emulator/auth/handler",IZ=encodeURIComponent("fac");function WV(n,e,t,i,r,s){return U(this,null,function*(){_t(n.config.authDomain,n,"auth-domain-config-required"),_t(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:fc,eventId:r};if(e instanceof b0){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",rV(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[u,d]of Object.entries(s||{}))o[u]=d}if(e instanceof nM){let u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let u of Object.keys(a))a[u]===void 0&&delete a[u];let c=yield n._getAppCheckToken(),l=c?`#${IZ}=${encodeURIComponent(c)}`:"";return`${CZ(n)}?${om(a).slice(1)}${l}`})}function CZ({config:n}){return n.emulator?hM(n,TZ):`https://${n.authDomain}/${SZ}`}var XC="webStorageSupport",lM=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=SM,this._completeRedirectFn=QK,this._overrideRedirectResult=KK}_openPopup(e,t,i,r){return U(this,null,function*(){var s;bc((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield WV(e,t,i,YC(),r);return wZ(e,o,mU())})}_openRedirect(e,t,i,r){return U(this,null,function*(){yield this._originValidation(e);let s=yield WV(e,t,i,YC(),r);return OK(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(bc(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){return U(this,null,function*(){let t=yield gZ(e),i=new cM(e);return t.register("authEvent",r=>(_t(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(XC,{type:XC},r=>{var s;let o=(s=r?.[0])===null||s===void 0?void 0:s[XC];o!==void 0&&t(!!o),vc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sZ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return lU()||iU()||_M()}},EU=lM;var $V="@firebase/auth",qV="1.10.8";var uM=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return U(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function MZ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AZ(n){Ts(new fr("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;_t(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uU(n)},l=new tM(i,r,s,c);return wK(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ts(new fr("auth-internal",e=>{let t=yM(e.getProvider("auth").getImmediate());return(i=>new uM(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),jn($V,qV,MZ(n)),jn($V,qV,"esm2017")}var DZ=300,RZ=xC("authIdTokenMaxAge")||DZ,XV=null,PZ=n=>e=>U(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>RZ)return;let r=t?.token;XV!==r&&(XV=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function TM(n=Ql()){let e=ih(n,"auth");if(e.isInitialized())return e.getImmediate();let t=bM(n,{popupRedirectResolver:EU,persistence:[vU,pU,SM]}),i=xC("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(i,location.origin);if(location.origin===s.origin){let o=PZ(s.toString());xM(t,o,()=>o(t.currentUser)),wM(t,a=>o(a))}}let r=EC("auth");return r&&EM(t,`http://${r}`),t}function NZ(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}vK({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=iu("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",NZ().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AZ("Browser");var wU="auth",ym=class{constructor(e){return e}},vm=class{constructor(){return sh(wU)}};var IM=new Re("angularfire2.auth-instances");function IJ(n,e){let t=lm(wU,n,e);return t&&new ym(t)}function CJ(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new ym(i)}}var MJ={provide:vm,deps:[[new Nr,IM]]},AJ={provide:ym,useFactory:IJ,deps:[[new Nr,IM],na]};function xU(n,...e){return jn("angularfire",pc.full,"auth"),or([AJ,MJ,{provide:IM,useFactory:CJ(n),multi:!0,deps:[Bt,Nn,mc,tu,[new Nr,oh],...e]}])}var SU=pr(TM,!0);var TU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},IU={};var sa,CM;(function(){var n;function e(S,w){function b(){}b.prototype=w.prototype,S.D=w.prototype,S.prototype=new b,S.prototype.constructor=S,S.C=function(E,T,R){for(var A=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)A[ne-2]=arguments[ne];return w.prototype[T].apply(E,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(S,w,b){b||(b=0);var E=Array(16);if(typeof w=="string")for(var T=0;16>T;++T)E[T]=w.charCodeAt(b++)|w.charCodeAt(b++)<<8|w.charCodeAt(b++)<<16|w.charCodeAt(b++)<<24;else for(T=0;16>T;++T)E[T]=w[b++]|w[b++]<<8|w[b++]<<16|w[b++]<<24;w=S.g[0],b=S.g[1],T=S.g[2];var R=S.g[3],A=w+(R^b&(T^R))+E[0]+3614090360&4294967295;w=b+(A<<7&4294967295|A>>>25),A=R+(T^w&(b^T))+E[1]+3905402710&4294967295,R=w+(A<<12&4294967295|A>>>20),A=T+(b^R&(w^b))+E[2]+606105819&4294967295,T=R+(A<<17&4294967295|A>>>15),A=b+(w^T&(R^w))+E[3]+3250441966&4294967295,b=T+(A<<22&4294967295|A>>>10),A=w+(R^b&(T^R))+E[4]+4118548399&4294967295,w=b+(A<<7&4294967295|A>>>25),A=R+(T^w&(b^T))+E[5]+1200080426&4294967295,R=w+(A<<12&4294967295|A>>>20),A=T+(b^R&(w^b))+E[6]+2821735955&4294967295,T=R+(A<<17&4294967295|A>>>15),A=b+(w^T&(R^w))+E[7]+4249261313&4294967295,b=T+(A<<22&4294967295|A>>>10),A=w+(R^b&(T^R))+E[8]+1770035416&4294967295,w=b+(A<<7&4294967295|A>>>25),A=R+(T^w&(b^T))+E[9]+2336552879&4294967295,R=w+(A<<12&4294967295|A>>>20),A=T+(b^R&(w^b))+E[10]+4294925233&4294967295,T=R+(A<<17&4294967295|A>>>15),A=b+(w^T&(R^w))+E[11]+2304563134&4294967295,b=T+(A<<22&4294967295|A>>>10),A=w+(R^b&(T^R))+E[12]+1804603682&4294967295,w=b+(A<<7&4294967295|A>>>25),A=R+(T^w&(b^T))+E[13]+4254626195&4294967295,R=w+(A<<12&4294967295|A>>>20),A=T+(b^R&(w^b))+E[14]+2792965006&4294967295,T=R+(A<<17&4294967295|A>>>15),A=b+(w^T&(R^w))+E[15]+1236535329&4294967295,b=T+(A<<22&4294967295|A>>>10),A=w+(T^R&(b^T))+E[1]+4129170786&4294967295,w=b+(A<<5&4294967295|A>>>27),A=R+(b^T&(w^b))+E[6]+3225465664&4294967295,R=w+(A<<9&4294967295|A>>>23),A=T+(w^b&(R^w))+E[11]+643717713&4294967295,T=R+(A<<14&4294967295|A>>>18),A=b+(R^w&(T^R))+E[0]+3921069994&4294967295,b=T+(A<<20&4294967295|A>>>12),A=w+(T^R&(b^T))+E[5]+3593408605&4294967295,w=b+(A<<5&4294967295|A>>>27),A=R+(b^T&(w^b))+E[10]+38016083&4294967295,R=w+(A<<9&4294967295|A>>>23),A=T+(w^b&(R^w))+E[15]+3634488961&4294967295,T=R+(A<<14&4294967295|A>>>18),A=b+(R^w&(T^R))+E[4]+3889429448&4294967295,b=T+(A<<20&4294967295|A>>>12),A=w+(T^R&(b^T))+E[9]+568446438&4294967295,w=b+(A<<5&4294967295|A>>>27),A=R+(b^T&(w^b))+E[14]+3275163606&4294967295,R=w+(A<<9&4294967295|A>>>23),A=T+(w^b&(R^w))+E[3]+4107603335&4294967295,T=R+(A<<14&4294967295|A>>>18),A=b+(R^w&(T^R))+E[8]+1163531501&4294967295,b=T+(A<<20&4294967295|A>>>12),A=w+(T^R&(b^T))+E[13]+2850285829&4294967295,w=b+(A<<5&4294967295|A>>>27),A=R+(b^T&(w^b))+E[2]+4243563512&4294967295,R=w+(A<<9&4294967295|A>>>23),A=T+(w^b&(R^w))+E[7]+1735328473&4294967295,T=R+(A<<14&4294967295|A>>>18),A=b+(R^w&(T^R))+E[12]+2368359562&4294967295,b=T+(A<<20&4294967295|A>>>12),A=w+(b^T^R)+E[5]+4294588738&4294967295,w=b+(A<<4&4294967295|A>>>28),A=R+(w^b^T)+E[8]+2272392833&4294967295,R=w+(A<<11&4294967295|A>>>21),A=T+(R^w^b)+E[11]+1839030562&4294967295,T=R+(A<<16&4294967295|A>>>16),A=b+(T^R^w)+E[14]+4259657740&4294967295,b=T+(A<<23&4294967295|A>>>9),A=w+(b^T^R)+E[1]+2763975236&4294967295,w=b+(A<<4&4294967295|A>>>28),A=R+(w^b^T)+E[4]+1272893353&4294967295,R=w+(A<<11&4294967295|A>>>21),A=T+(R^w^b)+E[7]+4139469664&4294967295,T=R+(A<<16&4294967295|A>>>16),A=b+(T^R^w)+E[10]+3200236656&4294967295,b=T+(A<<23&4294967295|A>>>9),A=w+(b^T^R)+E[13]+681279174&4294967295,w=b+(A<<4&4294967295|A>>>28),A=R+(w^b^T)+E[0]+3936430074&4294967295,R=w+(A<<11&4294967295|A>>>21),A=T+(R^w^b)+E[3]+3572445317&4294967295,T=R+(A<<16&4294967295|A>>>16),A=b+(T^R^w)+E[6]+76029189&4294967295,b=T+(A<<23&4294967295|A>>>9),A=w+(b^T^R)+E[9]+3654602809&4294967295,w=b+(A<<4&4294967295|A>>>28),A=R+(w^b^T)+E[12]+3873151461&4294967295,R=w+(A<<11&4294967295|A>>>21),A=T+(R^w^b)+E[15]+530742520&4294967295,T=R+(A<<16&4294967295|A>>>16),A=b+(T^R^w)+E[2]+3299628645&4294967295,b=T+(A<<23&4294967295|A>>>9),A=w+(T^(b|~R))+E[0]+4096336452&4294967295,w=b+(A<<6&4294967295|A>>>26),A=R+(b^(w|~T))+E[7]+1126891415&4294967295,R=w+(A<<10&4294967295|A>>>22),A=T+(w^(R|~b))+E[14]+2878612391&4294967295,T=R+(A<<15&4294967295|A>>>17),A=b+(R^(T|~w))+E[5]+4237533241&4294967295,b=T+(A<<21&4294967295|A>>>11),A=w+(T^(b|~R))+E[12]+1700485571&4294967295,w=b+(A<<6&4294967295|A>>>26),A=R+(b^(w|~T))+E[3]+2399980690&4294967295,R=w+(A<<10&4294967295|A>>>22),A=T+(w^(R|~b))+E[10]+4293915773&4294967295,T=R+(A<<15&4294967295|A>>>17),A=b+(R^(T|~w))+E[1]+2240044497&4294967295,b=T+(A<<21&4294967295|A>>>11),A=w+(T^(b|~R))+E[8]+1873313359&4294967295,w=b+(A<<6&4294967295|A>>>26),A=R+(b^(w|~T))+E[15]+4264355552&4294967295,R=w+(A<<10&4294967295|A>>>22),A=T+(w^(R|~b))+E[6]+2734768916&4294967295,T=R+(A<<15&4294967295|A>>>17),A=b+(R^(T|~w))+E[13]+1309151649&4294967295,b=T+(A<<21&4294967295|A>>>11),A=w+(T^(b|~R))+E[4]+4149444226&4294967295,w=b+(A<<6&4294967295|A>>>26),A=R+(b^(w|~T))+E[11]+3174756917&4294967295,R=w+(A<<10&4294967295|A>>>22),A=T+(w^(R|~b))+E[2]+718787259&4294967295,T=R+(A<<15&4294967295|A>>>17),A=b+(R^(T|~w))+E[9]+3951481745&4294967295,S.g[0]=S.g[0]+w&4294967295,S.g[1]=S.g[1]+(T+(A<<21&4294967295|A>>>11))&4294967295,S.g[2]=S.g[2]+T&4294967295,S.g[3]=S.g[3]+R&4294967295}i.prototype.u=function(S,w){w===void 0&&(w=S.length);for(var b=w-this.blockSize,E=this.B,T=this.h,R=0;R<w;){if(T==0)for(;R<=b;)r(this,S,R),R+=this.blockSize;if(typeof S=="string"){for(;R<w;)if(E[T++]=S.charCodeAt(R++),T==this.blockSize){r(this,E),T=0;break}}else for(;R<w;)if(E[T++]=S[R++],T==this.blockSize){r(this,E),T=0;break}}this.h=T,this.o+=w},i.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var w=1;w<S.length-8;++w)S[w]=0;var b=8*this.o;for(w=S.length-8;w<S.length;++w)S[w]=b&255,b/=256;for(this.u(S),S=Array(16),w=b=0;4>w;++w)for(var E=0;32>E;E+=8)S[b++]=this.g[w]>>>E&255;return S};function s(S,w){var b=a;return Object.prototype.hasOwnProperty.call(b,S)?b[S]:b[S]=w(S)}function o(S,w){this.h=w;for(var b=[],E=!0,T=S.length-1;0<=T;T--){var R=S[T]|0;E&&R==w||(b[T]=R,E=!1)}this.g=b}var a={};function c(S){return-128<=S&&128>S?s(S,function(w){return new o([w|0],0>w?-1:0)}):new o([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return d;if(0>S)return m(l(-S));for(var w=[],b=1,E=0;S>=b;E++)w[E]=S/b|0,b*=4294967296;return new o(w,0)}function u(S,w){if(S.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(S.charAt(0)=="-")return m(u(S.substring(1),w));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=l(Math.pow(w,8)),E=d,T=0;T<S.length;T+=8){var R=Math.min(8,S.length-T),A=parseInt(S.substring(T,T+R),w);8>R?(R=l(Math.pow(w,R)),E=E.j(R).add(l(A))):(E=E.j(b),E=E.add(l(A)))}return E}var d=c(0),h=c(1),p=c(16777216);n=o.prototype,n.m=function(){if(y(this))return-m(this).m();for(var S=0,w=1,b=0;b<this.g.length;b++){var E=this.i(b);S+=(0<=E?E:4294967296+E)*w,w*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(g(this))return"0";if(y(this))return"-"+m(this).toString(S);for(var w=l(Math.pow(S,6)),b=this,E="";;){var T=C(b,w).g;b=_(b,T.j(w));var R=((0<b.g.length?b.g[0]:b.h)>>>0).toString(S);if(b=T,g(b))return R+E;for(;6>R.length;)R="0"+R;E=R+E}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function g(S){if(S.h!=0)return!1;for(var w=0;w<S.g.length;w++)if(S.g[w]!=0)return!1;return!0}function y(S){return S.h==-1}n.l=function(S){return S=_(this,S),y(S)?-1:g(S)?0:1};function m(S){for(var w=S.g.length,b=[],E=0;E<w;E++)b[E]=~S.g[E];return new o(b,~S.h).add(h)}n.abs=function(){return y(this)?m(this):this},n.add=function(S){for(var w=Math.max(this.g.length,S.g.length),b=[],E=0,T=0;T<=w;T++){var R=E+(this.i(T)&65535)+(S.i(T)&65535),A=(R>>>16)+(this.i(T)>>>16)+(S.i(T)>>>16);E=A>>>16,R&=65535,A&=65535,b[T]=A<<16|R}return new o(b,b[b.length-1]&-2147483648?-1:0)};function _(S,w){return S.add(m(w))}n.j=function(S){if(g(this)||g(S))return d;if(y(this))return y(S)?m(this).j(m(S)):m(m(this).j(S));if(y(S))return m(this.j(m(S)));if(0>this.l(p)&&0>S.l(p))return l(this.m()*S.m());for(var w=this.g.length+S.g.length,b=[],E=0;E<2*w;E++)b[E]=0;for(E=0;E<this.g.length;E++)for(var T=0;T<S.g.length;T++){var R=this.i(E)>>>16,A=this.i(E)&65535,ne=S.i(T)>>>16,Y=S.i(T)&65535;b[2*E+2*T]+=A*Y,I(b,2*E+2*T),b[2*E+2*T+1]+=R*Y,I(b,2*E+2*T+1),b[2*E+2*T+1]+=A*ne,I(b,2*E+2*T+1),b[2*E+2*T+2]+=R*ne,I(b,2*E+2*T+2)}for(E=0;E<w;E++)b[E]=b[2*E+1]<<16|b[2*E];for(E=w;E<2*w;E++)b[E]=0;return new o(b,0)};function I(S,w){for(;(S[w]&65535)!=S[w];)S[w+1]+=S[w]>>>16,S[w]&=65535,w++}function M(S,w){this.g=S,this.h=w}function C(S,w){if(g(w))throw Error("division by zero");if(g(S))return new M(d,d);if(y(S))return w=C(m(S),w),new M(m(w.g),m(w.h));if(y(w))return w=C(S,m(w)),new M(m(w.g),w.h);if(30<S.g.length){if(y(S)||y(w))throw Error("slowDivide_ only works with positive integers.");for(var b=h,E=w;0>=E.l(S);)b=P(b),E=P(E);var T=N(b,1),R=N(E,1);for(E=N(E,2),b=N(b,2);!g(E);){var A=R.add(E);0>=A.l(S)&&(T=T.add(b),R=A),E=N(E,1),b=N(b,1)}return w=_(S,T.j(w)),new M(T,w)}for(T=d;0<=S.l(w);){for(b=Math.max(1,Math.floor(S.m()/w.m())),E=Math.ceil(Math.log(b)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),R=l(b),A=R.j(w);y(A)||0<A.l(S);)b-=E,R=l(b),A=R.j(w);g(R)&&(R=h),T=T.add(R),S=_(S,A)}return new M(T,S)}n.A=function(S){return C(this,S).h},n.and=function(S){for(var w=Math.max(this.g.length,S.g.length),b=[],E=0;E<w;E++)b[E]=this.i(E)&S.i(E);return new o(b,this.h&S.h)},n.or=function(S){for(var w=Math.max(this.g.length,S.g.length),b=[],E=0;E<w;E++)b[E]=this.i(E)|S.i(E);return new o(b,this.h|S.h)},n.xor=function(S){for(var w=Math.max(this.g.length,S.g.length),b=[],E=0;E<w;E++)b[E]=this.i(E)^S.i(E);return new o(b,this.h^S.h)};function P(S){for(var w=S.g.length+1,b=[],E=0;E<w;E++)b[E]=S.i(E)<<1|S.i(E-1)>>>31;return new o(b,S.h)}function N(S,w){var b=w>>5;w%=32;for(var E=S.g.length-b,T=[],R=0;R<E;R++)T[R]=0<w?S.i(R+b)>>>w|S.i(R+b+1)<<32-w:S.i(R+b);return new o(T,S.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,CM=IU.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,sa=IU.Integer=o}).apply(typeof TU<"u"?TU:typeof self<"u"?self:typeof window<"u"?window:{});var I0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oa={};var MM,DJ,ch,AM,bm,C0,DM,RM,PM;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,x){return f==Array.prototype||f==Object.prototype||(f[v]=x.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof I0=="object"&&I0];for(var v=0;v<f.length;++v){var x=f[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=t(this);function r(f,v){if(v)e:{var x=i;f=f.split(".");for(var k=0;k<f.length-1;k++){var W=f[k];if(!(W in x))break e;x=x[W]}f=f[f.length-1],k=x[f],v=v(k),v!=k&&v!=null&&e(x,f,{configurable:!0,writable:!0,value:v})}}function s(f,v){f instanceof String&&(f+="");var x=0,k=!1,W={next:function(){if(!k&&x<f.length){var te=x++;return{value:v(te,f[te]),done:!1}}return k=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}r("Array.prototype.values",function(f){return f||function(){return s(this,function(v,x){return x})}});var o=o||{},a=this||self;function c(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function l(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function u(f,v,x){return f.call.apply(f.bind,arguments)}function d(f,v,x){if(!f)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,k),f.apply(v,W)}}return function(){return f.apply(v,arguments)}}function h(f,v,x){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,h.apply(null,arguments)}function p(f,v){var x=Array.prototype.slice.call(arguments,1);return function(){var k=x.slice();return k.push.apply(k,arguments),f.apply(this,k)}}function g(f,v){function x(){}x.prototype=v.prototype,f.aa=v.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(k,W,te){for(var Ee=Array(arguments.length-2),gn=2;gn<arguments.length;gn++)Ee[gn-2]=arguments[gn];return v.prototype[W].apply(k,Ee)}}function y(f){let v=f.length;if(0<v){let x=Array(v);for(let k=0;k<v;k++)x[k]=f[k];return x}return[]}function m(f,v){for(let x=1;x<arguments.length;x++){let k=arguments[x];if(c(k)){let W=f.length||0,te=k.length||0;f.length=W+te;for(let Ee=0;Ee<te;Ee++)f[W+Ee]=k[Ee]}else f.push(k)}}class _{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function I(f){return/^[\s\xa0]*$/.test(f)}function M(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function C(f){return C[" "](f),f}C[" "]=function(){};var P=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function N(f,v,x){for(let k in f)v.call(x,f[k],k,f)}function S(f,v){for(let x in f)v.call(void 0,f[x],x,f)}function w(f){let v={};for(let x in f)v[x]=f[x];return v}let b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(f,v){let x,k;for(let W=1;W<arguments.length;W++){k=arguments[W];for(x in k)f[x]=k[x];for(let te=0;te<b.length;te++)x=b[te],Object.prototype.hasOwnProperty.call(k,x)&&(f[x]=k[x])}}function T(f){var v=1;f=f.split(":");let x=[];for(;0<v&&f.length;)x.push(f.shift()),v--;return f.length&&x.push(f.join(":")),x}function R(f){a.setTimeout(()=>{throw f},0)}function A(){var f=fe;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class ne{constructor(){this.h=this.g=null}add(v,x){let k=Y.get();k.set(v,x),this.h?this.h.next=k:this.g=k,this.h=k}}var Y=new _(()=>new J,f=>f.reset());class J{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let re,K=!1,fe=new ne,Se=()=>{let f=a.Promise.resolve(void 0);re=()=>{f.then(Ge)}};var Ge=()=>{for(var f;f=A();){try{f.h.call(f.g)}catch(x){R(x)}var v=Y;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}K=!1};function nt(){this.s=this.s,this.C=this.C}nt.prototype.s=!1,nt.prototype.ma=function(){this.s||(this.s=!0,this.N())},nt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ct(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}ct.prototype.h=function(){this.defaultPrevented=!0};var jt=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{let x=()=>{};a.addEventListener("test",x,v),a.removeEventListener("test",x,v)}catch{}return f})();function Ct(f,v){if(ct.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,k=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(P){e:{try{C(v.nodeName);var W=!0;break e}catch{}W=!1}W||(v=null)}}else x=="mouseover"?v=f.fromElement:x=="mouseout"&&(v=f.toElement);this.relatedTarget=v,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:oe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Ct.aa.h.call(this)}}g(Ct,ct);var oe={2:"touch",3:"pen",4:"mouse"};Ct.prototype.h=function(){Ct.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Be=0;function dt(f,v,x,k,W){this.listener=f,this.proxy=null,this.src=v,this.type=x,this.capture=!!k,this.ha=W,this.key=++Be,this.da=this.fa=!1}function Xe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Pt(f){this.src=f,this.g={},this.h=0}Pt.prototype.add=function(f,v,x,k,W){var te=f.toString();f=this.g[te],f||(f=this.g[te]=[],this.h++);var Ee=V(f,v,k,W);return-1<Ee?(v=f[Ee],x||(v.fa=!1)):(v=new dt(v,this.src,te,!!k,W),v.fa=x,f.push(v)),v};function Qn(f,v){var x=v.type;if(x in f.g){var k=f.g[x],W=Array.prototype.indexOf.call(k,v,void 0),te;(te=0<=W)&&Array.prototype.splice.call(k,W,1),te&&(Xe(v),f.g[x].length==0&&(delete f.g[x],f.h--))}}function V(f,v,x,k){for(var W=0;W<f.length;++W){var te=f[W];if(!te.da&&te.listener==v&&te.capture==!!x&&te.ha==k)return W}return-1}var pn="closure_lm_"+(1e6*Math.random()|0),pt={};function ot(f,v,x,k,W){if(k&&k.once)return He(f,v,x,k,W);if(Array.isArray(v)){for(var te=0;te<v.length;te++)ot(f,v[te],x,k,W);return null}return x=se(x),f&&f[de]?f.K(v,x,l(k)?!!k.capture:!!k,W):ze(f,v,x,!1,k,W)}function ze(f,v,x,k,W,te){if(!v)throw Error("Invalid event type");var Ee=l(W)?!!W.capture:!!W,gn=D(f);if(gn||(f[pn]=gn=new Pt(f)),x=gn.add(v,x,k,Ee,te),x.proxy)return x;if(k=En(),x.proxy=k,k.src=f,k.listener=x,f.addEventListener)jt||(W=Ee),W===void 0&&(W=!1),f.addEventListener(v.toString(),k,W);else if(f.attachEvent)f.attachEvent(Mn(v.toString()),k);else if(f.addListener&&f.removeListener)f.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return x}function En(){function f(x){return v.call(f.src,f.listener,x)}let v=L;return f}function He(f,v,x,k,W){if(Array.isArray(v)){for(var te=0;te<v.length;te++)He(f,v[te],x,k,W);return null}return x=se(x),f&&f[de]?f.L(v,x,l(k)?!!k.capture:!!k,W):ze(f,v,x,!0,k,W)}function xt(f,v,x,k,W){if(Array.isArray(v))for(var te=0;te<v.length;te++)xt(f,v[te],x,k,W);else k=l(k)?!!k.capture:!!k,x=se(x),f&&f[de]?(f=f.i,v=String(v).toString(),v in f.g&&(te=f.g[v],x=V(te,x,k,W),-1<x&&(Xe(te[x]),Array.prototype.splice.call(te,x,1),te.length==0&&(delete f.g[v],f.h--)))):f&&(f=D(f))&&(v=f.g[v.toString()],f=-1,v&&(f=V(v,x,k,W)),(x=-1<f?v[f]:null)&&Un(x))}function Un(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[de])Qn(v.i,f);else{var x=f.type,k=f.proxy;v.removeEventListener?v.removeEventListener(x,k,f.capture):v.detachEvent?v.detachEvent(Mn(x),k):v.addListener&&v.removeListener&&v.removeListener(k),(x=D(v))?(Qn(x,f),x.h==0&&(x.src=null,v[pn]=null)):Xe(f)}}}function Mn(f){return f in pt?pt[f]:pt[f]="on"+f}function L(f,v){if(f.da)f=!0;else{v=new Ct(v,this);var x=f.listener,k=f.ha||f.src;f.fa&&Un(f),f=x.call(k,v)}return f}function D(f){return f=f[pn],f instanceof Pt?f:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function se(f){return typeof f=="function"?f:(f[X]||(f[X]=function(v){return f.handleEvent(v)}),f[X])}function ce(){nt.call(this),this.i=new Pt(this),this.M=this,this.F=null}g(ce,nt),ce.prototype[de]=!0,ce.prototype.removeEventListener=function(f,v,x,k){xt(this,f,v,x,k)};function ee(f,v){var x,k=f.F;if(k)for(x=[];k;k=k.F)x.push(k);if(f=f.M,k=v.type||v,typeof v=="string")v=new ct(v,f);else if(v instanceof ct)v.target=v.target||f;else{var W=v;v=new ct(k,f),E(v,W)}if(W=!0,x)for(var te=x.length-1;0<=te;te--){var Ee=v.g=x[te];W=We(Ee,k,!0,v)&&W}if(Ee=v.g=f,W=We(Ee,k,!0,v)&&W,W=We(Ee,k,!1,v)&&W,x)for(te=0;te<x.length;te++)Ee=v.g=x[te],W=We(Ee,k,!1,v)&&W}ce.prototype.N=function(){if(ce.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var x=f.g[v],k=0;k<x.length;k++)Xe(x[k]);delete f.g[v],f.h--}}this.F=null},ce.prototype.K=function(f,v,x,k){return this.i.add(String(f),v,!1,x,k)},ce.prototype.L=function(f,v,x,k){return this.i.add(String(f),v,!0,x,k)};function We(f,v,x,k){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var W=!0,te=0;te<v.length;++te){var Ee=v[te];if(Ee&&!Ee.da&&Ee.capture==x){var gn=Ee.listener,Di=Ee.ha||Ee.src;Ee.fa&&Qn(f.i,Ee),W=gn.call(Di,k)!==!1&&W}}return W&&!k.defaultPrevented}function ve(f,v,x){if(typeof f=="function")x&&(f=h(f,x));else if(f&&typeof f.handleEvent=="function")f=h(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:a.setTimeout(f,v||0)}function $e(f){f.g=ve(()=>{f.g=null,f.i&&(f.i=!1,$e(f))},f.l);let v=f.h;f.h=null,f.m.apply(null,v)}class Ye extends nt{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:$e(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ge(f){nt.call(this),this.h=f,this.g={}}g(ge,nt);var Ae=[];function rt(f){N(f.g,function(v,x){this.g.hasOwnProperty(x)&&Un(v)},f),f.g={}}ge.prototype.N=function(){ge.aa.N.call(this),rt(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qe=a.JSON.stringify,Te=a.JSON.parse,St=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function z(){}z.prototype.h=null;function _e(f){return f.h||(f.h=f.i())}function be(){}var Oe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pe(){ct.call(this,"d")}g(pe,ct);function le(){ct.call(this,"c")}g(le,ct);var Fe={},mt=null;function Qt(){return mt=mt||new ce}Fe.La="serverreachability";function Xt(f){ct.call(this,Fe.La,f)}g(Xt,ct);function nr(f){let v=Qt();ee(v,new Xt(v))}Fe.STAT_EVENT="statevent";function Cr(f,v){ct.call(this,Fe.STAT_EVENT,f),this.stat=v}g(Cr,ct);function yi(f){let v=Qt();ee(v,new Cr(v,f))}Fe.Ma="timingevent";function Vs(f,v){ct.call(this,Fe.Ma,f),this.size=v}g(Vs,ct);function Do(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},v)}function La(){this.g=!0}La.prototype.xa=function(){this.g=!1};function Jg(f,v,x,k,W,te){f.info(function(){if(f.g)if(te)for(var Ee="",gn=te.split("&"),Di=0;Di<gn.length;Di++){var Jt=gn[Di].split("=");if(1<Jt.length){var zi=Jt[0];Jt=Jt[1];var Hi=zi.split("_");Ee=2<=Hi.length&&Hi[1]=="type"?Ee+(zi+"="+Jt+"&"):Ee+(zi+"=redacted&")}}else Ee=null;else Ee=te;return"XMLHTTP REQ ("+k+") [attempt "+W+"]: "+v+`
`+x+`
`+Ee})}function Xu(f,v,x,k,W,te,Ee){f.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+W+"]: "+v+`
`+x+`
`+te+" "+Ee})}function Ro(f,v,x,k){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+Qg(f,x)+(k?" "+k:"")})}function Yu(f,v){f.info(function(){return"TIMEOUT: "+v})}La.prototype.info=function(){};function Qg(f,v){if(!f.g)return v;if(!v)return null;try{var x=JSON.parse(v);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var k=x[f];if(!(2>k.length)){var W=k[1];if(Array.isArray(W)&&!(1>W.length)){var te=W[0];if(te!="noop"&&te!="stop"&&te!="close")for(var Ee=1;Ee<W.length;Ee++)W[Ee]=""}}}}return qe(x)}catch{return v}}var dl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},e_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Df;function Ku(){}g(Ku,z),Ku.prototype.g=function(){return new XMLHttpRequest},Ku.prototype.i=function(){return{}},Df=new Ku;function Us(f,v,x,k){this.j=f,this.i=v,this.l=x,this.R=k||1,this.U=new ge(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new t_}function t_(){this.i=null,this.g="",this.h=!1}var n_={},O={};function H(f,v,x){f.L=1,f.v=Wr(Bn(v)),f.m=x,f.P=!0,Z(f,null)}function Z(f,v){f.F=Date.now(),me(f),f.A=Bn(f.v);var x=f.A,k=f.R;Array.isArray(k)||(k=[String(k)]),WP(x.i,"t",k),f.C=0,x=f.j.J,f.h=new t_,f.g=lN(f.j,x?v:null,!f.m),0<f.O&&(f.M=new Ye(h(f.Y,f,f.g),f.O)),v=f.U,x=f.g,k=f.ca;var W="readystatechange";Array.isArray(W)||(W&&(Ae[0]=W.toString()),W=Ae);for(var te=0;te<W.length;te++){var Ee=ot(x,W[te],k||v.handleEvent,!1,v.h||v);if(!Ee)break;v.g[Ee.key]=Ee}v=f.H?w(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),nr(),Jg(f.i,f.u,f.A,f.l,f.R,f.m)}Us.prototype.ca=function(f){f=f.target;let v=this.M;v&&No(f)==3?v.j():this.Y(f)},Us.prototype.Y=function(f){try{if(f==this.g)e:{let Hi=No(this.g);var v=this.g.Ba();let Qu=this.g.Z();if(!(3>Hi)&&(Hi!=3||this.g&&(this.h.h||this.g.oa()||JP(this.g)))){this.J||Hi!=4||v==7||(v==8||0>=Qu?nr(3):nr(2)),Ve(this);var x=this.g.Z();this.X=x;t:if(Q(this)){var k=JP(this.g);f="";var W=k.length,te=No(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ke(this),De(this);var Ee="";break t}this.h.i=new a.TextDecoder}for(v=0;v<W;v++)this.h.h=!0,f+=this.h.i.decode(k[v],{stream:!(te&&v==W-1)});k.length=0,this.h.g+=f,this.C=0,Ee=this.h.g}else Ee=this.g.oa();if(this.o=x==200,Xu(this.i,this.u,this.A,this.l,this.R,Hi,x),this.o){if(this.T&&!this.K){t:{if(this.g){var gn,Di=this.g;if((gn=Di.g?Di.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(gn)){var Jt=gn;break t}}Jt=null}if(x=Jt)Ro(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,st(this,x);else{this.o=!1,this.s=3,yi(12),Ke(this),De(this);break e}}if(this.P){x=!0;let hs;for(;!this.J&&this.C<Ee.length;)if(hs=G(this,Ee),hs==O){Hi==4&&(this.s=4,yi(14),x=!1),Ro(this.i,this.l,null,"[Incomplete Response]");break}else if(hs==n_){this.s=4,yi(15),Ro(this.i,this.l,Ee,"[Invalid Chunk]"),x=!1;break}else Ro(this.i,this.l,hs,null),st(this,hs);if(Q(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Hi!=4||Ee.length!=0||this.h.h||(this.s=1,yi(16),x=!1),this.o=this.o&&x,!x)Ro(this.i,this.l,Ee,"[Invalid Chunked Response]"),Ke(this),De(this);else if(0<Ee.length&&!this.W){this.W=!0;var zi=this.j;zi.g==this&&zi.ba&&!zi.M&&(zi.j.info("Great, no buffering proxy detected. Bytes received: "+Ee.length),Sx(zi),zi.M=!0,yi(11))}}else Ro(this.i,this.l,Ee,null),st(this,Ee);Hi==4&&Ke(this),this.o&&!this.J&&(Hi==4?sN(this.j,this):(this.o=!1,me(this)))}else Kj(this.g),x==400&&0<Ee.indexOf("Unknown SID")?(this.s=3,yi(12)):(this.s=0,yi(13)),Ke(this),De(this)}}}catch{}finally{}};function Q(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function G(f,v){var x=f.C,k=v.indexOf(`
`,x);return k==-1?O:(x=Number(v.substring(x,k)),isNaN(x)?n_:(k+=1,k+x>v.length?O:(v=v.slice(k,k+x),f.C=k+x,v)))}Us.prototype.cancel=function(){this.J=!0,Ke(this)};function me(f){f.S=Date.now()+f.I,Ie(f,f.I)}function Ie(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Do(h(f.ba,f),v)}function Ve(f){f.B&&(a.clearTimeout(f.B),f.B=null)}Us.prototype.ba=function(){this.B=null;let f=Date.now();0<=f-this.S?(Yu(this.i,this.A),this.L!=2&&(nr(),yi(17)),Ke(this),this.s=2,De(this)):Ie(this,this.S-f)};function De(f){f.j.G==0||f.J||sN(f.j,f)}function Ke(f){Ve(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,rt(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function st(f,v){try{var x=f.j;if(x.G!=0&&(x.g==f||ln(x.h,f))){if(!f.K&&ln(x.h,f)&&x.G==3){try{var k=x.Da.g.parse(v)}catch{k=null}if(Array.isArray(k)&&k.length==3){var W=k;if(W[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)a_(x),s_(x);else break e;xx(x),yi(18)}}else x.za=W[1],0<x.za-x.T&&37500>W[2]&&x.F&&x.v==0&&!x.C&&(x.C=Do(h(x.Za,x),6e3));if(1>=In(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else fl(x,11)}else if((f.K||x.g==f)&&a_(x),!I(v))for(W=x.Da.g.parse(v),v=0;v<W.length;v++){let Jt=W[v];if(x.T=Jt[0],Jt=Jt[1],x.G==2)if(Jt[0]=="c"){x.K=Jt[1],x.ia=Jt[2];let zi=Jt[3];zi!=null&&(x.la=zi,x.j.info("VER="+x.la));let Hi=Jt[4];Hi!=null&&(x.Aa=Hi,x.j.info("SVER="+x.Aa));let Qu=Jt[5];Qu!=null&&typeof Qu=="number"&&0<Qu&&(k=1.5*Qu,x.L=k,x.j.info("backChannelRequestTimeoutMs_="+k)),k=x;let hs=f.g;if(hs){let l_=hs.g?hs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l_){var te=k.h;te.g||l_.indexOf("spdy")==-1&&l_.indexOf("quic")==-1&&l_.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(tn(te,te.h),te.h=null))}if(k.D){let Tx=hs.g?hs.g.getResponseHeader("X-HTTP-Session-Id"):null;Tx&&(k.ya=Tx,un(k.I,k.D,Tx))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),k=x;var Ee=f;if(k.qa=cN(k,k.J?k.ia:null,k.W),Ee.K){tt(k.h,Ee);var gn=Ee,Di=k.L;Di&&(gn.I=Di),gn.B&&(Ve(gn),me(gn)),k.g=Ee}else iN(k);0<x.i.length&&o_(x)}else Jt[0]!="stop"&&Jt[0]!="close"||fl(x,7);else x.G==3&&(Jt[0]=="stop"||Jt[0]=="close"?Jt[0]=="stop"?fl(x,7):wx(x):Jt[0]!="noop"&&x.l&&x.l.ta(Jt),x.v=0)}}nr(4)}catch{}}var et=class{constructor(f,v){this.g=f,this.map=v}};function Nt(f){this.l=f||10,a.PerformanceNavigationTiming?(f=a.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function en(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function In(f){return f.h?1:f.g?f.g.size:0}function ln(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function tn(f,v){f.g?f.g.add(v):f.h=v}function tt(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Nt.prototype.cancel=function(){if(this.i=wn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let f of this.g.values())f.cancel();this.g.clear()}};function wn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(let x of f.g.values())v=v.concat(x.D);return v}return y(f.i)}function Gt(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var v=[],x=f.length,k=0;k<x;k++)v.push(f[k]);return v}v=[],x=0;for(k in f)v[x++]=f[k];return v}function ir(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var v=[];f=f.length;for(var x=0;x<f;x++)v.push(x);return v}v=[],x=0;for(let k in f)v[x++]=k;return v}}}function Po(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var x=ir(f),k=Gt(f),W=k.length,te=0;te<W;te++)v.call(void 0,k[te],x&&x[te],f)}var Bi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hl(f,v){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var k=f[x].indexOf("="),W=null;if(0<=k){var te=f[x].substring(0,k);W=f[x].substring(k+1)}else te=f[x];v(te,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function nn(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof nn){this.h=f.h,Mi(this,f.j),this.o=f.o,this.g=f.g,ei(this,f.s),this.l=f.l;var v=f.i,x=new Nf;x.i=v.i,v.g&&(x.g=new Map(v.g),x.h=v.h),Ai(this,x),this.m=f.m}else f&&(v=String(f).match(Bi))?(this.h=!1,Mi(this,v[1]||"",!0),this.o=Rf(v[2]||""),this.g=Rf(v[3]||"",!0),ei(this,v[4]),this.l=Rf(v[5]||"",!0),Ai(this,v[6]||"",!0),this.m=Rf(v[7]||"")):(this.h=!1,this.i=new Nf(null,this.h))}nn.prototype.toString=function(){var f=[],v=this.j;v&&f.push(Pf(v,HP,!0),":");var x=this.g;return(x||v=="file")&&(f.push("//"),(v=this.o)&&f.push(Pf(v,HP,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(Pf(x,x.charAt(0)=="/"?Bj:Uj,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",Pf(x,Hj)),f.join("")};function Bn(f){return new nn(f)}function Mi(f,v,x){f.j=x?Rf(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function ei(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function Ai(f,v,x){v instanceof Nf?(f.i=v,jj(f.i,f.h)):(x||(v=Pf(v,zj)),f.i=new Nf(v,f.h))}function un(f,v,x){f.i.set(v,x)}function Wr(f){return un(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Rf(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Pf(f,v,x){return typeof f=="string"?(f=encodeURI(f).replace(v,Vj),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Vj(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var HP=/[#\/\?@]/g,Uj=/[#\?:]/g,Bj=/[#\?]/g,zj=/[#\?@]/g,Hj=/#/g;function Nf(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Fa(f){f.g||(f.g=new Map,f.h=0,f.i&&hl(f.i,function(v,x){f.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}n=Nf.prototype,n.add=function(f,v){Fa(this),this.i=null,f=Zu(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(v),this.h+=1,this};function jP(f,v){Fa(f),v=Zu(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function GP(f,v){return Fa(f),v=Zu(f,v),f.g.has(v)}n.forEach=function(f,v){Fa(this),this.g.forEach(function(x,k){x.forEach(function(W){f.call(v,W,k,this)},this)},this)},n.na=function(){Fa(this);let f=Array.from(this.g.values()),v=Array.from(this.g.keys()),x=[];for(let k=0;k<v.length;k++){let W=f[k];for(let te=0;te<W.length;te++)x.push(v[k])}return x},n.V=function(f){Fa(this);let v=[];if(typeof f=="string")GP(this,f)&&(v=v.concat(this.g.get(Zu(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)v=v.concat(f[x])}return v},n.set=function(f,v){return Fa(this),this.i=null,f=Zu(this,f),GP(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},n.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function WP(f,v,x){jP(f,v),0<x.length&&(f.i=null,f.g.set(Zu(f,v),y(x)),f.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let f=[],v=Array.from(this.g.keys());for(var x=0;x<v.length;x++){var k=v[x];let te=encodeURIComponent(String(k)),Ee=this.V(k);for(k=0;k<Ee.length;k++){var W=te;Ee[k]!==""&&(W+="="+encodeURIComponent(String(Ee[k]))),f.push(W)}}return this.i=f.join("&")};function Zu(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function jj(f,v){v&&!f.j&&(Fa(f),f.i=null,f.g.forEach(function(x,k){var W=k.toLowerCase();k!=W&&(jP(this,k),WP(this,W,x))},f)),f.j=v}function Gj(f,v){let x=new La;if(a.Image){let k=new Image;k.onload=p(Va,x,"TestLoadImage: loaded",!0,v,k),k.onerror=p(Va,x,"TestLoadImage: error",!1,v,k),k.onabort=p(Va,x,"TestLoadImage: abort",!1,v,k),k.ontimeout=p(Va,x,"TestLoadImage: timeout",!1,v,k),a.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=f}else v(!1)}function Wj(f,v){let x=new La,k=new AbortController,W=setTimeout(()=>{k.abort(),Va(x,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:k.signal}).then(te=>{clearTimeout(W),te.ok?Va(x,"TestPingServer: ok",!0,v):Va(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(W),Va(x,"TestPingServer: error",!1,v)})}function Va(f,v,x,k,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),k(x)}catch{}}function $j(){this.g=new St}function qj(f,v,x){let k=x||"";try{Po(f,function(W,te){let Ee=W;l(W)&&(Ee=qe(W)),v.push(k+te+"="+encodeURIComponent(Ee))})}catch(W){throw v.push(k+"type="+encodeURIComponent("_badmap")),W}}function Of(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Of,z),Of.prototype.g=function(){return new i_(this.l,this.j)},Of.prototype.i=(function(f){return function(){return f}})({});function i_(f,v){ce.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(i_,ce),n=i_.prototype,n.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,Lf(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||a).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kf(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Lf(this)),this.g&&(this.readyState=3,Lf(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$P(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function $P(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?kf(this):Lf(this),this.readyState==3&&$P(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,kf(this))},n.Qa=function(f){this.g&&(this.response=f,kf(this))},n.ga=function(){this.g&&kf(this)};function kf(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Lf(f)}n.setRequestHeader=function(f,v){this.u.append(f,v)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let f=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=v.next();return f.join(`\r
`)};function Lf(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(i_.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function qP(f){let v="";return N(f,function(x,k){v+=k,v+=":",v+=x,v+=`\r
`}),v}function Ex(f,v,x){e:{for(k in x){var k=!1;break e}k=!0}k||(x=qP(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):un(f,v,x))}function zn(f){ce.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(zn,ce);var Xj=/^https?$/i,Yj=["POST","PUT"];n=zn.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,v,x,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Df.g(),this.v=this.o?_e(this.o):_e(Df),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(te){XP(this,te);return}if(f=x||"",x=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var W in k)x.set(W,k[W]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(let te of k.keys())x.set(te,k.get(te));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(x.keys()).find(te=>te.toLowerCase()=="content-type"),W=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Yj,v,void 0))||k||W||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[te,Ee]of x)this.g.setRequestHeader(te,Ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ZP(this),this.u=!0,this.g.send(f),this.u=!1}catch(te){XP(this,te)}};function XP(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,YP(f),r_(f)}function YP(f){f.A||(f.A=!0,ee(f,"complete"),ee(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,ee(this,"complete"),ee(this,"abort"),r_(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),r_(this,!0)),zn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?KP(this):this.bb())},n.bb=function(){KP(this)};function KP(f){if(f.h&&typeof o<"u"&&(!f.v[1]||No(f)!=4||f.Z()!=2)){if(f.u&&No(f)==4)ve(f.Ea,0,f);else if(ee(f,"readystatechange"),No(f)==4){f.h=!1;try{let Ee=f.Z();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var k;if(k=Ee===0){var W=String(f.D).match(Bi)[1]||null;!W&&a.self&&a.self.location&&(W=a.self.location.protocol.slice(0,-1)),k=!Xj.test(W?W.toLowerCase():"")}x=k}if(x)ee(f,"complete"),ee(f,"success");else{f.m=6;try{var te=2<No(f)?f.g.statusText:""}catch{te=""}f.l=te+" ["+f.Z()+"]",YP(f)}}finally{r_(f)}}}}function r_(f,v){if(f.g){ZP(f);let x=f.g,k=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||ee(f,"ready");try{x.onreadystatechange=k}catch{}}}function ZP(f){f.I&&(a.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function No(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<No(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Te(v)}};function JP(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Kj(f){let v={};f=(f.g&&2<=No(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<f.length;k++){if(I(f[k]))continue;var x=T(f[k]);let W=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();let te=v[W]||[];v[W]=te,te.push(x)}S(v,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ff(f,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||v}function QP(f){this.Aa=0,this.i=[],this.j=new La,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ff("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ff("baseRetryDelayMs",5e3,f),this.cb=Ff("retryDelaySeedMs",1e4,f),this.Wa=Ff("forwardChannelMaxRetries",2,f),this.wa=Ff("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Nt(f&&f.concurrentRequestLimit),this.Da=new $j,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=QP.prototype,n.la=8,n.G=1,n.connect=function(f,v,x,k){yi(0),this.W=f,this.H=v||{},x&&k!==void 0&&(this.H.OSID=x,this.H.OAID=k),this.F=this.X,this.I=cN(this,null,this.W),o_(this)};function wx(f){if(eN(f),f.G==3){var v=f.U++,x=Bn(f.I);if(un(x,"SID",f.K),un(x,"RID",v),un(x,"TYPE","terminate"),Vf(f,x),v=new Us(f,f.j,v),v.L=2,v.v=Wr(Bn(x)),x=!1,a.navigator&&a.navigator.sendBeacon)try{x=a.navigator.sendBeacon(v.v.toString(),"")}catch{}!x&&a.Image&&(new Image().src=v.v,x=!0),x||(v.g=lN(v.j,null),v.g.ea(v.v)),v.F=Date.now(),me(v)}aN(f)}function s_(f){f.g&&(Sx(f),f.g.cancel(),f.g=null)}function eN(f){s_(f),f.u&&(a.clearTimeout(f.u),f.u=null),a_(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&a.clearTimeout(f.s),f.s=null)}function o_(f){if(!en(f.h)&&!f.s){f.s=!0;var v=f.Ga;re||Se(),K||(re(),K=!0),fe.add(v,f),f.B=0}}function Zj(f,v){return In(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Do(h(f.Ga,f,v),oN(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;let W=new Us(this,this.j,f),te=this.o;if(this.S&&(te?(te=w(te),E(te,this.S)):te=this.S),this.m!==null||this.O||(W.H=te,te=null),this.P)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var k=this.i[x];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(v+=k,4096<v){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=nN(this,W,v),x=Bn(this.I),un(x,"RID",f),un(x,"CVER",22),this.D&&un(x,"X-HTTP-Session-Id",this.D),Vf(this,x),te&&(this.O?v="headers="+encodeURIComponent(String(qP(te)))+"&"+v:this.m&&Ex(x,this.m,te)),tn(this.h,W),this.Ua&&un(x,"TYPE","init"),this.P?(un(x,"$req",v),un(x,"SID","null"),W.T=!0,H(W,x,null)):H(W,x,v),this.G=2}}else this.G==3&&(f?tN(this,f):this.i.length==0||en(this.h)||tN(this))};function tN(f,v){var x;v?x=v.l:x=f.U++;let k=Bn(f.I);un(k,"SID",f.K),un(k,"RID",x),un(k,"AID",f.T),Vf(f,k),f.m&&f.o&&Ex(k,f.m,f.o),x=new Us(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),v&&(f.i=v.D.concat(f.i)),v=nN(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),tn(f.h,x),H(x,k,v)}function Vf(f,v){f.H&&N(f.H,function(x,k){un(v,k,x)}),f.l&&Po({},function(x,k){un(v,k,x)})}function nN(f,v,x){x=Math.min(f.i.length,x);var k=f.l?h(f.l.Na,f.l,f):null;e:{var W=f.i;let te=-1;for(;;){let Ee=["count="+x];te==-1?0<x?(te=W[0].g,Ee.push("ofs="+te)):te=0:Ee.push("ofs="+te);let gn=!0;for(let Di=0;Di<x;Di++){let Jt=W[Di].g,zi=W[Di].map;if(Jt-=te,0>Jt)te=Math.max(0,W[Di].g-100),gn=!1;else try{qj(zi,Ee,"req"+Jt+"_")}catch{k&&k(zi)}}if(gn){k=Ee.join("&");break e}}}return f=f.i.splice(0,x),v.D=f,k}function iN(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;re||Se(),K||(re(),K=!0),fe.add(v,f),f.v=0}}function xx(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Do(h(f.Fa,f),oN(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,rN(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Do(h(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yi(10),s_(this),rN(this))};function Sx(f){f.A!=null&&(a.clearTimeout(f.A),f.A=null)}function rN(f){f.g=new Us(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=Bn(f.qa);un(v,"RID","rpc"),un(v,"SID",f.K),un(v,"AID",f.T),un(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&un(v,"TO",f.ja),un(v,"TYPE","xmlhttp"),Vf(f,v),f.m&&f.o&&Ex(v,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=Wr(Bn(v)),x.m=null,x.P=!0,Z(x,f)}n.Za=function(){this.C!=null&&(this.C=null,s_(this),xx(this),yi(19))};function a_(f){f.C!=null&&(a.clearTimeout(f.C),f.C=null)}function sN(f,v){var x=null;if(f.g==v){a_(f),Sx(f),f.g=null;var k=2}else if(ln(f.h,v))x=v.D,tt(f.h,v),k=1;else return;if(f.G!=0){if(v.o)if(k==1){x=v.m?v.m.length:0,v=Date.now()-v.F;var W=f.B;k=Qt(),ee(k,new Vs(k,x)),o_(f)}else iN(f);else if(W=v.s,W==3||W==0&&0<v.X||!(k==1&&Zj(f,v)||k==2&&xx(f)))switch(x&&0<x.length&&(v=f.h,v.i=v.i.concat(x)),W){case 1:fl(f,5);break;case 4:fl(f,10);break;case 3:fl(f,6);break;default:fl(f,2)}}}function oN(f,v){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*v}function fl(f,v){if(f.j.info("Error code "+v),v==2){var x=h(f.fb,f),k=f.Xa;let W=!k;k=new nn(k||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Mi(k,"https"),Wr(k),W?Gj(k.toString(),x):Wj(k.toString(),x)}else yi(2);f.G=0,f.l&&f.l.sa(v),aN(f),eN(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),yi(2)):(this.j.info("Failed to ping google.com"),yi(1))};function aN(f){if(f.G=0,f.ka=[],f.l){let v=wn(f.h);(v.length!=0||f.i.length!=0)&&(m(f.ka,v),m(f.ka,f.i),f.h.i.length=0,y(f.i),f.i.length=0),f.l.ra()}}function cN(f,v,x){var k=x instanceof nn?Bn(x):new nn(x);if(k.g!="")v&&(k.g=v+"."+k.g),ei(k,k.s);else{var W=a.location;k=W.protocol,v=v?v+"."+W.hostname:W.hostname,W=+W.port;var te=new nn(null);k&&Mi(te,k),v&&(te.g=v),W&&ei(te,W),x&&(te.l=x),k=te}return x=f.D,v=f.ya,x&&v&&un(k,x,v),un(k,"VER",f.la),Vf(f,k),k}function lN(f,v,x){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new zn(new Of({eb:x})):new zn(f.pa),v.Ha(f.J),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function uN(){}n=uN.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function c_(){}c_.prototype.g=function(f,v){return new Mr(f,v)};function Mr(f,v){ce.call(this),this.g=new QP(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!I(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!I(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Ju(this)}g(Mr,ce),Mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mr.prototype.close=function(){wx(this.g)},Mr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=qe(f),f=x);v.i.push(new et(v.Ya++,f)),v.G==3&&o_(v)},Mr.prototype.N=function(){this.g.l=null,delete this.j,wx(this.g),delete this.g,Mr.aa.N.call(this)};function dN(f){pe.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(let x in v){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}g(dN,pe);function hN(){le.call(this),this.status=1}g(hN,le);function Ju(f){this.g=f}g(Ju,uN),Ju.prototype.ua=function(){ee(this.g,"a")},Ju.prototype.ta=function(f){ee(this.g,new dN(f))},Ju.prototype.sa=function(f){ee(this.g,new hN)},Ju.prototype.ra=function(){ee(this.g,"b")},c_.prototype.createWebChannel=c_.prototype.g,Mr.prototype.send=Mr.prototype.o,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,PM=oa.createWebChannelTransport=function(){return new c_},RM=oa.getStatEventTarget=function(){return Qt()},DM=oa.Event=Fe,C0=oa.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},dl.NO_ERROR=0,dl.TIMEOUT=8,dl.HTTP_ERROR=6,bm=oa.ErrorCode=dl,e_.COMPLETE="complete",AM=oa.EventType=e_,be.EventType=Oe,Oe.OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",ce.prototype.listen=ce.prototype.K,ch=oa.WebChannel=be,DJ=oa.FetchXmlHttpFactory=Of,zn.prototype.listenOnce=zn.prototype.L,zn.prototype.getLastError=zn.prototype.Ka,zn.prototype.getLastErrorCode=zn.prototype.Ba,zn.prototype.getStatus=zn.prototype.Z,zn.prototype.getResponseJson=zn.prototype.Oa,zn.prototype.getResponseText=zn.prototype.oa,zn.prototype.send=zn.prototype.ea,zn.prototype.setWithCredentials=zn.prototype.Ha,MM=oa.XhrIo=zn}).apply(typeof I0<"u"?I0:typeof self<"u"?self:typeof window<"u"?window:{});var CU="@firebase/firestore",MU="4.8.0";var Ti=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ti.UNAUTHENTICATED=new Ti(null),Ti.GOOGLE_CREDENTIALS=new Ti("google-credentials-uid"),Ti.FIRST_PARTY=new Ti("first-party-uid"),Ti.MOCK_USER=new Ti("mock-user");var Rh="11.10.0";var uu=new ao("@firebase/firestore");function lh(){return uu.logLevel}function Le(n,...e){if(uu.logLevel<=Lt.DEBUG){let t=e.map(SD);uu.debug(`Firestore (${Rh}): ${n}`,...t)}}function la(n,...e){if(uu.logLevel<=Lt.ERROR){let t=e.map(SD);uu.error(`Firestore (${Rh}): ${n}`,...t)}}function Ic(n,...e){if(uu.logLevel<=Lt.WARN){let t=e.map(SD);uu.warn(`Firestore (${Rh}): ${n}`,...t)}}function SD(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function at(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,EB(n,i,t)}function EB(n,e,t){let i=`FIRESTORE (${Rh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw la(i),new Error(i)}function an(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||EB(e,r,i)}function wt(n,e){return n}var ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ne=class extends Fr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var aa=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var O0=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},FM=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ti.UNAUTHENTICATED))}shutdown(){}},VM=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},UM=class{constructor(e){this.t=e,this.currentUser=Ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){an(this.o===void 0,42304);let i=this.i,r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve(),s=new aa;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new aa,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>U(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new aa)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(an(typeof i.accessToken=="string",31837,{l:i}),new O0(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return an(e===null||typeof e=="string",2055,{h:e}),new Ti(e)}},BM=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ti.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},zM=class{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new BM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}},k0=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},HM=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,is(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){an(this.o===void 0,3512);let i=s=>{s.error!=null&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,Le("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?r(s):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new k0(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(an(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new k0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function RJ(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}function wB(){return new TextEncoder}var Im=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),i="";for(;i.length<20;){let r=RJ(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}};function Ot(n,e){return n<e?-1:n>e?1:0}function jM(n,e){let t=0;for(;t<n.length&&t<e.length;){let i=n.codePointAt(t),r=e.codePointAt(t);if(i!==r){if(i<128&&r<128)return Ot(i,r);{let s=wB(),o=PJ(s.encode(AU(n,t)),s.encode(AU(e,t)));return o!==0?o:Ot(i,r)}}t+=i>65535?2:1}return Ot(n.length,e.length)}function AU(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function PJ(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Ot(n[t],e[t]);return Ot(n.length,e.length)}function _h(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var DU="__name__",L0=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&at(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&at(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=n.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ot(e.length,t.length)}static compareSegments(e,t){let i=n.isNumericId(e),r=n.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?n.extractNumericId(e).compare(n.extractNumericId(t)):jM(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return sa.fromString(e.substring(4,e.length-2))}},Rn=class n extends L0{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new Ne(ue.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},NJ=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ur=class n extends L0{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return NJ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===DU}static keyField(){return new n([DU])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new Ne(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new Ne(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ne(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Ne(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var it=class n{constructor(e){this.path=e}static fromPath(e){return new n(Rn.fromString(e))}static fromName(e){return new n(Rn.fromString(e).popFirst(5))}static empty(){return new n(Rn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Rn(e.slice()))}};function xB(n,e,t){if(!t)throw new Ne(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function OJ(n,e,t,i){if(e===!0&&i===!0)throw new Ne(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function RU(n){if(!it.isDocumentKey(n))throw new Ne(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function PU(n){if(it.isDocumentKey(n))throw new Ne(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function SB(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function fb(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":at(12329,{type:typeof n})}function Ec(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ne(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=fb(n);throw new Ne(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function li(n,e){let t={typeString:n};return e&&(t.value=e),t}function Fm(n,e){if(!SB(n))throw new Ne(ue.INVALID_ARGUMENT,"JSON must be an object");let t;for(let i in e)if(e[i]){let r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}let o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Ne(ue.INVALID_ARGUMENT,t);return!0}var NU=-62135596800,OU=1e6,Gn=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*OU);return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ne(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ne(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<NU)throw new Ne(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OU}_compareTo(e){return this.seconds===e.seconds?Ot(this.nanoseconds,e.nanoseconds):Ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fm(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-NU;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Gn._jsonSchemaVersion="firestore/timestamp/1.0",Gn._jsonSchema={type:li("string",Gn._jsonSchemaVersion),seconds:li("number"),nanoseconds:li("number")};var It=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Gn(0,0))}static max(){return new n(new Gn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Cm=-1,GM=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};GM.UNKNOWN_ID=-1;function kJ(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=It.fromTimestamp(i===1e9?new Gn(t+1,0):new Gn(t,i));return new du(r,it.empty(),e)}function LJ(n){return new du(n.readTime,n.key,Cm)}var du=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(It.min(),it.empty(),Cm)}static max(){return new n(It.max(),it.empty(),Cm)}};function FJ(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=it.comparator(n.documentKey,e.documentKey),t!==0?t:Ot(n.largestBatchId,e.largestBatchId))}var VJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",WM=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ph(n){return U(this,null,function*(){if(n.code!==ue.FAILED_PRECONDITION||n.message!==VJ)throw n;Le("LocalStore","Unexpectedly lost primary lease")})}var he=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},c=>i(c))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function UJ(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Nh(n){return n.name==="IndexedDbTransactionError"}var TD=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this._e(r),this.ae=r=>i.writeSequenceNumber(r))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),ID=-1;function pb(n){return n==null}function Mm(n){return n===0&&1/n==-1/0}function BJ(n){return typeof n=="number"&&Number.isInteger(n)&&!Mm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var TB="";function zJ(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kU(e)),e=HJ(n.get(t),e);return kU(e)}function HJ(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":t+="";break;case TB:t+="";break;default:t+=s}}return t}function kU(n){return n+TB+""}var jJ="remoteDocuments",IB="owner";var CB="mutationQueues";var MB="mutations";var AB="documentMutations",GJ="remoteDocumentsV14";var DB="remoteDocumentGlobal";var RB="targets";var PB="targetDocuments";var NB="targetGlobal",OB="collectionParents";var kB="clientMetadata";var LB="bundles";var FB="namedQueries";var WJ="indexConfiguration";var $J="indexState";var qJ="indexEntries";var VB="documentOverlays";var XJ="globals";var YJ=[CB,MB,AB,jJ,RB,IB,NB,PB,kB,DB,OB,LB,FB],$1e=[...YJ,VB],KJ=[CB,MB,AB,GJ,RB,IB,NB,PB,kB,DB,OB,LB,FB,VB],ZJ=KJ,JJ=[...ZJ,WJ,$J,qJ];var q1e=[...JJ,XJ];function LU(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Rc(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UB(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Wn=class n{constructor(e,t){this.comparator=e,this.root=t||uo.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,uo.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,uo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fh(this.root,e,this.comparator,!1)}getReverseIterator(){return new fh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fh(this.root,e,this.comparator,!0)}},fh=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},uo=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw at(43730,{key:this.key,value:this.value});if(this.right.isRed())throw at(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw at(27949);return e+(this.isRed()?0:1)}};uo.EMPTY=null,uo.RED=!0,uo.BLACK=!1;uo.EMPTY=new class{constructor(){this.size=0}get key(){throw at(57766)}get value(){throw at(16141)}get color(){throw at(16727)}get left(){throw at(29726)}get right(){throw at(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new uo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ii=class n{constructor(e){this.comparator=e,this.data=new Wn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new F0(this.data.getIterator())}getIteratorFrom(e){return new F0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},F0=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ss=class n{constructor(e){this.fields=e,e.sort(Ur.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ii(Ur.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _h(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var V0=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Zi=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new V0("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Zi.EMPTY_BYTE_STRING=new Zi("");var QJ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ua(n){if(an(!!n,39018),typeof n=="string"){let e=0,t=QJ.exec(n);if(an(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Dn(n.seconds),nanos:Dn(n.nanos)}}function Dn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function da(n){return typeof n=="string"?Zi.fromBase64String(n):Zi.fromUint8Array(n)}var BB="server_timestamp",zB="__type__",HB="__previous_value__",jB="__local_write_time__";function CD(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[zB])===null||t===void 0?void 0:t.stringValue)===BB}function mb(n){let e=n.mapValue.fields[HB];return CD(e)?mb(e):e}function Am(n){let e=ua(n.mapValue.fields[jB].timestampValue);return new Gn(e.seconds,e.nanos)}var $M=class{constructor(e,t,i,r,s,o,a,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=u}},U0="(default)",B0=class n{constructor(e,t){this.projectId=e,this.database=t||U0}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===U0}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var MD="__type__",GB="__max__",M0={mapValue:{fields:{__type__:{stringValue:GB}}}},AD="__vector__",yh="value";function Cc(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?CD(n)?4:$B(n)?9007199254740991:WB(n)?10:11:at(28295,{value:n})}function po(n,e){if(n===e)return!0;let t=Cc(n);if(t!==Cc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Am(n).isEqual(Am(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=ua(r.timestampValue),a=ua(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return da(r.bytesValue).isEqual(da(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Dn(r.geoPointValue.latitude)===Dn(s.geoPointValue.latitude)&&Dn(r.geoPointValue.longitude)===Dn(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Dn(r.integerValue)===Dn(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=Dn(r.doubleValue),a=Dn(s.doubleValue);return o===a?Mm(o)===Mm(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return _h(n.arrayValue.values||[],e.arrayValue.values||[],po);case 10:case 11:return(function(r,s){let o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(LU(o)!==LU(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!po(o[c],a[c])))return!1;return!0})(n,e);default:return at(52216,{left:n})}}function Dm(n,e){return(n.values||[]).find(t=>po(t,e))!==void 0}function vh(n,e){if(n===e)return 0;let t=Cc(n),i=Cc(e);if(t!==i)return Ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ot(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=Dn(s.integerValue||s.doubleValue),c=Dn(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return FU(n.timestampValue,e.timestampValue);case 4:return FU(Am(n),Am(e));case 5:return jM(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=da(s),c=da(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=Ot(a[l],c[l]);if(u!==0)return u}return Ot(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=Ot(Dn(s.latitude),Dn(o.latitude));return a!==0?a:Ot(Dn(s.longitude),Dn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return VU(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,c,l,u;let d=s.fields||{},h=o.fields||{},p=(a=d[yh])===null||a===void 0?void 0:a.arrayValue,g=(c=h[yh])===null||c===void 0?void 0:c.arrayValue,y=Ot(((l=p?.values)===null||l===void 0?void 0:l.length)||0,((u=g?.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:VU(p,g)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===M0.mapValue&&o===M0.mapValue)return 0;if(s===M0.mapValue)return 1;if(o===M0.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){let h=jM(c[d],u[d]);if(h!==0)return h;let p=vh(a[c[d]],l[u[d]]);if(p!==0)return p}return Ot(c.length,u.length)})(n.mapValue,e.mapValue);default:throw at(23264,{le:t})}}function FU(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ot(n,e);let t=ua(n),i=ua(e),r=Ot(t.seconds,i.seconds);return r!==0?r:Ot(t.nanos,i.nanos)}function VU(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=vh(t[r],i[r]);if(s)return s}return Ot(t.length,i.length)}function bh(n){return qM(n)}function qM(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let i=ua(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return da(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return it.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=qM(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let o of i)s?s=!1:r+=",",r+=`${o}:${qM(t.fields[o])}`;return r+"}"})(n.mapValue):at(61005,{value:n})}function R0(n){switch(Cc(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=mb(n);return e?16+R0(e):16;case 5:return 2*n.stringValue.length;case 6:return da(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce((r,s)=>r+R0(s),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Rc(i.fields,(s,o)=>{r+=s.length+R0(o)}),r})(n.mapValue);default:throw at(13486,{value:n})}}function UU(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function XM(n){return!!n&&"integerValue"in n}function DD(n){return!!n&&"arrayValue"in n}function BU(n){return!!n&&"nullValue"in n}function zU(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function P0(n){return!!n&&"mapValue"in n}function WB(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[MD])===null||t===void 0?void 0:t.stringValue)===AD}function wm(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Rc(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=wm(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wm(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $B(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===GB}var Y1e={mapValue:{fields:{[MD]:{stringValue:AD},[yh]:{arrayValue:{}}}}};var Vr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!P0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wm(t)}setAll(e){let t=Ur.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=wm(o):r.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());P0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return po(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];P0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Rc(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(wm(this.value))}};function qB(n){let e=[];return Rc(n.fields,(t,i)=>{let r=new Ur([t]);if(P0(i)){let s=qB(i.mapValue).fields;if(s.length===0)e.push(r);else for(let o of s)e.push(r.child(o))}else e.push(r)}),new ss(e)}var Cs=class n{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,It.min(),It.min(),It.min(),Vr.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,It.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,It.min(),It.min(),Vr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,It.min(),It.min(),Vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(It.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=It.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Eh=class{constructor(e,t){this.position=e,this.inclusive=t}};function HU(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField()?i=it.comparator(it.fromName(o.referenceValue),t.key):i=vh(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function jU(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!po(n.position[t],e.position[t]))return!1;return!0}var wh=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function eQ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var z0=class{},ci=class n extends z0{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new KM(e,t,i):t==="array-contains"?new QM(e,i):t==="in"?new eA(e,i):t==="not-in"?new tA(e,i):t==="array-contains-any"?new nA(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new ZM(e,i):new JM(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(vh(t,this.value)):t!==null&&Cc(this.value)===Cc(t)&&this.matchesComparison(vh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ms=class n extends z0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return XB(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function XB(n){return n.op==="and"}function YB(n){return tQ(n)&&XB(n)}function tQ(n){for(let e of n.filters)if(e instanceof Ms)return!1;return!0}function YM(n){if(n instanceof ci)return n.field.canonicalString()+n.op.toString()+bh(n.value);if(YB(n))return n.filters.map(e=>YM(e)).join(",");{let e=n.filters.map(t=>YM(t)).join(",");return`${n.op}(${e})`}}function KB(n,e){return n instanceof ci?(function(i,r){return r instanceof ci&&i.op===r.op&&i.field.isEqual(r.field)&&po(i.value,r.value)})(n,e):n instanceof Ms?(function(i,r){return r instanceof Ms&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&KB(o,r.filters[a]),!0):!1})(n,e):void at(19439)}function ZB(n){return n instanceof ci?(function(t){return`${t.field.canonicalString()} ${t.op} ${bh(t.value)}`})(n):n instanceof Ms?(function(t){return t.op.toString()+" {"+t.getFilters().map(ZB).join(" ,")+"}"})(n):"Filter"}var KM=class extends ci{constructor(e,t,i){super(e,t,i),this.key=it.fromName(i.referenceValue)}matches(e){let t=it.comparator(e.key,this.key);return this.matchesComparison(t)}},ZM=class extends ci{constructor(e,t){super(e,"in",t),this.keys=JB("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},JM=class extends ci{constructor(e,t){super(e,"not-in",t),this.keys=JB("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function JB(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>it.fromName(i.referenceValue))}var QM=class extends ci{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return DD(t)&&Dm(t.arrayValue,this.value)}},eA=class extends ci{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Dm(this.value.arrayValue,t)}},tA=class extends ci{constructor(e,t){super(e,"not-in",t)}matches(e){if(Dm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Dm(this.value.arrayValue,t)}},nA=class extends ci{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!DD(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Dm(this.value.arrayValue,i))}};var iA=class{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}};function GU(n,e=null,t=[],i=[],r=null,s=null,o=null){return new iA(n,e,t,i,r,s,o)}function RD(n){let e=wt(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>YM(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>(function(s){return s.field.canonicalString()+s.dir})(i)).join(","),pb(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>bh(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>bh(i)).join(",")),e.Pe=t}return e.Pe}function PD(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eQ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KB(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jU(n.startAt,e.startAt)&&jU(n.endAt,e.endAt)}function rA(n){return it.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var hu=class{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function nQ(n,e,t,i,r,s,o,a){return new hu(n,e,t,i,r,s,o,a)}function ND(n){return new hu(n)}function WU(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function QB(n){return n.collectionGroup!==null}function xm(n){let e=wt(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ii(Ur.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new wh(s,i))}),t.has(Ur.keyField().canonicalString())||e.Te.push(new wh(Ur.keyField(),i))}return e.Te}function ho(n){let e=wt(n);return e.Ie||(e.Ie=iQ(e,xm(n))),e.Ie}function iQ(n,e){if(n.limitType==="F")return GU(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new wh(r.field,s)});let t=n.endAt?new Eh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Eh(n.startAt.position,n.startAt.inclusive):null;return GU(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function sA(n,e){let t=n.filters.concat([e]);return new hu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function oA(n,e,t){return new hu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function gb(n,e){return PD(ho(n),ho(e))&&n.limitType===e.limitType}function e3(n){return`${RD(ho(n))}|lt:${n.limitType}`}function uh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>ZB(r)).join(", ")}]`),pb(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>bh(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>bh(r)).join(",")),`Target(${i})`})(ho(n))}; limitType=${n.limitType})`}function _b(n,e){return e.isFoundDocument()&&(function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):it.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(let s of xm(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,c){let l=HU(o,a,c);return o.inclusive?l<=0:l<0})(i.startAt,xm(i),r)||i.endAt&&!(function(o,a,c){let l=HU(o,a,c);return o.inclusive?l>=0:l>0})(i.endAt,xm(i),r))})(n,e)}function rQ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t3(n){return(e,t)=>{let i=!1;for(let r of xm(n)){let s=sQ(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function sQ(n,e,t){let i=n.field.isKeyField()?it.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?vh(c,l):at(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return at(19790,{direction:n.dir})}}var ha=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Rc(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return UB(this.inner)}size(){return this.innerSize}};var oQ=new Wn(it.comparator);function fa(){return oQ}var n3=new Wn(it.comparator);function Em(...n){let e=n3;for(let t of n)e=e.insert(t.key,t);return e}function i3(n){let e=n3;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function ou(){return Sm()}function r3(){return Sm()}function Sm(){return new ha(n=>n.toString(),(n,e)=>n.isEqual(e))}var aQ=new Wn(it.comparator),cQ=new Ii(it.comparator);function zt(...n){let e=cQ;for(let t of n)e=e.add(t);return e}var lQ=new Ii(Ot);function uQ(){return lQ}function OD(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mm(e)?"-0":e}}function s3(n){return{integerValue:""+n}}function dQ(n,e){return BJ(e)?s3(e):OD(n,e)}var xh=class{constructor(){this._=void 0}};function hQ(n,e,t){return n instanceof fu?(function(r,s){let o={fields:{[zB]:{stringValue:BB},[jB]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&CD(s)&&(s=mb(s)),s&&(o.fields[HB]=s),{mapValue:o}})(t,e):n instanceof pu?a3(n,e):n instanceof mu?c3(n,e):(function(r,s){let o=o3(r,s),a=$U(o)+$U(r.Ee);return XM(o)&&XM(r.Ee)?s3(a):OD(r.serializer,a)})(n,e)}function fQ(n,e,t){return n instanceof pu?a3(n,e):n instanceof mu?c3(n,e):t}function o3(n,e){return n instanceof Sh?(function(i){return XM(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}var fu=class extends xh{},pu=class extends xh{constructor(e){super(),this.elements=e}};function a3(n,e){let t=l3(e);for(let i of n.elements)t.some(r=>po(r,i))||t.push(i);return{arrayValue:{values:t}}}var mu=class extends xh{constructor(e){super(),this.elements=e}};function c3(n,e){let t=l3(e);for(let i of n.elements)t=t.filter(r=>!po(r,i));return{arrayValue:{values:t}}}var Sh=class extends xh{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function $U(n){return Dn(n.integerValue||n.doubleValue)}function l3(n){return DD(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var aA=class{constructor(e,t){this.field=e,this.transform=t}};function pQ(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof pu&&r instanceof pu||i instanceof mu&&r instanceof mu?_h(i.elements,r.elements,po):i instanceof Sh&&r instanceof Sh?po(i.Ee,r.Ee):i instanceof fu&&r instanceof fu})(n.transform,e.transform)}var cA=class{constructor(e,t){this.version=e,this.transformResults=t}},ca=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function N0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Th=class{};function u3(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rm(n.key,ca.none()):new gu(n.key,n.data,ca.none());{let t=n.data,i=Vr.empty(),r=new Ii(Ur.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new mo(n.key,i,new ss(r.toArray()),ca.none())}}function mQ(n,e,t){n instanceof gu?(function(r,s,o){let a=r.value.clone(),c=XU(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof mo?(function(r,s,o){if(!N0(r.precondition,s))return void s.convertToUnknownDocument(o.version);let a=XU(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(d3(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Tm(n,e,t,i){return n instanceof gu?(function(s,o,a,c){if(!N0(s.precondition,o))return a;let l=s.value.clone(),u=YU(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null})(n,e,t,i):n instanceof mo?(function(s,o,a,c){if(!N0(s.precondition,o))return a;let l=YU(s.fieldTransforms,c,o),u=o.data;return u.setAll(d3(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))})(n,e,t,i):(function(s,o,a){return N0(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function gQ(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=o3(i.transform,r||null);s!=null&&(t===null&&(t=Vr.empty()),t.set(i.field,s))}return t||null}function qU(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&_h(i,r,(s,o)=>pQ(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var gu=class extends Th{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},mo=class extends Th{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function d3(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function XU(n,e,t){let i=new Map;an(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,fQ(o,a,t[r]))}return i}function YU(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,hQ(s,o,e))}return i}var Rm=class extends Th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},lA=class extends Th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var uA=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&mQ(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Tm(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Tm(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=r3();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;let c=u3(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(It.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),zt())}isEqual(e){return this.batchId===e.batchId&&_h(this.mutations,e.mutations,(t,i)=>qU(t,i))&&_h(this.baseMutations,e.baseMutations,(t,i)=>qU(t,i))}},dA=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){an(e.mutations.length===i.length,58842,{Ve:e.mutations.length,me:i.length});let r=(function(){return aQ})(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var hA=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fA=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var oi,$t;function _Q(n){switch(n){case ue.OK:return at(64938);case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0;default:return at(15467,{code:n})}}function h3(n){if(n===void 0)return la("GRPC error has no .code"),ue.UNKNOWN;switch(n){case oi.OK:return ue.OK;case oi.CANCELLED:return ue.CANCELLED;case oi.UNKNOWN:return ue.UNKNOWN;case oi.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case oi.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case oi.INTERNAL:return ue.INTERNAL;case oi.UNAVAILABLE:return ue.UNAVAILABLE;case oi.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case oi.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case oi.NOT_FOUND:return ue.NOT_FOUND;case oi.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case oi.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case oi.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case oi.ABORTED:return ue.ABORTED;case oi.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case oi.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case oi.DATA_LOSS:return ue.DATA_LOSS;default:return at(39323,{code:n})}}($t=oi||(oi={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";var KU=null;var yQ=new sa([4294967295,4294967295],0);function ZU(n){let e=wB().encode(n),t=new CM;return t.update(e),new Uint8Array(t.digest())}function JU(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new sa([t,i],0),new sa([r,s],0)]}var pA=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new au(`Invalid padding: ${t}`);if(i<0)throw new au(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new au(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new au(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=sa.fromNumber(this.fe)}pe(e,t,i){let r=e.add(t.multiply(sa.fromNumber(i)));return r.compare(yQ)===1&&(r=new sa([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=ZU(e),[i,r]=JU(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(i,r,s);if(!this.ye(o))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;let t=ZU(e),[i,r]=JU(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(i,r,s);this.we(o)}}we(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},au=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var H0=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Pm.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(It.min(),r,new Wn(Ot),fa(),zt())}},Pm=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,zt(),zt(),zt())}};var ph=class{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.be=r}},j0=class{constructor(e,t){this.targetId=e,this.De=t}},G0=class{constructor(e,t,i=Zi.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},W0=class{constructor(){this.ve=0,this.Ce=QU(),this.Fe=Zi.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=zt(),t=zt(),i=zt();return this.Ce.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:at(38017,{changeType:s})}}),new Pm(this.Fe,this.Me,e,t,i)}ke(){this.xe=!1,this.Ce=QU()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,an(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},mA=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=fa(),this.je=A0(),this.Je=A0(),this.He=new Wn(Ot)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let i=this.tt(t);switch(e.state){case 0:this.nt(t)&&i.Be(e.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(e.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(i.Ke(),i.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),i.Be(e.resumeToken));break;default:at(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((i,r)=>{this.nt(r)&&t(r)})}it(e){let t=e.targetId,i=e.De.count,r=this.st(t);if(r){let s=r.target;if(rA(s))if(i===0){let o=new it(s.path);this.Xe(t,o,Cs.newNoDocument(o,It.min()))}else an(i===1,20013,{expectedCount:i});else{let o=this.ot(t);if(o!==i){let a=this._t(e),c=a?this.ut(a,e,o):1;if(c!==0){this.rt(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,l)}KU?.ct((function(u,d,h,p,g){var y,m,_,I,M,C;let P={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},N=d.unchangedNames;return N&&(P.bloomFilter={applied:g===0,hashCount:(y=N?.hashCount)!==null&&y!==void 0?y:0,bitmapLength:(I=(_=(m=N?.bits)===null||m===void 0?void 0:m.bitmap)===null||_===void 0?void 0:_.length)!==null&&I!==void 0?I:0,padding:(C=(M=N?.bits)===null||M===void 0?void 0:M.padding)!==null&&C!==void 0?C:0,mightContain:S=>{var w;return(w=p?.mightContain(S))!==null&&w!==void 0&&w}}),P})(o,e.De,this.We.lt(),a,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o,a;try{o=da(i).toUint8Array()}catch(c){if(c instanceof V0)return Ic("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new pA(o,r,s)}catch(c){return Ic(c instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,i){return t.De.count===i-this.ht(e,t.targetId)?0:2}ht(e,t){let i=this.We.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),r++)}),r}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let a=this.st(o);if(a){if(s.current&&rA(a.target)){let c=new it(a.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,Cs.newNoDocument(c,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let i=zt();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let r=new H0(e,t,this.He,this.ze,i);return this.ze=fa(),this.je=A0(),this.Je=A0(),this.He=new Wn(Ot),r}Ze(e,t){if(!this.nt(e))return;let i=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,i),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,i){if(!this.nt(e))return;let r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),i&&(this.ze=this.ze.insert(t,i))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new W0,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ii(Ot),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ii(Ot),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||Le("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new W0),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function A0(){return new Wn(it.comparator)}function QU(){return new Wn(it.comparator)}var vQ={asc:"ASCENDING",desc:"DESCENDING"},bQ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EQ={and:"AND",or:"OR"},gA=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function _A(n,e){return n.useProto3Json||pb(e)?e:{value:e}}function $0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function f3(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function wQ(n,e){return $0(n,e.toTimestamp())}function fo(n){return an(!!n,49232),It.fromTimestamp((function(t){let i=ua(t);return new Gn(i.seconds,i.nanos)})(n))}function kD(n,e){return yA(n,e).canonicalString()}function yA(n,e){let t=(function(r){return new Rn(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function p3(n){let e=Rn.fromString(n);return an(v3(e),10190,{key:e.toString()}),e}function vA(n,e){return kD(n.databaseId,e.path)}function NM(n,e){let t=p3(e);if(t.get(1)!==n.databaseId.projectId)throw new Ne(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ne(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new it(g3(t))}function m3(n,e){return kD(n.databaseId,e)}function xQ(n){let e=p3(n);return e.length===4?Rn.emptyPath():g3(e)}function bA(n){return new Rn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function g3(n){return an(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function eB(n,e,t){return{name:vA(n,e),fields:t.value.mapValue.fields}}function SQ(n,e){let t;if("targetChange"in e){e.targetChange;let i=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:at(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(l,u){return l.useProto3Json?(an(u===void 0||typeof u=="string",58123),Zi.fromBase64String(u||"")):(an(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Zi.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(l){let u=l.code===void 0?ue.UNKNOWN:h3(l.code);return new Ne(u,l.message||"")})(o);t=new G0(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=NM(n,i.document.name),s=fo(i.document.updateTime),o=i.document.createTime?fo(i.document.createTime):It.min(),a=new Vr({mapValue:{fields:i.document.fields}}),c=Cs.newFoundDocument(r,s,o,a),l=i.targetIds||[],u=i.removedTargetIds||[];t=new ph(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=NM(n,i.document),s=i.readTime?fo(i.readTime):It.min(),o=Cs.newNoDocument(r,s),a=i.removedTargetIds||[];t=new ph([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=NM(n,i.document),s=i.removedTargetIds||[];t=new ph([],s,r,null)}else{if(!("filter"in e))return at(11601,{At:e});{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new fA(r,s),a=i.targetId;t=new j0(a,o)}}return t}function TQ(n,e){let t;if(e instanceof gu)t={update:eB(n,e.key,e.value)};else if(e instanceof Rm)t={delete:vA(n,e.key)};else if(e instanceof mo)t={update:eB(n,e.key,e.data),updateMask:OQ(e.fieldMask)};else{if(!(e instanceof lA))return at(16599,{Rt:e.type});t={verify:vA(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>(function(s,o){let a=o.transform;if(a instanceof fu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof pu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof mu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Sh)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw at(20930,{transform:o.transform})})(0,i))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:wQ(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:at(27497)})(n,e.precondition)),t}function IQ(n,e){return n&&n.length>0?(an(e!==void 0,14353),n.map(t=>(function(r,s){let o=r.updateTime?fo(r.updateTime):fo(s);return o.isEqual(It.min())&&(o=fo(s)),new cA(o,r.transformResults||[])})(t,e))):[]}function CQ(n,e){return{documents:[m3(n,e.path)]}}function MQ(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=m3(n,r);let s=(function(l){if(l.length!==0)return y3(Ms.create(l,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(l){if(l.length!==0)return l.map(u=>(function(h){return{field:dh(h.field),direction:RQ(h.dir)}})(u))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=_A(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{Vt:t,parent:r}}function AQ(n){let e=xQ(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){an(i===1,65062);let u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=(function(d){let h=_3(d);return h instanceof Ms&&YB(h)?h.getFilters():[h]})(t.where));let o=[];t.orderBy&&(o=(function(d){return d.map(h=>(function(g){return new wh(hh(g.field),(function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(g.direction))})(h))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let h;return h=typeof d=="object"?d.value:d,pb(h)?null:h})(t.limit));let c=null;t.startAt&&(c=(function(d){let h=!!d.before,p=d.values||[];return new Eh(p,h)})(t.startAt));let l=null;return t.endAt&&(l=(function(d){let h=!d.before,p=d.values||[];return new Eh(p,h)})(t.endAt)),nQ(e,r,o,s,a,"F",c,l)}function DQ(n,e){let t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _3(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=hh(t.unaryFilter.field);return ci.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=hh(t.unaryFilter.field);return ci.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=hh(t.unaryFilter.field);return ci.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=hh(t.unaryFilter.field);return ci.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return at(61313);default:return at(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ci.create(hh(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return at(58110);default:return at(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ms.create(t.compositeFilter.filters.map(i=>_3(i)),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return at(1026)}})(t.compositeFilter.op))})(n):at(30097,{filter:n})}function RQ(n){return vQ[n]}function PQ(n){return bQ[n]}function NQ(n){return EQ[n]}function dh(n){return{fieldPath:n.canonicalString()}}function hh(n){return Ur.fromServerFormat(n.fieldPath)}function y3(n){return n instanceof ci?(function(t){if(t.op==="=="){if(zU(t.value))return{unaryFilter:{field:dh(t.field),op:"IS_NAN"}};if(BU(t.value))return{unaryFilter:{field:dh(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(zU(t.value))return{unaryFilter:{field:dh(t.field),op:"IS_NOT_NAN"}};if(BU(t.value))return{unaryFilter:{field:dh(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dh(t.field),op:PQ(t.op),value:t.value}}})(n):n instanceof Ms?(function(t){let i=t.getFilters().map(r=>y3(r));return i.length===1?i[0]:{compositeFilter:{op:NQ(t.op),filters:i}}})(n):at(54877,{filter:n})}function OQ(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function v3(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Nm=class n{constructor(e,t,i,r,s=It.min(),o=It.min(),a=Zi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var EA=class{constructor(e){this.gt=e}};function kQ(n){let e=AQ({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?oA(e,e.limit,"L"):e}var q0=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Dn(e.integerValue));else if("doubleValue"in e){let i=Dn(e.doubleValue);isNaN(i)?this.Ct(t,13):(this.Ct(t,15),Mm(i)?t.Ft(0):t.Ft(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ct(t,20),typeof i=="string"&&(i=ua(i)),t.Mt(`${i.seconds||""}`),t.Ft(i.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(da(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Ct(t,45),t.Ft(i.latitude||0),t.Ft(i.longitude||0)}else"mapValue"in e?$B(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):WB(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):at(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let i=e.fields||{};this.Ct(t,55);for(let r of Object.keys(i))this.xt(r,t),this.Dt(i[r],t)}Lt(e,t){var i,r;let s=e.fields||{};this.Ct(t,53);let o=yh,a=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.Ct(t,15),t.Ft(Dn(a)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let i=e.values||[];this.Ct(t,50);for(let r of i)this.Dt(r,t)}Bt(e,t){this.Ct(t,37),it.fromName(e).path.forEach(i=>{this.Ct(t,60),this.$t(i,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};q0.Ut=new q0;var wA=class{constructor(){this.Dn=new xA}addToCollectionParentIndex(e,t){return this.Dn.add(t),he.resolve()}getCollectionParents(e,t){return he.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return he.resolve()}deleteFieldIndex(e,t){return he.resolve()}deleteAllFieldIndexes(e){return he.resolve()}createTargetIndexes(e,t){return he.resolve()}getDocumentsMatchingTarget(e,t){return he.resolve(null)}getIndexType(e,t){return he.resolve(0)}getFieldIndexes(e,t){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,t){return he.resolve(du.min())}getMinOffsetFromCollectionGroup(e,t){return he.resolve(du.min())}updateCollectionGroup(e,t,i){return he.resolve()}updateIndexEntries(e,t){return he.resolve()}},xA=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Ii(Rn.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Ii(Rn.comparator)).toArray()}};var K1e=new Uint8Array(0);var tB={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},b3=41943040,rs=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};rs.DEFAULT_COLLECTION_PERCENTILE=10,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rs.DEFAULT=new rs(b3,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rs.DISABLED=new rs(-1,0,0);var Om=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var nB="LruGarbageCollector",LQ=1048576;function iB([n,e],[t,i]){let r=Ot(n,t);return r===0?Ot(e,i):r}var SA=class{constructor(e){this.Tr=e,this.buffer=new Ii(iB),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();iB(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},TA=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Le(nB,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>U(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Nh(t)?Le(nB,"Ignoring IndexedDB error during garbage collection: ",t):yield Ph(t)}yield this.Rr(3e5)}))}},IA=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return he.resolve(TD.ue);let i=new SA(t);return this.Vr.forEachTarget(e,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.gr(e,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(tB)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tB):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let i,r,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(e,i,t))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(d=>(l=Date.now(),lh()<=Lt.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}};function FQ(n,e){return new IA(n,e)}var CA=class{constructor(){this.changes=new ha(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Cs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?he.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var MA=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var AA=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Tm(i.mutation,r,ss.empty(),Gn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,zt()).next(()=>i))}getLocalViewOfDocuments(e,t,i=zt()){let r=ou();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Em();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=ou();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,zt()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=fa(),o=Sm(),a=(function(){return Sm()})();return t.forEach((c,l)=>{let u=i.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof mo)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Tm(u.mutation,l,u.mutation.getFieldMask(),Gn.now())):o.set(l.key,ss.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>{var d;return a.set(l,new MA(u,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){let i=Sm(),r=new Wn((o,a)=>o-a),s=zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=i.get(c)||ss.empty();u=a.applyToLocalView(l,u),i.set(c,u);let d=(r.get(a.batchId)||zt()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,d=r3();u.forEach(h=>{if(!s.has(h)){let p=u3(t.get(h),i.get(h));p!==null&&d.set(h,p),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return he.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return it.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):QB(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):he.resolve(ou()),a=Cm,c=s;return o.next(l=>he.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?he.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,zt())).next(u=>({batchId:a,changes:i3(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new it(t)).next(i=>{let r=Em();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=Em();return this.indexManager.getCollectionParents(e,s).next(a=>he.forEach(a,c=>{let l=(function(d,h){return new hu(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,i,r).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,Cs.newInvalidDocument(u)))});let a=Em();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&Tm(u.mutation,l,ss.empty(),Gn.now()),_b(t,l)&&(a=a.insert(c,l))}),a})}};var DA=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return he.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:fo(r.createTime)}})(t)),he.resolve()}getNamedQuery(e,t){return he.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(r){return{name:r.name,query:kQ(r.bundledQuery),readTime:fo(r.readTime)}})(t)),he.resolve()}};var RA=class{constructor(){this.overlays=new Wn(it.comparator),this.kr=new Map}getOverlay(e,t){return he.resolve(this.overlays.get(t))}getOverlays(e,t){let i=ou();return he.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.wt(e,t,s)}),he.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.kr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(i)),he.resolve()}getOverlaysForCollection(e,t,i){let r=ou(),s=t.length+1,o=new it(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return he.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Wn((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>i){let u=s.get(l.largestBatchId);u===null&&(u=ou(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=ou(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return he.resolve(a)}wt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.kr.get(r.largestBatchId).delete(i.key);this.kr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new hA(t,i));let s=this.kr.get(t);s===void 0&&(s=zt(),this.kr.set(t,s)),this.kr.set(t,s.add(i.key))}};var PA=class{constructor(){this.sessionToken=Zi.EMPTY_BYTE_STRING}getSessionToken(e){return he.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,he.resolve()}};var km=class{constructor(){this.qr=new Ii(ai.Qr),this.$r=new Ii(ai.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let i=new ai(e,t);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new ai(e,t))}Gr(e,t){e.forEach(i=>this.removeReference(i,t))}zr(e){let t=new it(new Rn([])),i=new ai(t,e),r=new ai(t,e+1),s=[];return this.$r.forEachInRange([i,r],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new it(new Rn([])),i=new ai(t,e),r=new ai(t,e+1),s=zt();return this.$r.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ai(e,0),i=this.qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},ai=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return it.comparator(e.key,t.key)||Ot(e.Hr,t.Hr)}static Ur(e,t){return Ot(e.Hr,t.Hr)||it.comparator(e.key,t.key)}};var NA=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ii(ai.Qr)}checkEmpty(e){return he.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new uA(s,t,i,r);this.mutationQueue.push(o);for(let a of r)this.Yr=this.Yr.add(new ai(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return he.resolve(o)}lookupMutationBatch(e,t){return he.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Xr(i),s=r<0?0:r;return he.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(this.mutationQueue.length===0?ID:this.er-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new ai(t,0),r=new ai(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([i,r],o=>{let a=this.Zr(o.Hr);s.push(a)}),he.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ii(Ot);return t.forEach(r=>{let s=new ai(r,0),o=new ai(r,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],a=>{i=i.add(a.Hr)})}),he.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;it.isDocumentKey(s)||(s=s.child(""));let o=new ai(new it(s),0),a=new Ii(Ot);return this.Yr.forEachWhile(c=>{let l=c.key.path;return!!i.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.Hr)),!0)},o),he.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(i=>{let r=this.Zr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){an(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return he.forEach(t.mutations,r=>{let s=new ai(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=i})}rr(e){}containsKey(e,t){let i=new ai(t,0),r=this.Yr.firstAfterOrEqual(i);return he.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,he.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var OA=class{constructor(e){this.ni=e,this.docs=(function(){return new Wn(it.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ni(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return he.resolve(i?i.document.mutableCopy():Cs.newInvalidDocument(t))}getEntries(e,t){let i=fa();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Cs.newInvalidDocument(r))}),he.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=fa(),o=t.path,a=new it(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||FJ(LJ(u),i)<=0||(r.has(u.key)||_b(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return he.resolve(s)}getAllFromCollectionGroup(e,t,i,r){at(9500)}ri(e,t){return he.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new kA(this)}getSize(e){return he.resolve(this.size)}},kA=class extends CA{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(i)}),he.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var LA=class{constructor(e){this.persistence=e,this.ii=new ha(t=>RD(t),PD),this.lastRemoteSnapshotVersion=It.min(),this.highestTargetId=0,this.si=0,this.oi=new km,this.targetCount=0,this._i=Om.ar()}forEachTarget(e,t){return this.ii.forEach((i,r)=>t(r)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.si&&(this.si=t),he.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Om(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,he.resolve()}updateTargetData(e,t){return this.hr(t),he.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),he.waitFor(s).next(()=>r)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,t){let i=this.ii.get(t)||null;return he.resolve(i)}addMatchingKeys(e,t,i){return this.oi.Kr(t,i),he.resolve()}removeMatchingKeys(e,t,i){this.oi.Gr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),he.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),he.resolve()}getMatchingKeysForTargetId(e,t){let i=this.oi.Jr(t);return he.resolve(i)}containsKey(e,t){return he.resolve(this.oi.containsKey(t))}};var X0=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new TD(0),this.ci=!1,this.ci=!0,this.li=new PA,this.referenceDelegate=e(this),this.hi=new LA(this),this.indexManager=new wA,this.remoteDocumentCache=(function(r){return new OA(r)})(i=>this.referenceDelegate.Pi(i)),this.serializer=new EA(t),this.Ti=new DA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new RA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ai[e.toKey()];return i||(i=new NA(t,this.referenceDelegate),this.ai[e.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,i){Le("MemoryPersistence","Starting transaction:",e);let r=new FA(this.ui.next());return this.referenceDelegate.Ii(),i(r).next(s=>this.referenceDelegate.di(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ei(e,t){return he.or(Object.values(this.ai).map(i=>()=>i.containsKey(e,t)))}},FA=class extends WM{constructor(e){super(),this.currentSequenceNumber=e}},VA=class n{constructor(e){this.persistence=e,this.Ai=new km,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw at(60996)}addReference(e,t,i){return this.Ai.addReference(i,t),this.mi.delete(i.toString()),he.resolve()}removeReference(e,t,i){return this.Ai.removeReference(i,t),this.mi.add(i.toString()),he.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),he.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(r=>this.mi.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.mi.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.mi,i=>{let r=it.fromPath(i);return this.fi(e,r).next(s=>{s||t.removeEntry(r,It.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(i=>{i?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return he.or([()=>he.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Y0=class n{constructor(e,t){this.persistence=e,this.gi=new ha(i=>zJ(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=FQ(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return he.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}yr(e){let t=0;return this.gr(e,i=>{t++}).next(()=>t)}gr(e,t){return he.forEach(this.gi,(i,r)=>this.Sr(e,i,r).next(s=>s?he.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ri(e,o=>this.Sr(e,o,t).next(a=>{a||(i++,s.removeEntry(o,It.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),he.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),he.resolve()}removeReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),he.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),he.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=R0(e.data.value)),t}Sr(e,t,i){return he.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.gi.get(t);return he.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var UA=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Is=i,this.ds=r}static Es(e,t){let i=zt(),r=zt();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var BA=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var zA=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return nV()?8:UJ(Si())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new BA;return this.ws(e,t,o).next(a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)})}).next(()=>s.result)}Ss(e,t,i,r){return i.documentReadCount<this.Vs?(lh()<=Lt.DEBUG&&Le("QueryEngine","SDK will not create cache indexes for query:",uh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),he.resolve()):(lh()<=Lt.DEBUG&&Le("QueryEngine","Query:",uh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.fs*r?(lh()<=Lt.DEBUG&&Le("QueryEngine","The SDK decides to create cache indexes for query:",uh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ho(t))):he.resolve())}ps(e,t){if(WU(t))return he.resolve(null);let i=ho(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=oA(t,null,"F"),i=ho(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=zt(...s);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{let l=this.bs(t,a);return this.Ds(t,l,o,c.readTime)?this.ps(e,oA(t,null,"F")):this.vs(e,l,t,c)}))})))}ys(e,t,i,r){return WU(t)||r.isEqual(It.min())?he.resolve(null):this.gs.getDocuments(e,i).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,i,r)?he.resolve(null):(lh()<=Lt.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),uh(t)),this.vs(e,o,t,kJ(r,Cm)).next(a=>a))})}bs(e,t){let i=new Ii(t3(e));return t.forEach((r,s)=>{_b(e,s)&&(i=i.add(s))}),i}Ds(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ws(e,t,i){return lh()<=Lt.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",uh(t)),this.gs.getDocumentsMatchingQuery(e,t,du.min(),i)}vs(e,t,i,r){return this.gs.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var LD="LocalStore",VQ=3e8,HA=class{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Wn(Ot),this.Ms=new ha(s=>RD(s),PD),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(i)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new AA(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function UQ(n,e,t,i){return new HA(n,e,t,i)}function E3(n,e){return U(this,null,function*(){let t=wt(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let o=[],a=[],c=zt();for(let l of r){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(i,c).next(l=>({Bs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function BQ(n,e){let t=wt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,c,l,u){let d=l.batch,h=d.keys(),p=he.resolve();return h.forEach(g=>{p=p.next(()=>u.getEntry(c,g)).next(y=>{let m=l.docVersions.get(g);an(m!==null,48541),y.version.compareTo(m)<0&&(d.applyToRemoteDocument(y,l),y.isValidDocument()&&(y.setReadTime(l.commitVersion),u.addEntry(y)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,d))})(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=zt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c})(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function w3(n){let e=wt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function zQ(n,e){let t=wt(n),i=e.snapshotVersion,r=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});r=t.Fs;let a=[];e.targetChanges.forEach((u,d)=>{let h=r.get(d);if(!h)return;a.push(t.hi.removeMatchingKeys(s,u.removedDocuments,d).next(()=>t.hi.addMatchingKeys(s,u.addedDocuments,d)));let p=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Zi.EMPTY_BYTE_STRING,It.min()).withLastLimboFreeSnapshotVersion(It.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,i)),r=r.insert(d,p),(function(y,m,_){return y.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=VQ?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0})(h,p,u)&&a.push(t.hi.updateTargetData(s,p))});let c=fa(),l=zt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(HQ(s,o,e.documentUpdates).next(u=>{c=u.Ls,l=u.ks})),!i.isEqual(It.min())){let u=t.hi.getLastRemoteSnapshotVersion(s).next(d=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return he.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Fs=r,s))}function HQ(n,e,t){let i=zt(),r=zt();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=fa();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(It.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Le(LD,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ls:o,ks:r}})}function jQ(n,e){let t=wt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=ID),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function GQ(n,e){let t=wt(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.hi.getTargetData(i,e).next(s=>s?(r=s,he.resolve(r)):t.hi.allocateTargetId(i).next(o=>(r=new Nm(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.hi.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.Fs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(i.targetId,i),t.Ms.set(e,i.targetId)),i})}function jA(n,e,t){return U(this,null,function*(){let i=wt(n),r=i.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Nh(o))throw o;Le(LD,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Fs=i.Fs.remove(e),i.Ms.delete(r.target)})}function rB(n,e,t){let i=wt(n),r=It.min(),s=zt();return i.persistence.runTransaction("Execute query","readwrite",o=>(function(c,l,u){let d=wt(c),h=d.Ms.get(u);return h!==void 0?he.resolve(d.Fs.get(h)):d.hi.getTargetData(l,u)})(i,o,ho(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.Cs.getDocumentsMatchingQuery(o,e,t?r:It.min(),t?s:zt())).next(a=>(WQ(i,rQ(e),a),{documents:a,qs:s})))}function WQ(n,e,t){let i=n.xs.get(e)||It.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.xs.set(e,i)}var K0=class{constructor(){this.activeTargetIds=uQ()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var GA=class{constructor(){this.Fo=new K0,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,i){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new K0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var WA=class{xo(e){}shutdown(){}};var sB="ConnectivityMonitor",Z0=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Le(sB,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){Le(sB,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var D0=null;function $A(){return D0===null?D0=(function(){return 268435456+Math.round(2147483648*Math.random())})():D0++,"0x"+D0.toString(16)}var OM="RestConnection",$Q={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},qA=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.Ko=this.databaseId.database===U0?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,s){let o=$A(),a=this.Go(e,t.toUriEncodedString());Le(OM,`Sending RPC '${e}' ${o}:`,a,i);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,r,s);let{host:l}=new URL(a),u=dc(l);return this.jo(e,a,c,i,u).then(d=>(Le(OM,`Received RPC '${e}' ${o}: `,d),d),d=>{throw Ic(OM,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",i),d})}Jo(e,t,i,r,s,o){return this.Wo(e,t,i,r,s)}zo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Rh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}Go(e,t){let i=$Q[e];return`${this.$o}/v1/${t}:${i}`}terminate(){}};var XA=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Ki="WebChannelConnection",YA=class extends qA{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,i,r,s){let o=$A();return new Promise((a,c)=>{let l=new MM;l.setWithCredentials(!0),l.listenOnce(AM.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case bm.NO_ERROR:let d=l.getResponseJson();Le(Ki,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case bm.TIMEOUT:Le(Ki,`RPC '${e}' ${o} timed out`),c(new Ne(ue.DEADLINE_EXCEEDED,"Request time out"));break;case bm.HTTP_ERROR:let h=l.getStatus();if(Le(Ki,`RPC '${e}' ${o} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);let g=p?.error;if(g&&g.status&&g.message){let y=(function(_){let I=_.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(I)>=0?I:ue.UNKNOWN})(g.status);c(new Ne(y,g.message))}else c(new Ne(ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new Ne(ue.UNAVAILABLE,"Connection failed."));break;default:at(9055,{c_:e,streamId:o,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{Le(Ki,`RPC '${e}' ${o} completed.`)}});let u=JSON.stringify(r);Le(Ki,`RPC '${e}' ${o} sending request:`,r),l.send(t,"POST",u,i,15)})}P_(e,t,i){let r=$A(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=PM(),a=RM(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;let u=s.join("");Le(Ki,`Creating RPC '${e}' stream ${r}: ${u}`,c);let d=o.createWebChannel(u,c);this.T_(d);let h=!1,p=!1,g=new XA({Ho:m=>{p?Le(Ki,`Not sending because RPC '${e}' stream ${r} is closed:`,m):(h||(Le(Ki,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),Le(Ki,`RPC '${e}' stream ${r} sending:`,m),d.send(m))},Yo:()=>d.close()}),y=(m,_,I)=>{m.listen(_,M=>{try{I(M)}catch(C){setTimeout(()=>{throw C},0)}})};return y(d,ch.EventType.OPEN,()=>{p||(Le(Ki,`RPC '${e}' stream ${r} transport opened.`),g.s_())}),y(d,ch.EventType.CLOSE,()=>{p||(p=!0,Le(Ki,`RPC '${e}' stream ${r} transport closed`),g.__(),this.I_(d))}),y(d,ch.EventType.ERROR,m=>{p||(p=!0,Ic(Ki,`RPC '${e}' stream ${r} transport errored. Name:`,m.name,"Message:",m.message),g.__(new Ne(ue.UNAVAILABLE,"The operation could not be completed")))}),y(d,ch.EventType.MESSAGE,m=>{var _;if(!p){let I=m.data[0];an(!!I,16349);let M=I,C=M?.error||((_=M[0])===null||_===void 0?void 0:_.error);if(C){Le(Ki,`RPC '${e}' stream ${r} received error:`,C);let P=C.status,N=(function(b){let E=oi[b];if(E!==void 0)return h3(E)})(P),S=C.message;N===void 0&&(N=ue.INTERNAL,S="Unknown error status: "+P+" with message "+C.message),p=!0,g.__(new Ne(N,S)),d.close()}else Le(Ki,`RPC '${e}' stream ${r} received:`,I),g.a_(I)}}),y(a,DM.STAT_EVENT,m=>{m.stat===C0.PROXY?Le(Ki,`RPC '${e}' stream ${r} detected buffering proxy`):m.stat===C0.NOPROXY&&Le(Ki,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{g.o_()},0),g}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function kM(){return typeof document<"u"?document:null}function yb(n){return new gA(n,!0)}var J0=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=i,this.E_=r,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-i);r>0&&Le("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var oB="PersistentStream",Q0=class{constructor(e,t,i,r,s,o,a,c){this.Fi=e,this.w_=i,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new J0(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return U(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return U(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return U(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(la(t.toString()),la("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.b_===t&&this.W_(i,r)},i=>{e(()=>{let r=new Ne(ue.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(r)})})}W_(e,t){let i=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.e_(()=>{i(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(r=>{i(()=>this.G_(r))}),this.stream.onMessage(r=>{i(()=>++this.C_==1?this.j_(r):this.onNext(r))})}O_(){this.state=5,this.F_.g_(()=>U(this,null,function*(){this.state=0,this.start()}))}G_(e){return Le(oB,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(Le(oB,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},KA=class extends Q0{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=SQ(this.serializer,e),i=(function(s){if(!("targetChange"in s))return It.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?It.min():o.readTime?fo(o.readTime):It.min()})(e);return this.listener.J_(t,i)}H_(e){let t={};t.database=bA(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=rA(c)?{documents:CQ(s,c)}:{query:MQ(s,c).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=f3(s,o.resumeToken);let l=_A(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(It.min())>0){a.readTime=$0(s,o.snapshotVersion.toTimestamp());let l=_A(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);let i=DQ(this.serializer,e);i&&(t.labels=i),this.k_(t)}Y_(e){let t={};t.database=bA(this.serializer),t.removeTarget=e,this.k_(t)}},ZA=class extends Q0{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return an(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,an(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){an(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=IQ(e.writeResults,e.commitTime),i=fo(e.commitTime);return this.listener.ta(i,t)}na(){let e={};e.database=bA(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>TQ(this.serializer,i))};this.k_(t)}};var JA=class{},QA=class extends JA{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new Ne(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,yA(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ne(ue.UNKNOWN,s.toString())})}Jo(e,t,i,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,yA(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ne(ue.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},eD=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(la(t),this._a=!1):Le("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var _u="RemoteStore",tD=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{i.enqueueAndForget(()=>U(this,null,function*(){yu(this)&&(Le(_u,"Restarting streams for network reachability change."),yield(function(c){return U(this,null,function*(){let l=wt(c);l.Ia.add(4),yield Vm(l),l.Aa.set("Unknown"),l.Ia.delete(4),yield vb(l)})})(this))}))}),this.Aa=new eD(i,r)}};function vb(n){return U(this,null,function*(){if(yu(n))for(let e of n.da)yield e(!0)})}function Vm(n){return U(this,null,function*(){for(let e of n.da)yield e(!1)})}function x3(n,e){let t=wt(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),BD(t)?UD(t):Oh(t).x_()&&VD(t,e))}function FD(n,e){let t=wt(n),i=Oh(t);t.Ta.delete(e),i.x_()&&S3(t,e),t.Ta.size===0&&(i.x_()?i.B_():yu(t)&&t.Aa.set("Unknown"))}function VD(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(It.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Oh(n).H_(e)}function S3(n,e){n.Ra.$e(e),Oh(n).Y_(e)}function UD(n){n.Ra=new mA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Oh(n).start(),n.Aa.aa()}function BD(n){return yu(n)&&!Oh(n).M_()&&n.Ta.size>0}function yu(n){return wt(n).Ia.size===0}function T3(n){n.Ra=void 0}function qQ(n){return U(this,null,function*(){n.Aa.set("Online")})}function XQ(n){return U(this,null,function*(){n.Ta.forEach((e,t)=>{VD(n,e)})})}function YQ(n,e){return U(this,null,function*(){T3(n),BD(n)?(n.Aa.la(e),UD(n)):n.Aa.set("Unknown")})}function KQ(n,e,t){return U(this,null,function*(){if(n.Aa.set("Online"),e instanceof G0&&e.state===2&&e.cause)try{yield(function(r,s){return U(this,null,function*(){let o=s.cause;for(let a of s.targetIds)r.Ta.has(a)&&(yield r.remoteSyncer.rejectListen(a,o),r.Ta.delete(a),r.Ra.removeTarget(a))})})(n,e)}catch(i){Le(_u,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield eb(n,i)}else if(e instanceof ph?n.Ra.Ye(e):e instanceof j0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(It.min()))try{let i=yield w3(n.localStore);t.compareTo(i)>=0&&(yield(function(s,o){let a=s.Ra.Pt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.Ta.get(l);u&&s.Ta.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.Ta.get(c);if(!u)return;s.Ta.set(c,u.withResumeToken(Zi.EMPTY_BYTE_STRING,u.snapshotVersion)),S3(s,c);let d=new Nm(u.target,c,l,u.sequenceNumber);VD(s,d)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t))}catch(i){Le(_u,"Failed to raise snapshot:",i),yield eb(n,i)}})}function eb(n,e,t){return U(this,null,function*(){if(!Nh(e))throw e;n.Ia.add(1),yield Vm(n),n.Aa.set("Offline"),t||(t=()=>w3(n.localStore)),n.asyncQueue.enqueueRetryable(()=>U(null,null,function*(){Le(_u,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield vb(n)}))})}function I3(n,e){return e().catch(t=>eb(n,t,e))}function bb(n){return U(this,null,function*(){let e=wt(n),t=Mc(e),i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:ID;for(;ZQ(e);)try{let r=yield jQ(e.localStore,i);if(r===null){e.Pa.length===0&&t.B_();break}i=r.batchId,JQ(e,r)}catch(r){yield eb(e,r)}C3(e)&&M3(e)})}function ZQ(n){return yu(n)&&n.Pa.length<10}function JQ(n,e){n.Pa.push(e);let t=Mc(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function C3(n){return yu(n)&&!Mc(n).M_()&&n.Pa.length>0}function M3(n){Mc(n).start()}function QQ(n){return U(this,null,function*(){Mc(n).na()})}function eee(n){return U(this,null,function*(){let e=Mc(n);for(let t of n.Pa)e.X_(t.mutations)})}function tee(n,e,t){return U(this,null,function*(){let i=n.Pa.shift(),r=dA.from(i,e,t);yield I3(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield bb(n)})}function nee(n,e){return U(this,null,function*(){e&&Mc(n).Z_&&(yield(function(i,r){return U(this,null,function*(){if((function(o){return _Q(o)&&o!==ue.ABORTED})(r.code)){let s=i.Pa.shift();Mc(i).N_(),yield I3(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield bb(i)}})})(n,e)),C3(n)&&M3(n)})}function aB(n,e){return U(this,null,function*(){let t=wt(n);t.asyncQueue.verifyOperationInProgress(),Le(_u,"RemoteStore received new credentials");let i=yu(t);t.Ia.add(3),yield Vm(t),i&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield vb(t)})}function iee(n,e){return U(this,null,function*(){let t=wt(n);e?(t.Ia.delete(2),yield vb(t)):e||(t.Ia.add(2),yield Vm(t),t.Aa.set("Unknown"))})}function Oh(n){return n.Va||(n.Va=(function(t,i,r){let s=wt(t);return s.ia(),new KA(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:qQ.bind(null,n),e_:XQ.bind(null,n),n_:YQ.bind(null,n),J_:KQ.bind(null,n)}),n.da.push(e=>U(null,null,function*(){e?(n.Va.N_(),BD(n)?UD(n):n.Aa.set("Unknown")):(yield n.Va.stop(),T3(n))}))),n.Va}function Mc(n){return n.ma||(n.ma=(function(t,i,r){let s=wt(t);return s.ia(),new ZA(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:QQ.bind(null,n),n_:nee.bind(null,n),ea:eee.bind(null,n),ta:tee.bind(null,n)}),n.da.push(e=>U(null,null,function*(){e?(n.ma.N_(),yield bb(n)):(yield n.ma.stop(),n.Pa.length>0&&(Le(_u,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var nD=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new aa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,a=new n(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function zD(n,e){if(la("AsyncQueue",`${e}: ${n}`),Nh(n))return new Ne(ue.UNAVAILABLE,`${e}: ${n}`);throw n}var tb=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||it.comparator(t.key,i.key):(t,i)=>it.comparator(t.key,i.key),this.keyedMap=Em(),this.sortedSet=new Wn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var nb=class{constructor(){this.fa=new Wn(it.comparator)}track(e){let t=e.doc.key,i=this.fa.get(t);i?e.type!==0&&i.type===3?this.fa=this.fa.insert(t,e):e.type===3&&i.type!==1?this.fa=this.fa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.fa=this.fa.remove(t):e.type===1&&i.type===2?this.fa=this.fa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):at(63341,{At:e,ga:i}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,i)=>{e.push(i)}),e}},Ih=class n{constructor(e,t,i,r,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,tb.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var iD=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},rD=class{constructor(){this.queries=cB(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,i){let r=wt(t),s=r.queries;r.queries=cB(),s.forEach((o,a)=>{for(let c of a.wa)c.onError(i)})})(this,new Ne(ue.ABORTED,"Firestore shutting down"))}};function cB(){return new ha(n=>e3(n),gb)}function ree(n,e){return U(this,null,function*(){let t=wt(n),i=3,r=e.query,s=t.queries.get(r);s?!s.Sa()&&e.ba()&&(i=2):(s=new iD,i=e.ba()?0:1);try{switch(i){case 0:s.ya=yield t.onListen(r,!0);break;case 1:s.ya=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){let a=zD(o,`Initialization of query '${uh(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&HD(t)})}function see(n,e){return U(this,null,function*(){let t=wt(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?r=e.ba()?0:1:!s.Sa()&&e.ba()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function oee(n,e){let t=wt(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let a of o.wa)a.Ca(r)&&(i=!0);o.ya=r}}i&&HD(t)}function aee(n,e,t){let i=wt(n),r=i.queries.get(e);if(r)for(let s of r.wa)s.onError(t);i.queries.delete(e)}function HD(n){n.Da.forEach(e=>{e.next()})}var sD,lB;(lB=sD||(sD={})).Fa="default",lB.Cache="cache";var oD=class{constructor(e,t,i){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ih(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let i=t!=="Offline";return(!this.options.ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Ih.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==sD.Cache}};var ib=class{constructor(e){this.key=e}},rb=class{constructor(e){this.key=e}},aD=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=zt(),this.mutatedKeys=zt(),this.Xa=t3(e),this.eu=new tb(this.Xa)}get tu(){return this.Ha}nu(e,t){let i=t?t.ru:new nb,r=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,d)=>{let h=r.get(u),p=_b(this.query,d)?d:null,g=!!h&&this.mutatedKeys.has(h.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations),m=!1;h&&p?h.data.isEqual(p.data)?g!==y&&(i.track({type:3,doc:p}),m=!0):this.iu(h,p)||(i.track({type:2,doc:p}),m=!0,(c&&this.Xa(p,c)>0||l&&this.Xa(p,l)<0)&&(a=!0)):!h&&p?(i.track({type:0,doc:p}),m=!0):h&&!p&&(i.track({type:1,doc:h}),m=!0,(c||l)&&(a=!0)),m&&(p?(o=o.add(p),s=y?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{eu:o,ru:i,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((u,d)=>(function(p,g){let y=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at(20277,{At:m})}};return y(p)-y(g)})(u.type,d.type)||this.Xa(u.doc,d.doc)),this.su(i),r=r!=null&&r;let a=t&&!r?this.ou():[],c=this.Za.size===0&&this.current&&!r?1:0,l=c!==this.Ya;return this.Ya=c,o.length!==0||l?{snapshot:new Ih(this.query,e.eu,s,o,e.mutatedKeys,c===0,l,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new nb,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=zt(),this.eu.forEach(i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))});let t=[];return e.forEach(i=>{this.Za.has(i)||t.push(new rb(i))}),this.Za.forEach(i=>{e.has(i)||t.push(new ib(i))}),t}uu(e){this.Ha=e.qs,this.Za=zt();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Ih.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},jD="SyncEngine",cD=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},lD=class{constructor(e){this.key=e,this.lu=!1}},uD=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new ha(a=>e3(a),gb),this.Tu=new Map,this.Iu=new Set,this.du=new Wn(it.comparator),this.Eu=new Map,this.Au=new km,this.Ru={},this.Vu=new Map,this.mu=Om.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function cee(n,e,t=!0){return U(this,null,function*(){let i=O3(n),r,s=i.Pu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.cu()):r=yield A3(i,e,t,!0),r})}function lee(n,e){return U(this,null,function*(){let t=O3(n);yield A3(t,e,!0,!1)})}function A3(n,e,t,i){return U(this,null,function*(){let r=yield GQ(n.localStore,ho(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return i&&(a=yield uee(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&x3(n.remoteStore,r),a})}function uee(n,e,t,i,r){return U(this,null,function*(){n.gu=(d,h,p)=>(function(y,m,_,I){return U(this,null,function*(){let M=m.view.nu(_);M.Ds&&(M=yield rB(y.localStore,m.query,!1).then(({documents:S})=>m.view.nu(S,M)));let C=I&&I.targetChanges.get(m.targetId),P=I&&I.targetMismatches.get(m.targetId)!=null,N=m.view.applyChanges(M,y.isPrimaryClient,C,P);return dB(y,m.targetId,N._u),N.snapshot})})(n,d,h,p);let s=yield rB(n.localStore,e,!0),o=new aD(e,s.qs),a=o.nu(s.documents),c=Pm.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),l=o.applyChanges(a,n.isPrimaryClient,c);dB(n,t,l._u);let u=new cD(e,t,o);return n.Pu.set(e,u),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),l.snapshot})}function dee(n,e,t){return U(this,null,function*(){let i=wt(n),r=i.Pu.get(e),s=i.Tu.get(r.targetId);if(s.length>1)return i.Tu.set(r.targetId,s.filter(o=>!gb(o,e))),void i.Pu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield jA(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&FD(i.remoteStore,r.targetId),dD(i,r.targetId)}).catch(Ph))):(dD(i,r.targetId),yield jA(i.localStore,r.targetId,!0))})}function hee(n,e){return U(this,null,function*(){let t=wt(n),i=t.Pu.get(e),r=t.Tu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),FD(t.remoteStore,i.targetId))})}function fee(n,e,t){return U(this,null,function*(){let i=bee(n);try{let r=yield(function(o,a){let c=wt(o),l=Gn.now(),u=a.reduce((p,g)=>p.add(g.key),zt()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=fa(),y=zt();return c.Os.getEntries(p,u).next(m=>{g=m,g.forEach((_,I)=>{I.isValidDocument()||(y=y.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,g)).next(m=>{d=m;let _=[];for(let I of a){let M=gQ(I,d.get(I.key).overlayedDocument);M!=null&&_.push(new mo(I.key,M,qB(M.value.mapValue),ca.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,_,a)}).next(m=>{h=m;let _=m.applyToLocalDocumentSet(d,y);return c.documentOverlayCache.saveOverlays(p,m.batchId,_)})}).then(()=>({batchId:h.batchId,changes:i3(d)}))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,c){let l=o.Ru[o.currentUser.toKey()];l||(l=new Wn(Ot)),l=l.insert(a,c),o.Ru[o.currentUser.toKey()]=l})(i,r.batchId,t),yield Um(i,r.changes),yield bb(i.remoteStore)}catch(r){let s=zD(r,"Failed to persist write");t.reject(s)}})}function D3(n,e){return U(this,null,function*(){let t=wt(n);try{let i=yield zQ(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.Eu.get(s);o&&(an(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.lu=!0:r.modifiedDocuments.size>0?an(o.lu,14607):r.removedDocuments.size>0&&(an(o.lu,42227),o.lu=!1))}),yield Um(t,i,e)}catch(i){yield Ph(i)}})}function uB(n,e,t){let i=wt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Pu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&r.push(a.snapshot)}),(function(o,a){let c=wt(o);c.onlineState=a;let l=!1;c.queries.forEach((u,d)=>{for(let h of d.wa)h.va(a)&&(l=!0)}),l&&HD(c)})(i.eventManager,e),r.length&&i.hu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function pee(n,e,t){return U(this,null,function*(){let i=wt(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Eu.get(e),s=r&&r.key;if(s){let o=new Wn(it.comparator);o=o.insert(s,Cs.newNoDocument(s,It.min()));let a=zt().add(s),c=new H0(It.min(),new Map,new Wn(Ot),o,a);yield D3(i,c),i.du=i.du.remove(s),i.Eu.delete(e),GD(i)}else yield jA(i.localStore,e,!1).then(()=>dD(i,e,t)).catch(Ph)})}function mee(n,e){return U(this,null,function*(){let t=wt(n),i=e.batch.batchId;try{let r=yield BQ(t.localStore,e);P3(t,i,null),R3(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Um(t,r)}catch(r){yield Ph(r)}})}function gee(n,e,t){return U(this,null,function*(){let i=wt(n);try{let r=yield(function(o,a){let c=wt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(an(d!==null,37113),u=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})})(i.localStore,e);P3(i,e,t),R3(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Um(i,r)}catch(r){yield Ph(r)}})}function R3(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function P3(n,e,t){let i=wt(n),r=i.Ru[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ru[i.currentUser.toKey()]=r}}function dD(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Tu.get(e))n.Pu.delete(i),t&&n.hu.pu(i,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(i=>{n.Au.containsKey(i)||N3(n,i)})}function N3(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(FD(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),GD(n))}function dB(n,e,t){for(let i of t)i instanceof ib?(n.Au.addReference(i.key,e),_ee(n,i)):i instanceof rb?(Le(jD,"Document no longer in limbo: "+i.key),n.Au.removeReference(i.key,e),n.Au.containsKey(i.key)||N3(n,i.key)):at(19791,{yu:i})}function _ee(n,e){let t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Iu.has(i)||(Le(jD,"New document in limbo: "+t),n.Iu.add(i),GD(n))}function GD(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new it(Rn.fromString(e)),i=n.mu.next();n.Eu.set(i,new lD(t)),n.du=n.du.insert(t,i),x3(n.remoteStore,new Nm(ho(ND(t.path)),i,"TargetPurposeLimboResolution",TD.ue))}}function Um(n,e,t){return U(this,null,function*(){let i=wt(n),r=[],s=[],o=[];i.Pu.isEmpty()||(i.Pu.forEach((a,c)=>{o.push(i.gu(c,e,t).then(l=>{var u;if((l||t)&&i.isPrimaryClient){let d=l?!l.fromCache:(u=t?.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){r.push(l);let d=UA.Es(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),i.hu.J_(r),yield(function(c,l){return U(this,null,function*(){let u=wt(c);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>he.forEach(l,h=>he.forEach(h.Is,p=>u.persistence.referenceDelegate.addReference(d,h.targetId,p)).next(()=>he.forEach(h.ds,p=>u.persistence.referenceDelegate.removeReference(d,h.targetId,p)))))}catch(d){if(!Nh(d))throw d;Le(LD,"Failed to update sequence numbers: "+d)}for(let d of l){let h=d.targetId;if(!d.fromCache){let p=u.Fs.get(h),g=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(g);u.Fs=u.Fs.insert(h,y)}}})})(i.localStore,s))})}function yee(n,e){return U(this,null,function*(){let t=wt(n);if(!t.currentUser.isEqual(e)){Le(jD,"User change. New user:",e.toKey());let i=yield E3(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(a=>{a.forEach(c=>{c.reject(new Ne(ue.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Um(t,i.Bs)}})}function vee(n,e){let t=wt(n),i=t.Eu.get(e);if(i&&i.lu)return zt().add(i.key);{let r=zt(),s=t.Tu.get(e);if(!s)return r;for(let o of s){let a=t.Pu.get(o);r=r.unionWith(a.view.tu)}return r}}function O3(n){let e=wt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=D3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vee.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pee.bind(null,e),e.hu.J_=oee.bind(null,e.eventManager),e.hu.pu=aee.bind(null,e.eventManager),e}function bee(n){let e=wt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mee.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gee.bind(null,e),e}var k3=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return U(this,null,function*(){this.serializer=yb(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,i){return null}Fu(t,i){return null}vu(t){return UQ(this.persistence,new zA,t.initialUser,this.serializer)}Du(t){return new X0(VA.Vi,this.serializer)}bu(t){return new GA}terminate(){return U(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),hD=class extends k3{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){an(this.persistence.referenceDelegate instanceof Y0,46915);let i=this.persistence.referenceDelegate.garbageCollector;return new TA(i,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?rs.withCacheSize(this.cacheSizeBytes):rs.DEFAULT;return new X0(i=>Y0.Vi(i,t),this.serializer)}};var Eee=(()=>{class n{initialize(t,i){return U(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>uB(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yee.bind(null,this.syncEngine),yield iee(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return(function(){return new rD})()}createDatastore(t){let i=yb(t.databaseInfo.databaseId),r=(function(o){return new YA(o)})(t.databaseInfo);return(function(o,a,c,l){return new QA(o,a,c,l)})(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return(function(r,s,o,a,c){return new tD(r,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,i=>uB(this.syncEngine,i,0),(function(){return Z0.C()?new Z0:new WA})())}createSyncEngine(t,i){return(function(s,o,a,c,l,u,d){let h=new uD(s,o,a,c,l,u);return d&&(h.fu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return U(this,null,function*(){var t,i;yield(function(s){return U(this,null,function*(){let o=wt(s);Le(_u,"RemoteStore shutting down."),o.Ia.add(5),yield Vm(o),o.Ea.shutdown(),o.Aa.set("Unknown")})})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var fD=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):la("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ac="FirestoreClient",pD=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Ti.UNAUTHENTICATED,this.clientId=Im.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>U(this,null,function*(){Le(Ac,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(Le(Ac,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new aa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>U(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=zD(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function LM(n,e){return U(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),Le(Ac,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>U(null,null,function*(){i.isEqual(r)||(yield E3(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>{Ic("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{Le("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(r=>{Ic("Terminating Firestore due to IndexedDb database deletion failed",r)})}),n._offlineComponents=e})}function hB(n,e){return U(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield wee(n);Le(Ac,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>aB(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>aB(e.remoteStore,r)),n._onlineComponents=e})}function wee(n){return U(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Le(Ac,"Using user provided OfflineComponentProvider");try{yield LM(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ue.FAILED_PRECONDITION||r.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Ic("Error using user provided cache. Falling back to memory cache: "+t),yield LM(n,new k3)}}else Le(Ac,"Using default OfflineComponentProvider"),yield LM(n,new hD(void 0));return n._offlineComponents})}function L3(n){return U(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(Le(Ac,"Using user provided OnlineComponentProvider"),yield hB(n,n._uninitializedComponentsProvider._online)):(Le(Ac,"Using default OnlineComponentProvider"),yield hB(n,new Eee))),n._onlineComponents})}function xee(n){return L3(n).then(e=>e.syncEngine)}function fB(n){return U(this,null,function*(){let e=yield L3(n),t=e.eventManager;return t.onListen=cee.bind(null,e.syncEngine),t.onUnlisten=dee.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=lee.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=hee.bind(null,e.syncEngine),t})}function F3(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var pB=new Map;var V3="firestore.googleapis.com",mB=!0,sb=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=V3,this.ssl=mB}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:mB;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=b3;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<LQ)throw new Ne(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OJ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=F3((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ne(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ne(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ne(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ch=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ne(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new FM;switch(i.type){case"firstParty":return new zM(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ne(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return U(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let i=pB.get(t);i&&(Le("ComponentProvider","Removing Datastore"),pB.delete(t),i.terminate())})(this),Promise.resolve()}};function U3(n,e,t,i={}){var r;n=Ec(n,Ch);let s=dc(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(t0(`https://${c}`),n0("Firestore",!0)),o.host!==V3&&o.host!==c&&Ic("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:i});if(!oo(l,a)&&(n._setSettings(l),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Ti.MOCK_USER;else{u=K2(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new Ne(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ti(h)}n._authCredentials=new VM(new O0(u,d))}}var Mh=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ki=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Fm(t,n._jsonSchema))return new n(e,i||null,new it(Rn.fromString(t.referencePath)))}};ki._jsonSchemaVersion="firestore/documentReference/1.0",ki._jsonSchema={type:li("string",ki._jsonSchemaVersion),referencePath:li("string")};var wc=class n extends Mh{constructor(e,t,i){super(e,t,ND(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ki(this.firestore,null,new it(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function B3(n,e,...t){if(n=pi(n),xB("collection","path",e),n instanceof Ch){let i=Rn.fromString(e,...t);return PU(i),new wc(n,null,i)}{if(!(n instanceof ki||n instanceof wc))throw new Ne(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Rn.fromString(e,...t));return PU(i),new wc(n.firestore,null,i)}}function kh(n,e,...t){if(n=pi(n),arguments.length===1&&(e=Im.newId()),xB("doc","path",e),n instanceof Ch){let i=Rn.fromString(e,...t);return RU(i),new ki(n,null,new it(i))}{if(!(n instanceof ki||n instanceof wc))throw new Ne(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Rn.fromString(e,...t));return RU(i),new ki(n.firestore,n instanceof wc?n.converter:null,new it(i))}}var gB="AsyncQueue",ob=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new J0(this,"async_queue_retry"),this.oc=()=>{let i=kM();i&&Le(gB,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=e;let t=kM();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=kM();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new aa;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return U(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Nh(e))throw e;Le(gB,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(i=>{throw this.tc=i,this.nc=!1,la("INTERNAL UNHANDLED ERROR: ",_B(i)),i}).then(i=>(this.nc=!1,i))));return this._c=t,t}enqueueAfterDelay(e,t,i){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let r=nD.createAndSchedule(this,e,t,i,s=>this.lc(s));return this.ec.push(r),r}ac(){this.tc&&at(47125,{hc:_B(this.tc)})}verifyOperationInProgress(){}Pc(){return U(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function _B(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function yB(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1})(n,["next","error","complete"])}var Dc=class extends Ch{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new ob,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return U(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ob(e),this._firestoreClient=void 0,yield e}})}};function z3(n,e){let t=typeof n=="object"?n:Ql(),i=typeof n=="string"?n:e||U0,r=ih(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=Y2("firestore");s&&U3(r,...s)}return r}function H3(n){if(n._terminated)throw new Ne(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||See(n),n._firestoreClient}function See(n){var e,t,i;let r=n._freezeSettings(),s=(function(a,c,l,u){return new $M(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,F3(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new pD(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}})(n._componentsProvider))}var xc=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Zi.fromBase64String(e))}catch(t){throw new Ne(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Zi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fm(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};xc._jsonSchemaVersion="firestore/bytes/1.0",xc._jsonSchema={type:li("string",xc._jsonSchemaVersion),bytes:li("string")};var Ah=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ne(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Dh=class{constructor(e){this._methodName=e}};var Sc=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ne(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ne(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ot(this._lat,e._lat)||Ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Fm(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Sc._jsonSchemaVersion="firestore/geoPoint/1.0",Sc._jsonSchema={type:li("string",Sc._jsonSchemaVersion),latitude:li("number"),longitude:li("number")};var Tc=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fm(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new Ne(ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Tc._jsonSchemaVersion="firestore/vectorValue/1.0",Tc._jsonSchema={type:li("string",Tc._jsonSchemaVersion),vectorValues:li("object")};var Tee=/^__.*__$/,mD=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new mo(e,this.data,this.fieldMask,t,this.fieldTransforms):new gu(e,this.data,t,this.fieldTransforms)}},ab=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new mo(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function j3(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at(40011,{Ec:n})}}var gD=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.fc(e),r}gc(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return lb(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(j3(this.Ec)&&Tee.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},_D=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||yb(e)}Dc(e,t,i,r=!1){return new gD({Ec:e,methodName:t,bc:i,path:Ur.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function WD(n){let e=n._freezeSettings(),t=yb(n._databaseId);return new _D(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Iee(n,e,t,i,r,s={}){let o=n.Dc(s.merge||s.mergeFields?2:0,e,t,r);$D("Data must be an object, but it was:",o,i);let a=G3(i,o),c,l;if(s.merge)c=new ss(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=vD(e,d,t);if(!o.contains(h))throw new Ne(ue.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);$3(u,h)||u.push(h)}c=new ss(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new mD(new Vr(a),c,l)}var cb=class n extends Dh{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var yD=class n extends Dh{_toFieldTransform(e){return new aA(e.path,new fu)}isEqual(e){return e instanceof n}};function Cee(n,e,t,i){let r=n.Dc(1,e,t);$D("Data must be an object, but it was:",r,i);let s=[],o=Vr.empty();Rc(i,(c,l)=>{let u=qD(e,c,t);l=pi(l);let d=r.gc(u);if(l instanceof cb)s.push(u);else{let h=Bm(l,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new ss(s);return new ab(o,a,r.fieldTransforms)}function Mee(n,e,t,i,r,s){let o=n.Dc(1,e,t),a=[vD(e,i,t)],c=[r];if(s.length%2!=0)throw new Ne(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(vD(e,s[h])),c.push(s[h+1]);let l=[],u=Vr.empty();for(let h=a.length-1;h>=0;--h)if(!$3(l,a[h])){let p=a[h],g=c[h];g=pi(g);let y=o.gc(p);if(g instanceof cb)l.push(p);else{let m=Bm(g,y);m!=null&&(l.push(p),u.set(p,m))}}let d=new ss(l);return new ab(u,d,o.fieldTransforms)}function Aee(n,e,t,i=!1){return Bm(t,n.Dc(i?4:3,e))}function Bm(n,e){if(W3(n=pi(n)))return $D("Unsupported field value:",e,n),G3(n,e);if(n instanceof Dh)return(function(i,r){if(!j3(r.Ec))throw r.wc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.wc(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(i,r){let s=[],o=0;for(let a of i){let c=Bm(a,r.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=pi(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return dQ(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=Gn.fromDate(i);return{timestampValue:$0(r.serializer,s)}}if(i instanceof Gn){let s=new Gn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:$0(r.serializer,s)}}if(i instanceof Sc)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof xc)return{bytesValue:f3(r.serializer,i._byteString)};if(i instanceof ki){let s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kD(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Tc)return(function(o,a){return{mapValue:{fields:{[MD]:{stringValue:AD},[yh]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.wc("VectorValues must only contain numeric values.");return OD(a.serializer,l)})}}}}}})(i,r);throw r.wc(`Unsupported field value: ${fb(i)}`)})(n,e)}function G3(n,e){let t={};return UB(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rc(n,(i,r)=>{let s=Bm(r,e.Vc(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function W3(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Gn||n instanceof Sc||n instanceof xc||n instanceof ki||n instanceof Dh||n instanceof Tc)}function $D(n,e,t){if(!W3(t)||!SB(t)){let i=fb(t);throw i==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+i)}}function vD(n,e,t){if((e=pi(e))instanceof Ah)return e._internalPath;if(typeof e=="string")return qD(n,e);throw lb("Field path arguments must be of type string or ",n,!1,void 0,t)}var Dee=new RegExp("[~\\*/\\[\\]]");function qD(n,e,t){if(e.search(Dee)>=0)throw lb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ah(...e.split("."))._internalPath}catch{throw lb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lb(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Ne(ue.INVALID_ARGUMENT,a+n+c)}function $3(n,e){return n.some(t=>t.isEqual(e))}var ub=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ki(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new bD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(XD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},bD=class extends ub{data(){return super.data()}};function XD(n,e){return typeof e=="string"?qD(n,e):e instanceof Ah?e._internalPath:e._delegate._internalPath}function Ree(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ne(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Lm=class{},ED=class extends Lm{};function q3(n,e,...t){let i=[];e instanceof Lm&&i.push(e),i=i.concat(t),(function(s){let o=s.filter(c=>c instanceof wD).length,a=s.filter(c=>c instanceof db).length;if(o>1||o>0&&a>0)throw new Ne(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(let r of i)n=r._apply(n);return n}var db=class n extends ED{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return Y3(e._query,t),new Mh(e.firestore,e.converter,sA(e._query,t))}_parse(e){let t=WD(e.firestore);return(function(s,o,a,c,l,u,d){let h;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ne(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){bB(d,u);let g=[];for(let y of d)g.push(vB(c,s,y));h={arrayValue:{values:g}}}else h=vB(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||bB(d,u),h=Aee(a,o,d,u==="in"||u==="not-in");return ci.create(l,u,h)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function X3(n,e,t){let i=e,r=XD("where",n);return db._create(r,i,t)}var wD=class n extends Lm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ms.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r,a=s.getFlattenedFilters();for(let c of a)Y3(o,c),o=sA(o,c)})(e._query,t),new Mh(e.firestore,e.converter,sA(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function vB(n,e,t){if(typeof(t=pi(t))=="string"){if(t==="")throw new Ne(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!QB(e)&&t.indexOf("/")!==-1)throw new Ne(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Rn.fromString(t));if(!it.isDocumentKey(i))throw new Ne(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return UU(n,new it(i))}if(t instanceof ki)return UU(n,t._key);throw new Ne(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fb(t)}.`)}function bB(n,e){if(!Array.isArray(n)||n.length===0)throw new Ne(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Y3(n,e){let t=(function(r,s){for(let o of r)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ne(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ne(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var xD=class{convertValue(e,t="none"){switch(Cc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(da(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw at(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Rc(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t[yh].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>Dn(o.doubleValue));return new Tc(s)}convertGeoPoint(e){return new Sc(Dn(e.latitude),Dn(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=mb(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Am(e));default:return null}}convertTimestamp(e){let t=ua(e);return new Gn(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Rn.fromString(e);an(v3(i),9688,{name:e});let r=new B0(i.get(1),i.get(3)),s=new it(i.popFirst(5));return r.isEqual(t)||la(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Pee(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var cu=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},lu=class n extends ub{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(XD("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};lu._jsonSchemaVersion="firestore/documentSnapshot/1.0",lu._jsonSchema={type:li("string",lu._jsonSchemaVersion),bundleSource:li("string","DocumentSnapshot"),bundleName:li("string"),bundle:li("string")};var mh=class extends lu{data(e={}){return super.data(e)}},gh=class n{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new cu(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new mh(this._firestore,this._userDataWriter,i.key,i,new cu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ne(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{let c=new mh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cu(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new mh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cu(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Nee(a.type),doc:c,oldIndex:l,newIndex:u}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Im.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],i=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function Nee(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at(61501,{type:n})}}gh._jsonSchemaVersion="firestore/querySnapshot/1.0",gh._jsonSchema={type:li("string",gh._jsonSchemaVersion),bundleSource:li("string","QuerySnapshot"),bundleName:li("string"),bundle:li("string")};var hb=class extends xD{constructor(e){super(),this.firestore=e}convertBytes(e){return new xc(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ki(this.firestore,null,t)}};function Eb(n,e,t,...i){n=Ec(n,ki);let r=Ec(n.firestore,Dc),s=WD(r),o;return o=typeof(e=pi(e))=="string"||e instanceof Ah?Mee(s,"updateDoc",n._key,e,t,i):Cee(s,"updateDoc",n._key,e),KD(r,[o.toMutation(n._key,ca.exists(!0))])}function wb(n){return KD(Ec(n.firestore,Dc),[new Rm(n._key,ca.none())])}function K3(n,e){let t=Ec(n.firestore,Dc),i=kh(n),r=Pee(n.converter,e);return KD(t,[Iee(WD(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,ca.exists(!1))]).then(()=>i)}function YD(n,...e){var t,i,r;n=pi(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||yB(e[o])||(s=e[o++]);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(yB(e[o])){let d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,l,u;if(n instanceof ki)l=Ec(n.firestore,Dc),u=ND(n._key.path),c={next:d=>{e[o]&&e[o](Oee(l,n,d))},error:e[o+1],complete:e[o+2]};else{let d=Ec(n,Mh);l=Ec(d.firestore,Dc),u=d._query;let h=new hb(l);c={next:p=>{e[o]&&e[o](new gh(l,h,d,p))},error:e[o+1],complete:e[o+2]},Ree(n._query)}return(function(h,p,g,y){let m=new fD(y),_=new oD(p,m,g);return h.asyncQueue.enqueueAndForget(()=>U(null,null,function*(){return ree(yield fB(h),_)})),()=>{m.Ou(),h.asyncQueue.enqueueAndForget(()=>U(null,null,function*(){return see(yield fB(h),_)}))}})(H3(l),u,a,c)}function KD(n,e){return(function(i,r){let s=new aa;return i.asyncQueue.enqueueAndForget(()=>U(null,null,function*(){return fee(yield xee(i),r,s)})),s.promise})(H3(n),e)}function Oee(n,e,t){let i=t.docs.get(e._key),r=new hb(n);return new lu(n,r,e._key,i,new cu(t.hasPendingWrites,t.fromCache),e.converter)}function Z3(){return new yD("serverTimestamp")}(function(e,t=!0){(function(r){Rh=r})(fc),Ts(new fr("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),a=new Dc(new UM(i.getProvider("auth-internal")),new HM(o,i.getProvider("app-check-internal")),(function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ne(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new B0(l.options.projectId,u)})(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),jn(CU,MU,e),jn(CU,MU,"esm2017")})();var xb=function(){return xb=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},xb.apply(this,arguments)};var Fee={includeMetadataChanges:!1};function J3(n,e){return e===void 0&&(e=Fee),new bt(function(t){var i=YD(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:i}})}function Q3(n,e){var t;e===void 0&&(e={});var i=n.data(e);return!n.exists()||typeof i!="object"||i===null||!e.idField?i:xb(xb({},i),(t={},t[e.idField]=n.id,t))}function ez(n){return J3(n,{includeMetadataChanges:!0}).pipe(gt(function(e){return e.docs}))}function tz(n,e){return e===void 0&&(e={}),ez(n).pipe(gt(function(t){return t.map(function(i){return Q3(i,e)})}))}var pa=class{constructor(e){return e}},nz="firestore",ZD=class{constructor(){return sh(nz)}};var JD=new Re("angularfire2.firestore-instances");function Vee(n,e){let t=lm(nz,n,e);return t&&new pa(t)}function Uee(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new pa(i)}}var Bee={provide:ZD,deps:[[new Nr,JD]]},zee={provide:pa,useFactory:Vee,deps:[[new Nr,JD],na]};function iz(n,...e){return jn("angularfire",pc.full,"fst"),or([zee,Bee,{provide:JD,useFactory:Uee(n),multi:!0,deps:[Bt,Nn,mc,tu,[new Nr,vm],[new Nr,oh],...e]}])}var zm=pr(tz,!0);var Sb=pr(K3,!0,2);var vu=pr(B3,!0,2);var rz=pr(wb,!0,2);var QD=pr(kh,!0,2);var sz=pr(z3,!0);var Hm=pr(q3,!0,2);var oz=pr(Eb,!0,2);var jm=pr(X3,!0,2);var wr=class n{constructor(e){this.firestore=e;this.getUserInfo()}test;collectionName="AetheraUsers";connectedUser=null;tempAvatarPreview=Kn(null);getUserInfo(){let e=sessionStorage.getItem("email");e&&(this.getUserByEmail(e).subscribe(t=>{this.connectedUser=t[0],console.log("connectedUser",this.connectedUser),this.tempAvatarPreview.set(t[0].profilePic),this.test=t[0]}),console.log("constructor"),this.connectedUser={username:"null1",email:"null",password:"null",bio:"null",role:"null"})}addUser(e){let t=vu(this.firestore,this.collectionName);return Sb(t,e)}getUserByEmail(e){console.log("looking for : ",e);let t=vu(this.firestore,this.collectionName),i=Hm(t,jm("email","==",e));return zm(i,{idField:"id"})}editUser(e){if(e.id===void 0)return console.error("Cannot update user: Document ID is missing."),Promise.reject("Cannot Update a Document with no ID");{let i=kh(this.firestore,this.collectionName,e.id),t=e,{id:r}=t,s=Ix(t,["id"]);return console.log(s),Eb(i,ae({},s))}}deleteUser(e){let t=kh(this.firestore,`${this.collectionName}/${e}`);return wb(t)}toggleGameLike(e){return U(this,null,function*(){if(!this.connectedUser||!this.connectedUser.id)return;let t=this.connectedUser.likedGames||[],i=t.indexOf(e);i>-1?t.splice(i,1):t.push(e),yield this.editUser(je(ae({},this.connectedUser),{likedGames:t}))})}static \u0275fac=function(t){return new(t||n)(Qe(pa))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};var Pc=class n{games=[];http=ie(Gd);fb=ie(wr);constructor(){this.http.get("https://raw.githubusercontent.com/xAgesx/Aethera_Games_File/refs/heads/main/Games_list.json").subscribe({next:e=>{this.games=e,console.log("Games loaded:",this.games)}})}getAllGames(){let e=this.fb.connectedUser?.likedGames||[];return this.games.map(t=>je(ae({},t),{liked:e.includes(t.id)}))}getGameById(e){return this.games.find(t=>t.id===e)}getAllTags(){let e=[];for(let t of this.games)for(let i of t.tags)e.includes(i)||e.push(i);return e}toggleLike(e){return U(this,null,function*(){yield this.fb.toggleGameLike(e)})}getLikedGames(){return this.getAllGames().filter(e=>e.liked)}addGame(e){let t=je(ae({},e),{id:this.games.length?Math.max(...this.games.map(i=>i.id))+1:1,liked:!1});return this.games.push(t),t}updateGame(e){let t=this.games.findIndex(i=>i.id===e.id);if(t!==-1)return this.games[t]=ae(ae({},this.games[t]),e),this.games[t]}deleteGame(e){this.games=this.games.filter(t=>t.id!==e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};var gz=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(Ue(vs),Ue(es))};static \u0275dir=An({type:n})}return n})(),i1=(()=>{class n extends gz{static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275dir=An({type:n,features:[br]})}return n})(),Uh=new Re("");var Gee={provide:Uh,useExisting:Rr(()=>go),multi:!0};function Wee(){let n=ts()?ts().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var $ee=new Re(""),go=(()=>{class n extends gz{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Wee())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(Ue(vs),Ue(es),Ue($ee,8))};static \u0275dir=An({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&Pe("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},standalone:!1,features:[to([Gee]),br]})}return n})();function qee(n){return n==null||Xee(n)===0}function Xee(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var r1=new Re(""),_z=new Re("");function Yee(n){return qee(n.value)?{required:!0}:null}function az(n){return null}function yz(n){return n!=null}function vz(n){return jo(n)?Pn(n):n}function bz(n){let e={};return n.forEach(t=>{e=t!=null?ae(ae({},e),t):e}),Object.keys(e).length===0?null:e}function Ez(n,e){return e.map(t=>t(n))}function Kee(n){return!n.validate}function wz(n){return n.map(e=>Kee(e)?e:t=>e.validate(t))}function Zee(n){if(!n)return null;let e=n.filter(yz);return e.length==0?null:function(t){return bz(Ez(t,e))}}function s1(n){return n!=null?Zee(wz(n)):null}function Jee(n){if(!n)return null;let e=n.filter(yz);return e.length==0?null:function(t){let i=Ez(t,e).map(vz);return Xx(i).pipe(gt(bz))}}function o1(n){return n!=null?Jee(wz(n)):null}function cz(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Qee(n){return n._rawValidators}function ete(n){return n._rawAsyncValidators}function t1(n){return n?Array.isArray(n)?n:[n]:[]}function Ib(n,e){return Array.isArray(n)?n.includes(e):n===e}function lz(n,e){let t=t1(e);return t1(n).forEach(r=>{Ib(t,r)||t.push(r)}),t}function uz(n,e){return t1(e).filter(t=>!Ib(n,t))}var Cb=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=s1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=o1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Vh=class extends Cb{name;get formDirective(){return null}get path(){return null}},bu=class extends Cb{_parent=null;name=null;valueAccessor=null},Mb=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},tte={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},HPe=je(ae({},tte),{"[class.ng-submitted]":"isSubmitted"}),Oc=(()=>{class n extends Mb{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(Ue(bu,2))};static \u0275dir=An({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&yn("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[br]})}return n})(),Nb=(()=>{class n extends Mb{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(Ue(Vh,10))};static \u0275dir=An({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&yn("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[br]})}return n})();var Gm="VALID",Tb="INVALID",Lh="PENDING",Wm="DISABLED",Nc=class{},Ab=class extends Nc{value;source;constructor(e,t){super(),this.value=e,this.source=t}},qm=class extends Nc{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Xm=class extends Nc{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Fh=class extends Nc{status;source;constructor(e,t){super(),this.status=e,this.source=t}},n1=class extends Nc{source;constructor(e){super(),this.source=e}},Db=class extends Nc{source;constructor(e){super(),this.source=e}};function xz(n){return(Ob(n)?n.validators:n)||null}function nte(n){return Array.isArray(n)?s1(n):n||null}function Sz(n,e){return(Ob(e)?e.asyncValidators:n)||null}function ite(n){return Array.isArray(n)?o1(n):n||null}function Ob(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function rte(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new we(1e3,"");if(!i[t])throw new we(1001,"")}function ste(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new we(1002,"")})}var Rb=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return fi(this.statusReactive)}set status(e){fi(()=>this.statusReactive.set(e))}_status=Vd(()=>this.statusReactive());statusReactive=Kn(void 0);get valid(){return this.status===Gm}get invalid(){return this.status===Tb}get pending(){return this.status==Lh}get disabled(){return this.status===Wm}get enabled(){return this.status!==Wm}errors;get pristine(){return fi(this.pristineReactive)}set pristine(e){fi(()=>this.pristineReactive.set(e))}_pristine=Vd(()=>this.pristineReactive());pristineReactive=Kn(!0);get dirty(){return!this.pristine}get touched(){return fi(this.touchedReactive)}set touched(e){fi(()=>this.touchedReactive.set(e))}_touched=Vd(()=>this.touchedReactive());touchedReactive=Kn(!1);get untouched(){return!this.touched}_events=new ti;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(lz(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(lz(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(uz(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(uz(e,this._rawAsyncValidators))}hasValidator(e){return Ib(this._rawValidators,e)}hasAsyncValidator(e){return Ib(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(je(ae({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Xm(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Xm(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(je(ae({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new qm(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new qm(!0,i))}markAsPending(e={}){this.status=Lh;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Fh(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(je(ae({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wm,this.errors=null,this._forEachChild(r=>{r.disable(je(ae({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ab(this.value,i)),this._events.next(new Fh(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(je(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Gm,this._forEachChild(i=>{i.enable(je(ae({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(je(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Gm||this.status===Lh)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ab(this.value,t)),this._events.next(new Fh(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(je(ae({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wm:Gm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Lh,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=vz(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Fh(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new _n,this.statusChanges=new _n}_calculateStatus(){return this._allControlsDisabled()?Wm:this.errors?Tb:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Lh)?Lh:this._anyControlsHaveStatus(Tb)?Tb:Gm}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new qm(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Xm(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ob(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=nte(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=ite(this._rawAsyncValidators)}},Pb=class extends Rb{constructor(e,t,i){super(xz(t),Sz(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){ste(this,!0,e),Object.keys(e).forEach(i=>{rte(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Db(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var a1=new Re("",{providedIn:"root",factory:()=>c1}),c1="always";function ote(n,e){return[...e.path,n]}function Tz(n,e,t=c1){Iz(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),cte(n,e),ute(n,e),lte(n,e),ate(n,e)}function dz(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function ate(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Iz(n,e){let t=Qee(n);e.validator!==null?n.setValidators(cz(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=ete(n);e.asyncValidator!==null?n.setAsyncValidators(cz(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();dz(e._rawValidators,r),dz(e._rawAsyncValidators,r)}function cte(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Cz(n,e)})}function lte(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Cz(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Cz(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function ute(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function dte(n,e){n==null,Iz(n,e)}function hte(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function fte(n){return Object.getPrototypeOf(n.constructor)===i1}function pte(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function mte(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(s=>{s.constructor===go?t=s:fte(s)?i=s:r=s}),r||i||t||null}var gte={provide:Vh,useExisting:Rr(()=>Ym)},$m=Promise.resolve(),Ym=(()=>{class n extends Vh{callSetDisabledState;get submitted(){return fi(this.submittedReactive)}_submitted=Vd(()=>this.submittedReactive());submittedReactive=Kn(!1);_directives=new Set;form;ngSubmit=new _n;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new Pb({},s1(t),o1(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){$m.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Tz(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){$m.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){$m.then(()=>{let i=this._findContainer(t.path),r=new Pb({});dte(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){$m.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){$m.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),pte(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new n1(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(Ue(r1,10),Ue(_z,10),Ue(a1,8))};static \u0275dir=An({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&Pe("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[to([gte]),br]})}return n})();function hz(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function fz(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var _te=class extends Rb{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(xz(t),Sz(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ob(t)&&(t.nonNullable||t.initialValueIsDefault)&&(fz(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Db(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hz(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hz(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){fz(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var yte={provide:bu,useExisting:Rr(()=>ma)},pz=Promise.resolve(),ma=(()=>{class n extends bu{_changeDetectorRef;callSetDisabledState;control=new _te;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new _n;constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=mte(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),hte(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Tz(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){pz.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&av(i);pz.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?ote(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(Ue(Vh,9),Ue(r1,10),Ue(_z,10),Ue(Uh,10),Ue(zl,8),Ue(a1,8))};static \u0275dir=An({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[to([yte]),br,Xs]})}return n})();var kb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=An({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var vte={provide:Uh,useExisting:Rr(()=>Bh),multi:!0};function Mz(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function bte(n){return n.split(":")[0]}var Bh=(()=>{class n extends i1{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=ie(Go).injector;destroyRef=ie(Qr);cdr=ie(zl);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,Yy({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=Mz(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=bte(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275dir=An({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&Pe("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[to([vte]),br]})}return n})(),Lb=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Mz(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(Ue(es),Ue(vs),Ue(Bh,9))};static \u0275dir=An({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),Ete={provide:Uh,useExisting:Rr(()=>Az),multi:!0};function mz(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function wte(n){return n.split(":")[0]}var Az=(()=>{class n extends i1{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],s=i.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let c=o[a],l=this._getOptionValue(c.value);r.push(l)}}else{let o=i.options;for(let a=0;a<o.length;a++){let c=o[a];if(c.selected){let l=this._getOptionValue(c.value);r.push(l)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=wte(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275dir=An({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&Pe("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[to([Ete]),br]})}return n})(),Fb=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(mz(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(mz(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(Ue(es),Ue(vs),Ue(Az,9))};static \u0275dir=An({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var xte=(()=>{class n{_validator=az;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):az,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=An({type:n,features:[Xs]})}return n})();var Ste={provide:r1,useExisting:Rr(()=>Km),multi:!0};var Km=(()=>{class n extends xte{required;inputName="required";normalizeInput=av;createValidator=t=>Yee;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=zo(n)))(r||n)}})();static \u0275dir=An({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&iv("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[to([Ste]),br]})}return n})();var Tte=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=bs({type:n});static \u0275inj=qr({})}return n})();var kc=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:a1,useValue:t.callSetDisabledState??c1}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=bs({type:n});static \u0275inj=qr({imports:[Tte]})}return n})();var zh=class n{firestore=ie(pa);collectionPath="AetheraReviews";getReviewsByGameId(e){let t=vu(this.firestore,this.collectionPath),i=Hm(t,jm("gameId","==",e));return zm(i,{idField:"id"}).pipe(gt(r=>r.map(o=>je(ae({},o),{createdAt:o.createdAt instanceof Gn?o.createdAt.toDate():o.createdAt})).sort((o,a)=>{let c=o.createdAt?.getTime()||0;return(a.createdAt?.getTime()||0)-c})))}addReview(e){return U(this,null,function*(){let t=vu(this.firestore,this.collectionPath),i=je(ae({},e),{upvotes:[],createdAt:Z3()});yield Sb(t,i)})}updateReview(e,t){return U(this,null,function*(){let i=QD(this.firestore,this.collectionPath,e);yield oz(i,t)})}deleteReview(e){return U(this,null,function*(){let t=QD(this.firestore,this.collectionPath,e);yield rz(t)})}getReviewsByUserEmail(e){let t=vu(this.firestore,this.collectionPath),i=Hm(t,jm("userEmail","==",e));return zm(i,{idField:"id"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};var _o=class n{constructor(e){this.router=e}notification=Kn({message:"",type:null});redirect(e){this.router.navigate([e])}showNotification(e,t){this.notification.set({message:t,type:e}),setTimeout(()=>{this.notification.set({message:"",type:null})},5e3)}static \u0275fac=function(t){return new(t||n)(Qe(Yi))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};function Ite(n,e){n&1&&(cr(),F(0,"svg",11),Ce(1,"polyline",12),B())}function Cte(n,e){n&1&&(cr(),F(0,"svg",11),Ce(1,"circle",13)(2,"line",14)(3,"line",15),B())}function Mte(n,e){if(n&1){let t=rn();F(0,"div",3)(1,"div",4)(2,"div",5),lt(3,Ite,2,0,"svg",6)(4,Cte,4,0,"svg",6),B(),F(5,"div",7)(6,"p",8),j(7),B()(),F(8,"button",9),Pe("click",function(){Ze(t);let r=xe();return Je(r.mainService.notification.set({message:"",type:null}))}),j(9,"\xD7"),B(),Ce(10,"div",10),B()()}if(n&2){let t=xe();yn("show",t.mainService.notification().type),$(),ye("ngClass",t.mainService.notification().type),$(2),ye("ngIf",t.mainService.notification().type==="success"),$(),ye("ngIf",t.mainService.notification().type==="error"),$(3),ft(t.mainService.notification().message)}}function Ate(n,e){if(n&1&&Ce(0,"img",52),n&2){let t=e.$implicit,i=e.index,r=xe(3);yn("active",i===r.currentSlide),ye("src",t,Ys)}}function Dte(n,e){if(n&1){let t=rn();F(0,"div",46),lt(1,Ate,1,3,"img",47),F(2,"button",48),Pe("click",function(){Ze(t);let r=xe(2);return Je(r.changeSlide(-1))}),Ce(3,"i",49),B(),F(4,"button",50),Pe("click",function(){Ze(t);let r=xe(2);return Je(r.changeSlide(1))}),Ce(5,"i",51),B()()}if(n&2){let t=xe(2);$(),ye("ngForOf",t.game.images)}}function Rte(n,e){if(n&1){let t=rn();F(0,"div",53)(1,"div",54),Ce(2,"img",55),F(3,"span"),j(4,"Reviewing as "),F(5,"strong"),j(6),B()()(),F(7,"div",56)(8,"label"),j(9,"Rating: "),B(),F(10,"select",57),$o("ngModelChange",function(r){Ze(t);let s=xe(2);return oc(s.rating,r)||(s.rating=r),Je(r)}),F(11,"option",58),j(12,"5 - Excellent"),B(),F(13,"option",58),j(14,"4 - Great"),B(),F(15,"option",58),j(16,"3 - Good"),B(),F(17,"option",58),j(18,"2 - Fair"),B(),F(19,"option",58),j(20,"1 - Poor"),B()()(),F(21,"textarea",59),$o("ngModelChange",function(r){Ze(t);let s=xe(2);return oc(s.newReviewContent,r)||(s.newReviewContent=r),Je(r)}),B(),F(22,"button",60),Pe("click",function(){Ze(t);let r=xe(2);return Je(r.submitReview())}),j(23,"Post Review"),B()()}if(n&2){let t=xe(2);$(2),ye("src",t.firebaseService.connectedUser.profilePic||"https://api.dicebear.com/7.x/avataaars/svg?seed=fallback",Ys),$(4),ft(t.firebaseService.connectedUser.username),$(4),Wo("ngModel",t.rating),$(),ye("value",5),$(2),ye("value",4),$(2),ye("value",3),$(2),ye("value",2),$(2),ye("value",1),$(2),Wo("ngModel",t.newReviewContent),$(),ye("disabled",!t.newReviewContent.trim())}}function Pte(n,e){if(n&1){let t=rn();F(0,"div",75)(1,"button",76),Pe("click",function(){Ze(t);let r=xe().$implicit,s=xe(2);return Je(s.startEdit(r))}),Ce(2,"i",77),j(3,"Edit"),B(),F(4,"button",78),Pe("click",function(){Ze(t);let r=xe().$implicit,s=xe(2);return Je(s.deleteReview(r.id))}),Ce(5,"i",79),j(6,"Delete"),B()()}}function Nte(n,e){if(n&1){let t=rn();F(0,"div")(1,"textarea",80),$o("ngModelChange",function(r){Ze(t);let s=xe(3);return oc(s.editContent,r)||(s.editContent=r),Je(r)}),B(),F(2,"div",81)(3,"button",82),Pe("click",function(){Ze(t);let r=xe().$implicit,s=xe(2);return Je(s.saveEdit(r.id))}),j(4,"Save"),B(),F(5,"button",83),Pe("click",function(){Ze(t);let r=xe(3);return Je(r.cancelEdit())}),j(6,"Cancel"),B()()()}if(n&2){let t=xe(3);$(),Wo("ngModel",t.editContent)}}function Ote(n,e){if(n&1&&(F(0,"p",84),j(1),B()),n&2){let t=xe().$implicit;$(),ft(t.content)}}function kte(n,e){if(n&1){let t=rn();F(0,"div",61)(1,"div",62)(2,"div",63),Ce(3,"img",64),F(4,"span",65),j(5),B()(),F(6,"div",66)(7,"span",67),j(8),B(),lt(9,Pte,7,0,"div",68),B()(),F(10,"div",69),lt(11,Nte,7,1,"div",70)(12,Ote,2,1,"ng-template",null,0,dI),B(),F(14,"div",71)(15,"span",72),j(16),qo(17,"date"),B(),F(18,"button",73),Pe("click",function(){let r=Ze(t).$implicit,s=xe(2);return Je(s.toggleUpvote(r))}),Ce(19,"i",74),j(20),B()()()}if(n&2){let t=e.$implicit,i=qi(13),r=xe(2);$(3),ye("src",t.photoURL||"https://api.dicebear.com/7.x/avataaars/svg?seed="+t.username,Ys),$(2),ft(t.username),$(3),vn("",t.rating," \u2605"),$(),ye("ngIf",t.userEmail===(r.firebaseService.connectedUser==null?null:r.firebaseService.connectedUser.email)),$(2),ye("ngIf",r.editingReviewId===t.id)("ngIfElse",i),$(5),ft(Ep(17,10,t.createdAt,"mediumDate")),$(2),yn("voted",t.upvotes.includes((r.firebaseService.connectedUser==null?null:r.firebaseService.connectedUser.email)||"")),$(2),vn(" ",t.upvotes.length||0," ")}}function Lte(n,e){n&1&&(F(0,"div",85),j(1," No reviews yet. Be the first to share your experience! "),B())}function Fte(n,e){if(n&1&&(F(0,"span",89),j(1),B()),n&2){let t=e.$implicit;$(),ft(t)}}function Vte(n,e){if(n&1&&(F(0,"div",86)(1,"h2"),j(2,"Game Tags"),B(),F(3,"div",87),lt(4,Fte,2,1,"span",88),B()()),n&2){let t=xe(2);$(4),ye("ngForOf",t.game.tags)}}function Ute(n,e){if(n&1&&(F(0,"div",90)(1,"h2"),j(2,"Top Score"),B(),F(3,"div",91)(4,"span",92),j(5),B(),F(6,"span",93),j(7),B()()()),n&2){let t=xe(2);$(5),ft(t.game.topScore),$(2),vn("by ",t.game.topPlayer||"Elite User")}}function Bte(n,e){if(n&1){let t=rn();F(0,"div",16)(1,"button",17),Pe("click",function(){Ze(t);let r=xe();return Je(r.goBack())}),Ce(2,"i",18),j(3," Back to Browse "),B(),F(4,"header",19)(5,"div",20)(6,"h1"),j(7),B(),F(8,"p",21),j(9),B(),F(10,"div",22)(11,"span",23),Ce(12,"i",24),j(13),B(),F(14,"span",25),j(15,"|"),B(),F(16,"span",26)(17,"strong"),j(18),B(),j(19," Players "),B()()(),F(20,"div",27)(21,"button",28),Pe("click",function(){Ze(t);let r=xe();return Je(r.toggleLike())}),Ce(22,"i",29),j(23),B(),F(24,"button",30),Pe("click",function(){Ze(t);let r=xe();return Je(r.loadGame())}),Ce(25,"i",31),j(26," Play Now "),B()()(),F(27,"div",32)(28,"div",33),lt(29,Dte,6,1,"div",34),F(30,"div",35)(31,"h2"),j(32,"Overview"),B(),F(33,"p"),j(34),B()(),F(35,"div",36)(36,"h2"),j(37,"Community Reviews"),B(),lt(38,Rte,24,10,"div",37),F(39,"div",38),lt(40,kte,21,13,"div",39),qo(41,"async"),lt(42,Lte,2,0,"div",40),qo(43,"async"),B()()(),F(44,"aside",41),lt(45,Vte,5,1,"div",42),F(46,"div",43)(47,"h2"),j(48,"Game Info"),B(),F(49,"ul",44)(50,"li")(51,"span"),j(52,"Release:"),B(),F(53,"span"),j(54),B()(),F(55,"li")(56,"span"),j(57,"Developer:"),B(),F(58,"span"),j(59),B()(),F(60,"li")(61,"span"),j(62,"Duration:"),B(),F(63,"span"),j(64),B()(),F(65,"li")(66,"span"),j(67,"Complexity:"),B(),F(68,"span"),j(69),B()()()(),lt(70,Ute,8,2,"div",45),B()()()}if(n&2){let t,i=xe();$(7),ft(i.game.title),$(2),ft(i.game.description),$(4),vn(" ",i.game.rating||"N/A"," "),$(5),ft(i.game.players||"0"),$(3),yn("liked",i.game.liked),$(2),vn(" ",i.game.liked?"Liked":"Like"," "),$(6),ye("ngIf",i.game.images&&i.game.images.length>0),$(5),ft(i.game.longDescription||"No additional details available."),$(4),ye("ngIf",i.firebaseService.connectedUser),$(2),ye("ngForOf",Fd(41,18,i.reviews$)),$(2),ye("ngIf",((t=Fd(43,20,i.reviews$))==null?null:t.length)===0),$(3),ye("ngIf",i.game.tags.length),$(9),ft(i.game.release||"N/A"),$(5),ft(i.game.developer||"Unknown"),$(5),ft(i.game.duration||"N/A"),$(5),ft(i.game.complexity||"N/A"),$(),ye("ngIf",i.game.topScore)}}var Bb=class n{constructor(e){this.mainService=e}route=ie(so);router=ie(Yi);gameService=ie(Pc);reviewsService=ie(zh);firebaseService=ie(wr);game;reviews$;newReviewContent="";rating=5;currentSlide=0;editingReviewId=null;editContent="";ngOnInit(){let e=Number(this.route.snapshot.paramMap.get("id")),t=this.gameService.getGameById(e);if(!t){this.router.navigate(["/browse"]);return}this.game=t,this.reviews$=this.reviewsService.getReviewsByGameId(e),setTimeout(()=>this.loadGameData(e),100)}loadGameData(e){let t=this.gameService.getGameById(e);if(t){let i=this.firebaseService.connectedUser?.likedGames||[];this.game=je(ae({},t),{liked:i.includes(e)})}}submitReview(){let e=this.firebaseService.connectedUser;if(!this.newReviewContent.trim()||!this.game||!e||e.email==="null")return;let t={gameId:this.game.id,content:this.newReviewContent,rating:this.rating,username:e.username||"Aethera Explorer",userEmail:e.email,photoURL:e.profilePic||null,upvotes:[]};this.reviewsService.addReview(t).then(()=>{this.newReviewContent="",this.rating=5}),this.mainService.showNotification("success","Review posted successfully!")}startEdit(e){this.editingReviewId=e.id||null,this.editContent=e.content}cancelEdit(){this.editingReviewId=null,this.editContent=""}saveEdit(e){this.editContent.trim()&&(this.reviewsService.updateReview(e,{content:this.editContent}).then(()=>{this.editingReviewId=null}),this.mainService.showNotification("success","Review updated."))}toggleUpvote(e){let t=this.firebaseService.connectedUser?.email;if(!t||t==="null")return;let i=e.upvotes||[];i.includes(t)?i=i.filter(r=>r!==t):i.push(t),this.reviewsService.updateReview(e.id,{upvotes:i})}deleteReview(e){this.reviewsService.deleteReview(e),this.mainService.showNotification("success","Review deleted.")}changeSlide(e){this.game?.images&&(this.currentSlide=(this.currentSlide+e+this.game.images.length)%this.game.images.length)}goBack(){this.router.navigate(["/browse"])}toggleLike(){this.game&&(this.gameService.toggleLike(this.game.id),this.game.liked=!this.game.liked)}loadGame(){this.game?.id==3&&this.router.navigate(["/dashGame"])}static \u0275fac=function(t){return new(t||n)(Ue(_o))};static \u0275cmp=kn({type:n,selectors:[["app-game-details"]],decls:2,vars:2,consts:[["viewMode",""],["class","notification-container",3,"show",4,"ngIf"],["class","details-container",4,"ngIf"],[1,"notification-container"],[1,"notification-popup",3,"ngClass"],[1,"notification-icon"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],[1,"notification-content"],[1,"notification-message"],[1,"notification-close",3,"click"],[1,"notification-progress"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","20 6 9 17 4 12"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],[1,"details-container"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],[1,"header-hero"],[1,"header-info"],[1,"short-desc"],[1,"stats-row"],[1,"rating"],[1,"fas","fa-star"],[1,"divider"],[1,"players"],[1,"actions"],[1,"like-btn",3,"click"],[1,"fas","fa-heart"],[1,"launch-button",3,"click"],[1,"fas","fa-play"],[1,"main-grid"],[1,"main-content"],["class","media-carousel",4,"ngIf"],[1,"card","overview-card"],[1,"card","reviews-section"],["class","add-review",4,"ngIf"],[1,"reviews-list"],["class","review-item",4,"ngFor","ngForOf"],["class","no-reviews",4,"ngIf"],[1,"sidebar-content"],["class","card tags-card",4,"ngIf"],[1,"card","info-card"],[1,"info-list"],["class","card community-score",4,"ngIf"],[1,"media-carousel"],["class","carousel-img",3,"src","active",4,"ngFor","ngForOf"],[1,"carousel-arrow","left",3,"click"],[1,"fas","fa-chevron-left"],[1,"carousel-arrow","right",3,"click"],[1,"fas","fa-chevron-right"],[1,"carousel-img",3,"src"],[1,"add-review"],[1,"user-meta"],[1,"mini-avatar",3,"src"],[1,"rating-input"],[1,"styled-select",3,"ngModelChange","ngModel"],[3,"value"],["placeholder","Write your thoughts about the game...",3,"ngModelChange","ngModel"],[1,"save-btn",3,"click","disabled"],[1,"review-item"],[1,"review-header"],[1,"user-info"],[1,"review-avatar",3,"src"],[1,"user"],[1,"header-right"],[1,"stars"],["class","action-btns",4,"ngIf"],[1,"review-body"],[4,"ngIf","ngIfElse"],[1,"review-footer"],[1,"date"],[1,"upvote-btn",3,"click"],[1,"fas","fa-thumbs-up"],[1,"action-btns"],[1,"edit-btn",3,"click"],[1,"fas","fa-edit"],[1,"del-btn",3,"click"],[1,"fas","fa-trash"],[1,"edit-area",3,"ngModelChange","ngModel"],[1,"edit-actions"],[1,"save-btn",3,"click"],[1,"cancel-btn",3,"click"],[1,"content"],[1,"no-reviews"],[1,"card","tags-card"],[1,"tag-container"],["class","tag",4,"ngFor","ngForOf"],[1,"tag"],[1,"card","community-score"],[1,"score-display"],[1,"points"],[1,"player"]],template:function(t,i){t&1&&lt(0,Mte,11,6,"div",1)(1,Bte,71,22,"div",2),t&2&&(ye("ngIf",i.mainService.notification().type),$(),ye("ngIf",i.game))},dependencies:[kc,Lb,Fb,go,Bh,Oc,ma,wi,ws,cc,dr,PI,Ap],styles:[".details-container[_ngcontent-%COMP%]{color:#e8ffe5;padding:2rem;background:transparent}.back-button[_ngcontent-%COMP%]{background:none;border:none;color:#a8ffc2;font-size:1rem;margin-bottom:1.5rem;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:color .2s}.back-button[_ngcontent-%COMP%]:hover{color:#00e676}.header-hero[_ngcontent-%COMP%]{background:#001e14b3;border:1px solid rgba(0,230,118,.2);border-radius:12px;padding:2rem;display:flex;flex-direction:column;gap:1.5rem;margin-bottom:2rem;box-shadow:0 0 20px #00e67626}@media (min-width: 768px){.header-hero[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;align-items:center}}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:.5rem;color:#00e676}.stats-row[_ngcontent-%COMP%]{display:flex;gap:1rem;color:#a8ffc2}.actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.like-btn[_ngcontent-%COMP%], .launch-button[_ngcontent-%COMP%]{padding:.8rem 1.5rem;border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s}.like-btn[_ngcontent-%COMP%]{background:#00e6761a;border:1px solid #00e676;color:#00e676}.like-btn.liked[_ngcontent-%COMP%]{background:#00e676;color:#001a14}.launch-button[_ngcontent-%COMP%]{background:#00e676;color:#001a14;border:none}.main-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:2rem}@media (min-width: 1024px){.main-grid[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr}}.card[_ngcontent-%COMP%]{background:#00140f99;border:1px solid rgba(0,230,118,.15);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}.card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00e676;font-size:1.25rem;margin-bottom:1rem}.media-carousel[_ngcontent-%COMP%]{position:relative;height:400px;border-radius:12px;overflow:hidden;margin-bottom:1.5rem}.carousel-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:none}.carousel-img.active[_ngcontent-%COMP%]{display:block}.carousel-arrow[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);background:#00000080;color:#fff;border:none;padding:1rem;cursor:pointer}.carousel-arrow.left[_ngcontent-%COMP%]{left:0}.carousel-arrow.right[_ngcontent-%COMP%]{right:0}.add-review[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid rgba(0,230,118,.1)}.add-review[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{background:#0000004d;border:1px solid rgba(0,230,118,.2);color:#fff;padding:1rem;border-radius:8px;min-height:100px;resize:none}.user-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.8rem;font-size:.9rem}.mini-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%}.review-item[_ngcontent-%COMP%]{padding:1.5rem 0;border-bottom:1px solid rgba(0,230,118,.05)}.review-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.8rem}.review-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:2px solid #00e676}.stars[_ngcontent-%COMP%]{background:#ffca281a;padding:4px 10px;border-radius:20px;float:right}.review-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;color:#a8ffc2;font-size:.85rem}.upvote-btn[_ngcontent-%COMP%]{background:none;border:1px solid rgba(0,230,118,.3);color:#00e676;padding:4px 10px;border-radius:20px;cursor:pointer;transition:.2s}.upvote-btn.voted[_ngcontent-%COMP%]{background:#00e676;color:#001a14}.action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#ff5252;cursor:pointer;padding:5px;opacity:.7}.action-btns[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]{color:#00e676}.action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.edit-area[_ngcontent-%COMP%]{width:100%;min-height:80px;background:#001a14;border:1px solid #00e676;color:#fff;padding:.5rem;border-radius:4px}.edit-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.save-btn[_ngcontent-%COMP%]{background:#00e676;color:#001a14;border:none;padding:4px 12px;border-radius:4px;cursor:pointer}.cancel-btn[_ngcontent-%COMP%]{background:#ff5252;color:#fff;border:none;padding:4px 12px;border-radius:4px;cursor:pointer}.tag-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.tag[_ngcontent-%COMP%]{background:#00e6761a;border:1px solid rgba(0,230,118,.3);color:#b8ffce;padding:.2rem .6rem;border-radius:12px;font-size:.8rem}.info-list[_ngcontent-%COMP%]{list-style:none;padding:0}.info-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;border-bottom:1px solid rgba(0,230,118,.05);color:#a8ffc2}"]})};var zte=["bgCanvas"],Zm=class n{bgCanvas;router=ie(Yi);renderer;scene;camera;spheres=[];starField;animationId;scrollPercent=0;targetScroll=0;onWindowScroll(){let e=window.pageYOffset||document.documentElement.scrollTop,t=document.documentElement.scrollHeight-document.documentElement.clientHeight;this.targetScroll=e/t}ngAfterViewInit(){if(typeof THREE>"u"){let e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js",e.onload=()=>{this.initScene(),this.animate()},document.head.appendChild(e)}else this.initScene(),this.animate()}ngOnDestroy(){this.animationId&&cancelAnimationFrame(this.animationId)}redirect(e){this.router.navigate([e])}initScene(){this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new THREE.WebGLRenderer({canvas:this.bgCanvas.nativeElement,antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio);let e=new THREE.BufferGeometry,t=5e3,i=new Float32Array(t*3);for(let r=0;r<t*3;r++)i[r]=(Math.random()-.5)*100;e.setAttribute("position",new THREE.BufferAttribute(i,3)),this.starField=new THREE.Points(e,new THREE.PointsMaterial({size:.05,color:65443,transparent:!0,opacity:.4})),this.scene.add(this.starField);for(let r=0;r<20;r++){let s=new THREE.IcosahedronGeometry(Math.random()*1.5,0),o=new THREE.Mesh(s,new THREE.MeshStandardMaterial({color:65443,wireframe:!0,transparent:!0,opacity:.2}));o.position.set((Math.random()-.5)*40,(Math.random()-.5)*40,-Math.random()*100),this.scene.add(o),this.spheres.push(o)}this.scene.add(new THREE.PointLight(65443,2,50)),this.scene.add(new THREE.AmbientLight(4210752)),window.addEventListener("resize",this.onResize.bind(this))}onResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}animate=()=>{this.animationId=requestAnimationFrame(this.animate),this.scrollPercent+=(this.targetScroll-this.scrollPercent)*.05,this.camera.position.z=5-this.scrollPercent*50,this.starField.rotation.y+=5e-4,this.spheres.forEach(e=>{e.rotation.x+=.01,e.rotation.y+=.01}),this.renderer.render(this.scene,this.camera)};static \u0275fac=function(t){return new(t||n)};static \u0275cmp=kn({type:n,selectors:[["app-landing"]],viewQuery:function(t,i){if(t&1&&Js(zte,7),t&2){let r;Qs(r=eo())&&(i.bgCanvas=r.first)}},hostBindings:function(t,i){t&1&&Pe("scroll",function(){return i.onWindowScroll()},kd)},decls:59,vars:14,consts:[["bgCanvas",""],[1,"landing-container"],[1,"bg-canvas"],[1,"scroll-section","hero"],[1,"content-wrapper"],[1,"title"],[1,"subtitle"],[1,"buttons"],[1,"btn","primary",3,"click"],[1,"btn","secondary",3,"click"],[1,"scroll-section"],[1,"content-wrapper","side-content"],[1,"feature-card","mega-card"],[1,"model-container"],["viewBox","0 0 400 400",1,"complex-svg"],[1,"orbit-group"],["cx","200","cy","200","r","140","fill","none","stroke","#00ffa3","stroke-width","1","stroke-dasharray","10 5"],["cx","200","cy","200","r","100","fill","none","stroke","#fff","stroke-width","0.5","opacity","0.3"],["cx","340","cy","200","r","6","fill","#00ffa3",1,"node-pulse"],["cx","60","cy","200","r","6","fill","#00ffa3",1,"node-pulse",2,"animation-delay","-1.5s"],["x","140","y","140","width","120","height","120","fill","none","stroke","#00ffa3","stroke-width","2",1,"spinning-box"],["x","165","y","165","width","70","height","70","fill","none","stroke","#fff","stroke-width","1",1,"spinning-box-alt"],[1,"card-text"],[1,"content-wrapper","side-content","right"],[1,"network-group"],["d","M200,60 L340,200 L200,340 L60,200 Z","fill","none","stroke","#00ffa3","stroke-width","1","stroke-dasharray","5 5"],[1,"node-group"],["cx","200","cy","60","r","8","fill","#fff",1,"node-pulse"],["cx","340","cy","200","r","8","fill","#00ffa3",1,"node-pulse",2,"animation-delay","-0.5s"],["cx","200","cy","340","r","8","fill","#00ffa3",1,"node-pulse",2,"animation-delay","-1s"],["cx","60","cy","200","r","8","fill","#00ffa3",1,"node-pulse",2,"animation-delay","-1.5s"],["x","160","y","160","width","80","height","80","transform","rotate(45 200 200)","fill","none","stroke","#fff","stroke-width","2",1,"spinning-box"],[1,"title-small"],[1,"scroll-indicator"],[1,"mouse"]],template:function(t,i){if(t&1){let r=rn();Zn(0,"div",1),Zs(1,"canvas",2,0),Zn(3,"section",3)(4,"div",4)(5,"h1",5),j(6,"AETHERA"),ri(),Zn(7,"p",6),j(8,"Discover Learning in Motion"),ri(),Zn(9,"div",7)(10,"button",8),Ld("click",function(){return Ze(r),Je(i.redirect("/browse"))}),j(11,"Explore Games"),ri(),Zn(12,"button",9),Ld("click",function(){return Ze(r),Je(i.redirect("auth"))}),j(13,"Get Started"),ri()()()(),Zn(14,"section",10)(15,"div",11)(16,"div",12)(17,"div",13),cr(),Zn(18,"svg",14)(19,"g",15),Zs(20,"circle",16)(21,"circle",17)(22,"circle",18)(23,"circle",19),ri(),Zs(24,"rect",20)(25,"rect",21),ri()(),Ol(),Zn(26,"div",22)(27,"h2"),j(28,"Interactive 3D"),ri(),Zn(29,"p"),j(30,"Experience education through high-fidelity simulations that react to your touch. Our models bridge the gap between abstract concepts and physical intuition."),ri()()()()(),Zn(31,"section",10)(32,"div",23)(33,"div",12)(34,"div",13),cr(),Zn(35,"svg",14)(36,"g",24),Zs(37,"path",25),Zn(38,"g",26),Zs(39,"circle",27)(40,"circle",28)(41,"circle",29)(42,"circle",30),ri(),Zs(43,"rect",31),ri()()(),Ol(),Zn(44,"div",22)(45,"h2"),j(46,"Adaptive Learning"),ri(),Zn(47,"p"),j(48,"Content that evolves with your progress. Our system mirrors your unique learning style in real-time to ensure the perfect level of challenge."),ri()()()()(),Zn(49,"section",10)(50,"div",4)(51,"h2",32),j(52,"Ready to begin?"),ri(),Zn(53,"button",8),Ld("click",function(){return Ze(r),Je(i.redirect("auth"))}),j(54,"Get Started Now"),ri()()(),Zn(55,"div",33)(56,"span"),j(57,"SCROLL"),ri(),Zs(58,"div",34),ri()()}t&2&&($(4),ur("opacity",1-i.scrollPercent*4),$(11),ur("opacity",i.scrollPercent>.2&&i.scrollPercent<.5?1:0)("transform","translateX("+(i.scrollPercent>.2?"0":"-50px")+")"),$(17),ur("opacity",i.scrollPercent>.5&&i.scrollPercent<.8?1:0)("transform","translateX("+(i.scrollPercent>.5?"0":"50px")+")"),$(18),ur("opacity",i.scrollPercent>.8?1:0),$(5),ur("opacity",1-i.scrollPercent*2))},styles:['.landing-container[_ngcontent-%COMP%]{position:relative;width:100%;background:#01110b;overflow-x:hidden;font-family:Poppins,sans-serif}.bg-canvas[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}.scroll-section[_ngcontent-%COMP%]{position:relative;height:100vh;width:100%;display:flex;align-items:center;justify-content:center;z-index:1}.content-wrapper[_ngcontent-%COMP%]{width:90%;max-width:1200px;text-align:center;padding:2rem;transition:all .8s cubic-bezier(.2,1,.3,1)}.side-content[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding-left:5%}.side-content.right[_ngcontent-%COMP%]{justify-content:flex-end;padding-right:5%}.mega-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4rem;background:#ffffff08;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:4rem;border-radius:20px;border:1px solid rgba(0,255,163,.1);text-align:left;width:100%;max-width:900px}.side-content.right[_ngcontent-%COMP%]   .mega-card[_ngcontent-%COMP%]{flex-direction:row-reverse;text-align:right}.model-container[_ngcontent-%COMP%]{flex-shrink:0;width:300px}.complex-svg[_ngcontent-%COMP%]{width:100%;filter:drop-shadow(0 0 15px rgba(0,255,163,.4))}.card-text[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.5rem;color:#fff;margin-bottom:1rem}.card-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;line-height:1.6;font-size:1.1rem}.title[_ngcontent-%COMP%]{font-size:5rem;font-weight:800;letter-spacing:.1em;background:linear-gradient(90deg,#00e676,#1de9b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 30px rgba(29,233,182,.3);margin-bottom:1rem}.title-small[_ngcontent-%COMP%]{font-size:3rem;color:#fff;margin-bottom:2rem}.subtitle[_ngcontent-%COMP%]{font-size:1.3rem;color:#b8ffce;margin-bottom:3rem;opacity:.9}.orbit-group[_ngcontent-%COMP%]{transform-origin:center;animation:_ngcontent-%COMP%_rotateRing 20s linear infinite}@keyframes _ngcontent-%COMP%_rotateRing{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinning-box[_ngcontent-%COMP%]{transform-origin:center;animation:_ngcontent-%COMP%_rotateBox 10s linear infinite}.spinning-box-alt[_ngcontent-%COMP%]{transform-origin:center;animation:_ngcontent-%COMP%_rotateBox 15s linear reverse infinite}@keyframes _ngcontent-%COMP%_rotateBox{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.node-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_coreGlow 3s infinite}@keyframes _ngcontent-%COMP%_coreGlow{0%,to{opacity:.4;r:6}50%{opacity:1;r:10;filter:blur(2px)}}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1.5rem}.btn[_ngcontent-%COMP%]{padding:.8rem 2.2rem;border-radius:30px;font-weight:500;font-size:1rem;letter-spacing:.05em;border:none;cursor:pointer;transition:all .3s ease}.btn.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00e676,#1de9b6);color:#01210f;box-shadow:0 0 20px #1de9b64d}.btn.secondary[_ngcontent-%COMP%]{background:transparent;border:1px solid #1de9b6;color:#b8ffce}.btn.primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 0 30px #1de9b699}.btn.secondary[_ngcontent-%COMP%]:hover{background:#1de9b61a;border-color:#00e676;color:#fff}.scroll-indicator[_ngcontent-%COMP%]{position:fixed;bottom:2rem;left:50%;transform:translate(-50%);display:flex;flex-direction:column;align-items:center;gap:1rem;z-index:10;color:#00ffa3;font-size:.8rem;letter-spacing:.5em;opacity:.6}.mouse[_ngcontent-%COMP%]{width:20px;height:35px;border:2px solid #00ffa3;border-radius:10px;position:relative}.mouse[_ngcontent-%COMP%]:after{content:"";position:absolute;top:5px;left:50%;width:4px;height:4px;background:#00ffa3;border-radius:50%;transform:translate(-50%);animation:_ngcontent-%COMP%_scrollMouse 2s infinite}@keyframes _ngcontent-%COMP%_scrollMouse{0%{transform:translate(-50%);opacity:0}50%{opacity:1}to{transform:translate(-50%,15px);opacity:0}}@media (max-width: 900px){.mega-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center;padding:2rem}.side-content.right[_ngcontent-%COMP%]   .mega-card[_ngcontent-%COMP%]{flex-direction:column}.model-container[_ngcontent-%COMP%]{width:200px}}']})};var Hte=["captchaWrapperElem"],zb=(()=>{class n{zone;scriptElemId="ngx-catpcha-script";windowGrecaptcha="grecaptcha";windowGrecaptchaEnterprise="enterprise";windowOnLoadCallbackProperty="ngx_captcha_onload_callback";windowOnLoadEnterpriseCallbackProperty="ngx_captcha_onload_enterprise_callback";globalDomain="recaptcha.net";defaultDomain="google.com";enterpriseApi="enterprise.js";defaultApi="api.js";constructor(t){this.zone=t}registerCaptchaScript(t,i,r,s){if(this.grecaptchaScriptLoaded(t.useEnterprise)){t.useEnterprise?this.zone.run(()=>{r(window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise])}):this.zone.run(()=>{r(window[this.windowGrecaptcha])});return}t.useEnterprise?window[this.getCallbackName(!0)]=()=>this.zone.run(r.bind(this,window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise])):window[this.getCallbackName(!1)]=()=>this.zone.run(r.bind(this,window[this.windowGrecaptcha]));let o=document.createElement("script");o.id=this.scriptElemId,o.innerHTML="",o.src=this.getCaptchaScriptUrl(t,i,s),o.async=!0,o.defer=!0,document.getElementsByTagName("head")[0].appendChild(o)}cleanup(){let t=document.getElementById(this.scriptElemId);t&&t.remove(),window[this.getCallbackName()]=void 0,window[this.windowGrecaptcha]=void 0}grecaptchaScriptLoaded(t){return!window[this.getCallbackName(t)]||!window[this.windowGrecaptcha]?!1:t&&window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise]?!0:!!window[this.windowGrecaptcha].execute}getCallbackName(t){return t?this.windowOnLoadEnterpriseCallbackProperty:this.windowOnLoadCallbackProperty}getLanguageParam(t){return t?`&hl=${t}`:""}getCaptchaScriptUrl(t,i,r){let s=t.useGlobalDomain?this.globalDomain:this.defaultDomain,o=t.useEnterprise?this.enterpriseApi:this.defaultApi,a=this.getCallbackName(t.useEnterprise);return`https://www.${s}/recaptcha/${o}?onload=${a}&render=${i}${this.getLanguageParam(r)}`}static \u0275fac=function(i){return new(i||n)(Qe(Bt))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jte=(()=>{class n{renderer;zone;injector;scriptService;captchaElemPrefix="ngx_captcha_id_";setupCaptcha=!0;siteKey;useGlobalDomain=!1;useEnterprise=!1;type="image";hl;tabIndex=0;success=new _n;load=new _n;reset=new _n;ready=new _n;error=new _n;expire=new _n;setupAfterLoad=!1;captchaElem;captchaId;currentResponse;resetCaptchaAfterSuccess=!1;onChange=t=>{};onTouched=t=>{};isLoaded=!1;reCaptchaApi;captchaElemId;control;constructor(t,i,r,s){this.renderer=t,this.zone=i,this.injector=r,this.scriptService=s}ngAfterViewInit(){this.control=this.injector.get(bu,void 0,{optional:!0})?.control}ngAfterViewChecked(){this.setupCaptcha&&(this.setupCaptcha=!1,this.setupComponent())}ngOnChanges(t){t&&t.hl&&!t.hl.firstChange&&t.hl.currentValue!==t.hl.previousValue&&this.scriptService.cleanup(),t&&t.useGlobalDomain&&!t.useGlobalDomain.firstChange&&t.useGlobalDomain.currentValue!==t.useGlobalDomain.previousValue&&this.scriptService.cleanup(),this.setupCaptcha=!0}getResponse(){return this.reCaptchaApi.getResponse(this.captchaId)}getCaptchaId(){return this.captchaId}resetCaptcha(){this.zone.run(()=>{this.reCaptchaApi.reset(),this.onChange(void 0),this.onTouched(void 0),this.reset.next()})}getCurrentResponse(){return this.currentResponse}reloadCaptcha(){this.setupComponent()}ensureCaptchaElem(t){let i=document.getElementById(t);if(!i)throw Error(`Captcha element with id '${t}' was not found`);this.captchaElem=i}renderReCaptcha(){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.captchaId=this.reCaptchaApi.render(this.captchaElemId,this.getCaptchaProperties()),this.ready.next()},0)})}handleCallback(t){this.currentResponse=t,this.success.next(t),this.zone.run(()=>{this.onChange(t),this.onTouched(t)}),this.resetCaptchaAfterSuccess&&this.resetCaptcha()}getPseudoUniqueNumber(){return new Date().getUTCMilliseconds()+Math.floor(Math.random()*9999)}setupComponent(){this.captchaSpecificSetup(),this.createAndSetCaptchaElem(),this.scriptService.registerCaptchaScript({useGlobalDomain:this.useGlobalDomain,useEnterprise:this.useEnterprise},"explicit",t=>{this.onloadCallback(t)},this.hl)}onloadCallback(t){if(this.reCaptchaApi=t,!this.reCaptchaApi)throw Error("ReCaptcha Api was not initialized correctly");this.isLoaded=!0,this.load.next(),this.renderReCaptcha(),this.setupAfterLoad&&(this.setupAfterLoad=!1,this.setupComponent())}generateNewElemId(){return this.captchaElemPrefix+this.getPseudoUniqueNumber()}createAndSetCaptchaElem(){if(this.captchaElemId=this.generateNewElemId(),!this.captchaElemId)throw Error("Captcha elem Id is not set");if(!this.captchaWrapperElem)throw Error("Captcha DOM element is not initialized");this.captchaWrapperElem.nativeElement.innerHTML="";let t=this.renderer.createElement("div");t.id=this.captchaElemId,this.renderer.appendChild(this.captchaWrapperElem.nativeElement,t),setTimeout(()=>{this.captchaElemId&&this.ensureCaptchaElem(this.captchaElemId)},0)}writeValue(t){}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}handleErrorCallback(){this.zone.run(()=>{this.onChange(void 0),this.onTouched(void 0)}),this.error.next()}handleExpireCallback(){this.expire.next(),this.resetCaptcha()}static \u0275fac=function(i){return new(i||n)(Ue(vs),Ue(Bt),Ue(Nn),Ue(zb))};static \u0275dir=An({type:n,inputs:{siteKey:"siteKey",useGlobalDomain:"useGlobalDomain",useEnterprise:"useEnterprise",type:"type",hl:"hl",tabIndex:"tabIndex"},outputs:{success:"success",load:"load",reset:"reset",ready:"ready",error:"error",expire:"expire"},features:[Xs]})}return n})(),Dz=(function(n){return n[n.InvisibleReCaptcha=0]="InvisibleReCaptcha",n[n.ReCaptcha2=1]="ReCaptcha2",n})(Dz||{});var Rz=(()=>{class n extends jte{renderer;zone;injector;scriptService;windowOnErrorCallbackProperty="ngx_captcha_error_callback";windowOnExpireCallbackProperty="ngx_captcha_expire_callback";theme="light";size="normal";captchaWrapperElem;recaptchaType=Dz.ReCaptcha2;constructor(t,i,r,s){super(t,i,r,s),this.renderer=t,this.zone=i,this.injector=r,this.scriptService=s}ngOnChanges(t){super.ngOnChanges(t)}ngOnDestroy(){window[this.windowOnErrorCallbackProperty]={},window[this.windowOnExpireCallbackProperty]={}}captchaSpecificSetup(){this.registerCallbacks()}getCaptchaProperties(){return{sitekey:this.siteKey,callback:t=>this.zone.run(()=>this.handleCallback(t)),"expired-callback":()=>this.zone.run(()=>this.handleExpireCallback()),"error-callback":()=>this.zone.run(()=>this.handleErrorCallback()),theme:this.theme,type:this.type,size:this.size,tabindex:this.tabIndex}}registerCallbacks(){window[this.windowOnErrorCallbackProperty]=super.handleErrorCallback.bind(this),window[this.windowOnExpireCallbackProperty]=super.handleExpireCallback.bind(this)}static \u0275fac=function(i){return new(i||n)(Ue(vs),Ue(Bt),Ue(Nn),Ue(zb))};static \u0275cmp=kn({type:n,selectors:[["ngx-recaptcha2"]],viewQuery:function(i,r){if(i&1&&Js(Hte,5),i&2){let s;Qs(s=eo())&&(r.captchaWrapperElem=s.first)}},inputs:{theme:"theme",size:"size"},standalone:!1,features:[to([{provide:Uh,useExisting:Rr(()=>n),multi:!0}]),br,Xs],decls:2,vars:0,consts:[["captchaWrapperElem",""]],template:function(i,r){i&1&&Ce(0,"div",null,0)},encapsulation:2})}return n})(),Gte=(()=>{class n{scriptService;zone;constructor(t,i){this.scriptService=t,this.zone=i}execute(t,i,r,s,o){this.executeAsPromise(t,i,s).then(r).catch(a=>o?o(a):console.error(a))}executeAsPromise(t,i,r){return new Promise((s,o)=>{let a=r||{},c=l=>{this.zone.runOutsideAngular(()=>{try{l.execute(t,{action:i}).then(u=>this.zone.run(()=>s(u)))}catch(u){o(u)}})};this.scriptService.registerCaptchaScript(a,t,c)})}static \u0275fac=function(i){return new(i||n)(Qe(zb),Qe(Bt))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pz=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=bs({type:n});static \u0275inj=qr({providers:[zb,Gte],imports:[wi]})}return n})();function $te(n,e){n&1&&(cr(),F(0,"svg",33),Ce(1,"polyline",34),B())}function qte(n,e){n&1&&(cr(),F(0,"svg",33),Ce(1,"circle",35)(2,"line",36)(3,"line",37),B())}function Xte(n,e){if(n&1&&(F(0,"div",25)(1,"div",26)(2,"div",27),lt(3,$te,2,0,"svg",28)(4,qte,4,0,"svg",28),B(),F(5,"div",29)(6,"p",30),j(7),B()(),F(8,"button",31),j(9,"\xD7"),B(),Ce(10,"div",32),B()()),n&2){let t=xe();yn("show",t.mainService.notification().type),$(),ye("ngClass",t.mainService.notification().type),$(2),ye("ngIf",t.mainService.notification().type==="success"),$(),ye("ngIf",t.mainService.notification().type==="error"),$(3),ft(t.mainService.notification().message)}}function Yte(n,e){if(n&1){let t=rn();F(0,"div",9)(1,"label"),j(2,"Confirm Password"),B(),F(3,"input",38),Pe("change",function(){Ze(t);let r=xe(),s=qi(10);return Je(r.verifForm(s))}),B()()}if(n&2){let t=xe();$(3),ye("type",t.passwordVisible?"text":"password")}}var Hb=class n{constructor(e,t,i,r){this.router=e;this.http=t;this.firebaseService=i;this.mainService=r}isLogin=!0;captchaToken=null;siteKey="6LfW0v8rAAAAADQg4SsG6OZrcyYq1IN2XqwcPKuR";passwordVisible=!1;password;ngOnInit(){this.passwordVisible=!1,window.handleGoogleCredentialResponse=this.handleGoogleCredentialResponse.bind(this)}handleGoogleCredentialResponse(e){if(e.credential){let t=e.credential;this.http.post("http://localhost/Backend/google-callback.php",{id_token:t}).subscribe({next:r=>{r.success?(console.log("Google login verified and successful!",r.user),this.router.navigate(["/layout"])):console.error("Google verification failed:",r.message)},error:r=>{console.error("Network or Server Error during Google verification.",r)}})}}handleCaptchaResponse(e){this.captchaToken=e,console.log("reCAPTCHA Token received:",e)}toggleAuthMode(){this.isLogin=!this.isLogin}onSubmit(e){if(e.invalid)return;this.http.post("http://localhost/Backend/verify_recaptcha.php",{recaptcha:e.value.recaptcha}).subscribe({next:i=>{if(i.success){if(!this.verifForm(e))return;this.firebaseService.getUserByEmail(e.value.email).pipe($r(1)).subscribe(r=>{this.firebaseService.connectedUser=r[0],this.isLogin?this.login(r,e):this.signup(r,e)})}else this.mainService.showNotification("error","ReCAPTCHA Verification Failed")}})}verifForm(e){let t=e.value.email,i=e.value.password;if(this.isLogin&&(e.value.confirmPassword=i),this.verifEmail(t)){if(i.trim()!=""&&!this.isLogin&&(i.length<6||!this.containsUppercase(i)))return this.mainService.showNotification("error",'"Password Must Be At Least 5 Caracters Long And Must Have 1 Capital"'),!1;if(i!=e.value.confirmPassword&&e.value.confirmPassword.trim()!="")return this.mainService.showNotification("error","Password Don't Match"),!1}else return this.mainService.showNotification("error","Email Is Invalid"),console.log(i.trim()!=""&&(i.length<6||!this.containsUppercase(i))),!1;return!0}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible,console.log(this.passwordVisible)}verifEmail(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)}containsUppercase(e){return/[A-Z]/.test(e)}signup(e,t){if(e.length==0){let i=t.value.email?.split("@",1)[0];this.firebaseService.addUser({email:t.value.email,password:t.value.password,username:i,role:"Member",bio:"Nothing To See Here"}),sessionStorage.setItem("email",t.value.email),this.mainService.showNotification("success","You are in ! Welcome to the community"),this.redirectWithDelay("/browse",2e3),console.log("Success registering")}else this.mainService.showNotification("error","User Already Registered"),console.log("Failure Registering")}login(e,t){e.length==0?this.mainService.showNotification("error","User Is Not Registered"):t.value.password==e[0].password?(this.redirectWithDelay("/browse",2e3),sessionStorage.setItem("email",t.value.email),this.mainService.showNotification("success","Welcome Back !")):this.mainService.showNotification("error","Wrong Credentials")}addUser(e){this.firebaseService.addUser(e)}redirect(e){this.router.navigate([e])}redirectWithDelay(e,t){setTimeout(()=>{this.router.navigate([e])},t)}static \u0275fac=function(t){return new(t||n)(Ue(Yi),Ue(Gd),Ue(wr),Ue(_o))};static \u0275cmp=kn({type:n,selectors:[["app-auth"]],decls:38,vars:12,consts:[["authForm","ngForm"],["captchaElem",""],["class","notification-container",3,"show",4,"ngIf"],[1,"auth-container"],[1,"auth-card"],[1,"back-btn",3,"click"],[1,"auth-title"],[1,"auth-subtitle"],[1,"auth-form",3,"ngSubmit"],[1,"form-group"],["type","email","name","email","ngModel","","required","","placeholder","you@example.com",3,"change"],["name","password","ngModel","","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"change","type"],["id","eye-icon","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"eye-icon",3,"click"],["d","M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"],["cx","12","cy","12","r","3"],["x1","3","y1","3","x2","21","y2","21"],["class","form-group",4,"ngIf"],[1,"form-group","recaptcha"],["name","recaptcha","ngModel","","required","","theme","dark",3,"siteKey"],["type","submit",1,"btn","primary",3,"disabled"],[1,"divider"],["id","g_id_onload","data-client_id","790150872237-e6q4slaj075hi18fjs24as5ha0vgvhmd.apps.googleusercontent.com","data-callback","handleGoogleCredentialResponse","data-auto_prompt","false"],["data-type","standard","data-size","large","data-theme","dark","data-text","sign_in_with","data-shape","rectangular","data-logo_alignment","left",1,"g_id_signin"],[1,"switch"],[3,"click"],[1,"notification-container"],[1,"notification-popup",3,"ngClass"],[1,"notification-icon"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],[1,"notification-content"],[1,"notification-message"],[1,"notification-close"],[1,"notification-progress"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","20 6 9 17 4 12"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["name","confirmPassword","ngModel","","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"change","type"]],template:function(t,i){if(t&1){let r=rn();lt(0,Xte,11,6,"div",2),F(1,"div",3)(2,"div",4)(3,"button",5),Pe("click",function(){return Ze(r),Je(i.redirect("/landing"))}),j(4,"\u2190 Back"),B(),F(5,"h1",6),j(6),B(),F(7,"p",7),j(8),B(),F(9,"form",8,0),Pe("ngSubmit",function(){Ze(r);let o=qi(10);return Je(i.onSubmit(o))}),F(11,"div",9)(12,"label"),j(13,"Email"),B(),F(14,"input",10),Pe("change",function(){Ze(r);let o=qi(10);return Je(i.verifForm(o))}),B()(),F(15,"div",9)(16,"label"),j(17,"Password"),B(),F(18,"input",11),Pe("change",function(){Ze(r);let o=qi(10);return Je(i.verifForm(o))}),B(),cr(),F(19,"svg",12),Pe("click",function(){return Ze(r),Je(i.togglePasswordVisibility())}),Ce(20,"path",13)(21,"circle",14)(22,"line",15),B()(),lt(23,Yte,4,1,"div",16),Ol(),F(24,"div",17),Ce(25,"ngx-recaptcha2",18,1),B(),F(27,"button",19),j(28),B()(),F(29,"div",20)(30,"span"),j(31,"or"),B()(),Ce(32,"div",21)(33,"div",22),F(34,"p",23),j(35),F(36,"a",24),Pe("click",function(){return Ze(r),Je(i.toggleAuthMode())}),j(37),B()()()()}if(t&2){let r=qi(10);ye("ngIf",i.mainService.notification().type),$(6),ft(i.isLogin?"Welcome Back":"Create Your Account"),$(2),vn(" ",i.isLogin?"Login to continue your learning journey":"Join Aethera and start exploring knowledge"," "),$(10),ye("type",i.passwordVisible?"text":"password"),$(4),yn("strikethrough-line",!i.passwordVisible),$(),ye("ngIf",!i.isLogin),$(2),ye("siteKey",i.siteKey),$(2),ye("disabled",r.invalid),$(),vn(" ",i.isLogin?"Login":"Sign Up"," "),$(7),vn(" ",i.isLogin?"Don't have an account?":"Already have an account?"," "),$(2),vn(" ",i.isLogin?"Sign up":"Login"," ")}},dependencies:[kc,kb,go,Oc,Nb,Km,ma,Ym,Pz,Rz,wi,ws,dr],styles:['html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{background-color:#01110b!important;color-scheme:dark}*[_ngcontent-%COMP%]{margin:0}html[_ngcontent-%COMP%]{overflow-y:hidden;overscroll-behavior:none}.auth-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background:radial-gradient(circle at top,#0a2a1f,#01110b 80%);font-family:Poppins,sans-serif;color:#e7fbee}.eye-icon[_ngcontent-%COMP%]{position:absolute;right:20px;margin:-32px 0}.eye-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.strikethrough-line[_ngcontent-%COMP%]{display:none}.toggle-button.is-toggled[_ngcontent-%COMP%]   .strikethrough-line[_ngcontent-%COMP%]{display:block}.auth-card[_ngcontent-%COMP%]{scale:.8;position:relative;background:#051e14b3;border:1px solid rgba(0,230,118,.2);border-radius:20px;padding:3rem 2.5rem;width:80%;max-width:420px;text-align:center;box-shadow:0 0 25px #00e67626;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);animation:_ngcontent-%COMP%_fadeIn .7s ease}.auth-error[_ngcontent-%COMP%]{margin:15px 0;font-size:1.2rem;font-weight:700;background:linear-gradient(90deg,#e61300,#e9641d);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.back-btn[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;background:transparent;border:none;color:#b8ffce;font-size:1rem;cursor:pointer;transition:color .3s ease}.back-btn[_ngcontent-%COMP%]:hover{color:#00e676}.auth-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.5rem;background:linear-gradient(90deg,#00e676,#1de9b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.auth-subtitle[_ngcontent-%COMP%]{color:#a6f5c4;margin-bottom:2rem;font-size:.95rem;opacity:.9}.recaptcha[_ngcontent-%COMP%]{display:flex;white-space:none;justify-content:space-around}.form-group[_ngcontent-%COMP%]{margin-bottom:1.3rem;text-align:left}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.9rem;margin-bottom:.3rem;color:#b8ffce}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.7rem .9rem;border-radius:8px;border:1px solid rgba(0,230,118,.3);background:#ffffff0d;color:#e7fbee;font-size:.95rem;outline:none;transition:border-color .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#00e676}.btn[_ngcontent-%COMP%]{width:100%;padding:.9rem;border-radius:25px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .3s ease;border:none}.btn.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00e676,#1de9b6);color:#01210f;box-shadow:0 0 15px #1de9b64d}.btn.primary[_ngcontent-%COMP%]:hover{box-shadow:0 0 25px #1de9b699;transform:translateY(-2px)}.divider[_ngcontent-%COMP%]{margin:1.5rem 0;position:relative;text-align:center;color:#b8ffce;font-size:.9rem}.divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#051e14cc;padding:0 10px;position:relative;z-index:2}.divider[_ngcontent-%COMP%]:before{content:"";position:absolute;width:100%;height:1px;top:50%;left:0;background:#00e67633;z-index:1}.btn.google[_ngcontent-%COMP%]{background:#ffffff1a;border:1px solid rgba(0,230,118,.3);color:#e7fbee;display:flex;align-items:center;justify-content:center;gap:10px}.btn.google[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.btn.google[_ngcontent-%COMP%]:hover{background:#00e6761a;border-color:#00e676}.switch[_ngcontent-%COMP%]{margin-top:1.5rem;font-size:.9rem;color:#b8ffce}.switch[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#00e676;cursor:pointer;font-weight:500;margin-left:.3rem}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}']})};function Kte(n,e){if(n&1){let t=rn();F(0,"span",27),Pe("click",function(){Ze(t);let r=xe();return Je(r.redirect("/landing"))}),j(1,"Aethera"),B()}}function Zte(n,e){n&1&&(F(0,"span"),j(1,"Browse"),B())}function Jte(n,e){n&1&&(F(0,"span"),j(1,"Dashboard"),B())}function Qte(n,e){n&1&&(F(0,"span"),j(1,"Profile"),B())}function ene(n,e){if(n&1&&Ce(0,"div",28),n&2){let t=xe();ur("background-image","url("+t.tempAvatarView()+")")}}function tne(n,e){if(n&1&&(F(0,"div",29),j(1),B()),n&2){let t=xe();$(),vn(" ",t.loggedEmail?t.loggedEmail.split("")[0].toUpperCase():"?"," ")}}function nne(n,e){if(n&1&&(F(0,"div",30)(1,"span",31),j(2),B(),F(3,"small"),j(4),B()()),n&2){let t=xe();$(2),ft(t.loggedUser),$(2),ft(t.role)}}function ine(n,e){if(n&1){let t=rn();F(0,"div",32)(1,"p")(2,"strong"),j(3),B()(),F(4,"p",33),j(5),B(),Ce(6,"hr"),F(7,"button",23),Pe("click",function(){Ze(t);let r=xe();return r.redirect("/profile/1"),Je(r.toggleProfileDropdown())}),Ce(8,"i",10),j(9," View Profile "),B(),F(10,"button",23),Pe("click",function(){Ze(t);let r=xe();return Je(r.logout())}),Ce(11,"i",25),j(12," Logout "),B()()}if(n&2){let t=xe();$(3),ft(t.loggedUser),$(2),ft(t.loggedEmail)}}var jb=class n{constructor(e,t){this.mainService=e;this.firebaseService=t}isCollapsed=!1;showProfileDropdown=!1;loggedUser;loggedEmail;role="Member";userAvatar;toggleSidebar(){this.isCollapsed=!this.isCollapsed}ngOnInit(){this.loggedEmail=sessionStorage.getItem("email")??void 0,this.getUsername(),this.firebaseService.getUserInfo()}toggleProfileDropdown(){this.showProfileDropdown=!this.showProfileDropdown}logout(){sessionStorage.clear(),this.redirect("/landing"),this.firebaseService.tempAvatarPreview.set(null)}redirect(e){this.mainService.redirect(e)}tempAvatarView(){return this.firebaseService.tempAvatarPreview()}getUsername(){this.loggedEmail&&this.firebaseService.getUserByEmail(this.loggedEmail).subscribe(e=>{this.loggedUser=e[0].username})}static \u0275fac=function(t){return new(t||n)(Ue(_o),Ue(wr))};static \u0275cmp=kn({type:n,selectors:[["app-layout"]],decls:35,vars:11,consts:[[1,"layout"],[1,"sidebar"],[1,"logo"],["src","assets/aethera-logo.png","alt","Aethera Logo",2,"border-radius","50%"],["class","logo-text",3,"click",4,"ngIf"],[1,"nav-links"],["routerLinkActive","active",3,"click"],[1,"fas","fa-gamepad"],[4,"ngIf"],[1,"fas","fa-cog"],[1,"fas","fa-user"],[1,"sidebar-footer"],[1,"profile",3,"click"],["class","avatar-setting",3,"background-image",4,"ngIf"],["class","avatar","style",`width: 40px;
          height: 40px;
          border-radius: 50%;
          border: 1px solid rgba(0, 230, 118, 0.4);
          `,4,"ngIf"],["class","profile-info",4,"ngIf"],[1,"collapse-btn",3,"click"],[1,"fas",3,"ngClass"],["class","profile-dropdown",4,"ngIf"],[1,"main-content"],[1,"topbar"],[1,"top-actions"],["type","text","placeholder","Search..."],[3,"click"],[1,"fas","fa-bell"],[1,"fas","fa-sign-out-alt"],[1,"page-content"],[1,"logo-text",3,"click"],[1,"avatar-setting"],[1,"avatar",2,"width","40px","height","40px","border-radius","50%","border","1px solid rgba(0, 230, 118, 0.4)"],[1,"profile-info"],[1,"name"],[1,"profile-dropdown"],[1,"email"]],template:function(t,i){t&1&&(F(0,"div",0)(1,"aside",1)(2,"div",2),Ce(3,"img",3),lt(4,Kte,2,0,"span",4),B(),F(5,"nav",5)(6,"a",6),Pe("click",function(){return i.redirect("/browse")}),Ce(7,"i",7),lt(8,Zte,2,0,"span",8),B(),F(9,"a",6),Pe("click",function(){return i.redirect("/dashboard")}),Ce(10,"i",9),lt(11,Jte,2,0,"span",8),B(),F(12,"a",6),Pe("click",function(){return i.redirect("/profile/1")}),Ce(13,"i",10),lt(14,Qte,2,0,"span",8),B()(),F(15,"div",11)(16,"div",12),Pe("click",function(){return i.toggleProfileDropdown()}),lt(17,ene,1,2,"div",13)(18,tne,2,1,"div",14)(19,nne,5,2,"div",15),B(),F(20,"button",16),Pe("click",function(){return i.toggleSidebar()}),Ce(21,"i",17),B()()(),lt(22,ine,13,2,"div",18),F(23,"div",19)(24,"header",20)(25,"h1"),j(26,"Aethera Platform"),B(),F(27,"div",21),Ce(28,"input",22),F(29,"button",23),Pe("click",function(){return i.redirect("dashboard")}),Ce(30,"i",24),B(),F(31,"button",23),Pe("click",function(){return i.logout()}),Ce(32,"i",25),B()()(),F(33,"section",26),Ce(34,"router-outlet"),B()()()),t&2&&($(),yn("collapsed",i.isCollapsed),$(3),ye("ngIf",!i.isCollapsed),$(4),ye("ngIf",!i.isCollapsed),$(3),ye("ngIf",!i.isCollapsed),$(3),ye("ngIf",!i.isCollapsed),$(3),ye("ngIf",i.tempAvatarView()),$(),ye("ngIf",!i.tempAvatarView()),$(),ye("ngIf",!i.isCollapsed),$(2),ye("ngClass",i.isCollapsed?"fa-chevron-right":"fa-chevron-left"),$(),ye("ngIf",i.showProfileDropdown))},dependencies:[Kl,wi,ws,dr],styles:[".layout[_ngcontent-%COMP%]{display:flex;height:100vh;background:radial-gradient(circle at top,#041a11,#010806 80%);color:#e8ffe5;font-family:Poppins,sans-serif}.sidebar[_ngcontent-%COMP%]{background:#051e14e6;border-right:1px solid rgba(0,230,118,.2);width:240px;transition:width .3s ease;display:flex;flex-direction:column;justify-content:space-between}.sidebar.collapsed[_ngcontent-%COMP%]{width:80px}.logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:1.5rem 1rem}.logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;cursor:pointer}.logo-text[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;color:#00e676;cursor:pointer}.nav-links[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:1rem}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.9rem 1.2rem;color:#b8ffce;text-decoration:none;transition:all .3s ease;border-left:3px solid transparent;cursor:pointer}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background:#00e67626;border-left:3px solid #00e676;color:#00e676}.sidebar-footer[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid rgba(0,230,118,.2);display:flex;align-items:center;justify-content:space-between}.profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.7rem;cursor:pointer}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:1px solid rgba(0,230,118,.4)}.profile-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:.9rem}.name[_ngcontent-%COMP%]{font-weight:600;color:#00e676}.collapse-btn[_ngcontent-%COMP%]{background:none;border:none;color:#b8ffce;font-size:1.2rem;cursor:pointer;transition:color .3s}.collapse-btn[_ngcontent-%COMP%]:hover{color:#00e676}.main-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.topbar[_ngcontent-%COMP%]{background:#0000004d;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;border-bottom:1px solid rgba(0,230,118,.2)}.topbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#00e676;font-size:1.2rem;letter-spacing:.05em}.top-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.top-actions[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(0,230,118,.3);padding:.5rem .8rem;border-radius:10px;color:#e8ffe5;outline:none;width:200px;transition:border-color .3s ease}.top-actions[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#00e676}.top-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#b8ffce;font-size:1.1rem;cursor:pointer;transition:color .3s ease}.top-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#00e676}.page-content[_ngcontent-%COMP%]{padding:2rem;overflow-y:auto}.profile-dropdown[_ngcontent-%COMP%]{position:absolute;bottom:70px;left:5px;background:#051e14f2;border:1px solid rgba(0,230,118,.2);border-radius:10px;padding:.8rem 1rem;width:190px;box-shadow:0 0 12px #00e67626;animation:_ngcontent-%COMP%_fadeIn .2s ease}.profile-dropdown[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0;color:#b8ffce;font-size:.85rem}.profile-dropdown[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{opacity:.8;font-size:.8rem}.profile-dropdown[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;border-top:1px solid rgba(0,230,118,.2);margin:.5rem 0}.profile-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:transparent;border:none;color:#a8ffc2;cursor:pointer;font-size:.85rem;width:100%;padding:.4rem 0;transition:color .2s}.profile-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#00e676}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}@media (max-width : 550px){.sidebar[_ngcontent-%COMP%]{display:none}.top-actions[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:10px;width:100px}}.avatar-setting[_ngcontent-%COMP%]{width:50px;height:50px;background-size:cover;background-position:center;border-radius:50%;border:2px solid #00e676}"]})};function rne(n,e){if(n&1&&(F(0,"option",10),j(1),qo(2,"titlecase"),B()),n&2){let t=e.$implicit;ye("value",t),$(),ft(Fd(2,2,t))}}function sne(n,e){if(n&1&&(F(0,"span"),j(1),B()),n&2){let t=e.$implicit;$(),ft(t)}}function one(n,e){if(n&1){let t=rn();F(0,"div",11)(1,"div",12),Pe("click",function(){let r=Ze(t).$implicit,s=xe();return Je(s.openGameDetails(r.id))}),Ce(2,"img",13),F(3,"div",14)(4,"button",15),Ce(5,"i",16),B()()(),F(6,"div",17)(7,"h3"),j(8),B(),F(9,"p"),j(10),B(),F(11,"div",18),lt(12,sne,2,1,"span",19),B(),F(13,"div",20)(14,"button",21),Pe("click",function(){let r=Ze(t).$implicit,s=xe();return Je(s.toggleLike(r))}),Ce(15,"i",22),F(16,"span"),j(17),B()()()()()}if(n&2){let t=e.$implicit;$(2),ye("src",t.thumbnail,Ys)("alt",t.title),$(6),ft(t.title),$(2),ft(t.description),$(2),ye("ngForOf",t.tags),$(2),yn("liked",t.liked),$(),ye("ngClass",t.liked?"fa-heart":"fa-heart-broken"),$(2),ft(t.liked?"Liked":"Like")}}function ane(n,e){n&1&&(F(0,"div",23)(1,"p"),j(2,"No games found matching your search."),B()())}var Gb=class n{constructor(e,t){this.gameService=e;this.router=t;let i=sessionStorage.getItem("test");console.log(i,"browse")}games=[];filteredGames=[];tags=[];selectedTag="all";searchTerm="";ngOnInit(){sessionStorage.getItem("email")||this.router.navigate(["auth"]),setTimeout(()=>{this.games=this.gameService.getAllGames(),this.filteredGames=[...this.games],this.tags=this.gameService.getAllTags(),console.log("games in component : ",this.games)},1e3)}onSearchChange(e){this.searchTerm=e.toLowerCase().trim(),this.applyFilters()}onTagChange(e){this.selectedTag=e,this.applyFilters()}applyFilters(){this.filteredGames=this.games.filter(e=>{let t=this.selectedTag==="all"||e.tags.includes(this.selectedTag),i=e.title.toLowerCase().includes(this.searchTerm)||e.description.toLowerCase().includes(this.searchTerm)||e.tags.some(r=>r.toLowerCase().includes(this.searchTerm));return t&&i})}openGameDetails(e){this.router.navigate(["/details",e])}toggleLike(e){this.gameService.toggleLike(e.id),this.games=this.gameService.getAllGames(),this.applyFilters()}static \u0275fac=function(t){return new(t||n)(Ue(Pc),Ue(Yi))};static \u0275cmp=kn({type:n,selectors:[["app-browse"]],decls:15,vars:5,consts:[[1,"browse-wrapper"],[1,"browse-header"],[1,"browse-filters"],["type","text","placeholder","Search games...",1,"search-bar",3,"ngModelChange","input","ngModel"],[1,"styled-select",3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[1,"games-grid"],["class","game-card",4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],[3,"value"],[1,"game-card"],[1,"thumb",3,"click"],[3,"src","alt"],[1,"thumb-overlay"],[1,"play-btn"],[1,"fas","fa-play"],[1,"info"],[1,"tags"],[4,"ngFor","ngForOf"],[1,"actions"],[1,"like-btn",3,"click"],[1,"fas",3,"ngClass"],[1,"no-results"]],template:function(t,i){t&1&&(F(0,"div",0)(1,"div",1)(2,"h2"),j(3,"Explore Games"),B(),F(4,"p"),j(5,"Discover, play, and learn with interactive 3D experiences built with Three.js"),B(),F(6,"div",2)(7,"input",3),$o("ngModelChange",function(s){return oc(i.searchTerm,s)||(i.searchTerm=s),s}),Pe("input",function(){return i.onSearchChange(i.searchTerm)}),B(),F(8,"select",4),$o("ngModelChange",function(s){return oc(i.selectedTag,s)||(i.selectedTag=s),s}),Pe("change",function(){return i.onTagChange(i.selectedTag)}),F(9,"option",5),j(10,"All Tags"),B(),lt(11,rne,3,4,"option",6),B()()(),F(12,"div",7),lt(13,one,18,9,"div",8),B(),lt(14,ane,3,0,"div",9),B()),t&2&&($(7),Wo("ngModel",i.searchTerm),$(),Wo("ngModel",i.selectedTag),$(3),ye("ngForOf",i.tags),$(2),ye("ngForOf",i.filteredGames),$(),ye("ngIf",i.filteredGames.length===0))},dependencies:[wi,ws,cc,dr,kc,Lb,Fb,go,Bh,Oc,ma,NI],styles:[".browse-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:2rem;color:#e8ffe5;min-height:100%}.browse-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2.5rem}.browse-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;background:linear-gradient(90deg,#00e676,#1de9b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.browse-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#b8ffce;opacity:.8;margin-top:.5rem}.browse-filters[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:center;gap:1rem;flex-wrap:wrap}.search-bar[_ngcontent-%COMP%], .filter-dropdown[_ngcontent-%COMP%]{padding:.6rem 1rem;border-radius:10px;border:1px solid rgba(0,230,118,.3);background:#ffffff0d;color:#e8ffe5;outline:none;transition:border-color .3s ease}.search-bar[_ngcontent-%COMP%]:focus, .filter-dropdown[_ngcontent-%COMP%]:focus{border-color:#00e676}.games-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1.8rem;margin-top:2rem}.game-card[_ngcontent-%COMP%]{background:#051e1499;border-radius:15px;border:1px solid rgba(0,230,118,.2);overflow:hidden;transition:all .3s ease;display:flex;flex-direction:column}.game-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);border-color:#00e67666;box-shadow:0 0 25px #00e67640}.thumb[_ngcontent-%COMP%]{position:relative;height:180px;overflow:hidden}.thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;filter:brightness(.85);transition:transform .4s ease}.thumb[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05)}.thumb-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0006;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .3s ease}.thumb[_ngcontent-%COMP%]:hover   .thumb-overlay[_ngcontent-%COMP%]{opacity:1}.play-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00e676,#1de9b6);border:none;border-radius:50%;width:50px;height:50px;color:#01210f;font-size:1.3rem;cursor:pointer;box-shadow:0 0 10px #00e67680;transition:transform .3s ease}.play-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.info[_ngcontent-%COMP%]{padding:1.2rem;flex:1}.info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#00e676;margin-bottom:.4rem}.info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#b8ffce;opacity:.8;font-size:.9rem;margin-bottom:.8rem;height:60px;overflow:hidden}.tags[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1rem}.tags[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;background:#00e67626;border:1px solid rgba(0,230,118,.3);color:#a8ffc2;border-radius:20px;padding:.2rem .6rem}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.like-btn[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(0,230,118,.3);border-radius:20px;padding:.4rem .8rem;font-size:.85rem;color:#b8ffce;display:flex;align-items:center;gap:.4rem;cursor:pointer;transition:all .3s ease}.like-btn[_ngcontent-%COMP%]:hover{border-color:#00e676;color:#00e676}.like-btn.liked[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00e676,#1de9b6);color:#01210f;border-color:transparent;box-shadow:0 0 12px #1de9b666}.no-results[_ngcontent-%COMP%]{text-align:center;margin-top:3rem;opacity:.7}"]})};function cne(n,e){n&1&&(cr(),F(0,"svg",19),Ce(1,"polyline",20),B())}function lne(n,e){n&1&&(cr(),F(0,"svg",19),Ce(1,"circle",21)(2,"line",22)(3,"line",23),B())}function une(n,e){if(n&1&&(F(0,"div",11)(1,"div",12)(2,"div",13),lt(3,cne,2,0,"svg",14)(4,lne,4,0,"svg",14),B(),F(5,"div",15)(6,"p",16),j(7),B()(),F(8,"button",17),j(9,"\xD7"),B(),Ce(10,"div",18),B()()),n&2){let t=xe();yn("show",t.mainService.notification().type),$(),ye("ngClass",t.mainService.notification().type),$(2),ye("ngIf",t.mainService.notification().type==="success"),$(),ye("ngIf",t.mainService.notification().type==="error"),$(3),ft(t.mainService.notification().message)}}function dne(n,e){if(n&1){let t=rn();F(0,"div",24)(1,"div",25)(2,"h3",26),j(3,"Confirm Deletion"),B(),F(4,"p",27),j(5,"Are you absolutely sure you want to permanently delete your account? This action cannot be reversed."),B(),F(6,"div",28)(7,"button",29),Pe("click",function(){Ze(t);let r=xe();return Je(r.closeModal())}),j(8,"Cancel"),B(),F(9,"button",30),Pe("click",function(){Ze(t);let r=xe();return Je(r.handleDelete())}),j(10,"Delete Permanently"),B()()()()}if(n&2){let t=xe();yn("active",t.isModalOpen())}}function hne(n,e){if(n&1&&(F(0,"div",47),j(1),B()),n&2){let t=xe(3);$(),vn(" ",t.profile!=null&&t.profile.username?t.profile.username.split("")[0].toUpperCase():"?"," ")}}function fne(n,e){if(n&1&&Ce(0,"div",48),n&2){let t=xe(3);ur("background-image","url("+t.tempAvatarView()+")")}}function pne(n,e){if(n&1){let t=rn();F(0,"div",34)(1,"div",35),lt(2,hne,2,1,"div",36)(3,fne,1,2,"div",37),F(4,"div")(5,"h2",38),j(6),B(),F(7,"p",39),j(8),B()()(),F(9,"div",40)(10,"div")(11,"label",41),j(12,"Display Name"),B(),F(13,"div",42),j(14),B()(),F(15,"div")(16,"label",41),j(17,"Role"),B(),F(18,"div",42),j(19),B()(),F(20,"div",43)(21,"label",41),j(22,"Bio"),B(),F(23,"div",44),j(24),B()()(),F(25,"div",45)(26,"button",46),Pe("click",function(){Ze(t);let r=xe(2);return Je(r.toggleEditMode())}),j(27,"Edit Profile"),B()()()}if(n&2){let t=xe(2);$(2),ye("ngIf",!t.tempAvatarView()),$(),ye("ngIf",t.tempAvatarView()),$(3),ft(t.profile==null?null:t.profile.username),$(2),ft(t.profile==null?null:t.profile.email),$(6),ft(t.profile==null?null:t.profile.username),$(5),ft((t.profile==null?null:t.profile.role)||"User"),$(5),ft((t.profile==null?null:t.profile.bio)||"No bio provided.")}}function mne(n,e){if(n&1){let t=rn();F(0,"div",49)(1,"form",50,0),Pe("ngSubmit",function(){Ze(t);let r=qi(2),s=xe(2);return Je(s.handleSaveProfile(r))}),F(3,"div",51)(4,"div",43)(5,"label",52),j(6,"Display Name"),B(),Ce(7,"input",53),B(),F(8,"div",43)(9,"label",54),j(10,"Bio"),B(),Ce(11,"textarea",55),B(),F(12,"div",56)(13,"label",57),j(14,"Email Address (Read-Only)"),B(),Ce(15,"input",58),B()(),F(16,"div",59)(17,"button",60),Pe("click",function(){Ze(t);let r=xe(2);return Je(r.toggleEditMode())}),j(18,"Cancel"),B(),F(19,"button",61),j(20,"Save Changes"),B()()()()}if(n&2){let t=qi(2),i=xe(2);$(7),ye("ngModel",i.profile==null?null:i.profile.username),$(4),ye("ngModel",i.profile==null?null:i.profile.bio),$(4),ye("value",i.profile==null?null:i.profile.email),$(4),ye("disabled",t.invalid)}}function gne(n,e){if(n&1&&(F(0,"div",31),lt(1,pne,28,7,"div",32)(2,mne,21,4,"div",33),B()),n&2){let t=xe();$(),ye("ngIf",!t.isEditMode()),$(),ye("ngIf",t.isEditMode())}}function _ne(n,e){if(n&1){let t=rn();F(0,"div",62)(1,"h3",63),j(2,"Password Management"),B(),F(3,"form",50,1),Pe("ngSubmit",function(){Ze(t);let r=qi(4),s=xe();return Je(s.handlePasswordChange(r))}),F(5,"div",64)(6,"div")(7,"label",65),j(8,"Current Password"),B(),Ce(9,"input",66),B(),F(10,"div")(11,"label",67),j(12,"New Password"),B(),Ce(13,"input",68),B(),F(14,"div")(15,"label",69),j(16,"Confirm New Password"),B(),Ce(17,"input",70),B()(),F(18,"div",45)(19,"button",71),j(20," Update Password "),B()()(),F(21,"div",72)(22,"h3",73),j(23,"Account Deletion"),B(),F(24,"p",74),j(25," This action is irreversible. All associated data will be permanently wiped from our servers. Please proceed with caution. "),B(),F(26,"button",75),Pe("click",function(){Ze(t);let r=xe();return Je(r.openModal())}),j(27,"Delete Account"),B()()()}if(n&2){let t=qi(4);$(19),ye("disabled",t.invalid)}}function yne(n,e){if(n&1&&(F(0,"div",47),j(1),B()),n&2){let t=xe(2);$(),vn(" ",t.profile!=null&&t.profile.username?t.profile.username.split("")[0].toUpperCase():"?"," ")}}function vne(n,e){if(n&1&&Ce(0,"div",48),n&2){let t=xe(2);ur("background-image","url("+t.tempAvatarView()+")")}}function bne(n,e){if(n&1){let t=rn();F(0,"div",76)(1,"h3",63),j(2,"Profile Picture"),B(),F(3,"div",77),lt(4,yne,2,1,"div",36)(5,vne,1,2,"div",37),F(6,"p",78),j(7,"Max file size 5MB. Accepts JPG, PNG."),B(),F(8,"input",79),Pe("change",function(r){Ze(t);let s=xe();return Je(s.onFileSelected(r))}),B(),F(9,"div",80)(10,"label",81),j(11,"Choose File"),B(),F(12,"button",82),Pe("click",function(){Ze(t);let r=xe();return Je(r.removeAvatar())}),j(13," Remove "),B()(),F(14,"button",83),Pe("click",function(){Ze(t);let r=xe();return Je(r.handleAvatarUpload())}),j(15," Upload & Save "),B()()()}if(n&2){let t=xe();$(4),ye("ngIf",!t.tempAvatarView()),$(),ye("ngIf",t.tempAvatarView())}}var Wb=class n{constructor(e,t){this.mainService=e;this.firebaseService=t}activeTab=Kn("info");isEditMode=Kn(!1);isModalOpen=Kn(!1);profile=null;originalProfile=null;ngOnInit(){let e=sessionStorage.getItem("email");if(!e){this.mainService.redirect("/landing");return}this.profile?.profilePic&&this.firebaseService.tempAvatarPreview.set(this.profile.profilePic),this.firebaseService.connectedUser&&this.firebaseService.connectedUser.email===e?this.setProfileData(this.firebaseService.connectedUser):this.firebaseService.getUserByEmail(e).subscribe(t=>{t&&t.length>0&&this.setProfileData(t[0])})}setProfileData(e){this.profile=ae({},e),this.originalProfile=ae({},e),this.firebaseService.tempAvatarPreview.set(e.profilePic)}showTab(e){this.activeTab.set(e),this.isEditMode.set(!1),this.mainService.notification.set({message:"",type:null})}toggleEditMode(){let e=this.isEditMode();e?this.profile=ae({},this.originalProfile):this.originalProfile=ae({},this.profile),this.isEditMode.set(!e)}openModal(){this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleDelete(){this.firebaseService.deleteUser(this.profile?.id).then(()=>{sessionStorage.clear(),this.mainService.redirect("/landing")}).catch(()=>{this.mainService.showNotification("error","Critical error during account deletion"),this.closeModal()})}handleSaveProfile(e){if(e.invalid||!this.profile)return;let t=je(ae({},this.profile),{username:e.value.displayName,bio:e.value.bio});this.firebaseService.editUser(t).then(()=>{this.profile=ae({},t),this.originalProfile=ae({},t),this.mainService.showNotification("success","Profile updated successfully!"),this.isEditMode.set(!1)}).catch(()=>{this.mainService.showNotification("error","Failed to save changes due to a server error.")})}handlePasswordChange(e){let{currentPassword:t,newPassword:i,confirmPassword:r}=e.value;if(e.invalid){this.mainService.showNotification("error","Please fill in all required fields");return}if(this.profile&&this.verifPassword(t,i,r)){let s=je(ae({},this.profile),{password:i});this.firebaseService.editUser(s).then(()=>{this.profile=ae({},s),this.originalProfile=ae({},s),this.mainService.showNotification("success","Password updated successfully"),e.resetForm()}).catch(o=>{this.mainService.showNotification("error","Server error: Failed to update password")})}}verifPassword(e,t,i){return this.profile?.password!==e?(this.mainService.showNotification("error","Wrong Current Password"),!1):t.length<6||!/[A-Z]/.test(t)?(this.mainService.showNotification("error","Password must be at least 6 characters with 1 uppercase letter"),!1):t!==i?(this.mainService.showNotification("error","New passwords do not match"),!1):!0}handleAvatarUpload(){if(!this.profile||!this.firebaseService.tempAvatarPreview()){this.mainService.showNotification("error","No image selected to upload.");return}let e=je(ae({},this.profile),{profilePic:this.firebaseService.tempAvatarPreview()});this.firebaseService.editUser(e).then(()=>{this.profile=e,this.firebaseService.connectedUser=e,this.mainService.showNotification("success","Profile picture updated successfully!")}).catch(t=>{console.error(t),this.mainService.showNotification("error","Failed to upload image to server.")})}removeAvatar(){if(!this.profile)return;let e=je(ae({},this.profile),{profilePic:""});this.firebaseService.editUser(e).then(()=>{this.profile=e,this.firebaseService.connectedUser=e,this.firebaseService.tempAvatarPreview.set(null),this.mainService.showNotification("success","Avatar removed.")})}onFileSelected(e){let t=e.target.files[0];if(console.log("Processing Picture"),!t)return;if(t.size>5*1024*1024){this.mainService.showNotification("error","File is too large! Max 5MB");return}let i=new FileReader;i.onload=()=>{let r=i.result;this.firebaseService.tempAvatarPreview.set(r)},i.readAsDataURL(t)}tempAvatarView(){return this.firebaseService.tempAvatarPreview()}static \u0275fac=function(t){return new(t||n)(Ue(_o),Ue(wr))};static \u0275cmp=kn({type:n,selectors:[["app-root"]],decls:13,vars:11,consts:[["editForm","ngForm"],["passwordForm","ngForm"],["class","notification-container",3,"show",4,"ngIf"],["id","delete-modal","class","modal-backdrop",3,"active",4,"ngIf"],[1,"tab-nav"],[1,"tab-button",3,"click"],[1,"tab-button","color-text-muted",3,"click"],["id","tab-contents"],["id","info-content","class","tab-content",4,"ngIf"],["id","security-content","class","tab-content",4,"ngIf"],["id","avatar-content","class","tab-content",4,"ngIf"],[1,"notification-container"],[1,"notification-popup",3,"ngClass"],[1,"notification-icon"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],[1,"notification-content"],[1,"notification-message"],[1,"notification-close"],[1,"notification-progress"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","20 6 9 17 4 12"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["id","delete-modal",1,"modal-backdrop"],[1,"modal-card"],[1,"modal-title"],[1,"modal-message"],[1,"modal-actions"],[1,"btn-modal-cancel",3,"click"],[1,"btn-modal-delete",3,"click"],["id","info-content",1,"tab-content"],["id","view-mode",4,"ngIf"],["id","edit-mode",4,"ngIf"],["id","view-mode"],[1,"profile-header"],["class","avatar-preview-large",4,"ngIf"],["class","avatar-preview-large avatar-setting",3,"background-image",4,"ngIf"],[1,"profile-name"],[1,"color-text-muted"],[1,"info-grid"],[1,"info-label"],[1,"info-display"],[1,"col-span-full"],[1,"info-display","info-bio"],[2,"display","flex","justify-content","flex-end","margin-top","1rem"],[1,"btn-edit",3,"click"],[1,"avatar-preview-large"],[1,"avatar-preview-large","avatar-setting"],["id","edit-mode"],[3,"ngSubmit"],[1,"form-grid"],["for","display-name",1,"form-label"],["type","text","id","display-name","name","displayName","required","",1,"form-input",3,"ngModel"],["for","bio",1,"form-label"],["id","bio","name","bio","rows","4","placeholder","Tell us about yourself...",1,"form-textarea",3,"ngModel"],[1,"col-span-full","form-readonly"],[1,"form-label"],["type","email","disabled","",1,"form-input",3,"value"],[2,"display","flex","justify-content","flex-end","gap","1rem","margin-top","2rem"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-edit",3,"disabled"],["id","security-content",1,"tab-content"],[1,"security-header"],[1,"security-form-group"],["for","current-password",1,"form-label"],["type","password","id","current-password","name","currentPassword","ngModel","","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"form-input"],["for","new-password",1,"form-label"],["type","password","id","new-password","name","newPassword","ngModel","","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"form-input"],["for","confirm-password",1,"form-label"],["type","password","id","confirm-password","name","confirmPassword","ngModel","","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"form-input"],["type","submit",1,"btn-update-password",3,"disabled"],[1,"deletion-section"],[1,"deletion-title"],[1,"color-text-muted","deletion-p"],[1,"btn-delete",3,"click"],["id","avatar-content",1,"tab-content"],[1,"avatar-content-box"],[1,"color-text-muted","avatar-info"],["type","file","id","avatar-file-input","accept","image/*",2,"display","none",3,"change"],[1,"avatar-button-group"],["for","avatar-file-input",1,"btn-choose-file"],[1,"btn-remove-avatar",3,"click"],[1,"btn-upload-save",3,"click"]],template:function(t,i){t&1&&(lt(0,une,11,6,"div",2)(1,dne,11,2,"div",3),F(2,"div",4)(3,"button",5),Pe("click",function(){return i.showTab("info")}),j(4," Account Info "),B(),F(5,"button",6),Pe("click",function(){return i.showTab("security")}),j(6," Security "),B(),F(7,"button",6),Pe("click",function(){return i.showTab("avatar")}),j(8," Avatar "),B()(),F(9,"div",7),lt(10,gne,3,2,"div",8)(11,_ne,28,1,"div",9)(12,bne,16,2,"div",10),B()),t&2&&(ye("ngIf",i.mainService.notification().type),$(),ye("ngIf",i.isModalOpen()),$(2),yn("active",i.activeTab()==="info"),$(2),yn("active",i.activeTab()==="security"),$(2),yn("active",i.activeTab()==="avatar"),$(3),ye("ngIf",i.activeTab()==="info"),$(),ye("ngIf",i.activeTab()==="security"),$(),ye("ngIf",i.activeTab()==="avatar"))},dependencies:[wi,ws,dr,kc,kb,go,Oc,Nb,Km,ma,Ym],styles:[".color-bg-primary[_ngcontent-%COMP%]{background-color:#01140f}.color-bg-card[_ngcontent-%COMP%]{background-color:#051e14}.color-bg-field[_ngcontent-%COMP%]{background-color:#ffffff0d}.color-text-primary[_ngcontent-%COMP%]{color:#e8ffe5}.color-text-muted[_ngcontent-%COMP%]{color:#b8ffce}.color-accent-dark-border[_ngcontent-%COMP%]{border-color:#005c2e}.color-accent-green[_ngcontent-%COMP%]{color:#00e676}.color-red[_ngcontent-%COMP%]{color:#f87171}.color-bg-red[_ngcontent-%COMP%]{background-color:#dc2626}.color-bg-red-hover[_ngcontent-%COMP%]{background-color:#b91c1c}.color-text-dark[_ngcontent-%COMP%]{color:#01210f}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0}body[_ngcontent-%COMP%]{font-family:Inter,sans-serif;background-color:#01140f;color:#e8ffe5;min-height:100vh;height:100%;display:flex;align-items:flex-start;justify-content:center;padding:1rem}@media (min-width: 768px){body[_ngcontent-%COMP%]{padding:2rem}}.card-container[_ngcontent-%COMP%]{max-width:896px;width:100%;margin:1rem auto 0;background-color:#051e14;border-radius:1rem;border:1px solid #005c2e;padding:2.5rem;box-shadow:0 0 30px #00e67633}@media (min-width: 768px){.card-container[_ngcontent-%COMP%]{margin-top:3rem}}@media (max-width: 767px){.card-container[_ngcontent-%COMP%]{padding:1.5rem}}.header-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start;border-bottom:1px solid #005c2e;padding-bottom:1rem;margin-bottom:1.5rem}@media (min-width: 640px){.header-section[_ngcontent-%COMP%]{flex-direction:row;align-items:center}}.header-title[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:800;margin-bottom:.5rem;background-image:linear-gradient(90deg,#00e676,#1de9b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}@media (min-width: 640px){.header-title[_ngcontent-%COMP%]{margin-bottom:0}}.logout-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:transparent;border:1px solid #005c2e;border-radius:.75rem;color:#b8ffce;transition:all .3s ease;font-size:.875rem}.logout-btn[_ngcontent-%COMP%]:hover{border-color:#00e676;color:#00e676}.notification-area[_ngcontent-%COMP%]{padding:1rem;border-radius:.75rem;margin-bottom:1.5rem;font-size:.875rem;border:1px solid transparent;transition:opacity .3s ease}.notification-success[_ngcontent-%COMP%]{border-color:#00e676;background-color:#00e6761a;color:#00e676}.notification-error[_ngcontent-%COMP%]{border-color:#f87171;background-color:#f871711a;color:#f87171}.tab-nav[_ngcontent-%COMP%]{display:flex;column-gap:1.5rem;border-bottom:1px solid #005c2e;margin-bottom:2rem;overflow-x:auto;white-space:nowrap}.tab-button[_ngcontent-%COMP%]{padding:0 .25rem .75rem;font-weight:600;font-size:1.125rem;background:none;border:none;cursor:pointer;transition:color .3s ease;border-bottom:3px solid transparent;color:#b8ffce}.tab-button[_ngcontent-%COMP%]:hover{color:#00e676}.tab-button.active[_ngcontent-%COMP%]{border-bottom:3px solid #00e676;color:#e8ffe5}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:1rem;margin-bottom:2rem;padding:1rem;border-radius:.75rem;border:1px solid rgba(0,92,46,.5)}.profile-name[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#e8ffe5}.info-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem;margin-bottom:2rem}@media (min-width: 768px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.info-label[_ngcontent-%COMP%]{display:block;font-size:.75rem;text-transform:uppercase;font-weight:500;color:#b8ffce;margin-bottom:.25rem}.info-display[_ngcontent-%COMP%]{padding:.75rem;background-color:#ffffff0d;border-radius:.5rem;border:1px solid #005c2e;color:#e8ffe5}.info-bio[_ngcontent-%COMP%]{min-height:4rem}.info-grid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{grid-column:span 1 / span 1}@media (min-width: 768px){.info-grid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{grid-column:span 2 / span 2}}.btn-edit[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-image:linear-gradient(to right,#00e676,#1de9b6);color:#01210f;font-weight:700;border-radius:.75rem;box-shadow:0 10px 15px -3px #00e67633,0 4px 6px -2px #00e6761a;transition:background-position .3s ease;background-size:200% 100%;background-position:right bottom;border:none;cursor:pointer}.btn-edit[_ngcontent-%COMP%]:hover{background-position:left top}.btn-edit[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-position:right bottom}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;background-color:#ffffff0d;border:1px solid #005c2e;border-radius:.5rem;color:#e8ffe5;outline:none;transition:border-color .3s,box-shadow .3s}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{border-color:#00e676;box-shadow:0 0 0 2px #00e67680}.form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#b8ffce;margin-bottom:.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.col-span-full[_ngcontent-%COMP%]{grid-column:span 2 / span 2}.form-readonly[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.form-readonly[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#01140f;border:1px dashed #005c2e;color:#b8ffce}.btn-cancel[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:transparent;border:1px solid #4b5563;border-radius:.75rem;color:#fff;transition:border-color .3s;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]:hover{border-color:#fff}.security-header[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#e8ffe5;margin-bottom:1.5rem;border-bottom:1px solid #005c2e;padding-bottom:.75rem}.security-form-group[_ngcontent-%COMP%]{max-width:448px;margin-bottom:1.5rem;display:flex;flex-direction:column;row-gap:1rem}.btn-update-password[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-image:linear-gradient(to right,#00e676,#1de9b6);color:#01210f;font-weight:700;border-radius:.75rem;transition:background-position .3s ease;background-size:200% 100%;background-position:right bottom;align-self:flex-end;margin-top:1.5rem;border:none;cursor:pointer}.btn-update-password[_ngcontent-%COMP%]:hover{background-position:left top}.btn-update-password[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-position:right bottom}.deletion-section[_ngcontent-%COMP%]{margin-top:2.5rem;padding-top:1.5rem;border-top:1px solid #005c2e}.deletion-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#f87171;margin-bottom:1rem}.deletion-p[_ngcontent-%COMP%]{margin-bottom:1.5rem;max-width:512px}.btn-delete[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:#dc2626;border-radius:.75rem;color:#fff;font-weight:600;transition:background-color .3s;box-shadow:0 10px 15px -3px #dc26264d,0 4px 6px -2px #dc26261a;border:none;cursor:pointer}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#b91c1c}.avatar-content-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;row-gap:1.5rem;padding:1.5rem;background-color:#051e14;border:1px solid #005c2e;border-radius:.75rem;max-width:448px;margin:0 auto}.avatar-preview-large[_ngcontent-%COMP%]{width:7rem;height:7rem;border-radius:9999px;background-image:linear-gradient(to bottom right,#00e676,#1de9b6);display:flex;align-items:center;justify-content:center;color:#01210f;font-size:2.25rem;font-weight:700;box-shadow:0 0 0 4px #005c2e;margin-bottom:1rem}.avatar-setting[_ngcontent-%COMP%]{background-size:cover;background-position:center;border:2px solid #00e676}.avatar-info[_ngcontent-%COMP%]{font-size:.875rem}.avatar-button-group[_ngcontent-%COMP%]{display:flex;column-gap:1rem}.btn-choose-file[_ngcontent-%COMP%]{cursor:pointer;padding:.75rem 1.5rem;background-color:transparent;border:1px solid #4b5563;border-radius:.75rem;color:#fff;transition:border-color .3s}.btn-choose-file[_ngcontent-%COMP%]:hover{border-color:#fff}.btn-remove-avatar[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:#dc2626;border-radius:.75rem;color:#fff;font-weight:600;transition:background-color .3s;border:none;cursor:pointer}.btn-remove-avatar[_ngcontent-%COMP%]:hover{background-color:#b91c1c}.btn-upload-save[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.5rem;background-image:linear-gradient(to right,#00e676,#1de9b6);color:#01210f;font-weight:700;border-radius:.75rem;transition:background-position .3s ease;background-size:200% 100%;background-position:right bottom;margin-top:1rem;border:none;cursor:pointer}.btn-upload-save[_ngcontent-%COMP%]:hover{background-position:left top}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000c;z-index:50;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease}.modal-backdrop.active[_ngcontent-%COMP%]{opacity:1}.modal-card[_ngcontent-%COMP%]{background-color:#051e14;border:1px solid #005c2e;padding:2rem;border-radius:.75rem;max-width:384px;width:100%;box-shadow:0 0 30px #00e67633}@media (max-width: 767px){.modal-card[_ngcontent-%COMP%]{padding:1.5rem}}.modal-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#f87171;margin-bottom:1rem}.modal-message[_ngcontent-%COMP%]{color:#b8ffce;margin-bottom:1.5rem}.modal-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:1rem;justify-content:flex-end}@media (min-width: 640px){.modal-actions[_ngcontent-%COMP%]{flex-direction:row;column-gap:1rem}}.btn-modal-cancel[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;background-color:transparent;border:1px solid #4b5563;border-radius:.5rem;color:#fff;transition:border-color .3s;cursor:pointer}.btn-modal-cancel[_ngcontent-%COMP%]:hover{border-color:#fff}.btn-modal-delete[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;background-color:#dc2626;border-radius:.5rem;color:#fff;font-weight:600;transition:background-color .3s;border:none;cursor:pointer}.btn-modal-delete[_ngcontent-%COMP%]:hover{background-color:#b91c1c}"]})};function eg(n){return n+.5|0}var Lc=(n,e,t)=>Math.max(Math.min(n,t),e);function Jm(n){return Lc(eg(n*2.55),0,255)}function Fc(n){return Lc(eg(n*255),0,255)}function ga(n){return Lc(eg(n/2.55)/100,0,1)}function Nz(n){return Lc(eg(n*100),0,100)}var os={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},u1=[..."0123456789ABCDEF"],Ene=n=>u1[n&15],wne=n=>u1[(n&240)>>4]+u1[n&15],$b=n=>(n&240)>>4===(n&15),xne=n=>$b(n.r)&&$b(n.g)&&$b(n.b)&&$b(n.a);function Sne(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&os[n[1]]*17,g:255&os[n[2]]*17,b:255&os[n[3]]*17,a:e===5?os[n[4]]*17:255}:(e===7||e===9)&&(t={r:os[n[1]]<<4|os[n[2]],g:os[n[3]]<<4|os[n[4]],b:os[n[5]]<<4|os[n[6]],a:e===9?os[n[7]]<<4|os[n[8]]:255})),t}var Tne=(n,e)=>n<255?e(n):"";function Ine(n){var e=xne(n)?Ene:wne;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Tne(n.a,e):void 0}var Cne=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Fz(n,e,t){let i=e*Math.min(t,1-t),r=(s,o=(s+n/30)%12)=>t-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function Mne(n,e,t){let i=(r,s=(r+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function Ane(n,e,t){let i=Fz(n,1,.5),r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function Dne(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function d1(n){let t=n.r/255,i=n.g/255,r=n.b/255,s=Math.max(t,i,r),o=Math.min(t,i,r),a=(s+o)/2,c,l,u;return s!==o&&(u=s-o,l=a>.5?u/(2-s-o):u/(s+o),c=Dne(t,i,r,u,s),c=c*60+.5),[c|0,l||0,a]}function h1(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(Fc)}function f1(n,e,t){return h1(Fz,n,e,t)}function Rne(n,e,t){return h1(Ane,n,e,t)}function Pne(n,e,t){return h1(Mne,n,e,t)}function Vz(n){return(n%360+360)%360}function Nne(n){let e=Cne.exec(n),t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?Jm(+e[5]):Fc(+e[5]));let r=Vz(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=Rne(r,s,o):e[1]==="hsv"?i=Pne(r,s,o):i=f1(r,s,o),{r:i[0],g:i[1],b:i[2],a:t}}function One(n,e){var t=d1(n);t[0]=Vz(t[0]+e),t=f1(t),n.r=t[0],n.g=t[1],n.b=t[2]}function kne(n){if(!n)return;let e=d1(n),t=e[0],i=Nz(e[1]),r=Nz(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${ga(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}var Oz={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},kz={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Lne(){let n={},e=Object.keys(kz),t=Object.keys(Oz),i,r,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],r=0;r<t.length;r++)s=t[r],a=a.replace(s,Oz[s]);s=parseInt(kz[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}var qb;function Fne(n){qb||(qb=Lne(),qb.transparent=[0,0,0,0]);let e=qb[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}var Vne=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Une(n){let e=Vne.exec(n),t=255,i,r,s;if(e){if(e[7]!==i){let o=+e[7];t=e[8]?Jm(o):Lc(o*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?Jm(i):Lc(i,0,255)),r=255&(e[4]?Jm(r):Lc(r,0,255)),s=255&(e[6]?Jm(s):Lc(s,0,255)),{r:i,g:r,b:s,a:t}}}function Bne(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ga(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}var l1=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Hh=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function zne(n,e,t){let i=Hh(ga(n.r)),r=Hh(ga(n.g)),s=Hh(ga(n.b));return{r:Fc(l1(i+t*(Hh(ga(e.r))-i))),g:Fc(l1(r+t*(Hh(ga(e.g))-r))),b:Fc(l1(s+t*(Hh(ga(e.b))-s))),a:n.a+t*(e.a-n.a)}}function Xb(n,e,t){if(n){let i=d1(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=f1(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function Uz(n,e){return n&&Object.assign(e||{},n)}function Lz(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Fc(n[3]))):(e=Uz(n,{r:0,g:0,b:0,a:1}),e.a=Fc(e.a)),e}function Hne(n){return n.charAt(0)==="r"?Une(n):Nne(n)}var Qm=class n{constructor(e){if(e instanceof n)return e;let t=typeof e,i;t==="object"?i=Lz(e):t==="string"&&(i=Sne(e)||Fne(e)||Hne(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=Uz(this._rgb);return e&&(e.a=ga(e.a)),e}set rgb(e){this._rgb=Lz(e)}rgbString(){return this._valid?Bne(this._rgb):void 0}hexString(){return this._valid?Ine(this._rgb):void 0}hslString(){return this._valid?kne(this._rgb):void 0}mix(e,t){if(e){let i=this.rgb,r=e.rgb,s,o=t===s?.5:t,a=2*o-1,c=i.a-r.a,l=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;s=1-l,i.r=255&l*i.r+s*r.r+.5,i.g=255&l*i.g+s*r.g+.5,i.b=255&l*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=zne(this._rgb,e._rgb,t)),this}clone(){return new n(this.rgb)}alpha(e){return this._rgb.a=Fc(e),this}clearer(e){let t=this._rgb;return t.a*=1-e,this}greyscale(){let e=this._rgb,t=eg(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){let t=this._rgb;return t.a*=1+e,this}negate(){let e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Xb(this._rgb,2,e),this}darken(e){return Xb(this._rgb,2,-e),this}saturate(e){return Xb(this._rgb,1,e),this}desaturate(e){return Xb(this._rgb,1,-e),this}rotate(e){return One(this._rgb,e),this}};function bo(){}var Kz=(()=>{let n=0;return()=>n++})();function kt(n){return n==null}function Sn(n){if(Array.isArray&&Array.isArray(n))return!0;let e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ft(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Fn(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function xr(n,e){return Fn(n)?n:e}function vt(n,e){return typeof n>"u"?e:n}var Zz=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,_1=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function bn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function cn(n,e,t,i){let r,s,o;if(Sn(n))if(s=n.length,i)for(r=s-1;r>=0;r--)e.call(t,n[r],r);else for(r=0;r<s;r++)e.call(t,n[r],r);else if(Ft(n))for(o=Object.keys(n),s=o.length,r=0;r<s;r++)e.call(t,n[o[r]],o[r])}function ig(n,e){let t,i,r,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],s=e[t],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Jb(n){if(Sn(n))return n.map(Jb);if(Ft(n)){let e=Object.create(null),t=Object.keys(n),i=t.length,r=0;for(;r<i;++r)e[t[r]]=Jb(n[t[r]]);return e}return n}function Jz(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function jne(n,e,t,i){if(!Jz(n))return;let r=e[n],s=t[n];Ft(r)&&Ft(s)?Gh(r,s,i):e[n]=Jb(s)}function Gh(n,e,t){let i=Sn(e)?e:[e],r=i.length;if(!Ft(n))return n;t=t||{};let s=t.merger||jne,o;for(let a=0;a<r;++a){if(o=i[a],!Ft(o))continue;let c=Object.keys(o);for(let l=0,u=c.length;l<u;++l)s(c[l],n,o,t)}return n}function $h(n,e){return Gh(n,e,{merger:Gne})}function Gne(n,e,t){if(!Jz(n))return;let i=e[n],r=t[n];Ft(i)&&Ft(r)?$h(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Jb(r))}var Bz={"":n=>n,x:n=>n.x,y:n=>n.y};function Wne(n){let e=n.split("."),t=[],i="";for(let r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function $ne(n){let e=Wne(n);return t=>{for(let i of e){if(i==="")break;t=t&&t[i]}return t}}function va(n,e){return(Bz[e]||(Bz[e]=$ne(e)))(n)}function nE(n){return n.charAt(0).toUpperCase()+n.slice(1)}var qh=n=>typeof n<"u",_a=n=>typeof n=="function",y1=(n,e)=>{if(n.size!==e.size)return!1;for(let t of n)if(!e.has(t))return!1;return!0};function Qz(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}var Yt=Math.PI,Tn=2*Yt,qne=Tn+Yt,Qb=Number.POSITIVE_INFINITY,Xne=Yt/180,$n=Yt/2,Eu=Yt/4,zz=Yt*2/3,ya=Math.log10,As=Math.sign;function Xh(n,e,t){return Math.abs(n-e)<t}function v1(n){let e=Math.round(n);n=Xh(n,e,n/1e3)?e:n;let t=Math.pow(10,Math.floor(ya(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function eH(n){let e=[],t=Math.sqrt(n),i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,s)=>r-s).pop(),e}function Yne(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Su(n){return!Yne(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function tH(n,e){let t=Math.round(n);return t-e<=n&&t+e>=n}function b1(n,e,t){let i,r,s;for(i=0,r=n.length;i<r;i++)s=n[i][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function as(n){return n*(Yt/180)}function iE(n){return n*(180/Yt)}function E1(n){if(!Fn(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function w1(n,e){let t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i),s=Math.atan2(i,t);return s<-.5*Yt&&(s+=Tn),{angle:s,distance:r}}function eE(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Kne(n,e){return(n-e+qne)%Tn-Yt}function Li(n){return(n%Tn+Tn)%Tn}function Yh(n,e,t,i){let r=Li(n),s=Li(e),o=Li(t),a=Li(s-r),c=Li(o-r),l=Li(r-s),u=Li(r-o);return r===s||r===o||i&&s===o||a>c&&l<u}function mi(n,e,t){return Math.max(e,Math.min(t,n))}function nH(n){return mi(n,-32768,32767)}function Eo(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function rE(n,e,t){t=t||(o=>n[o]<e);let i=n.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,t(s)?r=s:i=s;return{lo:r,hi:i}}var yo=(n,e,t,i)=>rE(n,t,i?r=>{let s=n[r][e];return s<t||s===t&&n[r+1][e]===t}:r=>n[r][e]<t),iH=(n,e,t)=>rE(n,t,i=>n[i][e]>=t);function rH(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}var sH=["push","pop","shift","splice","unshift"];function oH(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),sH.forEach(t=>{let i="_onData"+nE(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){let o=r.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function x1(n,e){let t=n._chartjs;if(!t)return;let i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(sH.forEach(s=>{delete n[s]}),delete n._chartjs)}function S1(n){let e=new Set(n);return e.size===n.length?n:Array.from(e)}var T1=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function I1(n,e){let t=[],i=!1;return function(...r){t=r,i||(i=!0,T1.call(window,()=>{i=!1,n.apply(e,t)}))}}function aH(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}var sE=n=>n==="start"?"left":n==="end"?"right":"center",Fi=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,cH=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function C1(n,e,t){let i=e.length,r=0,s=i;if(n._sorted){let{iScale:o,vScale:a,_parsed:c}=n,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:d,max:h,minDefined:p,maxDefined:g}=o.getUserBounds();if(p){if(r=Math.min(yo(c,u,d).lo,t?i:yo(e,u,o.getPixelForValue(d)).lo),l){let y=c.slice(0,r+1).reverse().findIndex(m=>!kt(m[a.axis]));r-=Math.max(0,y)}r=mi(r,0,i-1)}if(g){let y=Math.max(yo(c,o.axis,h,!0).hi+1,t?0:yo(e,u,o.getPixelForValue(h),!0).hi+1);if(l){let m=c.slice(y-1).findIndex(_=>!kt(_[a.axis]));y+=Math.max(0,m)}s=mi(y,r,i)-r}else s=i-r}return{start:r,count:s}}function M1(n){let{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;let s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),s}var Yb=n=>n===0||n===1,Hz=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Tn/t)),jz=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Tn/t)+1,jh={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*$n)+1,easeOutSine:n=>Math.sin(n*$n),easeInOutSine:n=>-.5*(Math.cos(Yt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Yb(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Yb(n)?n:Hz(n,.075,.3),easeOutElastic:n=>Yb(n)?n:jz(n,.075,.3),easeInOutElastic(n){return Yb(n)?n:n<.5?.5*Hz(n*2,.1125,.45):.5+.5*jz(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-jh.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?jh.easeInBounce(n*2)*.5:jh.easeOutBounce(n*2-1)*.5+.5};function A1(n){if(n&&typeof n=="object"){let e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function D1(n){return A1(n)?n:new Qm(n)}function p1(n){return A1(n)?n:new Qm(n).saturate(.5).darken(.1).hexString()}var Zne=["x","y","borderWidth","radius","tension"],Jne=["color","borderColor","backgroundColor"];function Qne(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:Jne},numbers:{type:"number",properties:Zne}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function eie(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var Gz=new Map;function tie(n,e){e=e||{};let t=n+JSON.stringify(e),i=Gz.get(t);return i||(i=new Intl.NumberFormat(n,e),Gz.set(t,i)),i}function Kh(n,e,t){return tie(e,t).format(n)}var lH={values(n){return Sn(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";let i=this.chart.options.locale,r,s=n;if(t.length>1){let l=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(l<1e-4||l>1e15)&&(r="scientific"),s=nie(n,t)}let o=ya(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Kh(n,i,c)},logarithmic(n,e,t){if(n===0)return"0";let i=t[e].significand||n/Math.pow(10,Math.floor(ya(n)));return[1,2,3,5,10,15].includes(i)||e>.8*t.length?lH.numeric.call(this,n,e,t):""}};function nie(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var rg={formatters:lH};function iie(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:rg.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}var Bc=Object.create(null),oE=Object.create(null);function tg(n,e){if(!e)return n;let t=e.split(".");for(let i=0,r=t.length;i<r;++i){let s=t[i];n=n[s]||(n[s]=Object.create(null))}return n}function m1(n,e,t){return typeof e=="string"?Gh(tg(n,e),t):Gh(tg(n,""),e)}var g1=class{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>p1(r.backgroundColor),this.hoverBorderColor=(i,r)=>p1(r.borderColor),this.hoverColor=(i,r)=>p1(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return m1(this,e,t)}get(e){return tg(this,e)}describe(e,t){return m1(oE,e,t)}override(e,t){return m1(Bc,e,t)}route(e,t,i,r){let s=tg(this,e),o=tg(this,i),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){let c=this[a],l=o[r];return Ft(c)?Object.assign({},l,c):vt(c,l)},set(c){this[a]=c}}})}apply(e){e.forEach(t=>t(this))}},Cn=new g1({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Qne,eie,iie]);function rie(n){return!n||kt(n.size)||kt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function ng(n,e,t,i,r){let s=e[r];return s||(s=e[r]=n.measureText(r).width,t.push(r)),s>i&&(i=s),i}function uH(n,e,t,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},s=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let o=0,a=t.length,c,l,u,d,h;for(c=0;c<a;c++)if(d=t[c],d!=null&&!Sn(d))o=ng(n,r,s,o,d);else if(Sn(d))for(l=0,u=d.length;l<u;l++)h=d[l],h!=null&&!Sn(h)&&(o=ng(n,r,s,o,h));n.restore();let p=s.length/2;if(p>t.length){for(c=0;c<p;c++)delete r[s[c]];s.splice(0,p)}return o}function zc(n,e,t){let i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function R1(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function aE(n,e,t,i){P1(n,e,t,i,null)}function P1(n,e,t,i,r){let s,o,a,c,l,u,d,h,p=e.pointStyle,g=e.rotation,y=e.radius,m=(g||0)*Xne;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(m),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),n.restore();return}if(!(isNaN(y)||y<=0)){switch(n.beginPath(),p){default:r?n.ellipse(t,i,r/2,y,0,0,Tn):n.arc(t,i,y,0,Tn),n.closePath();break;case"triangle":u=r?r/2:y,n.moveTo(t+Math.sin(m)*u,i-Math.cos(m)*y),m+=zz,n.lineTo(t+Math.sin(m)*u,i-Math.cos(m)*y),m+=zz,n.lineTo(t+Math.sin(m)*u,i-Math.cos(m)*y),n.closePath();break;case"rectRounded":l=y*.516,c=y-l,o=Math.cos(m+Eu)*c,d=Math.cos(m+Eu)*(r?r/2-l:c),a=Math.sin(m+Eu)*c,h=Math.sin(m+Eu)*(r?r/2-l:c),n.arc(t-d,i-a,l,m-Yt,m-$n),n.arc(t+h,i-o,l,m-$n,m),n.arc(t+d,i+a,l,m,m+$n),n.arc(t-h,i+o,l,m+$n,m+Yt),n.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*y,u=r?r/2:c,n.rect(t-u,i-c,2*u,2*c);break}m+=Eu;case"rectRot":d=Math.cos(m)*(r?r/2:y),o=Math.cos(m)*y,a=Math.sin(m)*y,h=Math.sin(m)*(r?r/2:y),n.moveTo(t-d,i-a),n.lineTo(t+h,i-o),n.lineTo(t+d,i+a),n.lineTo(t-h,i+o),n.closePath();break;case"crossRot":m+=Eu;case"cross":d=Math.cos(m)*(r?r/2:y),o=Math.cos(m)*y,a=Math.sin(m)*y,h=Math.sin(m)*(r?r/2:y),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+h,i-o),n.lineTo(t-h,i+o);break;case"star":d=Math.cos(m)*(r?r/2:y),o=Math.cos(m)*y,a=Math.sin(m)*y,h=Math.sin(m)*(r?r/2:y),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+h,i-o),n.lineTo(t-h,i+o),m+=Eu,d=Math.cos(m)*(r?r/2:y),o=Math.cos(m)*y,a=Math.sin(m)*y,h=Math.sin(m)*(r?r/2:y),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+h,i-o),n.lineTo(t-h,i+o);break;case"line":o=r?r/2:Math.cos(m)*y,a=Math.sin(m)*y,n.moveTo(t-o,i-a),n.lineTo(t+o,i+a);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(m)*(r?r/2:y),i+Math.sin(m)*y);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function vo(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function sg(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function og(n){n.restore()}function dH(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){let s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function hH(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function sie(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),kt(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function oie(n,e,t,i,r){if(r.strikethrough||r.underline){let s=n.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,c=t-s.actualBoundingBoxAscent,l=t+s.actualBoundingBoxDescent,u=r.strikethrough?(c+l)/2:l;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function aie(n,e){let t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Hc(n,e,t,i,r,s={}){let o=Sn(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="",c,l;for(n.save(),n.font=r.string,sie(n,s),c=0;c<o.length;++c)l=o[c],s.backdrop&&aie(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),kt(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(l,t,i,s.maxWidth)),n.fillText(l,t,i,s.maxWidth),oie(n,t,i,l,s),i+=Number(r.lineHeight);n.restore()}function Zh(n,e){let{x:t,y:i,w:r,h:s,radius:o}=e;n.arc(t+o.topLeft,i+o.topLeft,o.topLeft,1.5*Yt,Yt,!0),n.lineTo(t,i+s-o.bottomLeft),n.arc(t+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,Yt,$n,!0),n.lineTo(t+r-o.bottomRight,i+s),n.arc(t+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,$n,0,!0),n.lineTo(t+r,i+o.topRight),n.arc(t+r-o.topRight,i+o.topRight,o.topRight,0,-$n,!0),n.lineTo(t+o.topLeft,i)}var cie=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,lie=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function uie(n,e){let t=(""+n).match(cie);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}var die=n=>+n||0;function cE(n,e){let t={},i=Ft(e),r=i?Object.keys(e):e,s=Ft(n)?i?o=>vt(n[o],n[e[o]]):o=>n[o]:()=>n;for(let o of r)t[o]=die(s(o));return t}function N1(n){return cE(n,{top:"y",right:"x",bottom:"y",left:"x"})}function jc(n){return cE(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Vi(n){let e=N1(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ui(n,e){n=n||{},e=e||Cn.font;let t=vt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=vt(n.style,e.style);i&&!(""+i).match(lie)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);let r={family:vt(n.family,e.family),lineHeight:uie(vt(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:vt(n.weight,e.weight),string:""};return r.string=rie(r),r}function Jh(n,e,t,i){let r=!0,s,o,a;for(s=0,o=n.length;s<o;++s)if(a=n[s],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),r=!1),t!==void 0&&Sn(a)&&(a=a[t%a.length],r=!1),a!==void 0))return i&&!r&&(i.cacheable=!1),a}function fH(n,e,t){let{min:i,max:r}=n,s=_1(e,(r-i)/2),o=(a,c)=>t&&a===0?0:a+c;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function ba(n,e){return Object.assign(Object.create(n),e)}function lE(n,e=[""],t,i,r=()=>n[0]){let s=t||n;typeof i>"u"&&(i=gH("_fallback",n));let o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>lE([a,...n],e,s,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return pH(a,c,()=>vie(c,e,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return $z(a).includes(c)},ownKeys(a){return $z(a)},set(a,c,l){let u=a._storage||(a._storage=r());return a[c]=u[c]=l,delete a._keys,!0}})}function xu(n,e,t,i){let r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:O1(n,i),setContext:s=>xu(n,s,t,i),override:s=>xu(n.override(s),e,t,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return pH(s,o,()=>fie(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function O1(n,e={scriptable:!0,indexable:!0}){let{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:_a(t)?t:()=>t,isIndexable:_a(i)?i:()=>i}}var hie=(n,e)=>n?n+nE(e):e,k1=(n,e)=>Ft(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function pH(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];let i=t();return n[e]=i,i}function fie(n,e,t){let{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=n,a=i[e];return _a(a)&&o.isScriptable(e)&&(a=pie(e,a,n,t)),Sn(a)&&a.length&&(a=mie(e,a,n,o.isIndexable)),k1(e,a)&&(a=xu(a,r,s&&s[e],o)),a}function pie(n,e,t,i){let{_proxy:r,_context:s,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=e(s,o||i);return a.delete(n),k1(n,c)&&(c=L1(r._scopes,r,n,c)),c}function mie(n,e,t,i){let{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=t;if(typeof s.index<"u"&&i(n))return e[s.index%e.length];if(Ft(e[0])){let c=e,l=r._scopes.filter(u=>u!==c);e=[];for(let u of c){let d=L1(l,r,n,u);e.push(xu(d,s,o&&o[n],a))}}return e}function mH(n,e,t){return _a(n)?n(e,t):n}var gie=(n,e)=>n===!0?e:typeof n=="string"?va(e,n):void 0;function _ie(n,e,t,i,r){for(let s of e){let o=gie(t,s);if(o){n.add(o);let a=mH(o._fallback,t,r);if(typeof a<"u"&&a!==t&&a!==i)return a}else if(o===!1&&typeof i<"u"&&t!==i)return null}return!1}function L1(n,e,t,i){let r=e._rootScopes,s=mH(e._fallback,t,i),o=[...n,...r],a=new Set;a.add(i);let c=Wz(a,o,t,s||t,i);return c===null||typeof s<"u"&&s!==t&&(c=Wz(a,o,s,c,i),c===null)?!1:lE(Array.from(a),[""],r,s,()=>yie(e,t,i))}function Wz(n,e,t,i,r){for(;t;)t=_ie(n,e,t,i,r);return t}function yie(n,e,t){let i=n._getTarget();e in i||(i[e]={});let r=i[e];return Sn(r)&&Ft(t)?t:r||{}}function vie(n,e,t,i){let r;for(let s of e)if(r=gH(hie(s,n),t),typeof r<"u")return k1(n,r)?L1(t,i,n,r):r}function gH(n,e){for(let t of e){if(!t)continue;let i=t[n];if(typeof i<"u")return i}}function $z(n){let e=n._keys;return e||(e=n._keys=bie(n._scopes)),e}function bie(n){let e=new Set;for(let t of n)for(let i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function F1(n,e,t,i){let{iScale:r}=n,{key:s="r"}=this._parsing,o=new Array(i),a,c,l,u;for(a=0,c=i;a<c;++a)l=a+t,u=e[l],o[a]={r:r.parse(va(u,s),l)};return o}var Eie=Number.EPSILON||1e-14,Wh=(n,e)=>e<n.length&&!n[e].skip&&n[e],_H=n=>n==="x"?"y":"x";function wie(n,e,t,i){let r=n.skip?e:n,s=e,o=t.skip?e:t,a=eE(s,r),c=eE(o,s),l=a/(a+c),u=c/(a+c);l=isNaN(l)?0:l,u=isNaN(u)?0:u;let d=i*l,h=i*u;return{previous:{x:s.x-d*(o.x-r.x),y:s.y-d*(o.y-r.y)},next:{x:s.x+h*(o.x-r.x),y:s.y+h*(o.y-r.y)}}}function xie(n,e,t){let i=n.length,r,s,o,a,c,l=Wh(n,0);for(let u=0;u<i-1;++u)if(c=l,l=Wh(n,u+1),!(!c||!l)){if(Xh(e[u],0,Eie)){t[u]=t[u+1]=0;continue}r=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=r*o*e[u],t[u+1]=s*o*e[u])}}function Sie(n,e,t="x"){let i=_H(t),r=n.length,s,o,a,c=Wh(n,0);for(let l=0;l<r;++l){if(o=a,a=c,c=Wh(n,l+1),!a)continue;let u=a[t],d=a[i];o&&(s=(u-o[t])/3,a[`cp1${t}`]=u-s,a[`cp1${i}`]=d-s*e[l]),c&&(s=(c[t]-u)/3,a[`cp2${t}`]=u+s,a[`cp2${i}`]=d+s*e[l])}}function Tie(n,e="x"){let t=_H(e),i=n.length,r=Array(i).fill(0),s=Array(i),o,a,c,l=Wh(n,0);for(o=0;o<i;++o)if(a=c,c=l,l=Wh(n,o+1),!!c){if(l){let u=l[e]-c[e];r[o]=u!==0?(l[t]-c[t])/u:0}s[o]=a?l?As(r[o-1])!==As(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}xie(n,r,s),Sie(n,s,e)}function Kb(n,e,t){return Math.max(Math.min(n,t),e)}function Iie(n,e){let t,i,r,s,o,a=vo(n[0],e);for(t=0,i=n.length;t<i;++t)o=s,s=a,a=t<i-1&&vo(n[t+1],e),s&&(r=n[t],o&&(r.cp1x=Kb(r.cp1x,e.left,e.right),r.cp1y=Kb(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=Kb(r.cp2x,e.left,e.right),r.cp2y=Kb(r.cp2y,e.top,e.bottom)))}function yH(n,e,t,i,r){let s,o,a,c;if(e.spanGaps&&(n=n.filter(l=>!l.skip)),e.cubicInterpolationMode==="monotone")Tie(n,r);else{let l=i?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],c=wie(l,a,n[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,l=a}e.capBezierPoints&&Iie(n,t)}function uE(){return typeof window<"u"&&typeof document<"u"}function dE(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function tE(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}var hE=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Cie(n,e){return hE(n).getPropertyValue(e)}var Mie=["top","right","bottom","left"];function wu(n,e,t){let i={};t=t?"-"+t:"";for(let r=0;r<4;r++){let s=Mie[r];i[s]=parseFloat(n[e+"-"+s+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}var Aie=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function Die(n,e){let t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:s}=i,o=!1,a,c;if(Aie(r,s,n.target))a=r,c=s;else{let l=e.getBoundingClientRect();a=i.clientX-l.left,c=i.clientY-l.top,o=!0}return{x:a,y:c,box:o}}function Gc(n,e){if("native"in n)return n;let{canvas:t,currentDevicePixelRatio:i}=e,r=hE(t),s=r.boxSizing==="border-box",o=wu(r,"padding"),a=wu(r,"border","width"),{x:c,y:l,box:u}=Die(n,t),d=o.left+(u&&a.left),h=o.top+(u&&a.top),{width:p,height:g}=e;return s&&(p-=o.width+a.width,g-=o.height+a.height),{x:Math.round((c-d)/p*t.width/i),y:Math.round((l-h)/g*t.height/i)}}function Rie(n,e,t){let i,r;if(e===void 0||t===void 0){let s=n&&dE(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{let o=s.getBoundingClientRect(),a=hE(s),c=wu(a,"border","width"),l=wu(a,"padding");e=o.width-l.width-c.width,t=o.height-l.height-c.height,i=tE(a.maxWidth,s,"clientWidth"),r=tE(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:i||Qb,maxHeight:r||Qb}}var Uc=n=>Math.round(n*10)/10;function vH(n,e,t,i){let r=hE(n),s=wu(r,"margin"),o=tE(r.maxWidth,n,"clientWidth")||Qb,a=tE(r.maxHeight,n,"clientHeight")||Qb,c=Rie(n,e,t),{width:l,height:u}=c;if(r.boxSizing==="content-box"){let h=wu(r,"border","width"),p=wu(r,"padding");l-=p.width+h.width,u-=p.height+h.height}return l=Math.max(0,l-s.width),u=Math.max(0,i?l/i:u-s.height),l=Uc(Math.min(l,o,c.maxWidth)),u=Uc(Math.min(u,a,c.maxHeight)),l&&!u&&(u=Uc(l/2)),(e!==void 0||t!==void 0)&&i&&c.height&&u>c.height&&(u=c.height,l=Uc(Math.floor(u*i))),{width:l,height:u}}function V1(n,e,t){let i=e||1,r=Uc(n.height*i),s=Uc(n.width*i);n.height=Uc(n.height),n.width=Uc(n.width);let o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(n.currentDevicePixelRatio=i,o.height=r,o.width=s,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}var bH=(function(){let n=!1;try{let e={get passive(){return n=!0,!1}};uE()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function U1(n,e){let t=Cie(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Vc(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function EH(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function wH(n,e,t,i){let r={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=Vc(n,r,t),a=Vc(r,s,t),c=Vc(s,e,t),l=Vc(o,a,t),u=Vc(a,c,t);return Vc(l,u,t)}var Pie=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},Nie=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Tu(n,e,t){return n?Pie(e,t):Nie()}function B1(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function z1(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function xH(n){return n==="angle"?{between:Yh,compare:Kne,normalize:Li}:{between:Eo,compare:(e,t)=>e-t,normalize:e=>e}}function qz({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function Oie(n,e,t){let{property:i,start:r,end:s}=t,{between:o,normalize:a}=xH(i),c=e.length,{start:l,end:u,loop:d}=n,h,p;if(d){for(l+=c,u+=c,h=0,p=c;h<p&&o(a(e[l%c][i]),r,s);++h)l--,u--;l%=c,u%=c}return u<l&&(u+=c),{start:l,end:u,loop:d,style:n.style}}function H1(n,e,t){if(!t)return[n];let{property:i,start:r,end:s}=t,o=e.length,{compare:a,between:c,normalize:l}=xH(i),{start:u,end:d,loop:h,style:p}=Oie(n,e,t),g=[],y=!1,m=null,_,I,M,C=()=>c(r,M,_)&&a(r,M)!==0,P=()=>a(s,_)===0||c(s,M,_),N=()=>y||C(),S=()=>!y||P();for(let w=u,b=u;w<=d;++w)I=e[w%o],!I.skip&&(_=l(I[i]),_!==M&&(y=c(_,r,s),m===null&&N()&&(m=a(_,r)===0?w:b),m!==null&&S()&&(g.push(qz({start:m,end:w,loop:h,count:o,style:p})),m=null),b=w,M=_));return m!==null&&g.push(qz({start:m,end:d,loop:h,count:o,style:p})),g}function j1(n,e){let t=[],i=n.segments;for(let r=0;r<i.length;r++){let s=H1(i[r],n.points,e);s.length&&t.push(...s)}return t}function kie(n,e,t,i){let r=0,s=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(s+=r);s>r&&n[s%e].skip;)s--;return s%=e,{start:r,end:s}}function Lie(n,e,t,i){let r=n.length,s=[],o=e,a=n[e],c;for(c=e+1;c<=t;++c){let l=n[c%r];l.skip||l.stop?a.skip||(i=!1,s.push({start:e%r,end:(c-1)%r,loop:i}),e=o=l.stop?c:null):(o=c,a.skip&&(e=c)),a=l}return o!==null&&s.push({start:e%r,end:o%r,loop:i}),s}function SH(n,e){let t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];let s=!!n._loop,{start:o,end:a}=kie(t,r,s,i);if(i===!0)return Xz(n,[{start:o,end:a,loop:s}],t,e);let c=a<o?a+r:a,l=!!n._fullLoop&&o===0&&a===r-1;return Xz(n,Lie(t,o,c,l),t,e)}function Xz(n,e,t,i){return!i||!i.setContext||!t?e:Fie(n,e,t,i)}function Fie(n,e,t,i){let r=n._chart.getContext(),s=Yz(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=t.length,l=[],u=s,d=e[0].start,h=d;function p(g,y,m,_){let I=a?-1:1;if(g!==y){for(g+=c;t[g%c].skip;)g-=I;for(;t[y%c].skip;)y+=I;g%c!==y%c&&(l.push({start:g%c,end:y%c,loop:m,style:_}),u=_,d=y%c)}}for(let g of e){d=a?d:g.start;let y=t[d%c],m;for(h=d+1;h<=g.end;h++){let _=t[h%c];m=Yz(i.setContext(ba(r,{type:"segment",p0:y,p1:_,p0DataIndex:(h-1)%c,p1DataIndex:h%c,datasetIndex:o}))),Vie(m,u)&&p(d,h-1,g.loop,u),y=_,u=m}d<h-1&&p(d,h-1,g.loop,u)}return l}function Yz(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Vie(n,e){if(!e)return!1;let t=[],i=function(r,s){return A1(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function Zb(n,e,t){return n.options.clip?n[t]:e[t]}function Uie(n,e){let{xScale:t,yScale:i}=n;return t&&i?{left:Zb(t,e,"left"),right:Zb(t,e,"right"),top:Zb(i,e,"top"),bottom:Zb(i,e,"bottom")}:e}function G1(n,e){let t=e._clip;if(t.disabled)return!1;let i=Uie(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}var nR=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){let s=t.listeners[r],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(i-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=T1.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;let s=i.items,o=s.length-1,a=!1,c;for(;o>=0;--o)c=s[o],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){let t=this._charts,i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){let t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;let t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){let t=this._charts.get(e);if(!t||!t.items.length)return;let i=t.items,r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}},Ea=new nR,TH="transparent",Bie={boolean(n,e,t){return t>.5?e:n},color(n,e,t){let i=D1(n||TH),r=i.valid&&D1(e||TH);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}},iR=class{constructor(e,t,i,r){let s=t[i];r=Jh([e.to,r,s,e.from]);let o=Jh([e.from,s,r]);this._active=!0,this._fn=e.fn||Bie[e.type||typeof o],this._easing=jh[e.easing]||jh.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);let r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Jh([e.to,t,r,e.from]),this._from=Jh([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){let t=e-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to,c;if(this._active=s!==a&&(o||t<i),!this._active){this._target[r]=a,this._notify(!0);return}if(t<0){this._target[r]=s;return}c=t/i%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(s,a,c)}wait(){let e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){let t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}},EE=class{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Ft(e))return;let t=Object.keys(Cn.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{let s=e[r];if(!Ft(s))return;let o={};for(let a of t)o[a]=s[a];(Sn(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,t){let i=t.options,r=Hie(e,i);if(!r)return[];let s=this._createAnimations(r,i);return i.$shared&&zie(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,t){let i=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now(),c;for(c=o.length-1;c>=0;--c){let l=o[c];if(l.charAt(0)==="$")continue;if(l==="options"){r.push(...this._animateOptions(e,t));continue}let u=t[l],d=s[l],h=i.get(l);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){e[l]=u;continue}s[l]=d=new iR(h,e,l,u),r.push(d)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}let i=this._createAnimations(e,t);if(i.length)return Ea.add(this._chart,i),!0}};function zie(n,e){let t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){let s=n[i[r]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function Hie(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function IH(n,e){let t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function jie(n,e,t){if(t===!1)return!1;let i=IH(n,t),r=IH(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function Gie(n){let e,t,i,r;return Ft(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function T4(n,e){let t=[],i=n._getSortedDatasetMetas(e),r,s;for(r=0,s=i.length;r<s;++r)t.push(i[r].index);return t}function CH(n,e,t,i={}){let r=n.keys,s=i.mode==="single",o,a,c,l;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(c=+r[o],c===t){if(u=!0,i.all)continue;break}l=n.values[c],Fn(l)&&(s||e===0||As(e)===As(l))&&(e+=l)}return!u&&!i.all?0:e}function Wie(n,e){let{iScale:t,vScale:i}=e,r=t.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length),c,l,u;for(c=0,l=o.length;c<l;++c)u=o[c],a[c]={[r]:u,[s]:n[u]};return a}function W1(n,e){let t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function $ie(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function qie(n){let{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function Xie(n,e,t){let i=n[e]||(n[e]={});return i[t]||(i[t]={})}function MH(n,e,t,i){for(let r of e.getMatchingVisibleMetas(i).reverse()){let s=n[r.index];if(t&&s>0||!t&&s<0)return r.index}return null}function AH(n,e){let{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=i,c=s.axis,l=o.axis,u=$ie(s,o,i),d=e.length,h;for(let p=0;p<d;++p){let g=e[p],{[c]:y,[l]:m}=g,_=g._stacks||(g._stacks={});h=_[l]=Xie(r,u,y),h[a]=m,h._top=MH(h,o,!0,i.type),h._bottom=MH(h,o,!1,i.type);let I=h._visualValues||(h._visualValues={});I[a]=m}}function $1(n,e){let t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function Yie(n,e){return ba(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Kie(n,e,t){return ba(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function ag(n,e){let t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(let r of e){let s=r._stacks;if(!s||s[i]===void 0||s[i][t]===void 0)return;delete s[i][t],s[i]._visualValues!==void 0&&s[i]._visualValues[t]!==void 0&&delete s[i]._visualValues[t]}}}var q1=n=>n==="reset"||n==="none",DH=(n,e)=>e?n:Object.assign({},n),Zie=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:T4(t,!0),values:null},$c=(()=>{class n{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,i){this.chart=t,this._ctx=t.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=W1(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&ag(this._cachedMeta),this.index=t}linkScales(){let t=this.chart,i=this._cachedMeta,r=this.getDataset(),s=(h,p,g,y)=>h==="x"?p:h==="r"?y:g,o=i.xAxisID=vt(r.xAxisID,$1(t,"x")),a=i.yAxisID=vt(r.yAxisID,$1(t,"y")),c=i.rAxisID=vt(r.rAxisID,$1(t,"r")),l=i.indexAxis,u=i.iAxisID=s(l,o,a,c),d=i.vAxisID=s(l,a,o,c);i.xScale=this.getScaleForId(o),i.yScale=this.getScaleForId(a),i.rScale=this.getScaleForId(c),i.iScale=this.getScaleForId(u),i.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){let i=this._cachedMeta;return t===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){let t=this._cachedMeta;this._data&&x1(this._data,this),t._stacked&&ag(t)}_dataCheck(){let t=this.getDataset(),i=t.data||(t.data=[]),r=this._data;if(Ft(i)){let s=this._cachedMeta;this._data=Wie(i,s)}else if(r!==i){if(r){x1(r,this);let s=this._cachedMeta;ag(s),s._parsed=[]}i&&Object.isExtensible(i)&&oH(i,this),this._syncList=[],this._data=i}}addElements(){let t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){let i=this._cachedMeta,r=this.getDataset(),s=!1;this._dataCheck();let o=i._stacked;i._stacked=W1(i.vScale,i),i.stack!==r.stack&&(s=!0,ag(i),i.stack=r.stack),this._resyncElements(t),(s||o!==i._stacked)&&(AH(this,i._parsed),i._stacked=W1(i.vScale,i))}configure(){let t=this.chart.config,i=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),i,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,i){let{_cachedMeta:r,_data:s}=this,{iScale:o,_stacked:a}=r,c=o.axis,l=t===0&&i===s.length?!0:r._sorted,u=t>0&&r._parsed[t-1],d,h,p;if(this._parsing===!1)r._parsed=s,r._sorted=!0,p=s;else{Sn(s[t])?p=this.parseArrayData(r,s,t,i):Ft(s[t])?p=this.parseObjectData(r,s,t,i):p=this.parsePrimitiveData(r,s,t,i);let g=()=>h[c]===null||u&&h[c]<u[c];for(d=0;d<i;++d)r._parsed[d+t]=h=p[d],l&&(g()&&(l=!1),u=h);r._sorted=l}a&&AH(this,p)}parsePrimitiveData(t,i,r,s){let{iScale:o,vScale:a}=t,c=o.axis,l=a.axis,u=o.getLabels(),d=o===a,h=new Array(s),p,g,y;for(p=0,g=s;p<g;++p)y=p+r,h[p]={[c]:d||o.parse(u[y],y),[l]:a.parse(i[y],y)};return h}parseArrayData(t,i,r,s){let{xScale:o,yScale:a}=t,c=new Array(s),l,u,d,h;for(l=0,u=s;l<u;++l)d=l+r,h=i[d],c[l]={x:o.parse(h[0],d),y:a.parse(h[1],d)};return c}parseObjectData(t,i,r,s){let{xScale:o,yScale:a}=t,{xAxisKey:c="x",yAxisKey:l="y"}=this._parsing,u=new Array(s),d,h,p,g;for(d=0,h=s;d<h;++d)p=d+r,g=i[p],u[d]={x:o.parse(va(g,c),p),y:a.parse(va(g,l),p)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,i,r){let s=this.chart,o=this._cachedMeta,a=i[t.axis],c={keys:T4(s,!0),values:i._stacks[t.axis]._visualValues};return CH(c,a,o.index,{mode:r})}updateRangeFromParsed(t,i,r,s){let o=r[i.axis],a=o===null?NaN:o,c=s&&r._stacks[i.axis];s&&c&&(s.values=c,a=CH(s,o,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,i){let r=this._cachedMeta,s=r._parsed,o=r._sorted&&t===r.iScale,a=s.length,c=this._getOtherScale(t),l=Zie(i,r,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=qie(c),p,g;function y(){g=s[p];let m=g[c.axis];return!Fn(g[t.axis])||d>m||h<m}for(p=0;p<a&&!(!y()&&(this.updateRangeFromParsed(u,t,g,l),o));++p);if(o){for(p=a-1;p>=0;--p)if(!y()){this.updateRangeFromParsed(u,t,g,l);break}}return u}getAllParsedValues(t){let i=this._cachedMeta._parsed,r=[],s,o,a;for(s=0,o=i.length;s<o;++s)a=i[s][t.axis],Fn(a)&&r.push(a);return r}getMaxOverflow(){return!1}getLabelAndValue(t){let i=this._cachedMeta,r=i.iScale,s=i.vScale,o=this.getParsed(t);return{label:r?""+r.getLabelForValue(o[r.axis]):"",value:s?""+s.getLabelForValue(o[s.axis]):""}}_update(t){let i=this._cachedMeta;this.update(t||"default"),i._clip=Gie(vt(this.options.clip,jie(i.xScale,i.yScale,this.getMaxOverflow())))}update(t){}draw(){let t=this._ctx,i=this.chart,r=this._cachedMeta,s=r.data||[],o=i.chartArea,a=[],c=this._drawStart||0,l=this._drawCount||s.length-c,u=this.options.drawActiveElementsOnTop,d;for(r.dataset&&r.dataset.draw(t,o,c,l),d=c;d<c+l;++d){let h=s[d];h.hidden||(h.active&&u?a.push(h):h.draw(t,o))}for(d=0;d<a.length;++d)a[d].draw(t,o)}getStyle(t,i){let r=i?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,i,r){let s=this.getDataset(),o;if(t>=0&&t<this._cachedMeta.data.length){let a=this._cachedMeta.data[t];o=a.$context||(a.$context=Kie(this.getContext(),t,a)),o.parsed=this.getParsed(t),o.raw=s.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=Yie(this.chart.getContext(),this.index)),o.dataset=s,o.index=o.datasetIndex=this.index;return o.active=!!i,o.mode=r,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,i){return this._resolveElementOptions(this.dataElementType.id,i,t)}_resolveElementOptions(t,i="default",r){let s=i==="active",o=this._cachedDataOpts,a=t+"-"+i,c=o[a],l=this.enableOptionSharing&&qh(r);if(c)return DH(c,l);let u=this.chart.config,d=u.datasetElementScopeKeys(this._type,t),h=s?[`${t}Hover`,"hover",t,""]:[t,""],p=u.getOptionScopes(this.getDataset(),d),g=Object.keys(Cn.elements[t]),y=()=>this.getContext(r,s,i),m=u.resolveNamedOptions(p,g,y,h);return m.$shared&&(m.$shared=l,o[a]=Object.freeze(DH(m,l))),m}_resolveAnimations(t,i,r){let s=this.chart,o=this._cachedDataOpts,a=`animation-${i}`,c=o[a];if(c)return c;let l;if(s.options.animation!==!1){let d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,i),p=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(p,this.getContext(t,r,i))}let u=new EE(s,l&&l.animations);return l&&l._cacheable&&(o[a]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,i){return!i||q1(t)||this.chart._animationsDisabled}_getSharedOptions(t,i){let r=this.resolveDataElementOptions(t,i),s=this._sharedOptions,o=this.getSharedOptions(r),a=this.includeOptions(i,o)||o!==s;return this.updateSharedOptions(o,i,r),{sharedOptions:o,includeOptions:a}}updateElement(t,i,r,s){q1(s)?Object.assign(t,r):this._resolveAnimations(i,s).update(t,r)}updateSharedOptions(t,i,r){t&&!q1(i)&&this._resolveAnimations(void 0,i).update(t,r)}_setStyle(t,i,r,s){t.active=s;let o=this.getStyle(i,s);this._resolveAnimations(i,r,s).update(t,{options:!s&&this.getSharedOptions(o)||o})}removeHoverStyle(t,i,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,i,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){let i=this._data,r=this._cachedMeta.data;for(let[c,l,u]of this._syncList)this[c](l,u);this._syncList=[];let s=r.length,o=i.length,a=Math.min(o,s);a&&this.parse(0,a),o>s?this._insertElements(s,o-s,t):o<s&&this._removeElements(o,s-o)}_insertElements(t,i,r=!0){let s=this._cachedMeta,o=s.data,a=t+i,c,l=u=>{for(u.length+=i,c=u.length-1;c>=a;c--)u[c]=u[c-i]};for(l(o),c=t;c<a;++c)o[c]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(t,i),r&&this.updateElements(o,t,i,"reset")}updateElements(t,i,r,s){}_removeElements(t,i){let r=this._cachedMeta;if(this._parsing){let s=r._parsed.splice(t,i);r._stacked&&ag(r,s)}r.data.splice(t,i)}_sync(t){if(this._parsing)this._syncList.push(t);else{let[i,r,s]=t;this[i](r,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){let t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,i){i&&this._sync(["_removeElements",t,i]);let r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return n})();function Jie(n,e){if(!n._cache.$bar){let t=n.getMatchingVisibleMetas(e),i=[];for(let r=0,s=t.length;r<s;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=S1(i.sort((r,s)=>r-s))}return n._cache.$bar}function Qie(n){let e=n.iScale,t=Jie(e,n.type),i=e._length,r,s,o,a,c=()=>{o===32767||o===-32768||(qh(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(r=0,s=t.length;r<s;++r)o=e.getPixelForValue(t[r]),c();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),c();return i}function ere(n,e,t,i){let r=t.barThickness,s,o;return kt(r)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:e.pixels[n]-s/2}}function tre(n,e,t,i){let r=e.pixels,s=r[n],o=n>0?r[n-1]:null,a=n<r.length-1?r[n+1]:null,c=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);let l=s-(s-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:t.barPercentage,start:l}}function nre(n,e,t,i){let r=t.parse(n[0],i),s=t.parse(n[1],i),o=Math.min(r,s),a=Math.max(r,s),c=o,l=a;Math.abs(o)>Math.abs(a)&&(c=a,l=o),e[t.axis]=l,e._custom={barStart:c,barEnd:l,start:r,end:s,min:o,max:a}}function I4(n,e,t,i){return Sn(n)?nre(n,e,t,i):e[t.axis]=t.parse(n,i),e}function RH(n,e,t,i){let r=n.iScale,s=n.vScale,o=r.getLabels(),a=r===s,c=[],l,u,d,h;for(l=t,u=t+i;l<u;++l)h=e[l],d={},d[r.axis]=a||r.parse(o[l],l),c.push(I4(h,d,s,l));return c}function X1(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function ire(n,e,t){return n!==0?As(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function rre(n){let e,t,i,r,s;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:t,end:i,reverse:e,top:r,bottom:s}}function sre(n,e,t,i){let r=e.borderSkipped,s={};if(!r){n.borderSkipped=s;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:o,end:a,reverse:c,top:l,bottom:u}=rre(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=l:(t._bottom||0)===i?r=u:(s[PH(u,o,a,c)]=!0,r=l)),s[PH(r,o,a,c)]=!0,n.borderSkipped=s}function PH(n,e,t,i){return i?(n=ore(n,e,t),n=NH(n,t,e)):n=NH(n,e,t),n}function ore(n,e,t){return n===e?t:n===t?e:n}function NH(n,e,t){return n==="start"?e:n==="end"?t:n}function are(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}var cre=(()=>{class n extends $c{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,i,r,s){return RH(t,i,r,s)}parseArrayData(t,i,r,s){return RH(t,i,r,s)}parseObjectData(t,i,r,s){let{iScale:o,vScale:a}=t,{xAxisKey:c="x",yAxisKey:l="y"}=this._parsing,u=o.axis==="x"?c:l,d=a.axis==="x"?c:l,h=[],p,g,y,m;for(p=r,g=r+s;p<g;++p)m=i[p],y={},y[o.axis]=o.parse(va(m,u),p),h.push(I4(va(m,d),y,a,p));return h}updateRangeFromParsed(t,i,r,s){super.updateRangeFromParsed(t,i,r,s);let o=r._custom;o&&i===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){let i=this._cachedMeta,{iScale:r,vScale:s}=i,o=this.getParsed(t),a=o._custom,c=X1(a)?"["+a.start+", "+a.end+"]":""+s.getLabelForValue(o[s.axis]);return{label:""+r.getLabelForValue(o[r.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();let t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){let i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,t)}updateElements(t,i,r,s){let o=s==="reset",{index:a,_cachedMeta:{vScale:c}}=this,l=c.getBasePixel(),u=c.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:p}=this._getSharedOptions(i,s);for(let g=i;g<i+r;g++){let y=this.getParsed(g),m=o||kt(y[c.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),_=this._calculateBarIndexPixels(g,d),I=(y._stacks||{})[c.axis],M={horizontal:u,base:m.base,enableBorderRadius:!I||X1(y._custom)||a===I._top||a===I._bottom,x:u?m.head:_.center,y:u?_.center:m.head,height:u?_.size:Math.abs(m.size),width:u?Math.abs(m.size):_.size};p&&(M.options=h||this.resolveDataElementOptions(g,t[g].active?"active":s));let C=M.options||t[g].options;sre(M,C,I,a),are(M,C,d.ratio),this.updateElement(t[g],g,M,s)}}_getStacks(t,i){let{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),o=r.options.stacked,a=[],c=this._cachedMeta.controller.getParsed(i),l=c&&c[r.axis],u=d=>{let h=d._parsed.find(g=>g[r.axis]===l),p=h&&h[d.vScale.axis];if(kt(p)||isNaN(p))return!0};for(let d of s)if(!(i!==void 0&&u(d))&&((o===!1||a.indexOf(d.stack)===-1||o===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){let t=this.chart.scales,i=this.chart.options.indexAxis;return Object.keys(t).filter(r=>t[r].axis===i).shift()}_getAxis(){let t={},i=this.getFirstScaleIdForIndexAxis();for(let r of this.chart.data.datasets)t[vt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,i)]=!0;return Object.keys(t)}_getStackIndex(t,i,r){let s=this._getStacks(t,r),o=i!==void 0?s.indexOf(i):-1;return o===-1?s.length-1:o}_getRuler(){let t=this.options,i=this._cachedMeta,r=i.iScale,s=[],o,a;for(o=0,a=i.data.length;o<a;++o)s.push(r.getPixelForValue(this.getParsed(o)[r.axis],o));let c=t.barThickness;return{min:c||Qie(i),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:t.grouped,ratio:c?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){let{_cachedMeta:{vScale:i,_stacked:r,index:s},options:{base:o,minBarLength:a}}=this,c=o||0,l=this.getParsed(t),u=l._custom,d=X1(u),h=l[i.axis],p=0,g=r?this.applyStack(i,l,r):h,y,m;g!==h&&(p=g-h,g=h),d&&(h=u.barStart,g=u.barEnd-u.barStart,h!==0&&As(h)!==As(u.barEnd)&&(p=0),p+=h);let _=!kt(o)&&!d?o:p,I=i.getPixelForValue(_);if(this.chart.getDataVisibility(t)?y=i.getPixelForValue(p+g):y=I,m=y-I,Math.abs(m)<a){m=ire(m,i,c)*a,h===c&&(I-=m/2);let M=i.getPixelForDecimal(0),C=i.getPixelForDecimal(1),P=Math.min(M,C),N=Math.max(M,C);I=Math.max(Math.min(I,N),P),y=I+m,r&&!d&&(l._stacks[i.axis]._visualValues[s]=i.getValueForPixel(y)-i.getValueForPixel(I))}if(I===i.getPixelForValue(c)){let M=As(m)*i.getLineWidthForValue(c)/2;I+=M,m-=M}return{size:m,base:I,head:y,center:y+m/2}}_calculateBarIndexPixels(t,i){let r=i.scale,s=this.options,o=s.skipNull,a=vt(s.maxBarThickness,1/0),c,l,u=this._getAxisCount();if(i.grouped){let d=o?this._getStackCount(t):i.stackCount,h=s.barThickness==="flex"?tre(t,i,s,d*u):ere(t,i,s,d*u),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(vt(p,this.getFirstScaleIdForIndexAxis())),y=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0)+g;c=h.start+h.chunk*y+h.chunk/2,l=Math.min(a,h.chunk*h.ratio)}else c=r.getPixelForValue(this.getParsed(t)[r.axis],t),l=Math.min(a,i.min*i.ratio);return{base:c-l/2,head:c+l/2,center:c,size:l}}draw(){let t=this._cachedMeta,i=t.vScale,r=t.data,s=r.length,o=0;for(;o<s;++o)this.getParsed(o)[i.axis]!==null&&!r[o].hidden&&r[o].draw(this._ctx)}}return n})(),lre=(()=>{class n extends $c{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,i,r,s){let o=super.parsePrimitiveData(t,i,r,s);for(let a=0;a<o.length;a++)o[a]._custom=this.resolveDataElementOptions(a+r).radius;return o}parseArrayData(t,i,r,s){let o=super.parseArrayData(t,i,r,s);for(let a=0;a<o.length;a++){let c=i[r+a];o[a]._custom=vt(c[2],this.resolveDataElementOptions(a+r).radius)}return o}parseObjectData(t,i,r,s){let o=super.parseObjectData(t,i,r,s);for(let a=0;a<o.length;a++){let c=i[r+a];o[a]._custom=vt(c&&c.r&&+c.r,this.resolveDataElementOptions(a+r).radius)}return o}getMaxOverflow(){let t=this._cachedMeta.data,i=0;for(let r=t.length-1;r>=0;--r)i=Math.max(i,t[r].size(this.resolveDataElementOptions(r))/2);return i>0&&i}getLabelAndValue(t){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:o}=i,a=this.getParsed(t),c=s.getLabelForValue(a.x),l=o.getLabelForValue(a.y),u=a._custom;return{label:r[t]||"",value:"("+c+", "+l+(u?", "+u:"")+")"}}update(t){let i=this._cachedMeta.data;this.updateElements(i,0,i.length,t)}updateElements(t,i,r,s){let o=s==="reset",{iScale:a,vScale:c}=this._cachedMeta,{sharedOptions:l,includeOptions:u}=this._getSharedOptions(i,s),d=a.axis,h=c.axis;for(let p=i;p<i+r;p++){let g=t[p],y=!o&&this.getParsed(p),m={},_=m[d]=o?a.getPixelForDecimal(.5):a.getPixelForValue(y[d]),I=m[h]=o?c.getBasePixel():c.getPixelForValue(y[h]);m.skip=isNaN(_)||isNaN(I),u&&(m.options=l||this.resolveDataElementOptions(p,g.active?"active":s),o&&(m.options.radius=0)),this.updateElement(g,p,m,s)}}resolveDataElementOptions(t,i){let r=this.getParsed(t),s=super.resolveDataElementOptions(t,i);s.$shared&&(s=Object.assign({},s,{$shared:!1}));let o=s.radius;return i!=="active"&&(s.radius=0),s.radius+=vt(r&&r._custom,o),s}}return n})();function ure(n,e,t){let i=1,r=1,s=0,o=0;if(e<Tn){let a=n,c=a+e,l=Math.cos(a),u=Math.sin(a),d=Math.cos(c),h=Math.sin(c),p=(M,C,P)=>Yh(M,a,c,!0)?1:Math.max(C,C*t,P,P*t),g=(M,C,P)=>Yh(M,a,c,!0)?-1:Math.min(C,C*t,P,P*t),y=p(0,l,d),m=p($n,u,h),_=g(Yt,l,d),I=g(Yt+$n,u,h);i=(y-_)/2,r=(m-I)/2,s=-(y+_)/2,o=-(m+I)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}var xR=(()=>{class n extends $c{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let i=t.data,{labels:{pointStyle:r,textAlign:s,color:o,useBorderRadius:a,borderRadius:c}}=t.legend.options;return i.labels.length&&i.datasets.length?i.labels.map((l,u)=>{let h=t.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:o,hidden:!t.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:s,pointStyle:r,borderRadius:a&&(c||h.borderRadius),index:u}}):[]}},onClick(t,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}}};constructor(t,i){super(t,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,i){let r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let o=l=>+r[l];if(Ft(r[t])){let{key:l="value"}=this._parsing;o=u=>+va(r[u],l)}let a,c;for(a=t,c=t+i;a<c;++a)s._parsed[a]=o(a)}}_getRotation(){return as(this.options.rotation-90)}_getCircumference(){return as(this.options.circumference)}_getRotationExtents(){let t=Tn,i=-Tn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){let s=this.chart.getDatasetMeta(r).controller,o=s._getRotation(),a=s._getCircumference();t=Math.min(t,o),i=Math.max(i,o+a)}return{rotation:t,circumference:i-t}}update(t){let i=this.chart,{chartArea:r}=i,s=this._cachedMeta,o=s.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,c=Math.max((Math.min(r.width,r.height)-a)/2,0),l=Math.min(Zz(this.options.cutout,c),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:g,offsetX:y,offsetY:m}=ure(h,d,l),_=(r.width-a)/p,I=(r.height-a)/g,M=Math.max(Math.min(_,I)/2,0),C=_1(this.options.radius,M),P=Math.max(C*l,0),N=(C-P)/this._getVisibleDatasetWeightTotal();this.offsetX=y*C,this.offsetY=m*C,s.total=this.calculateTotal(),this.outerRadius=C-N*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-N*u,0),this.updateElements(o,0,o.length,t)}_circumference(t,i){let r=this.options,s=this._cachedMeta,o=this._getCircumference();return i&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*o/Tn)}updateElements(t,i,r,s){let o=s==="reset",a=this.chart,c=a.chartArea,u=a.options.animation,d=(c.left+c.right)/2,h=(c.top+c.bottom)/2,p=o&&u.animateScale,g=p?0:this.innerRadius,y=p?0:this.outerRadius,{sharedOptions:m,includeOptions:_}=this._getSharedOptions(i,s),I=this._getRotation(),M;for(M=0;M<i;++M)I+=this._circumference(M,o);for(M=i;M<i+r;++M){let C=this._circumference(M,o),P=t[M],N={x:d+this.offsetX,y:h+this.offsetY,startAngle:I,endAngle:I+C,circumference:C,outerRadius:y,innerRadius:g};_&&(N.options=m||this.resolveDataElementOptions(M,P.active?"active":s)),I+=C,this.updateElement(P,M,N,s)}}calculateTotal(){let t=this._cachedMeta,i=t.data,r=0,s;for(s=0;s<i.length;s++){let o=t._parsed[s];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(s)&&!i[s].hidden&&(r+=Math.abs(o))}return r}calculateCircumference(t){let i=this._cachedMeta.total;return i>0&&!isNaN(t)?Tn*(Math.abs(t)/i):0}getLabelAndValue(t){let i=this._cachedMeta,r=this.chart,s=r.data.labels||[],o=Kh(i._parsed[t],r.options.locale);return{label:s[t]||"",value:o}}getMaxBorderWidth(t){let i=0,r=this.chart,s,o,a,c,l;if(!t){for(s=0,o=r.data.datasets.length;s<o;++s)if(r.isDatasetVisible(s)){a=r.getDatasetMeta(s),t=a.data,c=a.controller;break}}if(!t)return 0;for(s=0,o=t.length;s<o;++s)l=c.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(i=Math.max(i,l.borderWidth||0,l.hoverBorderWidth||0));return i}getMaxOffset(t){let i=0;for(let r=0,s=t.length;r<s;++r){let o=this.resolveDataElementOptions(r);i=Math.max(i,o.offset||0,o.hoverOffset||0)}return i}_getRingWeightOffset(t){let i=0;for(let r=0;r<t;++r)this.chart.isDatasetVisible(r)&&(i+=this._getRingWeight(r));return i}_getRingWeight(t){return Math.max(vt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return n})(),dre=(()=>{class n extends $c{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){let i=this._cachedMeta,{dataset:r,data:s=[],_dataset:o}=i,a=this.chart._animationsDisabled,{start:c,count:l}=C1(i,s,a);this._drawStart=c,this._drawCount=l,M1(i)&&(c=0,l=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!o._decimated,r.points=s;let u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(r,void 0,{animated:!a,options:u},t),this.updateElements(s,c,l,t)}updateElements(t,i,r,s){let o=s==="reset",{iScale:a,vScale:c,_stacked:l,_dataset:u}=this._cachedMeta,{sharedOptions:d,includeOptions:h}=this._getSharedOptions(i,s),p=a.axis,g=c.axis,{spanGaps:y,segment:m}=this.options,_=Su(y)?y:Number.POSITIVE_INFINITY,I=this.chart._animationsDisabled||o||s==="none",M=i+r,C=t.length,P=i>0&&this.getParsed(i-1);for(let N=0;N<C;++N){let S=t[N],w=I?S:{};if(N<i||N>=M){w.skip=!0;continue}let b=this.getParsed(N),E=kt(b[g]),T=w[p]=a.getPixelForValue(b[p],N),R=w[g]=o||E?c.getBasePixel():c.getPixelForValue(l?this.applyStack(c,b,l):b[g],N);w.skip=isNaN(T)||isNaN(R)||E,w.stop=N>0&&Math.abs(b[p]-P[p])>_,m&&(w.parsed=b,w.raw=u.data[N]),h&&(w.options=d||this.resolveDataElementOptions(N,S.active?"active":s)),I||this.updateElement(S,N,w,s),P=b}}getMaxOverflow(){let t=this._cachedMeta,i=t.dataset,r=i.options&&i.options.borderWidth||0,s=t.data||[];if(!s.length)return r;let o=s[0].size(this.resolveDataElementOptions(0)),a=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,o,a)/2}draw(){let t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}return n})(),C4=(()=>{class n extends $c{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let i=t.data;if(i.labels.length&&i.datasets.length){let{labels:{pointStyle:r,color:s}}=t.legend.options;return i.labels.map((o,a)=>{let l=t.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:r,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,i){super(t,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){let i=this._cachedMeta,r=this.chart,s=r.data.labels||[],o=Kh(i._parsed[t].r,r.options.locale);return{label:s[t]||"",value:o}}parseObjectData(t,i,r,s){return F1.bind(this)(t,i,r,s)}update(t){let i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,t)}getMinMax(){let t=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((r,s)=>{let o=this.getParsed(s).r;!isNaN(o)&&this.chart.getDataVisibility(s)&&(o<i.min&&(i.min=o),o>i.max&&(i.max=o))}),i}_updateRadius(){let t=this.chart,i=t.chartArea,r=t.options,s=Math.min(i.right-i.left,i.bottom-i.top),o=Math.max(s/2,0),a=Math.max(r.cutoutPercentage?o/100*r.cutoutPercentage:1,0),c=(o-a)/t.getVisibleDatasetCount();this.outerRadius=o-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(t,i,r,s){let o=s==="reset",a=this.chart,l=a.options.animation,u=this._cachedMeta.rScale,d=u.xCenter,h=u.yCenter,p=u.getIndexAngle(0)-.5*Yt,g=p,y,m=360/this.countVisibleElements();for(y=0;y<i;++y)g+=this._computeAngle(y,s,m);for(y=i;y<i+r;y++){let _=t[y],I=g,M=g+this._computeAngle(y,s,m),C=a.getDataVisibility(y)?u.getDistanceFromCenterForValue(this.getParsed(y).r):0;g=M,o&&(l.animateScale&&(C=0),l.animateRotate&&(I=M=p));let P={x:d,y:h,innerRadius:0,outerRadius:C,startAngle:I,endAngle:M,options:this.resolveDataElementOptions(y,_.active?"active":s)};this.updateElement(_,y,P,s)}}countVisibleElements(){let t=this._cachedMeta,i=0;return t.data.forEach((r,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&i++}),i}_computeAngle(t,i,r){return this.chart.getDataVisibility(t)?as(this.resolveDataElementOptions(t,i).angle||r):0}}return n})(),hre=(()=>{class n extends xR{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return n})(),fre=(()=>{class n extends $c{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){let i=this._cachedMeta.vScale,r=this.getParsed(t);return{label:i.getLabels()[t],value:""+i.getLabelForValue(r[i.axis])}}parseObjectData(t,i,r,s){return F1.bind(this)(t,i,r,s)}update(t){let i=this._cachedMeta,r=i.dataset,s=i.data||[],o=i.iScale.getLabels();if(r.points=s,t!=="resize"){let a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);let c={_loop:!0,_fullLoop:o.length===s.length,options:a};this.updateElement(r,void 0,c,t)}this.updateElements(s,0,s.length,t)}updateElements(t,i,r,s){let o=this._cachedMeta.rScale,a=s==="reset";for(let c=i;c<i+r;c++){let l=t[c],u=this.resolveDataElementOptions(c,l.active?"active":s),d=o.getPointPositionForValue(c,this.getParsed(c).r),h=a?o.xCenter:d.x,p=a?o.yCenter:d.y,g={x:h,y:p,angle:d.angle,skip:isNaN(h)||isNaN(p),options:u};this.updateElement(l,c,g,s)}}}return n})(),pre=(()=>{class n extends $c{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:o}=i,a=this.getParsed(t),c=s.getLabelForValue(a.x),l=o.getLabelForValue(a.y);return{label:r[t]||"",value:"("+c+", "+l+")"}}update(t){let i=this._cachedMeta,{data:r=[]}=i,s=this.chart._animationsDisabled,{start:o,count:a}=C1(i,r,s);if(this._drawStart=o,this._drawCount=a,M1(i)&&(o=0,a=r.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:c,_dataset:l}=i;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!l._decimated,c.points=r;let u=this.resolveDatasetElementOptions(t);u.segment=this.options.segment,this.updateElement(c,void 0,{animated:!s,options:u},t)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(r,o,a,t)}addElements(){let{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,i,r,s){let o=s==="reset",{iScale:a,vScale:c,_stacked:l,_dataset:u}=this._cachedMeta,d=this.resolveDataElementOptions(i,s),h=this.getSharedOptions(d),p=this.includeOptions(s,h),g=a.axis,y=c.axis,{spanGaps:m,segment:_}=this.options,I=Su(m)?m:Number.POSITIVE_INFINITY,M=this.chart._animationsDisabled||o||s==="none",C=i>0&&this.getParsed(i-1);for(let P=i;P<i+r;++P){let N=t[P],S=this.getParsed(P),w=M?N:{},b=kt(S[y]),E=w[g]=a.getPixelForValue(S[g],P),T=w[y]=o||b?c.getBasePixel():c.getPixelForValue(l?this.applyStack(c,S,l):S[y],P);w.skip=isNaN(E)||isNaN(T)||b,w.stop=P>0&&Math.abs(S[g]-C[g])>I,_&&(w.parsed=S,w.raw=u.data[P]),p&&(w.options=h||this.resolveDataElementOptions(P,N.active?"active":s)),M||this.updateElement(N,P,w,s),C=S}this.updateSharedOptions(h,s,d)}getMaxOverflow(){let t=this._cachedMeta,i=t.data||[];if(!this.options.showLine){let c=0;for(let l=i.length-1;l>=0;--l)c=Math.max(c,i[l].size(this.resolveDataElementOptions(l))/2);return c>0&&c}let r=t.dataset,s=r.options&&r.options.borderWidth||0;if(!i.length)return s;let o=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,o,a)/2}}return n})(),mre=Object.freeze({__proto__:null,BarController:cre,BubbleController:lre,DoughnutController:xR,LineController:dre,PieController:hre,PolarAreaController:C4,RadarController:fre,ScatterController:pre});function Iu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var rR=class n{static override(e){Object.assign(n.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Iu()}parse(){return Iu()}format(){return Iu()}add(){return Iu()}diff(){return Iu()}startOf(){return Iu()}endOf(){return Iu()}},gre={_date:rR};function _re(n,e,t,i){let{controller:r,data:s,_sorted:o}=n,a=r._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){let l=a._reversePixels?iH:yo;if(i){if(r._sharedOptions){let u=s[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){let h=l(s,e,t-d),p=l(s,e,t+d);return{lo:h.lo,hi:p.hi}}}}else{let u=l(s,e,t);if(c){let{vScale:d}=r._cachedMeta,{_parsed:h}=n,p=h.slice(0,u.lo+1).reverse().findIndex(y=>!kt(y[d.axis]));u.lo-=Math.max(0,p);let g=h.slice(u.hi).findIndex(y=>!kt(y[d.axis]));u.hi+=Math.max(0,g)}return u}}return{lo:0,hi:s.length-1}}function _g(n,e,t,i,r){let s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,c=s.length;a<c;++a){let{index:l,data:u}=s[a],{lo:d,hi:h}=_re(s[a],e,o,r);for(let p=d;p<=h;++p){let g=u[p];g.skip||i(g,l,p)}}}function yre(n){let e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){let s=e?Math.abs(i.x-r.x):0,o=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function Y1(n,e,t,i,r){let s=[];return!r&&!n.isPointInArea(e)||_g(n,t,e,function(a,c,l){!r&&!vo(a,n.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:c,index:l})},!0),s}function vre(n,e,t,i){let r=[];function s(o,a,c){let{startAngle:l,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:d}=w1(o,{x:e.x,y:e.y});Yh(d,l,u)&&r.push({element:o,datasetIndex:a,index:c})}return _g(n,t,e,s),r}function bre(n,e,t,i,r,s){let o=[],a=yre(t),c=Number.POSITIVE_INFINITY;function l(u,d,h){let p=u.inRange(e.x,e.y,r);if(i&&!p)return;let g=u.getCenterPoint(r);if(!(!!s||n.isPointInArea(g))&&!p)return;let m=a(e,g);m<c?(o=[{element:u,datasetIndex:d,index:h}],c=m):m===c&&o.push({element:u,datasetIndex:d,index:h})}return _g(n,t,e,l),o}function K1(n,e,t,i,r,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!i?vre(n,e,t,r):bre(n,e,t,i,r,s)}function OH(n,e,t,i,r){let s=[],o=t==="x"?"inXRange":"inYRange",a=!1;return _g(n,t,e,(c,l,u)=>{c[o]&&c[o](e[t],r)&&(s.push({element:c,datasetIndex:l,index:u}),a=a||c.inRange(e.x,e.y,r))}),i&&!a?[]:s}var Ere={evaluateInteractionItems:_g,modes:{index(n,e,t,i){let r=Gc(e,n),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?Y1(n,r,s,i,o):K1(n,r,s,!1,i,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(l=>{let u=a[0].index,d=l.data[u];d&&!d.skip&&c.push({element:d,datasetIndex:l.index,index:u})}),c):[]},dataset(n,e,t,i){let r=Gc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1,a=t.intersect?Y1(n,r,s,i,o):K1(n,r,s,!1,i,o);if(a.length>0){let c=a[0].datasetIndex,l=n.getDatasetMeta(c).data;a=[];for(let u=0;u<l.length;++u)a.push({element:l[u],datasetIndex:c,index:u})}return a},point(n,e,t,i){let r=Gc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return Y1(n,r,s,i,o)},nearest(n,e,t,i){let r=Gc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return K1(n,r,s,t.intersect,i,o)},x(n,e,t,i){let r=Gc(e,n);return OH(n,r,"x",t.intersect,i)},y(n,e,t,i){let r=Gc(e,n);return OH(n,r,"y",t.intersect,i)}}},M4=["left","top","right","bottom"];function cg(n,e){return n.filter(t=>t.pos===e)}function kH(n,e){return n.filter(t=>M4.indexOf(t.pos)===-1&&t.box.axis===e)}function lg(n,e){return n.sort((t,i)=>{let r=e?i:t,s=e?t:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function wre(n){let e=[],t,i,r,s,o,a;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:t,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function xre(n){let e={};for(let t of n){let{stack:i,pos:r,stackWeight:s}=t;if(!i||!M4.includes(r))continue;let o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function Sre(n,e){let t=xre(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e,s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];let{fullSize:c}=a.box,l=t[a.stack],u=l&&a.stackWeight/l.weight;a.horizontal?(a.width=u?u*i:c&&e.availableWidth,a.height=r):(a.width=i,a.height=u?u*r:c&&e.availableHeight)}return t}function Tre(n){let e=wre(n),t=lg(e.filter(l=>l.box.fullSize),!0),i=lg(cg(e,"left"),!0),r=lg(cg(e,"right")),s=lg(cg(e,"top"),!0),o=lg(cg(e,"bottom")),a=kH(e,"x"),c=kH(e,"y");return{fullSize:t,leftAndTop:i.concat(s),rightAndBottom:r.concat(c).concat(o).concat(a),chartArea:cg(e,"chartArea"),vertical:i.concat(r).concat(c),horizontal:s.concat(o).concat(a)}}function LH(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function A4(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function Ire(n,e,t,i){let{pos:r,box:s}=t,o=n.maxPadding;if(!Ft(r)){t.size&&(n[r]-=t.size);let d=i[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?s.height:s.width),t.size=d.size/d.count,n[r]+=t.size}s.getPadding&&A4(o,s.getPadding());let a=Math.max(0,e.outerWidth-LH(o,n,"left","right")),c=Math.max(0,e.outerHeight-LH(o,n,"top","bottom")),l=a!==n.w,u=c!==n.h;return n.w=a,n.h=c,t.horizontal?{same:l,other:u}:{same:u,other:l}}function Cre(n){let e=n.maxPadding;function t(i){let r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function Mre(n,e){let t=e.maxPadding;function i(r){let s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return i(n?["left","right"]:["top","bottom"])}function hg(n,e,t,i){let r=[],s,o,a,c,l,u;for(s=0,o=n.length,l=0;s<o;++s){a=n[s],c=a.box,c.update(a.width||e.w,a.height||e.h,Mre(a.horizontal,e));let{same:d,other:h}=Ire(e,t,a,i);l|=d&&r.length,u=u||h,c.fullSize||r.push(a)}return l&&hg(r,e,t,i)||u}function fE(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function FH(n,e,t,i){let r=t.padding,{x:s,y:o}=e;for(let a of n){let c=a.box,l=i[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/l.weight||1;if(a.horizontal){let d=e.w*u,h=l.size||c.height;qh(l.start)&&(o=l.start),c.fullSize?fE(c,r.left,o,t.outerWidth-r.right-r.left,h):fE(c,e.left+l.placed,o,d,h),l.start=o,l.placed+=d,o=c.bottom}else{let d=e.h*u,h=l.size||c.width;qh(l.start)&&(s=l.start),c.fullSize?fE(c,s,r.top,h,t.outerHeight-r.bottom-r.top):fE(c,s,e.top+l.placed,h,d),l.start=s,l.placed+=d,s=c.right}}e.x=s,e.y=o}var Ji={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){let t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;let r=Vi(n.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(t-r.height,0),a=Tre(n.boxes),c=a.vertical,l=a.horizontal;cn(n.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});let u=c.reduce((y,m)=>m.box.options&&m.box.options.display===!1?y:y+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},r);A4(h,Vi(i));let p=Object.assign({maxPadding:h,w:s,h:o,x:r.left,y:r.top},r),g=Sre(c.concat(l),d);hg(a.fullSize,p,d,g),hg(c,p,d,g),hg(l,p,d,g)&&hg(c,p,d,g),Cre(p),FH(a.leftAndTop,p,d,g),p.x+=p.w,p.y+=p.h,FH(a.rightAndBottom,p,d,g),n.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},cn(a.chartArea,y=>{let m=y.box;Object.assign(m,n.chartArea),m.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}},wE=class{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}},sR=class extends wE{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}},vE="$chartjs",Are={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},VH=n=>n===null||n==="";function Dre(n,e){let t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[vE]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",VH(r)){let s=U1(n,"width");s!==void 0&&(n.width=s)}if(VH(i))if(n.style.height==="")n.height=n.width/(e||2);else{let s=U1(n,"height");s!==void 0&&(n.height=s)}return n}var D4=bH?{passive:!0}:!1;function Rre(n,e,t){n&&n.addEventListener(e,t,D4)}function Pre(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,D4)}function Nre(n,e){let t=Are[n.type]||n.type,{x:i,y:r}=Gc(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function xE(n,e){for(let t of n)if(t===e||t.contains(e))return!0}function Ore(n,e,t){let i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(let a of s)o=o||xE(a.addedNodes,i),o=o&&!xE(a.removedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function kre(n,e,t){let i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(let a of s)o=o||xE(a.removedNodes,i),o=o&&!xE(a.addedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}var pg=new Map,UH=0;function R4(){let n=window.devicePixelRatio;n!==UH&&(UH=n,pg.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Lre(n,e){pg.size||window.addEventListener("resize",R4),pg.set(n,e)}function Fre(n){pg.delete(n),pg.size||window.removeEventListener("resize",R4)}function Vre(n,e,t){let i=n.canvas,r=i&&dE(i);if(!r)return;let s=I1((a,c)=>{let l=r.clientWidth;t(a,c),l<r.clientWidth&&t()},window),o=new ResizeObserver(a=>{let c=a[0],l=c.contentRect.width,u=c.contentRect.height;l===0&&u===0||s(l,u)});return o.observe(r),Lre(n,s),o}function Z1(n,e,t){t&&t.disconnect(),e==="resize"&&Fre(n)}function Ure(n,e,t){let i=n.canvas,r=I1(s=>{n.ctx!==null&&t(Nre(s,n))},n);return Rre(i,e,r),r}var oR=class extends wE{acquireContext(e,t){let i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(Dre(e,t),i):null}releaseContext(e){let t=e.canvas;if(!t[vE])return!1;let i=t[vE].initial;["height","width"].forEach(s=>{let o=i[s];kt(o)?t.removeAttribute(s):t.setAttribute(s,o)});let r=i.style||{};return Object.keys(r).forEach(s=>{t.style[s]=r[s]}),t.width=t.width,delete t[vE],!0}addEventListener(e,t,i){this.removeEventListener(e,t);let r=e.$proxies||(e.$proxies={}),o={attach:Ore,detach:kre,resize:Vre}[t]||Ure;r[t]=o(e,t,i)}removeEventListener(e,t){let i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:Z1,detach:Z1,resize:Z1}[t]||Pre)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return vH(e,t,i,r)}isAttached(e){let t=e&&dE(e);return!!(t&&t.isConnected)}};function Bre(n){return!uE()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?sR:oR}var Ds=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){let{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return Su(this.x)&&Su(this.y)}getProps(e,t){let i=this.$animations;if(!t||!i)return this;let r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}};function zre(n,e){let t=n.options.ticks,i=Hre(n),r=Math.min(t.maxTicksLimit||i,i),s=t.major.enabled?Gre(e):[],o=s.length,a=s[0],c=s[o-1],l=[];if(o>r)return Wre(e,l,s,o/r),l;let u=jre(s,e,r);if(o>0){let d,h,p=o>1?Math.round((c-a)/(o-1)):null;for(pE(e,l,u,kt(p)?0:a-p,a),d=0,h=o-1;d<h;d++)pE(e,l,u,s[d],s[d+1]);return pE(e,l,u,c,kt(p)?e.length:c+p),l}return pE(e,l,u),l}function Hre(n){let e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function jre(n,e,t){let i=$re(n),r=e.length/t;if(!i)return Math.max(r,1);let s=eH(i);for(let o=0,a=s.length-1;o<a;o++){let c=s[o];if(c>r)return c}return Math.max(r,1)}function Gre(n){let e=[],t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function Wre(n,e,t,i){let r=0,s=t[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===s&&(e.push(n[o]),r++,s=t[r*i])}function pE(n,e,t,i,r){let s=vt(i,0),o=Math.min(vt(r,n.length),n.length),a=0,c,l,u;for(t=Math.ceil(t),r&&(c=r-i,t=c/Math.floor(c/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(l=Math.max(s,0);l<o;l++)l===u&&(e.push(n[l]),a++,u=Math.round(s+a*t))}function $re(n){let e=n.length,t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}var qre=n=>n==="left"?"right":n==="right"?"left":n,BH=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,zH=(n,e)=>Math.min(e||n,n);function HH(n,e){let t=[],i=n.length/e,r=n.length,s=0;for(;s<r;s+=i)t.push(n[Math.floor(s)]);return t}function Xre(n,e,t){let i=n.ticks.length,r=Math.min(e,i-1),s=n._startPixel,o=n._endPixel,a=1e-6,c=n.getPixelForTick(r),l;if(!(t&&(i===1?l=Math.max(c-s,o-c):e===0?l=(n.getPixelForTick(1)-c)/2:l=(c-n.getPixelForTick(r-1))/2,c+=r<e?l:-l,c<s-a||c>o+a)))return c}function Yre(n,e){cn(n,t=>{let i=t.gc,r=i.length/2,s;if(r>e){for(s=0;s<r;++s)delete t.data[i[s]];i.splice(0,r)}})}function ug(n){return n.drawTicks?n.tickLength:0}function jH(n,e){if(!n.display)return 0;let t=ui(n.font,e),i=Vi(n.padding);return(Sn(n.text)?n.text.length:1)*t.lineHeight+i.height}function Kre(n,e){return ba(n,{scale:e,type:"scale"})}function Zre(n,e,t){return ba(n,{tick:t,index:e,type:"tick"})}function Jre(n,e,t){let i=sE(n);return(t&&e!=="right"||!t&&e==="right")&&(i=qre(i)),i}function Qre(n,e,t,i){let{top:r,left:s,bottom:o,right:a,chart:c}=n,{chartArea:l,scales:u}=c,d=0,h,p,g,y=o-r,m=a-s;if(n.isHorizontal()){if(p=Fi(i,s,a),Ft(t)){let _=Object.keys(t)[0],I=t[_];g=u[_].getPixelForValue(I)+y-e}else t==="center"?g=(l.bottom+l.top)/2+y-e:g=BH(n,t,e);h=a-s}else{if(Ft(t)){let _=Object.keys(t)[0],I=t[_];p=u[_].getPixelForValue(I)-m+e}else t==="center"?p=(l.left+l.right)/2-m+e:p=BH(n,t,e);g=Fi(i,o,r),d=t==="left"?-$n:$n}return{titleX:p,titleY:g,maxWidth:h,rotation:d}}var Mu=class n extends Ds{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=xr(e,Number.POSITIVE_INFINITY),t=xr(t,Number.NEGATIVE_INFINITY),i=xr(i,Number.POSITIVE_INFINITY),r=xr(r,Number.NEGATIVE_INFINITY),{min:xr(e,i),max:xr(t,r),minDefined:Fn(e),maxDefined:Fn(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:t,max:i};let a=this.getMatchingVisibleMetas();for(let c=0,l=a.length;c<l;++c)o=a[c].controller.getMinMax(this,e),r||(t=Math.min(t,o.min)),s||(i=Math.max(i,o.max));return t=s&&t>i?i:t,i=r&&t>i?t:i,{min:xr(t,xr(i,t)),max:xr(i,xr(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){bn(this.options.beforeUpdate,[this])}update(e,t,i){let{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=fH(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let c=a<this.ticks.length;this._convertTicksToLabels(c?HH(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=zre(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){bn(this.options.afterUpdate,[this])}beforeSetDimensions(){bn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){bn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),bn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){bn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){let t=this.options.ticks,i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=bn(t.callback,[s.value,i,e],this)}afterTickToLabelConversion(){bn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){bn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let e=this.options,t=e.ticks,i=zH(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,s=t.maxRotation,o=r,a,c,l;if(!this._isVisible()||!t.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}let u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,p=mi(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/i:p/(i-1),d+6>a&&(a=p/(i-(e.offset?.5:1)),c=this.maxHeight-ug(e.grid)-t.padding-jH(e.title,this.chart.options.font),l=Math.sqrt(d*d+h*h),o=iE(Math.min(Math.asin(mi((u.highest.height+6)/a,-1,1)),Math.asin(mi(c/l,-1,1))-Math.asin(mi(h/l,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){bn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){bn(this.options.beforeFit,[this])}fit(){let e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){let c=jH(r,t.options.font);if(a?(e.width=this.maxWidth,e.height=ug(s)+c):(e.height=this.maxHeight,e.width=ug(s)+c),i.display&&this.ticks.length){let{first:l,last:u,widest:d,highest:h}=this._getLabelSizes(),p=i.padding*2,g=as(this.labelRotation),y=Math.cos(g),m=Math.sin(g);if(a){let _=i.mirror?0:m*d.width+y*h.height;e.height=Math.min(this.maxHeight,e.height+_+p)}else{let _=i.mirror?0:y*d.width+m*h.height;e.width=Math.min(this.maxWidth,e.width+_+p)}this._calculatePadding(l,u,m,y)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){let{ticks:{align:s,padding:o},position:a}=this.options,c=this.labelRotation!==0,l=a!=="top"&&this.axis==="x";if(this.isHorizontal()){let u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1),h=0,p=0;c?l?(h=r*e.width,p=i*t.height):(h=i*e.height,p=r*t.width):s==="start"?p=t.width:s==="end"?h=e.width:s!=="inner"&&(h=e.width/2,p=t.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-d+o)*this.width/(this.width-d),0)}else{let u=t.height/2,d=e.height/2;s==="start"?(u=0,d=e.height):s==="end"&&(u=t.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){bn(this.options.afterFit,[this])}isHorizontal(){let{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)kt(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){let t=this.options.ticks.sampleSize,i=this.ticks;t<i.length&&(i=HH(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){let{ctx:r,_longestTextCache:s}=this,o=[],a=[],c=Math.floor(t/zH(t,i)),l=0,u=0,d,h,p,g,y,m,_,I,M,C,P;for(d=0;d<t;d+=c){if(g=e[d].label,y=this._resolveTickFontOptions(d),r.font=m=y.string,_=s[m]=s[m]||{data:{},gc:[]},I=y.lineHeight,M=C=0,!kt(g)&&!Sn(g))M=ng(r,_.data,_.gc,M,g),C=I;else if(Sn(g))for(h=0,p=g.length;h<p;++h)P=g[h],!kt(P)&&!Sn(P)&&(M=ng(r,_.data,_.gc,M,P),C+=I);o.push(M),a.push(C),l=Math.max(M,l),u=Math.max(C,u)}Yre(s,t);let N=o.indexOf(l),S=a.indexOf(u),w=b=>({width:o[b]||0,height:a[b]||0});return{first:w(0),last:w(t-1),widest:w(N),highest:w(S),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){let t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);let t=this._startPixel+e*this._length;return nH(this._alignToPixels?zc(this.chart,t,0):t)}getDecimalForPixel(e){let t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){let t=this.ticks||[];if(e>=0&&e<t.length){let i=t[e];return i.$context||(i.$context=Zre(this.getContext(),e,i))}return this.$context||(this.$context=Kre(this.chart.getContext(),this))}_tickSize(){let e=this.options.ticks,t=as(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,c=s?s.highest.height+o:0;return this.isHorizontal()?c*i>a*r?a/i:c/r:c*r<a*i?c/i:a/r}_isVisible(){let e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){let t=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,c=s.offset,l=this.isHorizontal(),d=this.ticks.length+(c?1:0),h=ug(s),p=[],g=a.setContext(this.getContext()),y=g.display?g.width:0,m=y/2,_=function(J){return zc(i,J,y)},I,M,C,P,N,S,w,b,E,T,R,A;if(o==="top")I=_(this.bottom),S=this.bottom-h,b=I-m,T=_(e.top)+m,A=e.bottom;else if(o==="bottom")I=_(this.top),T=e.top,A=_(e.bottom)-m,S=I+m,b=this.top+h;else if(o==="left")I=_(this.right),N=this.right-h,w=I-m,E=_(e.left)+m,R=e.right;else if(o==="right")I=_(this.left),E=e.left,R=_(e.right)-m,N=I+m,w=this.left+h;else if(t==="x"){if(o==="center")I=_((e.top+e.bottom)/2+.5);else if(Ft(o)){let J=Object.keys(o)[0],re=o[J];I=_(this.chart.scales[J].getPixelForValue(re))}T=e.top,A=e.bottom,S=I+m,b=S+h}else if(t==="y"){if(o==="center")I=_((e.left+e.right)/2);else if(Ft(o)){let J=Object.keys(o)[0],re=o[J];I=_(this.chart.scales[J].getPixelForValue(re))}N=I-m,w=N-h,E=e.left,R=e.right}let ne=vt(r.ticks.maxTicksLimit,d),Y=Math.max(1,Math.ceil(d/ne));for(M=0;M<d;M+=Y){let J=this.getContext(M),re=s.setContext(J),K=a.setContext(J),fe=re.lineWidth,Se=re.color,Ge=K.dash||[],nt=K.dashOffset,ct=re.tickWidth,jt=re.tickColor,Ct=re.tickBorderDash||[],oe=re.tickBorderDashOffset;C=Xre(this,M,c),C!==void 0&&(P=zc(i,C,fe),l?N=w=E=R=P:S=b=T=A=P,p.push({tx1:N,ty1:S,tx2:w,ty2:b,x1:E,y1:T,x2:R,y2:A,width:fe,color:Se,borderDash:Ge,borderDashOffset:nt,tickWidth:ct,tickColor:jt,tickBorderDash:Ct,tickBorderDashOffset:oe}))}return this._ticksLength=d,this._borderValue=I,p}_computeLabelItems(e){let t=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:l,padding:u,mirror:d}=s,h=ug(i.grid),p=h+u,g=d?-u:p,y=-as(this.labelRotation),m=[],_,I,M,C,P,N,S,w,b,E,T,R,A="middle";if(r==="top")N=this.bottom-g,S=this._getXAxisLabelAlignment();else if(r==="bottom")N=this.top+g,S=this._getXAxisLabelAlignment();else if(r==="left"){let Y=this._getYAxisLabelAlignment(h);S=Y.textAlign,P=Y.x}else if(r==="right"){let Y=this._getYAxisLabelAlignment(h);S=Y.textAlign,P=Y.x}else if(t==="x"){if(r==="center")N=(e.top+e.bottom)/2+p;else if(Ft(r)){let Y=Object.keys(r)[0],J=r[Y];N=this.chart.scales[Y].getPixelForValue(J)+p}S=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")P=(e.left+e.right)/2-p;else if(Ft(r)){let Y=Object.keys(r)[0],J=r[Y];P=this.chart.scales[Y].getPixelForValue(J)}S=this._getYAxisLabelAlignment(h).textAlign}t==="y"&&(c==="start"?A="top":c==="end"&&(A="bottom"));let ne=this._getLabelSizes();for(_=0,I=a.length;_<I;++_){M=a[_],C=M.label;let Y=s.setContext(this.getContext(_));w=this.getPixelForTick(_)+s.labelOffset,b=this._resolveTickFontOptions(_),E=b.lineHeight,T=Sn(C)?C.length:1;let J=T/2,re=Y.color,K=Y.textStrokeColor,fe=Y.textStrokeWidth,Se=S;o?(P=w,S==="inner"&&(_===I-1?Se=this.options.reverse?"left":"right":_===0?Se=this.options.reverse?"right":"left":Se="center"),r==="top"?l==="near"||y!==0?R=-T*E+E/2:l==="center"?R=-ne.highest.height/2-J*E+E:R=-ne.highest.height+E/2:l==="near"||y!==0?R=E/2:l==="center"?R=ne.highest.height/2-J*E:R=ne.highest.height-T*E,d&&(R*=-1),y!==0&&!Y.showLabelBackdrop&&(P+=E/2*Math.sin(y))):(N=w,R=(1-T)*E/2);let Ge;if(Y.showLabelBackdrop){let nt=Vi(Y.backdropPadding),ct=ne.heights[_],jt=ne.widths[_],Ct=R-nt.top,oe=0-nt.left;switch(A){case"middle":Ct-=ct/2;break;case"bottom":Ct-=ct;break}switch(S){case"center":oe-=jt/2;break;case"right":oe-=jt;break;case"inner":_===I-1?oe-=jt:_>0&&(oe-=jt/2);break}Ge={left:oe,top:Ct,width:jt+nt.width,height:ct+nt.height,color:Y.backdropColor}}m.push({label:C,font:b,textOffset:R,options:{rotation:y,color:re,strokeColor:K,strokeWidth:fe,textAlign:Se,textBaseline:A,translation:[P,N],backdrop:Ge}})}return m}_getXAxisLabelAlignment(){let{position:e,ticks:t}=this.options;if(-as(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){let{position:t,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,c=o.widest.width,l,u;return t==="left"?r?(u=this.right+s,i==="near"?l="left":i==="center"?(l="center",u+=c/2):(l="right",u+=c)):(u=this.right-a,i==="near"?l="right":i==="center"?(l="center",u-=c/2):(l="left",u=this.left)):t==="right"?r?(u=this.left+s,i==="near"?l="right":i==="center"?(l="center",u-=c/2):(l="left",u-=c)):(u=this.left+a,i==="near"?l="left":i==="center"?(l="center",u+=c/2):(l="right",u=this.right)):l="right",{textAlign:l,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;let e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){let{ctx:e,options:{backgroundColor:t},left:i,top:r,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,s,o),e.restore())}getLineWidthForValue(e){let t=this.options.grid;if(!this._isVisible()||!t.display)return 0;let r=this.ticks.findIndex(s=>s.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){let t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),s,o,a=(c,l,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(l.x,l.y),i.stroke(),i.restore())};if(t.display)for(s=0,o=r.length;s<o;++s){let c=r[s];t.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){let{chart:e,ctx:t,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;let a=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue,l,u,d,h;this.isHorizontal()?(l=zc(e,this.left,o)-o/2,u=zc(e,this.right,a)+a/2,d=h=c):(d=zc(e,this.top,o)-o/2,h=zc(e,this.bottom,a)+a/2,l=u=c),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(l,d),t.lineTo(u,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;let i=this.ctx,r=this._computeLabelArea();r&&sg(i,r);let s=this.getLabelItems(e);for(let o of s){let a=o.options,c=o.font,l=o.label,u=o.textOffset;Hc(i,l,0,u,c,a)}r&&og(i)}drawTitle(){let{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;let s=ui(i.font),o=Vi(i.padding),a=i.align,c=s.lineHeight/2;t==="bottom"||t==="center"||Ft(t)?(c+=o.bottom,Sn(i.text)&&(c+=s.lineHeight*(i.text.length-1))):c+=o.top;let{titleX:l,titleY:u,maxWidth:d,rotation:h}=Qre(this,c,t,a);Hc(e,i.text,0,0,s,{color:i.color,maxWidth:d,rotation:h,textAlign:Jre(a,t,r),textBaseline:"middle",translation:[l,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){let e=this.options,t=e.ticks&&e.ticks.z||0,i=vt(e.grid&&e.grid.z,-1),r=vt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==n.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){let t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[],s,o;for(s=0,o=t.length;s<o;++s){let a=t[s];a[i]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){let t=this.options.ticks.setContext(this.getContext(e));return ui(t.font)}_maxDigits(){let e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}},ef=class{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){let t=Object.getPrototypeOf(e),i;nse(t)&&(i=this.register(t));let r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,ese(e,o,i),this.override&&Cn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){let t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in Cn[r]&&(delete Cn[r][i],this.override&&delete Bc[i])}};function ese(n,e,t){let i=Gh(Object.create(null),[t?Cn.get(t):{},Cn.get(e),n.defaults]);Cn.set(e,i),n.defaultRoutes&&tse(e,n.defaultRoutes),n.descriptors&&Cn.describe(e,n.descriptors)}function tse(n,e){Object.keys(e).forEach(t=>{let i=t.split("."),r=i.pop(),s=[n].concat(i).join("."),o=e[t].split("."),a=o.pop(),c=o.join(".");Cn.route(s,r,c,a)})}function nse(n){return"id"in n&&"defaults"in n}var aR=class{constructor(){this.controllers=new ef($c,"datasets",!0),this.elements=new ef(Ds,"elements"),this.plugins=new ef(Object,"plugins"),this.scales=new ef(Mu,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{let s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):cn(r,o=>{let a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,i){let r=nE(e);bn(i["before"+r],[],i),t[e](i),bn(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){let i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){let r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}},xo=new aR,cR=class{constructor(){this._init=void 0}notify(e,t,i,r){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;let s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,t,i);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,i,r){r=r||{};for(let s of e){let o=s.plugin,a=o[i],c=[t,r,s.options];if(bn(a,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){kt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;let t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){let i=e&&e.config,r=vt(i.options&&i.options.plugins,{}),s=ise(i);return r===!1&&!t?[]:sse(e,s,r,t)}_notifyStateChanges(e){let t=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}};function ise(n){let e={},t=[],i=Object.keys(xo.plugins.items);for(let s=0;s<i.length;s++)t.push(xo.getPlugin(i[s]));let r=n.plugins||[];for(let s=0;s<r.length;s++){let o=r[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function rse(n,e){return!e&&n===!1?null:n===!0?{}:n}function sse(n,{plugins:e,localIds:t},i,r){let s=[],o=n.getContext();for(let a of e){let c=a.id,l=rse(i[c],r);l!==null&&s.push({plugin:a,options:ose(n.config,{plugin:a,local:t[c]},l,o)})}return s}function ose(n,{plugin:e,local:t},i,r){let s=n.pluginScopeKeys(e),o=n.getOptionScopes(i,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function lR(n,e){let t=Cn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function ase(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function cse(n,e){return n===e?"_index_":"_value_"}function GH(n){if(n==="x"||n==="y"||n==="r")return n}function lse(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function uR(n,...e){if(GH(n))return n;for(let t of e){let i=t.axis||lse(t.position)||n.length>1&&GH(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function WH(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function use(n,e){if(e.data&&e.data.datasets){let t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return WH(n,"x",t[0])||WH(n,"y",t[0])}return{}}function dse(n,e){let t=Bc[n.type]||{scales:{}},i=e.scales||{},r=lR(n.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{let a=i[o];if(!Ft(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);let c=uR(o,a,use(o,n),Cn.scales[a.type]),l=cse(c,r),u=t.scales||{};s[o]=$h(Object.create(null),[{axis:c},a,u[c],u[l]])}),n.data.datasets.forEach(o=>{let a=o.type||n.type,c=o.indexAxis||lR(a,e),u=(Bc[a]||{}).scales||{};Object.keys(u).forEach(d=>{let h=ase(d,c),p=o[h+"AxisID"]||h;s[p]=s[p]||Object.create(null),$h(s[p],[{axis:h},i[p],u[d]])})}),Object.keys(s).forEach(o=>{let a=s[o];$h(a,[Cn.scales[a.type],Cn.scale])}),s}function P4(n){let e=n.options||(n.options={});e.plugins=vt(e.plugins,{}),e.scales=dse(n,e)}function N4(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function hse(n){return n=n||{},n.data=N4(n.data),P4(n),n}var $H=new Map,O4=new Set;function mE(n,e){let t=$H.get(n);return t||(t=e(),$H.set(n,t),O4.add(t)),t}var dg=(n,e,t)=>{let i=va(e,t);i!==void 0&&n.add(i)},dR=class{constructor(e){this._config=hse(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=N4(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){let e=this._config;this.clearCache(),P4(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return mE(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return mE(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return mE(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){let t=e.id,i=this.type;return mE(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){let i=this._scopeCache,r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){let{options:r,type:s}=this,o=this._cachedScopes(e,i),a=o.get(t);if(a)return a;let c=new Set;t.forEach(u=>{e&&(c.add(e),u.forEach(d=>dg(c,e,d))),u.forEach(d=>dg(c,r,d)),u.forEach(d=>dg(c,Bc[s]||{},d)),u.forEach(d=>dg(c,Cn,d)),u.forEach(d=>dg(c,oE,d))});let l=Array.from(c);return l.length===0&&l.push(Object.create(null)),O4.has(t)&&o.set(t,l),l}chartOptionScopes(){let{options:e,type:t}=this;return[e,Bc[t]||{},Cn.datasets[t]||{},{type:t},Cn,oE]}resolveNamedOptions(e,t,i,r=[""]){let s={$shared:!0},{resolver:o,subPrefixes:a}=qH(this._resolverCache,e,r),c=o;if(pse(o,t)){s.$shared=!1,i=_a(i)?i():i;let l=this.createResolver(e,i,a);c=xu(o,i,l)}for(let l of t)s[l]=c[l];return s}createResolver(e,t,i=[""],r){let{resolver:s}=qH(this._resolverCache,e,i);return Ft(t)?xu(s,t,void 0,r):s}};function qH(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));let r=t.join(),s=i.get(r);return s||(s={resolver:lE(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}var fse=n=>Ft(n)&&Object.getOwnPropertyNames(n).some(e=>_a(n[e]));function pse(n,e){let{isScriptable:t,isIndexable:i}=O1(n);for(let r of e){let s=t(r),o=i(r),a=(o||s)&&n[r];if(s&&(_a(a)||fse(a))||o&&Sn(a))return!0}return!1}var mse="4.5.1",gse=["top","bottom","left","right","chartArea"];function XH(n,e){return n==="top"||n==="bottom"||gse.indexOf(n)===-1&&e==="x"}function YH(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function KH(n){let e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),bn(t&&t.onComplete,[n],e)}function _se(n){let e=n.chart,t=e.options.animation;bn(t&&t.onProgress,[n],e)}function k4(n){return uE()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}var bE={},ZH=n=>{let e=k4(n);return Object.values(bE).filter(t=>t.canvas===e).pop()};function yse(n,e,t){let i=Object.keys(n);for(let r of i){let s=+r;if(s>=e){let o=n[r];delete n[r],(t>0||s>e)&&(n[s+t]=o)}}}function vse(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}var CE=(()=>{class n{static defaults=Cn;static instances=bE;static overrides=Bc;static registry=xo;static version=mse;static getChart=ZH;static register(...t){xo.add(...t),JH()}static unregister(...t){xo.remove(...t),JH()}constructor(t,i){let r=this.config=new dR(i),s=k4(t),o=ZH(s);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");let a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Bre(s)),this.platform.updateConfig(r);let c=this.platform.acquireContext(s,a.aspectRatio),l=c&&c.canvas,u=l&&l.height,d=l&&l.width;if(this.id=Kz(),this.ctx=c,this.canvas=l,this.width=d,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new cR,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=aH(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],bE[this.id]=this,!c||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ea.listen(this,"complete",KH),Ea.listen(this,"progress",_se),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:t,maintainAspectRatio:i},width:r,height:s,_aspectRatio:o}=this;return kt(t)?i&&o?o:s?r/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return xo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():V1(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return R1(this.canvas,this.ctx),this}stop(){return Ea.stop(this),this}resize(t,i){Ea.running(this)?this._resizeBeforeDraw={width:t,height:i}:this._resize(t,i)}_resize(t,i){let r=this.options,s=this.canvas,o=r.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(s,t,i,o),c=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,V1(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),bn(r.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){let i=this.options.scales||{};cn(i,(r,s)=>{r.id=s})}buildOrUpdateScales(){let t=this.options,i=t.scales,r=this.scales,s=Object.keys(r).reduce((a,c)=>(a[c]=!1,a),{}),o=[];i&&(o=o.concat(Object.keys(i).map(a=>{let c=i[a],l=uR(a,c),u=l==="r",d=l==="x";return{options:c,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),cn(o,a=>{let c=a.options,l=c.id,u=uR(l,c),d=vt(c.type,a.dtype);(c.position===void 0||XH(c.position,u)!==XH(a.dposition))&&(c.position=a.dposition),s[l]=!0;let h=null;if(l in r&&r[l].type===d)h=r[l];else{let p=xo.getScale(d);h=new p({id:l,type:d,ctx:this.ctx,chart:this}),r[h.id]=h}h.init(c,t)}),cn(s,(a,c)=>{a||delete r[c]}),cn(r,a=>{Ji.configure(this,a,a.options),Ji.addBox(this,a)})}_updateMetasets(){let t=this._metasets,i=this.data.datasets.length,r=t.length;if(t.sort((s,o)=>s.index-o.index),r>i){for(let s=i;s<r;++s)this._destroyDatasetMeta(s);t.splice(i,r-i)}this._sortedMetasets=t.slice(0).sort(YH("order","index"))}_removeUnreferencedMetasets(){let{_metasets:t,data:{datasets:i}}=this;t.length>i.length&&delete this._stacks,t.forEach((r,s)=>{i.filter(o=>o===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){let t=[],i=this.data.datasets,r,s;for(this._removeUnreferencedMetasets(),r=0,s=i.length;r<s;r++){let o=i[r],a=this.getDatasetMeta(r),c=o.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=c,a.indexAxis=o.indexAxis||lR(c,this.options),a.order=o.order||0,a.index=r,a.label=""+o.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{let l=xo.getController(c),{datasetElementType:u,dataElementType:d}=Cn.datasets[c];Object.assign(l,{dataElementType:xo.getElement(d),datasetElementType:u&&xo.getElement(u)}),a.controller=new l(this,r),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){cn(this.data.datasets,(t,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){let i=this.config;i.update();let r=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;let o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,d=this.data.datasets.length;u<d;u++){let{controller:h}=this.getDatasetMeta(u),p=!s&&o.indexOf(h)===-1;h.buildOrUpdateElements(p),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=r.layout.autoPadding?a:0,this._updateLayout(a),s||cn(o,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(YH("z","_idx"));let{_active:c,_lastEvent:l}=this;l?this._eventHandler(l,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){cn(this.scales,t=>{Ji.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let t=this.options,i=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!y1(i,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:t}=this,i=this._getUniformDataChanges()||[];for(let{method:r,start:s,count:o}of i){let a=r==="_removeElements"?-o:o;yse(t,s,a)}}_getUniformDataChanges(){let t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];let i=this.data.datasets.length,r=o=>new Set(t.filter(a=>a[0]===o).map((a,c)=>c+","+a.splice(1).join(","))),s=r(0);for(let o=1;o<i;o++)if(!y1(s,r(o)))return;return Array.from(s).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ji.update(this,this.width,this.height,t);let i=this.chartArea,r=i.width<=0||i.height<=0;this._layers=[],cn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,o)=>{s._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let i=0,r=this.data.datasets.length;i<r;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,r=this.data.datasets.length;i<r;++i)this._updateDataset(i,_a(t)?t({datasetIndex:i}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,i){let r=this.getDatasetMeta(t),s={meta:r,index:t,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(i),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ea.has(this)?this.attached&&!Ea.running(this)&&Ea.start(this):(this.draw(),KH({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){let{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let i=this._layers;for(t=0;t<i.length&&i[t].z<=0;++t)i[t].draw(this.chartArea);for(this._drawDatasets();t<i.length;++t)i[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){let i=this._sortedMetasets,r=[],s,o;for(s=0,o=i.length;s<o;++s){let a=i[s];(!t||a.visible)&&r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let t=this.getSortedVisibleDatasetMetas();for(let i=t.length-1;i>=0;--i)this._drawDataset(t[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){let i=this.ctx,r={meta:t,index:t.index,cancelable:!0},s=G1(this,t);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&sg(i,s),t.controller.draw(),s&&og(i),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return vo(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,i,r,s){let o=Ere.modes[i];return typeof o=="function"?o(this,t,r,s):[]}getDatasetMeta(t){let i=this.data.datasets[t],r=this._metasets,s=r.filter(o=>o&&o._dataset===i).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:t,_dataset:i,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=ba(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){let i=this.data.datasets[t];if(!i)return!1;let r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!i.hidden}setDatasetVisibility(t,i){let r=this.getDatasetMeta(t);r.hidden=!i}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,i,r){let s=r?"show":"hide",o=this.getDatasetMeta(t),a=o.controller._resolveAnimations(void 0,s);qh(i)?(o.data[i].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),a.update(o,{visible:r}),this.update(c=>c.datasetIndex===t?s:void 0))}hide(t,i){this._updateVisibility(t,i,!1)}show(t,i){this._updateVisibility(t,i,!0)}_destroyDatasetMeta(t){let i=this._metasets[t];i&&i.controller&&i.controller._destroy(),delete this._metasets[t]}_stop(){let t,i;for(this.stop(),Ea.remove(this),t=0,i=this.data.datasets.length;t<i;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:t,ctx:i}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),R1(t,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete bE[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let t=this._listeners,i=this.platform,r=(o,a)=>{i.addEventListener(this,o,a),t[o]=a},s=(o,a,c)=>{o.offsetX=a,o.offsetY=c,this._eventHandler(o)};cn(this.options.events,o=>r(o,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let t=this._responsiveListeners,i=this.platform,r=(l,u)=>{i.addEventListener(this,l,u),t[l]=u},s=(l,u)=>{t[l]&&(i.removeEventListener(this,l,u),delete t[l])},o=(l,u)=>{this.canvas&&this.resize(l,u)},a,c=()=>{s("attach",c),this.attached=!0,this.resize(),r("resize",o),r("detach",a)};a=()=>{this.attached=!1,s("resize",o),this._stop(),this._resize(0,0),r("attach",c)},i.isAttached(this.canvas)?c():a()}unbindEvents(){cn(this._listeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._listeners={},cn(this._responsiveListeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,i,r){let s=r?"set":"remove",o,a,c,l;for(i==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+s+"DatasetHoverStyle"]()),c=0,l=t.length;c<l;++c){a=t[c];let u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){let i=this._active||[],r=t.map(({datasetIndex:o,index:a})=>{let c=this.getDatasetMeta(o);if(!c)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:c.data[a],index:a}});!ig(r,i)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,i))}notifyPlugins(t,i,r){return this._plugins.notify(this,t,i,r)}isPluginEnabled(t){return this._plugins._cache.filter(i=>i.plugin.id===t).length===1}_updateHoverStyles(t,i,r){let s=this.options.hover,o=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),a=o(i,t),c=r?t:o(t,i);a.length&&this.updateHoverStyle(a,s.mode,!1),c.length&&s.mode&&this.updateHoverStyle(c,s.mode,!0)}_eventHandler(t,i){let r={event:t,replay:i,cancelable:!0,inChartArea:this.isPointInArea(t)},s=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;let o=this._handleEvent(t,i,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(o||r.changed)&&this.render(),this}_handleEvent(t,i,r){let{_active:s=[],options:o}=this,a=i,c=this._getActiveElements(t,s,r,a),l=Qz(t),u=vse(t,this._lastEvent,r,l);r&&(this._lastEvent=null,bn(o.onHover,[t,c,this],this),l&&bn(o.onClick,[t,c,this],this));let d=!ig(c,s);return(d||i)&&(this._active=c,this._updateHoverStyles(c,s,i)),this._lastEvent=u,d}_getActiveElements(t,i,r,s){if(t.type==="mouseout")return[];if(!r)return i;let o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,s)}}return n})();function JH(){return cn(CE.instances,n=>n._plugins.invalidate())}function bse(n,e,t){let{startAngle:i,x:r,y:s,outerRadius:o,innerRadius:a,options:c}=e,{borderWidth:l,borderJoinStyle:u}=c,d=Math.min(l/o,Li(i-t));if(n.beginPath(),n.arc(r,s,o-l/2,i+d/2,t-d/2),a>0){let h=Math.min(l/a,Li(i-t));n.arc(r,s,a+l/2,t-h/2,i+h/2,!0)}else{let h=Math.min(l/2,o*Li(i-t));if(u==="round")n.arc(r,s,h,t-Yt/2,i+Yt/2,!0);else if(u==="bevel"){let p=2*h*h,g=-p*Math.cos(t+Yt/2)+r,y=-p*Math.sin(t+Yt/2)+s,m=p*Math.cos(i+Yt/2)+r,_=p*Math.sin(i+Yt/2)+s;n.lineTo(g,y),n.lineTo(m,_)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function Ese(n,e,t){let{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:c}=e,l=r/a;n.beginPath(),n.arc(s,o,a,i-l,t+l),c>r?(l=r/c,n.arc(s,o,c,t+l,i-l,!0)):n.arc(s,o,r,t+$n,i-$n),n.closePath(),n.clip()}function wse(n){return cE(n,["outerStart","outerEnd","innerStart","innerEnd"])}function xse(n,e,t,i){let r=wse(n.options.borderRadius),s=(t-e)/2,o=Math.min(s,i*e/2),a=c=>{let l=(t-Math.min(s,c))*i/2;return mi(c,0,Math.min(s,l))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:mi(r.innerStart,0,o),innerEnd:mi(r.innerEnd,0,o)}}function Qh(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function SE(n,e,t,i,r,s){let{x:o,y:a,startAngle:c,pixelMargin:l,innerRadius:u}=e,d=Math.max(e.outerRadius+i+t-l,0),h=u>0?u+i+t+l:0,p=0,g=r-c;if(i){let Y=u>0?u-i:0,J=d>0?d-i:0,re=(Y+J)/2,K=re!==0?g*re/(re+i):g;p=(g-K)/2}let y=Math.max(.001,g*d-t/Yt)/d,m=(g-y)/2,_=c+m+p,I=r-m-p,{outerStart:M,outerEnd:C,innerStart:P,innerEnd:N}=xse(e,h,d,I-_),S=d-M,w=d-C,b=_+M/S,E=I-C/w,T=h+P,R=h+N,A=_+P/T,ne=I-N/R;if(n.beginPath(),s){let Y=(b+E)/2;if(n.arc(o,a,d,b,Y),n.arc(o,a,d,Y,E),C>0){let fe=Qh(w,E,o,a);n.arc(fe.x,fe.y,C,E,I+$n)}let J=Qh(R,I,o,a);if(n.lineTo(J.x,J.y),N>0){let fe=Qh(R,ne,o,a);n.arc(fe.x,fe.y,N,I+$n,ne+Math.PI)}let re=(I-N/h+(_+P/h))/2;if(n.arc(o,a,h,I-N/h,re,!0),n.arc(o,a,h,re,_+P/h,!0),P>0){let fe=Qh(T,A,o,a);n.arc(fe.x,fe.y,P,A+Math.PI,_-$n)}let K=Qh(S,_,o,a);if(n.lineTo(K.x,K.y),M>0){let fe=Qh(S,b,o,a);n.arc(fe.x,fe.y,M,_-$n,b)}}else{n.moveTo(o,a);let Y=Math.cos(b)*d+o,J=Math.sin(b)*d+a;n.lineTo(Y,J);let re=Math.cos(E)*d+o,K=Math.sin(E)*d+a;n.lineTo(re,K)}n.closePath()}function Sse(n,e,t,i,r){let{fullCircles:s,startAngle:o,circumference:a}=e,c=e.endAngle;if(s){SE(n,e,t,i,c,r);for(let l=0;l<s;++l)n.fill();isNaN(a)||(c=o+(a%Tn||Tn))}return SE(n,e,t,i,c,r),n.fill(),c}function Tse(n,e,t,i,r){let{fullCircles:s,startAngle:o,circumference:a,options:c}=e,{borderWidth:l,borderJoinStyle:u,borderDash:d,borderDashOffset:h,borderRadius:p}=c,g=c.borderAlign==="inner";if(!l)return;n.setLineDash(d||[]),n.lineDashOffset=h,g?(n.lineWidth=l*2,n.lineJoin=u||"round"):(n.lineWidth=l,n.lineJoin=u||"bevel");let y=e.endAngle;if(s){SE(n,e,t,i,y,r);for(let m=0;m<s;++m)n.stroke();isNaN(a)||(y=o+(a%Tn||Tn))}g&&Ese(n,e,y),c.selfJoin&&y-o>=Yt&&p===0&&u!=="miter"&&bse(n,e,y),s||(SE(n,e,t,i,y,r),n.stroke())}var hR=class extends Ds{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){let r=this.getProps(["x","y"],i),{angle:s,distance:o}=w1(r,{x:e,y:t}),{startAngle:a,endAngle:c,innerRadius:l,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),h=(this.options.spacing+this.options.borderWidth)/2,p=vt(d,c-a),g=Yh(s,a,c)&&a!==c,y=p>=Tn||g,m=Eo(o,l+h,u+h);return y&&m}getCenterPoint(e){let{x:t,y:i,startAngle:r,endAngle:s,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:l}=this.options,u=(r+s)/2,d=(o+a+l+c)/2;return{x:t+Math.cos(u)*d,y:i+Math.sin(u)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){let{options:t,circumference:i}=this,r=(t.offset||0)/4,s=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Tn?Math.floor(i/Tn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*r,Math.sin(a)*r);let c=1-Math.sin(Math.min(Yt,i||0)),l=r*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,Sse(e,this,l,s,o),Tse(e,this,l,s,o),e.restore()}};function L4(n,e,t=e){n.lineCap=vt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(vt(t.borderDash,e.borderDash)),n.lineDashOffset=vt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=vt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=vt(t.borderWidth,e.borderWidth),n.strokeStyle=vt(t.borderColor,e.borderColor)}function Ise(n,e,t){n.lineTo(t.x,t.y)}function Cse(n){return n.stepped?dH:n.tension||n.cubicInterpolationMode==="monotone"?hH:Ise}function F4(n,e,t={}){let i=n.length,{start:r=0,end:s=i-1}=t,{start:o,end:a}=e,c=Math.max(r,o),l=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:i,start:c,loop:e.loop,ilen:l<c&&!u?i+l-c:l-c}}function Mse(n,e,t,i){let{points:r,options:s}=e,{count:o,start:a,loop:c,ilen:l}=F4(r,t,i),u=Cse(s),{move:d=!0,reverse:h}=i||{},p,g,y;for(p=0;p<=l;++p)g=r[(a+(h?l-p:p))%o],!g.skip&&(d?(n.moveTo(g.x,g.y),d=!1):u(n,y,g,h,s.stepped),y=g);return c&&(g=r[(a+(h?l:0))%o],u(n,y,g,h,s.stepped)),!!c}function Ase(n,e,t,i){let r=e.points,{count:s,start:o,ilen:a}=F4(r,t,i),{move:c=!0,reverse:l}=i||{},u=0,d=0,h,p,g,y,m,_,I=C=>(o+(l?a-C:C))%s,M=()=>{y!==m&&(n.lineTo(u,m),n.lineTo(u,y),n.lineTo(u,_))};for(c&&(p=r[I(0)],n.moveTo(p.x,p.y)),h=0;h<=a;++h){if(p=r[I(h)],p.skip)continue;let C=p.x,P=p.y,N=C|0;N===g?(P<y?y=P:P>m&&(m=P),u=(d*u+C)/++d):(M(),n.lineTo(C,P),g=N,d=0,y=m=P),_=P}M()}function fR(n){let e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Ase:Mse}function Dse(n){return n.stepped?EH:n.tension||n.cubicInterpolationMode==="monotone"?wH:Vc}function Rse(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),L4(n,e.options),n.stroke(r)}function Pse(n,e,t,i){let{segments:r,options:s}=e,o=fR(e);for(let a of r)L4(n,s,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}var Nse=typeof Path2D=="function";function Ose(n,e,t,i){Nse&&!e.options.segment?Rse(n,e,t,i):Pse(n,e,t,i)}var ME=(()=>{class n extends Ds{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,i){let r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){let s=r.spanGaps?this._loop:this._fullLoop;yH(this._points,r,t,s,i),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=SH(this,this.options.segment))}first(){let t=this.segments,i=this.points;return t.length&&i[t[0].start]}last(){let t=this.segments,i=this.points,r=t.length;return r&&i[t[r-1].end]}interpolate(t,i){let r=this.options,s=t[i],o=this.points,a=j1(this,{property:i,start:s,end:s});if(!a.length)return;let c=[],l=Dse(r),u,d;for(u=0,d=a.length;u<d;++u){let{start:h,end:p}=a[u],g=o[h],y=o[p];if(g===y){c.push(g);continue}let m=Math.abs((s-g[i])/(y[i]-g[i])),_=l(g,y,m,r.stepped);_[i]=t[i],c.push(_)}return c.length===1?c[0]:c}pathSegment(t,i,r){return fR(this)(t,this,i,r)}path(t,i,r){let s=this.segments,o=fR(this),a=this._loop;i=i||0,r=r||this.points.length-i;for(let c of s)a&=o(t,this,c,{start:i,end:i+r-1});return!!a}draw(t,i,r,s){let o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),Ose(t,this,r,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return n})();function QH(n,e,t,i){let r=n.options,{[t]:s}=n.getProps([t],i);return Math.abs(e-s)<r.radius+r.hitRadius}var kse=(()=>{class n extends Ds{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,i,r){let s=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(t-o,2)+Math.pow(i-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,i){return QH(this,t,"x",i)}inYRange(t,i){return QH(this,t,"y",i)}getCenterPoint(t){let{x:i,y:r}=this.getProps(["x","y"],t);return{x:i,y:r}}size(t){t=t||this.options||{};let i=t.radius||0;i=Math.max(i,i&&t.hoverRadius||0);let r=i&&t.borderWidth||0;return(i+r)*2}draw(t,i){let r=this.options;this.skip||r.radius<.1||!vo(this,i,this.size(r)/2)||(t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.fillStyle=r.backgroundColor,aE(t,r,this.x,this.y))}getRange(){let t=this.options||{};return t.radius+t.hitRadius}}return n})();function V4(n,e){let{x:t,y:i,base:r,width:s,height:o}=n.getProps(["x","y","base","width","height"],e),a,c,l,u,d;return n.horizontal?(d=o/2,a=Math.min(t,r),c=Math.max(t,r),l=i-d,u=i+d):(d=s/2,a=t-d,c=t+d,l=Math.min(i,r),u=Math.max(i,r)),{left:a,top:l,right:c,bottom:u}}function Wc(n,e,t,i){return n?0:mi(e,t,i)}function Lse(n,e,t){let i=n.options.borderWidth,r=n.borderSkipped,s=N1(i);return{t:Wc(r.top,s.top,0,t),r:Wc(r.right,s.right,0,e),b:Wc(r.bottom,s.bottom,0,t),l:Wc(r.left,s.left,0,e)}}function Fse(n,e,t){let{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,s=jc(r),o=Math.min(e,t),a=n.borderSkipped,c=i||Ft(r);return{topLeft:Wc(!c||a.top||a.left,s.topLeft,0,o),topRight:Wc(!c||a.top||a.right,s.topRight,0,o),bottomLeft:Wc(!c||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:Wc(!c||a.bottom||a.right,s.bottomRight,0,o)}}function Vse(n){let e=V4(n),t=e.right-e.left,i=e.bottom-e.top,r=Lse(n,t/2,i/2),s=Fse(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function J1(n,e,t,i){let r=e===null,s=t===null,a=n&&!(r&&s)&&V4(n,i);return a&&(r||Eo(e,a.left,a.right))&&(s||Eo(t,a.top,a.bottom))}function Use(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Bse(n,e){n.rect(e.x,e.y,e.w,e.h)}function Q1(n,e,t={}){let i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-i,o=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+s,h:n.h+o,radius:n.radius}}var pR=class extends Ds{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){let{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=Vse(this),a=Use(o.radius)?Zh:Bse;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,Q1(o,t,s)),e.clip(),a(e,Q1(s,-t,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),a(e,Q1(s,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return J1(this,e,t,i)}inXRange(e,t){return J1(this,e,null,t)}inYRange(e,t){return J1(this,null,e,t)}getCenterPoint(e){let{x:t,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+r)/2:t,y:s?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}},zse=Object.freeze({__proto__:null,ArcElement:hR,BarElement:pR,LineElement:ME,PointElement:kse}),mR=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],e4=mR.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function U4(n){return mR[n%mR.length]}function B4(n){return e4[n%e4.length]}function Hse(n,e){return n.borderColor=U4(e),n.backgroundColor=B4(e),++e}function jse(n,e){return n.backgroundColor=n.data.map(()=>U4(e++)),e}function Gse(n,e){return n.backgroundColor=n.data.map(()=>B4(e++)),e}function Wse(n){let e=0;return(t,i)=>{let r=n.getDatasetMeta(i).controller;r instanceof xR?e=jse(t,e):r instanceof C4?e=Gse(t,e):r&&(e=Hse(t,e))}}function t4(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function $se(n){return n&&(n.borderColor||n.backgroundColor)}function qse(){return Cn.borderColor!=="rgba(0,0,0,0.1)"||Cn.backgroundColor!=="rgba(0,0,0,0.1)"}var Xse={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;let{data:{datasets:i},options:r}=n.config,{elements:s}=r,o=t4(i)||$se(r)||s&&t4(s)||qse();if(!t.forceOverride&&o)return;let a=Wse(n);i.forEach(a)}};function Yse(n,e,t,i,r){let s=r.samples||i;if(s>=t)return n.slice(e,e+t);let o=[],a=(t-2)/(s-2),c=0,l=e+t-1,u=e,d,h,p,g,y;for(o[c++]=n[u],d=0;d<s-2;d++){let m=0,_=0,I,M=Math.floor((d+1)*a)+1+e,C=Math.min(Math.floor((d+2)*a)+1,t)+e,P=C-M;for(I=M;I<C;I++)m+=n[I].x,_+=n[I].y;m/=P,_/=P;let N=Math.floor(d*a)+1+e,S=Math.min(Math.floor((d+1)*a)+1,t)+e,{x:w,y:b}=n[u];for(p=g=-1,I=N;I<S;I++)g=.5*Math.abs((w-m)*(n[I].y-b)-(w-n[I].x)*(_-b)),g>p&&(p=g,h=n[I],y=I);o[c++]=h,u=y}return o[c++]=n[l],o}function Kse(n,e,t,i){let r=0,s=0,o,a,c,l,u,d,h,p,g,y,m=[],_=e+t-1,I=n[e].x,C=n[_].x-I;for(o=e;o<e+t;++o){a=n[o],c=(a.x-I)/C*i,l=a.y;let P=c|0;if(P===u)l<g?(g=l,d=o):l>y&&(y=l,h=o),r=(s*r+a.x)/++s;else{let N=o-1;if(!kt(d)&&!kt(h)){let S=Math.min(d,h),w=Math.max(d,h);S!==p&&S!==N&&m.push(je(ae({},n[S]),{x:r})),w!==p&&w!==N&&m.push(je(ae({},n[w]),{x:r}))}o>0&&N!==p&&m.push(n[N]),m.push(a),u=P,s=0,g=y=l,d=h=p=o}}return m}function z4(n){if(n._decimated){let e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function n4(n){n.data.datasets.forEach(e=>{z4(e)})}function Zse(n,e){let t=e.length,i=0,r,{iScale:s}=n,{min:o,max:a,minDefined:c,maxDefined:l}=s.getUserBounds();return c&&(i=mi(yo(e,s.axis,o).lo,0,t-1)),l?r=mi(yo(e,s.axis,a).hi+1,i,t)-i:r=t-i,{start:i,count:r}}var Jse={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){n4(n);return}let i=n.width;n.data.datasets.forEach((r,s)=>{let{_data:o,indexAxis:a}=r,c=n.getDatasetMeta(s),l=o||r.data;if(Jh([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;let u=n.scales[c.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:d,count:h}=Zse(c,l),p=t.threshold||4*i;if(h<=p){z4(r);return}kt(o)&&(r._data=l,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(y){this._data=y}}));let g;switch(t.algorithm){case"lttb":g=Yse(l,d,h,i,t);break;case"min-max":g=Kse(l,d,h,i);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}r._decimated=g})},destroy(n){n4(n)}};function Qse(n,e,t){let i=n.segments,r=n.points,s=e.points,o=[];for(let a of i){let{start:c,end:l}=a;l=AE(c,l,r);let u=gR(t,r[c],r[l],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[c],end:r[l]});continue}let d=j1(e,u);for(let h of d){let p=gR(t,s[h.start],s[h.end],h.loop),g=H1(a,r,p);for(let y of g)o.push({source:y,target:h,start:{[t]:i4(u,p,"start",Math.max)},end:{[t]:i4(u,p,"end",Math.min)}})}}return o}function gR(n,e,t,i){if(i)return;let r=e[n],s=t[n];return n==="angle"&&(r=Li(r),s=Li(s)),{property:n,start:r,end:s}}function eoe(n,e){let{x:t=null,y:i=null}=n||{},r=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=AE(o,a,r);let c=r[o],l=r[a];i!==null?(s.push({x:c.x,y:i}),s.push({x:l.x,y:i})):t!==null&&(s.push({x:t,y:c.y}),s.push({x:t,y:l.y}))}),s}function AE(n,e,t){for(;e>n;e--){let i=t[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function i4(n,e,t,i){return n&&e?i(n[t],e[t]):n?n[t]:e?e[t]:0}function H4(n,e){let t=[],i=!1;return Sn(n)?(i=!0,t=n):t=eoe(n,e),t.length?new ME({points:t,options:{tension:0},_loop:i,_fullLoop:i}):null}function r4(n){return n&&n.fill!==!1}function toe(n,e,t){let r=n[e].fill,s=[e],o;if(!t)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!Fn(r))return r;if(o=n[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function noe(n,e,t){let i=ooe(n);if(Ft(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return Fn(r)&&Math.floor(r)===r?ioe(i[0],e,r,t):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function ioe(n,e,t,i){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=i?!1:t}function roe(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Ft(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function soe(n,e,t){let i;return n==="start"?i=t:n==="end"?i=e.options.reverse?e.min:e.max:Ft(n)?i=n.value:i=e.getBaseValue(),i}function ooe(n){let e=n.options,t=e.fill,i=vt(t&&t.target,t);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function aoe(n){let{scale:e,index:t,line:i}=n,r=[],s=i.segments,o=i.points,a=coe(e,t);a.push(H4({x:null,y:e.bottom},i));for(let c=0;c<s.length;c++){let l=s[c];for(let u=l.start;u<=l.end;u++)loe(r,o[u],a)}return new ME({points:r,options:{}})}function coe(n,e){let t=[],i=n.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){let s=i[r];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function loe(n,e,t){let i=[];for(let r=0;r<t.length;r++){let s=t[r],{first:o,last:a,point:c}=uoe(s,e,"x");if(!(!c||o&&a)){if(o)i.unshift(c);else if(n.push(c),!a)break}}n.push(...i)}function uoe(n,e,t){let i=n.interpolate(e,t);if(!i)return{};let r=i[t],s=n.segments,o=n.points,a=!1,c=!1;for(let l=0;l<s.length;l++){let u=s[l],d=o[u.start][t],h=o[u.end][t];if(Eo(r,d,h)){a=r===d,c=r===h;break}}return{first:a,last:c,point:i}}var TE=class{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){let{x:r,y:s,radius:o}=this;return t=t||{start:0,end:Tn},e.arc(r,s,o,t.end,t.start,!0),!i.bounds}interpolate(e){let{x:t,y:i,radius:r}=this,s=e.angle;return{x:t+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}};function doe(n){let{chart:e,fill:t,line:i}=n;if(Fn(t))return hoe(e,t);if(t==="stack")return aoe(n);if(t==="shape")return!0;let r=foe(n);return r instanceof TE?r:H4(r,i)}function hoe(n,e){let t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function foe(n){return(n.scale||{}).getPointPositionForValue?moe(n):poe(n)}function poe(n){let{scale:e={},fill:t}=n,i=roe(t,e);if(Fn(i)){let r=e.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function moe(n){let{scale:e,fill:t}=n,i=e.options,r=e.getLabels().length,s=i.reverse?e.max:e.min,o=soe(t,e,s),a=[];if(i.grid.circular){let c=e.getPointPositionForValue(0,s);return new TE({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<r;++c)a.push(e.getPointPositionForValue(c,o));return a}function eR(n,e,t){let i=doe(e),{chart:r,index:s,line:o,scale:a,axis:c}=e,l=o.options,u=l.fill,d=l.backgroundColor,{above:h=d,below:p=d}=u||{},g=r.getDatasetMeta(s),y=G1(r,g);i&&o.points.length&&(sg(n,t),goe(n,{line:o,target:i,above:h,below:p,area:t,scale:a,axis:c,clip:y}),og(n))}function goe(n,e){let{line:t,target:i,above:r,below:s,area:o,scale:a,clip:c}=e,l=t._loop?"angle":e.axis;n.save();let u=s;s!==r&&(l==="x"?(s4(n,i,o.top),tR(n,{line:t,target:i,color:r,scale:a,property:l,clip:c}),n.restore(),n.save(),s4(n,i,o.bottom)):l==="y"&&(o4(n,i,o.left),tR(n,{line:t,target:i,color:s,scale:a,property:l,clip:c}),n.restore(),n.save(),o4(n,i,o.right),u=r)),tR(n,{line:t,target:i,color:u,scale:a,property:l,clip:c}),n.restore()}function s4(n,e,t){let{segments:i,points:r}=e,s=!0,o=!1;n.beginPath();for(let a of i){let{start:c,end:l}=a,u=r[c],d=r[AE(c,l,r)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function o4(n,e,t){let{segments:i,points:r}=e,s=!0,o=!1;n.beginPath();for(let a of i){let{start:c,end:l}=a,u=r[c],d=r[AE(c,l,r)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(t,u.y),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(t,d.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function tR(n,e){let{line:t,target:i,property:r,color:s,scale:o,clip:a}=e,c=Qse(t,i,r);for(let{source:l,target:u,start:d,end:h}of c){let{style:{backgroundColor:p=s}={}}=l,g=i!==!0;n.save(),n.fillStyle=p,_oe(n,o,a,g&&gR(r,d,h)),n.beginPath();let y=!!t.pathSegment(n,l),m;if(g){y?n.closePath():a4(n,i,h,r);let _=!!i.pathSegment(n,u,{move:y,reverse:!0});m=y&&_,m||a4(n,i,d,r)}n.closePath(),n.fill(m?"evenodd":"nonzero"),n.restore()}}function _oe(n,e,t,i){let r=e.chart.chartArea,{property:s,start:o,end:a}=i||{};if(s==="x"||s==="y"){let c,l,u,d;s==="x"?(c=o,l=r.top,u=a,d=r.bottom):(c=r.left,l=o,u=r.right,d=a),n.beginPath(),t&&(c=Math.max(c,t.left),u=Math.min(u,t.right),l=Math.max(l,t.top),d=Math.min(d,t.bottom)),n.rect(c,l,u-c,d-l),n.clip()}}function a4(n,e,t,i){let r=e.interpolate(t,i);r&&n.lineTo(r.x,r.y)}var yoe={id:"filler",afterDatasetsUpdate(n,e,t){let i=(n.data.datasets||[]).length,r=[],s,o,a,c;for(o=0;o<i;++o)s=n.getDatasetMeta(o),a=s.dataset,c=null,a&&a.options&&a instanceof ME&&(c={visible:n.isDatasetVisible(o),index:o,fill:noe(a,o,i),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=c,r.push(c);for(o=0;o<i;++o)c=r[o],!(!c||c.fill===!1)&&(c.fill=toe(r,o,t.propagate))},beforeDraw(n,e,t){let i=t.drawTime==="beforeDraw",r=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=r.length-1;o>=0;--o){let a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&eR(n.ctx,a,s))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;let i=n.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){let s=i[r].$filler;r4(s)&&eR(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,e,t){let i=e.meta.$filler;!r4(i)||t.drawTime!=="beforeDatasetDraw"||eR(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},c4=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},voe=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index,IE=class extends Ds{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let e=this.options.labels||{},t=bn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){let{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}let i=e.labels,r=ui(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=c4(i,s),l,u;t.font=r.string,this.isHorizontal()?(l=this.maxWidth,u=this._fitRows(o,s,a,c)+10):(u=this.maxHeight,l=this._fitCols(o,r,a,c)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){let{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.lineWidths=[0],u=r+a,d=e;s.textAlign="left",s.textBaseline="middle";let h=-1,p=-u;return this.legendItems.forEach((g,y)=>{let m=i+t/2+s.measureText(g.text).width;(y===0||l[l.length-1]+m+2*a>o)&&(d+=u,l[l.length-(y>0?0:1)]=0,p+=u,h++),c[y]={left:0,top:p,row:h,width:m,height:r},l[l.length-1]+=m+a}),d}_fitCols(e,t,i,r){let{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.columnSizes=[],u=o-e,d=a,h=0,p=0,g=0,y=0;return this.legendItems.forEach((m,_)=>{let{itemWidth:I,itemHeight:M}=boe(i,t,s,m,r);_>0&&p+M+2*a>u&&(d+=h+a,l.push({width:h,height:p}),g+=h+a,y++,h=p=0),c[_]={left:g,top:p,col:y,width:I,height:M},h=Math.max(h,I),p+=M+a}),d+=h,l.push({width:h,height:p}),d}adjustHitBoxes(){if(!this.options.display)return;let e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:s}}=this,o=Tu(s,this.left,this.width);if(this.isHorizontal()){let a=0,c=Fi(i,this.left+r,this.right-this.lineWidths[a]);for(let l of t)a!==l.row&&(a=l.row,c=Fi(i,this.left+r,this.right-this.lineWidths[a])),l.top+=this.top+e+r,l.left=o.leftForLtr(o.x(c),l.width),c+=l.width+r}else{let a=0,c=Fi(i,this.top+e+r,this.bottom-this.columnSizes[a].height);for(let l of t)l.col!==a&&(a=l.col,c=Fi(i,this.top+e+r,this.bottom-this.columnSizes[a].height)),l.top=c,l.left+=this.left+r,l.left=o.leftForLtr(o.x(l.left),l.width),c+=l.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let e=this.ctx;sg(e,this),this._draw(),og(e)}}_draw(){let{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:s,labels:o}=e,a=Cn.color,c=Tu(e.rtl,this.left,this.width),l=ui(o.font),{padding:u}=o,d=l.size,h=d/2,p;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;let{boxWidth:g,boxHeight:y,itemHeight:m}=c4(o,d),_=function(N,S,w){if(isNaN(g)||g<=0||isNaN(y)||y<0)return;r.save();let b=vt(w.lineWidth,1);if(r.fillStyle=vt(w.fillStyle,a),r.lineCap=vt(w.lineCap,"butt"),r.lineDashOffset=vt(w.lineDashOffset,0),r.lineJoin=vt(w.lineJoin,"miter"),r.lineWidth=b,r.strokeStyle=vt(w.strokeStyle,a),r.setLineDash(vt(w.lineDash,[])),o.usePointStyle){let E={radius:y*Math.SQRT2/2,pointStyle:w.pointStyle,rotation:w.rotation,borderWidth:b},T=c.xPlus(N,g/2),R=S+h;P1(r,E,T,R,o.pointStyleWidth&&g)}else{let E=S+Math.max((d-y)/2,0),T=c.leftForLtr(N,g),R=jc(w.borderRadius);r.beginPath(),Object.values(R).some(A=>A!==0)?Zh(r,{x:T,y:E,w:g,h:y,radius:R}):r.rect(T,E,g,y),r.fill(),b!==0&&r.stroke()}r.restore()},I=function(N,S,w){Hc(r,w.text,N,S+m/2,l,{strikethrough:w.hidden,textAlign:c.textAlign(w.textAlign)})},M=this.isHorizontal(),C=this._computeTitleHeight();M?p={x:Fi(s,this.left+u,this.right-i[0]),y:this.top+u+C,line:0}:p={x:this.left+u,y:Fi(s,this.top+C+u,this.bottom-t[0].height),line:0},B1(this.ctx,e.textDirection);let P=m+u;this.legendItems.forEach((N,S)=>{r.strokeStyle=N.fontColor,r.fillStyle=N.fontColor;let w=r.measureText(N.text).width,b=c.textAlign(N.textAlign||(N.textAlign=o.textAlign)),E=g+h+w,T=p.x,R=p.y;c.setWidth(this.width),M?S>0&&T+E+u>this.right&&(R=p.y+=P,p.line++,T=p.x=Fi(s,this.left+u,this.right-i[p.line])):S>0&&R+P>this.bottom&&(T=p.x=T+t[p.line].width+u,p.line++,R=p.y=Fi(s,this.top+C+u,this.bottom-t[p.line].height));let A=c.x(T);if(_(A,R,N),T=cH(b,T+g+h,M?T+E:this.right,e.rtl),I(c.x(T),R,N),M)p.x+=E+u;else if(typeof N.text!="string"){let ne=l.lineHeight;p.y+=j4(N,ne)+u}else p.y+=P}),z1(this.ctx,e.textDirection)}drawTitle(){let e=this.options,t=e.title,i=ui(t.font),r=Vi(t.padding);if(!t.display)return;let s=Tu(e.rtl,this.left,this.width),o=this.ctx,a=t.position,c=i.size/2,l=r.top+c,u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+l,d=Fi(e.align,d,this.right-h);else{let g=this.columnSizes.reduce((y,m)=>Math.max(y,m.height),0);u=l+Fi(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}let p=Fi(a,d,d+h);o.textAlign=s.textAlign(sE(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=i.string,Hc(o,t.text,p,u,i)}_computeTitleHeight(){let e=this.options.title,t=ui(e.font),i=Vi(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,s;if(Eo(e,this.left,this.right)&&Eo(t,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],Eo(e,r.left,r.left+r.width)&&Eo(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){let t=this.options;if(!xoe(e.type,t))return;let i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){let r=this._hoveredItem,s=voe(r,i);r&&!s&&bn(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&bn(t.onHover,[e,i,this],this)}else i&&bn(t.onClick,[e,i,this],this)}};function boe(n,e,t,i,r){let s=Eoe(i,n,e,t),o=woe(r,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function Eoe(n,e,t,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+i.measureText(r).width}function woe(n,e,t){let i=n;return typeof e.text!="string"&&(i=j4(e,t)),i}function j4(n,e){let t=n.text?n.text.length:0;return e*t}function xoe(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Soe={id:"legend",_element:IE,start(n,e,t){let i=n.legend=new IE({ctx:n.ctx,options:t,chart:n});Ji.configure(n,i,t),Ji.addBox(n,i)},stop(n){Ji.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){let i=n.legend;Ji.configure(n,i,t),i.options=t},afterUpdate(n){let e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){let i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){let e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{let l=c.controller.getStyle(t?0:void 0),u=Vi(l.borderWidth);return{text:e[c.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!c.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:o&&(a||l.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}},mg=class extends Ds{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){let i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;let r=Sn(i.text)?i.text.length:1;this._padding=Vi(i.padding);let s=r*ui(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){let e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){let{top:t,left:i,bottom:r,right:s,options:o}=this,a=o.align,c=0,l,u,d;return this.isHorizontal()?(u=Fi(a,i,s),d=t+e,l=s-i):(o.position==="left"?(u=i+e,d=Fi(a,r,t),c=Yt*-.5):(u=s-e,d=Fi(a,t,r),c=Yt*.5),l=r-t),{titleX:u,titleY:d,maxWidth:l,rotation:c}}draw(){let e=this.ctx,t=this.options;if(!t.display)return;let i=ui(t.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:l}=this._drawArgs(s);Hc(e,t.text,0,0,i,{color:t.color,maxWidth:c,rotation:l,textAlign:sE(t.align),textBaseline:"middle",translation:[o,a]})}};function Toe(n,e){let t=new mg({ctx:n.ctx,options:e,chart:n});Ji.configure(n,t,e),Ji.addBox(n,t),n.titleBlock=t}var Ioe={id:"title",_element:mg,start(n,e,t){Toe(n,t)},stop(n){let e=n.titleBlock;Ji.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){let i=n.titleBlock;Ji.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},gE=new WeakMap,Coe={id:"subtitle",start(n,e,t){let i=new mg({ctx:n.ctx,options:t,chart:n});Ji.configure(n,i,t),Ji.addBox(n,i),gE.set(n,i)},stop(n){Ji.removeBox(n,gE.get(n)),gE.delete(n)},beforeUpdate(n,e,t){let i=gE.get(n);Ji.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},fg={average(n){if(!n.length)return!1;let e,t,i=new Set,r=0,s=0;for(e=0,t=n.length;e<t;++e){let a=n[e].element;if(a&&a.hasValue()){let c=a.tooltipPosition();i.add(c.x),r+=c.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,c)=>a+c)/i.size,y:r/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){let c=n[s].element;if(c&&c.hasValue()){let l=c.getCenterPoint(),u=eE(e,l);u<r&&(r=u,a=c)}}if(a){let c=a.tooltipPosition();t=c.x,i=c.y}return{x:t,y:i}}};function wo(n,e){return e&&(Sn(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function wa(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function Moe(n,e){let{element:t,datasetIndex:i,index:r}=e,s=n.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:n,label:o,parsed:s.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function l4(n,e){let t=n.chart.ctx,{body:i,footer:r,title:s}=n,{boxWidth:o,boxHeight:a}=e,c=ui(e.bodyFont),l=ui(e.titleFont),u=ui(e.footerFont),d=s.length,h=r.length,p=i.length,g=Vi(e.padding),y=g.height,m=0,_=i.reduce((C,P)=>C+P.before.length+P.lines.length+P.after.length,0);if(_+=n.beforeBody.length+n.afterBody.length,d&&(y+=d*l.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),_){let C=e.displayColors?Math.max(a,c.lineHeight):c.lineHeight;y+=p*C+(_-p)*c.lineHeight+(_-1)*e.bodySpacing}h&&(y+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let I=0,M=function(C){m=Math.max(m,t.measureText(C).width+I)};return t.save(),t.font=l.string,cn(n.title,M),t.font=c.string,cn(n.beforeBody.concat(n.afterBody),M),I=e.displayColors?o+2+e.boxPadding:0,cn(i,C=>{cn(C.before,M),cn(C.lines,M),cn(C.after,M)}),I=0,t.font=u.string,cn(n.footer,M),t.restore(),m+=g.width,{width:m,height:y}}function Aoe(n,e){let{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function Doe(n,e,t,i){let{x:r,width:s}=i,o=t.caretSize+t.caretPadding;if(n==="left"&&r+s+o>e.width||n==="right"&&r-s-o<0)return!0}function Roe(n,e,t,i){let{x:r,width:s}=t,{width:o,chartArea:{left:a,right:c}}=n,l="center";return i==="center"?l=r<=(a+c)/2?"left":"right":r<=s/2?l="left":r>=o-s/2&&(l="right"),Doe(l,n,e,t)&&(l="center"),l}function u4(n,e,t){let i=t.yAlign||e.yAlign||Aoe(n,t);return{xAlign:t.xAlign||e.xAlign||Roe(n,e,t,i),yAlign:i}}function Poe(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function Noe(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function d4(n,e,t,i){let{caretSize:r,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:c}=t,l=r+s,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=jc(o),g=Poe(e,a),y=Noe(e,c,l);return c==="center"?a==="left"?g+=l:a==="right"&&(g-=l):a==="left"?g-=Math.max(u,h)+r:a==="right"&&(g+=Math.max(d,p)+r),{x:mi(g,0,i.width-e.width),y:mi(y,0,i.height-e.height)}}function _E(n,e,t){let i=Vi(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function h4(n){return wo([],wa(n))}function Ooe(n,e,t){return ba(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function f4(n,e){let t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}var G4={beforeTitle:bo,title(n){if(n.length>0){let e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:bo,beforeBody:bo,beforeLabel:bo,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");let t=n.formattedValue;return kt(t)||(e+=t),e},labelColor(n){let t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){let t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:bo,afterBody:bo,beforeFooter:bo,footer:bo,afterFooter:bo};function Sr(n,e,t,i){let r=n[e].call(t,i);return typeof r>"u"?G4[e].call(t,i):r}var p4=(()=>{class n extends Ds{static positioners=fg;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let t=this._cachedAnimations;if(t)return t;let i=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&i.options.animation&&r.animations,o=new EE(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=Ooe(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,i){let{callbacks:r}=i,s=Sr(r,"beforeTitle",this,t),o=Sr(r,"title",this,t),a=Sr(r,"afterTitle",this,t),c=[];return c=wo(c,wa(s)),c=wo(c,wa(o)),c=wo(c,wa(a)),c}getBeforeBody(t,i){return h4(Sr(i.callbacks,"beforeBody",this,t))}getBody(t,i){let{callbacks:r}=i,s=[];return cn(t,o=>{let a={before:[],lines:[],after:[]},c=f4(r,o);wo(a.before,wa(Sr(c,"beforeLabel",this,o))),wo(a.lines,Sr(c,"label",this,o)),wo(a.after,wa(Sr(c,"afterLabel",this,o))),s.push(a)}),s}getAfterBody(t,i){return h4(Sr(i.callbacks,"afterBody",this,t))}getFooter(t,i){let{callbacks:r}=i,s=Sr(r,"beforeFooter",this,t),o=Sr(r,"footer",this,t),a=Sr(r,"afterFooter",this,t),c=[];return c=wo(c,wa(s)),c=wo(c,wa(o)),c=wo(c,wa(a)),c}_createItems(t){let i=this._active,r=this.chart.data,s=[],o=[],a=[],c=[],l,u;for(l=0,u=i.length;l<u;++l)c.push(Moe(this.chart,i[l]));return t.filter&&(c=c.filter((d,h,p)=>t.filter(d,h,p,r))),t.itemSort&&(c=c.sort((d,h)=>t.itemSort(d,h,r))),cn(c,d=>{let h=f4(t.callbacks,d);s.push(Sr(h,"labelColor",this,d)),o.push(Sr(h,"labelPointStyle",this,d)),a.push(Sr(h,"labelTextColor",this,d))}),this.labelColors=s,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=c,c}update(t,i){let r=this.options.setContext(this.getContext()),s=this._active,o,a=[];if(!s.length)this.opacity!==0&&(o={opacity:0});else{let c=fg[r.position].call(this,s,this._eventPosition);a=this._createItems(r),this.title=this.getTitle(a,r),this.beforeBody=this.getBeforeBody(a,r),this.body=this.getBody(a,r),this.afterBody=this.getAfterBody(a,r),this.footer=this.getFooter(a,r);let l=this._size=l4(this,r),u=Object.assign({},c,l),d=u4(this.chart,r,u),h=d4(r,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,o={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:c.x,caretY:c.y}}this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(t,i,r,s){let o=this.getCaretPosition(t,r,s);i.lineTo(o.x1,o.y1),i.lineTo(o.x2,o.y2),i.lineTo(o.x3,o.y3)}getCaretPosition(t,i,r){let{xAlign:s,yAlign:o}=this,{caretSize:a,cornerRadius:c}=r,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=jc(c),{x:p,y:g}=t,{width:y,height:m}=i,_,I,M,C,P,N;return o==="center"?(P=g+m/2,s==="left"?(_=p,I=_-a,C=P+a,N=P-a):(_=p+y,I=_+a,C=P-a,N=P+a),M=_):(s==="left"?I=p+Math.max(l,d)+a:s==="right"?I=p+y-Math.max(u,h)-a:I=this.caretX,o==="top"?(C=g,P=C-a,_=I-a,M=I+a):(C=g+m,P=C+a,_=I+a,M=I-a),N=C),{x1:_,x2:I,x3:M,y1:C,y2:P,y3:N}}drawTitle(t,i,r){let s=this.title,o=s.length,a,c,l;if(o){let u=Tu(r.rtl,this.x,this.width);for(t.x=_E(this,r.titleAlign,r),i.textAlign=u.textAlign(r.titleAlign),i.textBaseline="middle",a=ui(r.titleFont),c=r.titleSpacing,i.fillStyle=r.titleColor,i.font=a.string,l=0;l<o;++l)i.fillText(s[l],u.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+c,l+1===o&&(t.y+=r.titleMarginBottom-c)}}_drawColorBox(t,i,r,s,o){let a=this.labelColors[r],c=this.labelPointStyles[r],{boxHeight:l,boxWidth:u}=o,d=ui(o.bodyFont),h=_E(this,"left",o),p=s.x(h),g=l<d.lineHeight?(d.lineHeight-l)/2:0,y=i.y+g;if(o.usePointStyle){let m={radius:Math.min(u,l)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},_=s.leftForLtr(p,u)+u/2,I=y+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,aE(t,m,_,I),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,aE(t,m,_,I)}else{t.lineWidth=Ft(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;let m=s.leftForLtr(p,u),_=s.leftForLtr(s.xPlus(p,1),u-2),I=jc(a.borderRadius);Object.values(I).some(M=>M!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Zh(t,{x:m,y,w:u,h:l,radius:I}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Zh(t,{x:_,y:y+1,w:u-2,h:l-2,radius:I}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(m,y,u,l),t.strokeRect(m,y,u,l),t.fillStyle=a.backgroundColor,t.fillRect(_,y+1,u-2,l-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,i,r){let{body:s}=this,{bodySpacing:o,bodyAlign:a,displayColors:c,boxHeight:l,boxWidth:u,boxPadding:d}=r,h=ui(r.bodyFont),p=h.lineHeight,g=0,y=Tu(r.rtl,this.x,this.width),m=function(b){i.fillText(b,y.x(t.x+g),t.y+p/2),t.y+=p+o},_=y.textAlign(a),I,M,C,P,N,S,w;for(i.textAlign=a,i.textBaseline="middle",i.font=h.string,t.x=_E(this,_,r),i.fillStyle=r.bodyColor,cn(this.beforeBody,m),g=c&&_!=="right"?a==="center"?u/2+d:u+2+d:0,P=0,S=s.length;P<S;++P){for(I=s[P],M=this.labelTextColors[P],i.fillStyle=M,cn(I.before,m),C=I.lines,c&&C.length&&(this._drawColorBox(i,t,P,y,r),p=Math.max(h.lineHeight,l)),N=0,w=C.length;N<w;++N)m(C[N]),p=h.lineHeight;cn(I.after,m)}g=0,p=h.lineHeight,cn(this.afterBody,m),t.y-=o}drawFooter(t,i,r){let s=this.footer,o=s.length,a,c;if(o){let l=Tu(r.rtl,this.x,this.width);for(t.x=_E(this,r.footerAlign,r),t.y+=r.footerMarginTop,i.textAlign=l.textAlign(r.footerAlign),i.textBaseline="middle",a=ui(r.footerFont),i.fillStyle=r.footerColor,i.font=a.string,c=0;c<o;++c)i.fillText(s[c],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+r.footerSpacing}}drawBackground(t,i,r,s){let{xAlign:o,yAlign:a}=this,{x:c,y:l}=t,{width:u,height:d}=r,{topLeft:h,topRight:p,bottomLeft:g,bottomRight:y}=jc(s.cornerRadius);i.fillStyle=s.backgroundColor,i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.beginPath(),i.moveTo(c+h,l),a==="top"&&this.drawCaret(t,i,r,s),i.lineTo(c+u-p,l),i.quadraticCurveTo(c+u,l,c+u,l+p),a==="center"&&o==="right"&&this.drawCaret(t,i,r,s),i.lineTo(c+u,l+d-y),i.quadraticCurveTo(c+u,l+d,c+u-y,l+d),a==="bottom"&&this.drawCaret(t,i,r,s),i.lineTo(c+g,l+d),i.quadraticCurveTo(c,l+d,c,l+d-g),a==="center"&&o==="left"&&this.drawCaret(t,i,r,s),i.lineTo(c,l+h),i.quadraticCurveTo(c,l,c+h,l),i.closePath(),i.fill(),s.borderWidth>0&&i.stroke()}_updateAnimationTarget(t){let i=this.chart,r=this.$animations,s=r&&r.x,o=r&&r.y;if(s||o){let a=fg[t.position].call(this,this._active,this._eventPosition);if(!a)return;let c=this._size=l4(this,t),l=Object.assign({},a,this._size),u=u4(i,t,l),d=d4(t,l,u,i);(s._to!==d.x||o._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=c.width,this.height=c.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(t){let i=this.options.setContext(this.getContext()),r=this.opacity;if(!r)return;this._updateAnimationTarget(i);let s={width:this.width,height:this.height},o={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;let a=Vi(i.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&c&&(t.save(),t.globalAlpha=r,this.drawBackground(o,t,s,i),B1(t,i.textDirection),o.y+=a.top,this.drawTitle(o,t,i),this.drawBody(o,t,i),this.drawFooter(o,t,i),z1(t,i.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,i){let r=this._active,s=t.map(({datasetIndex:c,index:l})=>{let u=this.chart.getDatasetMeta(c);if(!u)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:u.data[l],index:l}}),o=!ig(r,s),a=this._positionChanged(s,i);(o||a)&&(this._active=s,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,i,r=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let s=this.options,o=this._active||[],a=this._getActiveElements(t,o,i,r),c=this._positionChanged(a,t),l=i||!ig(a,o)||c;return l&&(this._active=a,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,i))),l}_getActiveElements(t,i,r,s){let o=this.options;if(t.type==="mouseout")return[];if(!s)return i.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);let a=this.chart.getElementsAtEventForMode(t,o.mode,o,r);return o.reverse&&a.reverse(),a}_positionChanged(t,i){let{caretX:r,caretY:s,options:o}=this,a=fg[o.position].call(this,t,i);return a!==!1&&(r!==a.x||s!==a.y)}}return n})(),koe={id:"tooltip",_element:p4,positioners:fg,afterInit(n,e,t){t&&(n.tooltip=new p4({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){let e=n.tooltip;if(e&&e._willRender()){let t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",je(ae({},t),{cancelable:!0}))===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){let t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:G4},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Loe=Object.freeze({__proto__:null,Colors:Xse,Decimation:Jse,Filler:yoe,Legend:Soe,SubTitle:Coe,Title:Ioe,Tooltip:koe}),Foe=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Voe(n,e,t,i){let r=n.indexOf(e);if(r===-1)return Foe(n,e,t,i);let s=n.lastIndexOf(e);return r!==s?t:r}var Uoe=(n,e)=>n===null?null:mi(Math.round(n),0,e);function m4(n){let e=this.getLabels();return n>=0&&n<e.length?e[n]:n}var Boe=(()=>{class n extends Mu{static id="category";static defaults={ticks:{callback:m4}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){let i=this._addedLabels;if(i.length){let r=this.getLabels();for(let{index:s,label:o}of i)r[s]===o&&r.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,i){if(kt(t))return null;let r=this.getLabels();return i=isFinite(i)&&r[i]===t?i:Voe(r,t,vt(i,t),this._addedLabels),Uoe(i,r.length-1)}determineDataLimits(){let{minDefined:t,maxDefined:i}=this.getUserBounds(),{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),i||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){let t=this.min,i=this.max,r=this.options.offset,s=[],o=this.getLabels();o=t===0&&i===o.length-1?o:o.slice(t,i+1),this._valueRange=Math.max(o.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let a=t;a<=i;a++)s.push({value:a});return s}getLabelForValue(t){return m4.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){let i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}return n})();function zoe(n,e){let t=[],{bounds:r,step:s,min:o,max:a,precision:c,count:l,maxTicks:u,maxDigits:d,includeBounds:h}=n,p=s||1,g=u-1,{min:y,max:m}=e,_=!kt(o),I=!kt(a),M=!kt(l),C=(m-y)/(d+1),P=v1((m-y)/g/p)*p,N,S,w,b;if(P<1e-14&&!_&&!I)return[{value:y},{value:m}];b=Math.ceil(m/P)-Math.floor(y/P),b>g&&(P=v1(b*P/g/p)*p),kt(c)||(N=Math.pow(10,c),P=Math.ceil(P*N)/N),r==="ticks"?(S=Math.floor(y/P)*P,w=Math.ceil(m/P)*P):(S=y,w=m),_&&I&&s&&tH((a-o)/s,P/1e3)?(b=Math.round(Math.min((a-o)/P,u)),P=(a-o)/b,S=o,w=a):M?(S=_?o:S,w=I?a:w,b=l-1,P=(w-S)/b):(b=(w-S)/P,Xh(b,Math.round(b),P/1e3)?b=Math.round(b):b=Math.ceil(b));let E=Math.max(E1(P),E1(S));N=Math.pow(10,kt(c)?E:c),S=Math.round(S*N)/N,w=Math.round(w*N)/N;let T=0;for(_&&(h&&S!==o?(t.push({value:o}),S<o&&T++,Xh(Math.round((S+T*P)*N)/N,o,g4(o,C,n))&&T++):S<o&&T++);T<b;++T){let R=Math.round((S+T*P)*N)/N;if(I&&R>a)break;t.push({value:R})}return I&&h&&w!==a?t.length&&Xh(t[t.length-1].value,a,g4(a,C,n))?t[t.length-1].value=a:t.push({value:a}):(!I||w===a)&&t.push({value:w}),t}function g4(n,e,{horizontal:t,minRotation:i}){let r=as(i),s=(t?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}var tf=class extends Mu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return kt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){let{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds(),{min:r,max:s}=this,o=c=>r=t?r:c,a=c=>s=i?s:c;if(e){let c=As(r),l=As(s);c<0&&l<0?a(0):c>0&&l>0&&o(0)}if(r===s){let c=s===0?1:Math.abs(s*.05);a(s+c),e||o(r-c)}this.min=r,this.max=s}getTickLimit(){let e=this.options.ticks,{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let e=this.options,t=e.ticks,i=this.getTickLimit();i=Math.max(2,i);let r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=zoe(r,s);return e.bounds==="ticks"&&b1(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){let e=this.ticks,t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){let r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return Kh(e,this.chart.options.locale,this.options.ticks.format)}},_R=class extends tf{static id="linear";static defaults={ticks:{callback:rg.formatters.numeric}};determineDataLimits(){let{min:e,max:t}=this.getMinMax(!0);this.min=Fn(e)?e:0,this.max=Fn(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){let e=this.isHorizontal(),t=e?this.width:this.height,i=as(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}},gg=n=>Math.floor(ya(n)),Cu=(n,e)=>Math.pow(10,gg(n)+e);function _4(n){return n/Math.pow(10,gg(n))===1}function y4(n,e,t){let i=Math.pow(10,t),r=Math.floor(n/i);return Math.ceil(e/i)-r}function Hoe(n,e){let t=e-n,i=gg(t);for(;y4(n,e,i)>10;)i++;for(;y4(n,e,i)<10;)i--;return Math.min(i,gg(n))}function joe(n,{min:e,max:t}){e=xr(n.min,e);let i=[],r=gg(e),s=Hoe(e,t),o=s<0?Math.pow(10,Math.abs(s)):1,a=Math.pow(10,s),c=r>s?Math.pow(10,r):0,l=Math.round((e-c)*o)/o,u=Math.floor((e-c)/a/10)*a*10,d=Math.floor((l-u)/Math.pow(10,s)),h=xr(n.min,Math.round((c+u+d*Math.pow(10,s))*o)/o);for(;h<t;)i.push({value:h,major:_4(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),h=Math.round((c+u+d*Math.pow(10,s))*o)/o;let p=xr(n.max,h);return i.push({value:p,major:_4(p),significand:d}),i}var yR=class extends Mu{static id="logarithmic";static defaults={ticks:{callback:rg.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){let i=tf.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return Fn(i)&&i>0?i:null}determineDataLimits(){let{min:e,max:t}=this.getMinMax(!0);this.min=Fn(e)?Math.max(0,e):null,this.max=Fn(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Fn(this._userMin)&&(this.min=e===Cu(this.min,0)?Cu(this.min,-1):Cu(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:e,maxDefined:t}=this.getUserBounds(),i=this.min,r=this.max,s=a=>i=e?i:a,o=a=>r=t?r:a;i===r&&(i<=0?(s(1),o(10)):(s(Cu(i,-1)),o(Cu(r,1)))),i<=0&&s(Cu(r,-1)),r<=0&&o(Cu(i,1)),this.min=i,this.max=r}buildTicks(){let e=this.options,t={min:this._userMin,max:this._userMax},i=joe(t,this);return e.bounds==="ticks"&&b1(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":Kh(e,this.chart.options.locale,this.options.ticks.format)}configure(){let e=this.min;super.configure(),this._startValue=ya(e),this._valueRange=ya(this.max)-ya(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(ya(e)-this._startValue)/this._valueRange)}getValueForPixel(e){let t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}};function vR(n){let e=n.ticks;if(e.display&&n.display){let t=Vi(e.backdropPadding);return vt(e.font&&e.font.size,Cn.font.size)+t.height}return 0}function Goe(n,e,t){return t=Sn(t)?t:[t],{w:uH(n,e.string,t),h:t.length*e.lineHeight}}function v4(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function Woe(n){let e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],s=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?Yt/s:0;for(let c=0;c<s;c++){let l=o.setContext(n.getPointLabelContext(c));r[c]=l.padding;let u=n.getPointPosition(c,n.drawingArea+r[c],a),d=ui(l.font),h=Goe(n.ctx,d,n._pointLabels[c]);i[c]=h;let p=Li(n.getIndexAngle(c)+a),g=Math.round(iE(p)),y=v4(g,u.x,h.w,0,180),m=v4(g,u.y,h.h,90,270);$oe(t,e,p,y,m)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=Yoe(n,i,r)}function $oe(n,e,t,i,r){let s=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t)),a=0,c=0;i.start<e.l?(a=(e.l-i.start)/s,n.l=Math.min(n.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/s,n.r=Math.max(n.r,e.r+a)),r.start<e.t?(c=(e.t-r.start)/o,n.t=Math.min(n.t,e.t-c)):r.end>e.b&&(c=(r.end-e.b)/o,n.b=Math.max(n.b,e.b+c))}function qoe(n,e,t){let i=n.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=t,c=n.getPointPosition(e,i+r+o,s),l=Math.round(iE(Li(c.angle+$n))),u=Joe(c.y,a.h,l),d=Koe(l),h=Zoe(c.x,a.w,d);return{visible:!0,x:c.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function Xoe(n,e){if(!e)return!0;let{left:t,top:i,right:r,bottom:s}=n;return!(vo({x:t,y:i},e)||vo({x:t,y:s},e)||vo({x:r,y:i},e)||vo({x:r,y:s},e))}function Yoe(n,e,t){let i=[],r=n._pointLabels.length,s=n.options,{centerPointLabels:o,display:a}=s.pointLabels,c={extra:vR(s)/2,additionalAngle:o?Yt/r:0},l;for(let u=0;u<r;u++){c.padding=t[u],c.size=e[u];let d=qoe(n,u,c);i.push(d),a==="auto"&&(d.visible=Xoe(d,l),d.visible&&(l=d))}return i}function Koe(n){return n===0||n===180?"center":n<180?"left":"right"}function Zoe(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function Joe(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function Qoe(n,e,t){let{left:i,top:r,right:s,bottom:o}=t,{backdropColor:a}=e;if(!kt(a)){let c=jc(e.borderRadius),l=Vi(e.backdropPadding);n.fillStyle=a;let u=i-l.left,d=r-l.top,h=s-i+l.width,p=o-r+l.height;Object.values(c).some(g=>g!==0)?(n.beginPath(),Zh(n,{x:u,y:d,w:h,h:p,radius:c}),n.fill()):n.fillRect(u,d,h,p)}}function eae(n,e){let{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){let s=n._pointLabelItems[r];if(!s.visible)continue;let o=i.setContext(n.getPointLabelContext(r));Qoe(t,o,s);let a=ui(o.font),{x:c,y:l,textAlign:u}=s;Hc(t,n._pointLabels[r],c,l+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function W4(n,e,t,i){let{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,Tn);else{let s=n.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=n.getPointPosition(o,e),r.lineTo(s.x,s.y)}}function tae(n,e,t,i,r){let s=n.ctx,o=e.circular,{color:a,lineWidth:c}=e;!o&&!i||!a||!c||t<0||(s.save(),s.strokeStyle=a,s.lineWidth=c,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),W4(n,t,o,i),s.closePath(),s.stroke(),s.restore())}function nae(n,e,t){return ba(n,{label:t,index:e,type:"pointLabel"})}var bR=class extends tf{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:rg.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let e=this._padding=Vi(vR(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){let{min:e,max:t}=this.getMinMax(!1);this.min=Fn(e)&&!isNaN(e)?e:0,this.max=Fn(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/vR(this.options))}generateTickLabels(e){tf.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{let r=bn(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){let e=this.options;e.display&&e.pointLabels.display?Woe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){let t=Tn/(this._pointLabels.length||1),i=this.options.startAngle||0;return Li(e*t+as(i))}getDistanceFromCenterForValue(e){if(kt(e))return NaN;let t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(kt(e))return NaN;let t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){let t=this._pointLabels||[];if(e>=0&&e<t.length){let i=t[e];return nae(this.getContext(),e,i)}}getPointPosition(e,t,i=0){let r=this.getIndexAngle(e)-$n+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){let{left:t,top:i,right:r,bottom:s}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:s}}drawBackground(){let{backgroundColor:e,grid:{circular:t}}=this.options;if(e){let i=this.ctx;i.save(),i.beginPath(),W4(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){let e=this.ctx,t=this.options,{angleLines:i,grid:r,border:s}=t,o=this._pointLabels.length,a,c,l;if(t.pointLabels.display&&eae(this,o),r.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(u.value);let h=this.getContext(d),p=r.setContext(h),g=s.setContext(h);tae(this,p,c,o,g)}}),i.display){for(e.save(),a=o-1;a>=0;a--){let u=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(e.lineWidth=h,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,c=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(a,c),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){let e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;let r=this.getIndexAngle(0),s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!t.reverse)return;let l=i.setContext(this.getContext(c)),u=ui(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[c].value),l.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=l.backdropColor;let d=Vi(l.backdropPadding);e.fillRect(-o/2-d.left,-s-u.size/2-d.top,o+d.width,u.size+d.height)}Hc(e,a.label,0,-s,u,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}),e.restore()}drawTitle(){}},DE={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Tr=Object.keys(DE);function b4(n,e){return n-e}function E4(n,e){if(kt(e))return null;let t=n._adapter,{parser:i,round:r,isoWeekday:s}=n._parseOpts,o=e;return typeof i=="function"&&(o=i(o)),Fn(o)||(o=typeof i=="string"?t.parse(o,i):t.parse(o)),o===null?null:(r&&(o=r==="week"&&(Su(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,r)),+o)}function w4(n,e,t,i){let r=Tr.length;for(let s=Tr.indexOf(n);s<r-1;++s){let o=DE[Tr[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=i)return Tr[s]}return Tr[r-1]}function iae(n,e,t,i,r){for(let s=Tr.length-1;s>=Tr.indexOf(t);s--){let o=Tr[s];if(DE[o].common&&n._adapter.diff(r,i,o)>=e-1)return o}return Tr[t?Tr.indexOf(t):0]}function rae(n){for(let e=Tr.indexOf(n)+1,t=Tr.length;e<t;++e)if(DE[Tr[e]].common)return Tr[e]}function x4(n,e,t){if(!t)n[e]=!0;else if(t.length){let{lo:i,hi:r}=rE(t,e),s=t[i]>=e?t[i]:t[r];n[s]=!0}}function sae(n,e,t,i){let r=n._adapter,s=+r.startOf(e[0].value,i),o=e[e.length-1].value,a,c;for(a=s;a<=o;a=+r.add(a,1,i))c=t[a],c>=0&&(e[c].major=!0);return e}function S4(n,e,t){let i=[],r={},s=e.length,o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,i.push({value:a,major:!1});return s===0||!t?i:sae(n,i,r,t)}var ER=(()=>{class n extends Mu{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,i={}){let r=t.time||(t.time={}),s=this._adapter=new gre._date(t.adapters.date);s.init(i),$h(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=i.normalized}parse(t,i){return t===void 0?null:E4(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let t=this.options,i=this._adapter,r=t.time.unit||"day",{min:s,max:o,minDefined:a,maxDefined:c}=this.getUserBounds();function l(u){!a&&!isNaN(u.min)&&(s=Math.min(s,u.min)),!c&&!isNaN(u.max)&&(o=Math.max(o,u.max))}(!a||!c)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=Fn(s)&&!isNaN(s)?s:+i.startOf(Date.now(),r),o=Fn(o)&&!isNaN(o)?o:+i.endOf(Date.now(),r)+1,this.min=Math.min(s,o-1),this.max=Math.max(s+1,o)}_getLabelBounds(){let t=this.getLabelTimestamps(),i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(i=t[0],r=t[t.length-1]),{min:i,max:r}}buildTicks(){let t=this.options,i=t.time,r=t.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);let o=this.min,a=this.max,c=rH(s,o,a);return this._unit=i.unit||(r.autoSkip?w4(i.minUnit,this.min,this.max,this._getLabelCapacity(o)):iae(this,c.length,i.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:rae(this._unit),this.initOffsets(s),t.reverse&&c.reverse(),S4(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let i=0,r=0,s,o;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?i=1-s:i=(this.getDecimalForValue(t[1])-s)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?r=o:r=(o-this.getDecimalForValue(t[t.length-2]))/2);let a=t.length<3?.5:.25;i=mi(i,0,a),r=mi(r,0,a),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){let t=this._adapter,i=this.min,r=this.max,s=this.options,o=s.time,a=o.unit||w4(o.minUnit,i,r,this._getLabelCapacity(i)),c=vt(s.ticks.stepSize,1),l=a==="week"?o.isoWeekday:!1,u=Su(l)||l===!0,d={},h=i,p,g;if(u&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,u?"day":a),t.diff(r,i,a)>1e5*c)throw new Error(i+" and "+r+" are too far apart with stepSize of "+c+" "+a);let y=s.ticks.source==="data"&&this.getDataTimestamps();for(p=h,g=0;p<r;p=+t.add(p,c,a),g++)x4(d,p,y);return(p===r||s.bounds==="ticks"||g===1)&&x4(d,p,y),Object.keys(d).sort(b4).map(m=>+m)}getLabelForValue(t){let i=this._adapter,r=this.options.time;return r.tooltipFormat?i.format(t,r.tooltipFormat):i.format(t,r.displayFormats.datetime)}format(t,i){let s=this.options.time.displayFormats,o=this._unit,a=i||s[o];return this._adapter.format(t,a)}_tickFormatFunction(t,i,r,s){let o=this.options,a=o.ticks.callback;if(a)return bn(a,[t,i,r],this);let c=o.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&c[l],h=u&&c[u],p=r[i],g=u&&h&&p&&p.major;return this._adapter.format(t,s||(g?h:d))}generateTickLabels(t){let i,r,s;for(i=0,r=t.length;i<r;++i)s=t[i],s.label=this._tickFormatFunction(s.value,i,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){let i=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((i.start+r)*i.factor)}getValueForPixel(t){let i=this._offsets,r=this.getDecimalForPixel(t)/i.factor-i.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){let i=this.options.ticks,r=this.ctx.measureText(t).width,s=as(this.isHorizontal()?i.maxRotation:i.minRotation),o=Math.cos(s),a=Math.sin(s),c=this._resolveTickFontOptions(0).size;return{w:r*o+c*a,h:r*a+c*o}}_getLabelCapacity(t){let i=this.options.time,r=i.displayFormats,s=r[i.unit]||r.millisecond,o=this._tickFormatFunction(t,0,S4(this,[t],this._majorUnit),s),a=this._getLabelSize(o),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let t=this._cache.data||[],i,r;if(t.length)return t;let s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(i=0,r=s.length;i<r;++i)t=t.concat(s[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){let t=this._cache.labels||[],i,r;if(t.length)return t;let s=this.getLabels();for(i=0,r=s.length;i<r;++i)t.push(E4(this,s[i]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return S1(t.sort(b4))}}return n})();function yE(n,e,t){let i=0,r=n.length-1,s,o,a,c;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=yo(n,"pos",e)),{pos:s,time:a}=n[i],{pos:o,time:c}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=yo(n,"time",e)),{time:s,pos:a}=n[i],{time:o,pos:c}=n[r]);let l=o-s;return l?a+(c-a)*(e-s)/l:a}var wR=class extends ER{static id="timeseries";static defaults=ER.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=yE(t,this.min),this._tableRange=yE(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){let{min:t,max:i}=this,r=[],s=[],o,a,c,l,u;for(o=0,a=e.length;o<a;++o)l=e[o],l>=t&&l<=i&&r.push(l);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],c=r[o-1],l=r[o],Math.round((u+c)/2)!==l&&s.push({time:l,pos:o/(a-1)});return s}_generate(){let e=this.min,t=this.max,i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;let t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(yE(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){let t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return yE(this._table,i*this._tableRange+this._minPos,!0)}},oae=Object.freeze({__proto__:null,CategoryScale:Boe,LinearScale:_R,LogarithmicScale:yR,RadialLinearScale:bR,TimeScale:ER,TimeSeriesScale:wR}),$4=[mre,zse,Loe,oae];CE.register(...$4);var SR=CE;var aae=["genreChart"],cae=["dimChart"],q4=()=>[1,2,3,4,5];function lae(n,e){if(n&1&&(F(0,"div",27),Ce(1,"i",28),F(2,"span"),j(3),B()()),n&2){let t=xe();$(3),ft(t.firebaseService.connectedUser.username||"Gamer Profile")}}function uae(n,e){n&1&&(F(0,"div",29)(1,"span"),j(2,"Like some games to see your stats!"),B()())}function dae(n,e){n&1&&(F(0,"div",29)(1,"span"),j(2,"No preference data available"),B()())}function hae(n,e){if(n&1&&(F(0,"span",41),j(1),B()),n&2){let t=e.$implicit;$(),ft(t)}}function fae(n,e){if(n&1&&Ce(0,"i",42),n&2){let t=e.$implicit,i=xe().$implicit;ur("color",t<=(+i.rating||0)?"#00ffa3":"#333")}}function pae(n,e){if(n&1&&(F(0,"div",30)(1,"div",31)(2,"div",32),Ce(3,"img",33),B(),F(4,"div",34)(5,"h4"),j(6),B(),F(7,"div",35),lt(8,hae,2,1,"span",36),B()()(),F(9,"div",37)(10,"div",38),lt(11,fae,1,2,"i",39),B(),F(12,"span",40),j(13),B()()()),n&2){let t=e.$implicit;$(3),ye("src",t.thumbnail,Ys),$(3),ft(t.title),$(2),ye("ngForOf",t.tags.slice(0,2)),$(3),ye("ngForOf",rv(5,q4)),$(2),ft(t.rating||"N/A")}}function mae(n,e){n&1&&(F(0,"div",43),Ce(1,"i",44),F(2,"p"),j(3,"You haven't liked any games yet."),B()())}function gae(n,e){if(n&1&&Ce(0,"i",42),n&2){let t=e.$implicit,i=xe().$implicit;yn("active",t<=i.rating)}}function _ae(n,e){if(n&1){let t=rn();F(0,"div",45)(1,"img",46),Pe("click",function(){let r=Ze(t).$implicit,s=xe();return Je(s.navigateToGame(r.gameId))}),B(),F(2,"div",47)(3,"div",48)(4,"div")(5,"strong",49),Pe("click",function(){let r=Ze(t).$implicit,s=xe();return Je(s.navigateToGame(r.gameId))}),j(6),B(),F(7,"div",38),lt(8,gae,1,2,"i",50),B()(),F(9,"div",51),Ce(10,"i",52),F(11,"span"),j(12),B()()(),F(13,"p",53),j(14),B(),F(15,"div",54)(16,"span",55),j(17),qo(18,"date"),B(),F(19,"button",56),Pe("click",function(){let r=Ze(t).$implicit,s=xe();return Je(s.navigateToGame(r.gameId))}),j(20," View Details "),Ce(21,"i",57),B()()()()}if(n&2){let t=e.$implicit;$(),ye("src",(t.game==null?null:t.game.thumbnail)||"assets/placeholder.png",Ys),$(5),vn(" ",(t.game==null?null:t.game.title)||"Unknown Game"," "),$(2),ye("ngForOf",rv(11,q4)),$(),yn("has-upvotes",t.upvoteCount>0),$(3),ft(t.upvoteCount),$(2),vn('"',t.content,'"'),$(3),ft(Ep(18,8,(t.createdAt==null?null:t.createdAt.seconds)*1e3,"mediumDate"))}}function yae(n,e){if(n&1){let t=rn();F(0,"div",58)(1,"button",59),Pe("click",function(){Ze(t);let r=xe();return Je(r.toggleExpand())}),j(2),Ce(3,"i",60),B()()}if(n&2){let t=xe();$(2),vn(" ",t.isExpanded?"Show Less":"View All "+t.filteredReviews.length+" Reviews"," "),$(),yn("fa-chevron-up",t.isExpanded)("fa-chevron-down",!t.isExpanded)}}function vae(n,e){n&1&&(F(0,"div",43),Ce(1,"i",61),F(2,"p"),j(3,"You haven't written any reviews yet."),B()())}var RE=class n{gameService=ie(Pc);firebaseService=ie(wr);reviewsService=ie(zh);router=ie(Yi);games=[];likedGames=[];likedGamesCount=0;userReviews=[];filteredReviews=[];isExpanded=!1;currentSort="newest";reviewLimit=3;genreCanvas;dimCanvas;chartInstances=[];ngOnInit(){this.refreshData(),setTimeout(()=>{this.loadUserReviews()},1e3)}ngAfterViewInit(){setTimeout(()=>{this.refreshData(),this.initCharts()},1e3)}refreshData(){this.games=this.gameService.getAllGames(),this.likedGames=this.games.filter(e=>e.liked),this.likedGamesCount=this.likedGames.length}loadUserReviews(){let e=this.firebaseService.connectedUser?.email;e&&this.reviewsService.getReviewsByUserEmail(e).subscribe(t=>{this.userReviews=t.map(i=>je(ae({},i),{game:this.gameService.getGameById(i.gameId),upvoteCount:i.upvotes?.length||0})),this.applySort()})}setSort(e){console.log(e),this.currentSort=e,this.applySort()}applySort(){let e=[...this.userReviews];this.currentSort==="upvotes"?e.sort((t,i)=>i.upvoteCount-t.upvoteCount):this.currentSort==="game"?e.sort((t,i)=>(t.game?.title||"").localeCompare(i.game?.title||"")):e.sort((t,i)=>(i.createdAt?.seconds||0)-(t.createdAt?.seconds||0)),this.filteredReviews=e}toggleExpand(){this.isExpanded=!this.isExpanded,this.reviewLimit=this.isExpanded?1e3:3}navigateToGame(e){this.router.navigate(["/details",e])}goToBrowse(){this.router.navigate(["/browse"])}initCharts(){if(this.chartInstances.forEach(o=>o.destroy()),this.chartInstances=[],this.likedGames.length===0)return;let e={},t={"2D":0,"3D":0};this.likedGames.forEach(o=>{o.tags.some(c=>c.toLowerCase().includes("3d"))?t["3D"]++:t["2D"]++,o.tags.forEach(c=>{let l=c.toLowerCase();!l.includes("2d")&&!l.includes("3d")&&(e[c]=(e[c]||0)+1)})});let i="#00ffa3",r=this.genreCanvas.nativeElement.getContext("2d");r&&this.chartInstances.push(new SR(r,{type:"polarArea",data:{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["rgba(0, 255, 163, 0.5)","rgba(99, 102, 241, 0.5)","rgba(236, 72, 153, 0.5)","rgba(245, 158, 11, 0.5)","rgba(59, 130, 246, 0.5)"],borderColor:"#0a1612",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{r:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{display:!1}}},plugins:{legend:{position:"right",labels:{color:"#aaa",font:{size:11}}}}}}));let s=this.dimCanvas.nativeElement.getContext("2d");s&&this.chartInstances.push(new SR(s,{type:"doughnut",data:{labels:["2D","3D"],datasets:[{data:[t["2D"],t["3D"]],backgroundColor:["rgba(255,255,255,0.1)",i],borderColor:"#0a1612",borderWidth:5,hoverOffset:15}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"75%",plugins:{legend:{position:"bottom",labels:{color:"#aaa",padding:20}}}}}))}ngOnDestroy(){this.chartInstances.forEach(e=>e.destroy())}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=kn({type:n,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(t&1&&(Js(aae,5),Js(cae,5)),t&2){let r;Qs(r=eo())&&(i.genreCanvas=r.first),Qs(r=eo())&&(i.dimCanvas=r.first)}},decls:60,vars:10,consts:[["genreChart",""],["dimChart",""],["SelectFilter",""],[1,"insights-container"],[1,"page-header"],["class","user-badge",4,"ngIf"],[1,"charts-grid"],[1,"chart-card"],[1,"card-info"],[1,"canvas-wrapper"],["class","no-data-overlay",4,"ngIf"],[1,"dashboard-section"],[1,"section-header"],[1,"view-all-btn",3,"click"],[1,"activity-list"],["class","activity-item",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"dashboard-section","reviews-section"],[1,"header-actions"],[1,"count-pill"],["ngModel","",1,"styled-select",3,"change"],["value","newest"],["value","upvotes"],["value","game"],[1,"reviews-list"],["class","review-item",4,"ngFor","ngForOf"],["class","expand-container",4,"ngIf"],[1,"user-badge"],[1,"fas","fa-shield-halved"],[1,"no-data-overlay"],[1,"activity-item"],[1,"game-info"],[1,"game-icon"],["alt","thumb",1,"rounded-icon",3,"src"],[1,"game-details"],[1,"game-meta"],["class","tag-badge",4,"ngFor","ngForOf"],[1,"game-rating"],[1,"stars"],["class","fas fa-star",3,"color",4,"ngFor","ngForOf"],[1,"rating-value"],[1,"tag-badge"],[1,"fas","fa-star"],[1,"empty-state"],[1,"fas","fa-heart-broken"],[1,"review-item"],["alt","Game thumb",1,"mini-thumb",3,"click","src"],[1,"review-body"],[1,"review-meta"],[1,"game-link",3,"click"],["class","fas fa-star",3,"active",4,"ngFor","ngForOf"],[1,"upvote-badge"],[1,"fas","fa-arrow-up"],[1,"review-text"],[1,"review-footer"],[1,"review-date"],[1,"text-btn",3,"click"],[1,"fas","fa-chevron-right"],[1,"expand-container"],[1,"expand-btn",3,"click"],[1,"fas"],[1,"fas","fa-comment-slash"]],template:function(t,i){if(t&1){let r=rn();F(0,"div",3)(1,"header",4)(2,"div")(3,"h1"),j(4,"User Insights"),B(),F(5,"p"),j(6,"Analyzing your taste based on "),F(7,"strong"),j(8),B(),j(9," favorites"),B()(),lt(10,lae,4,1,"div",5),B(),F(11,"div",6)(12,"div",7)(13,"div",8)(14,"h3"),j(15,"Genre Affinity"),B(),F(16,"p"),j(17,"Your most liked categories"),B()(),F(18,"div",9),Ce(19,"canvas",null,0),lt(21,uae,3,0,"div",10),B()(),F(22,"div",7)(23,"div",8)(24,"h3"),j(25,"Visual Preference"),B(),F(26,"p"),j(27,"Dimension distribution"),B()(),F(28,"div",9),Ce(29,"canvas",null,1),lt(31,dae,3,0,"div",10),B()()(),F(32,"div",11)(33,"div",12)(34,"h3"),j(35,"Favorite Experiences"),B(),F(36,"button",13),Pe("click",function(){return Ze(r),Je(i.goToBrowse())}),j(37,"View All Games"),B()(),F(38,"div",14),lt(39,pae,14,6,"div",15)(40,mae,4,0,"div",16),B()(),F(41,"section",17)(42,"div",12)(43,"h3"),j(44,"Your Recent Reviews"),B(),F(45,"div",18)(46,"span",19),j(47),B(),F(48,"select",20,2),Pe("change",function(){Ze(r);let o=qi(49);return Je(i.setSort(o.value))}),F(50,"option",21),j(51,"Newest First"),B(),F(52,"option",22),j(53,"Highest Upvotes"),B(),F(54,"option",23),j(55,"Game Title"),B()()()(),F(56,"div",24),lt(57,_ae,22,12,"div",25)(58,yae,4,5,"div",26)(59,vae,4,0,"div",16),B()()()}t&2&&($(8),ft(i.likedGamesCount),$(2),ye("ngIf",i.firebaseService.connectedUser),$(11),ye("ngIf",i.likedGames.length===0),$(10),ye("ngIf",i.likedGames.length===0),$(8),ye("ngForOf",i.likedGames),$(),ye("ngIf",i.likedGames.length===0),$(7),vn("",i.filteredReviews.length," Total "),$(10),ye("ngForOf",i.filteredReviews.slice(0,i.reviewLimit)),$(),ye("ngIf",i.filteredReviews.length>5),$(),ye("ngIf",i.filteredReviews.length===0))},dependencies:[wi,cc,dr,Ap],styles:[".insights-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto;color:#fff}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.2rem;margin:0;background:linear-gradient(90deg,#fff,#00ffa3);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;margin-top:.5rem}.user-badge[_ngcontent-%COMP%]{background:#ffffff0d;padding:.6rem 1.2rem;border-radius:50px;border:1px solid rgba(255,255,255,.1);display:flex;align-items:center;gap:.8rem}.user-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#00ffa3}.charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1.5fr 1fr;gap:1.5rem;margin-bottom:3rem}.chart-card[_ngcontent-%COMP%]{background:#ffffff08;border-radius:24px;padding:1.5rem;border:1px solid rgba(255,255,255,.05)}.canvas-wrapper[_ngcontent-%COMP%]{height:250px;position:relative}.dashboard-section[_ngcontent-%COMP%]{background:#ffffff05;border-radius:24px;padding:1.5rem;margin-bottom:2rem;border:1px solid rgba(255,255,255,.05)}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.view-all-btn[_ngcontent-%COMP%]{background:none;border:1px solid #333;color:#888;padding:.4rem 1rem;border-radius:8px;cursor:pointer}.activity-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.activity-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#ffffff08;border-radius:16px;cursor:pointer;transition:.2s}.activity-item[_ngcontent-%COMP%]:hover{background:#ffffff0f}.game-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.rounded-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;object-fit:cover}.game-meta[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.3rem}.tag-badge[_ngcontent-%COMP%]{font-size:.7rem;background:#ffffff0d;padding:.1rem .4rem;border-radius:4px;color:#666}.rating-value[_ngcontent-%COMP%]{font-weight:700;color:#00ffa3}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#555}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.reviews-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.2rem}.review-item[_ngcontent-%COMP%]{display:flex;gap:1.5rem;padding:1.2rem;background:#ffffff08;border-radius:16px;transition:all .3s cubic-bezier(.4,0,.2,1);border:1px solid transparent}.review-item[_ngcontent-%COMP%]:hover{background:#ffffff0f;transform:translateY(-3px);border-color:#00ffa333}.mini-thumb[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:14px;object-fit:cover;cursor:pointer}.review-body[_ngcontent-%COMP%]{flex:1}.review-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.8rem}.game-link[_ngcontent-%COMP%]{font-size:1.1rem;color:#fff;cursor:pointer;transition:color .2s}.game-link[_ngcontent-%COMP%]:hover{color:#00ffa3}.stars[_ngcontent-%COMP%]{margin-top:.3rem}.stars[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.8rem;color:#222;margin-right:2px}.stars[_ngcontent-%COMP%]   i.active[_ngcontent-%COMP%]{color:#f59e0b}.upvote-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#ffffff0d;padding:.3rem .8rem;border-radius:10px;font-size:.9rem;color:#555}.upvote-badge.has-upvotes[_ngcontent-%COMP%]{color:#00ffa3;background:#00ffa31a}.review-text[_ngcontent-%COMP%]{color:#aaa;line-height:1.6;font-size:.95rem;margin:.5rem 0}.review-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:.8rem;border-top:1px solid rgba(255,255,255,.05)}.review-date[_ngcontent-%COMP%]{color:#555;font-size:.8rem}.text-btn[_ngcontent-%COMP%]{background:none;border:none;color:#00ffa3;cursor:pointer;font-size:.85rem;display:flex;align-items:center;gap:.5rem;opacity:.7;transition:opacity .2s}.text-btn[_ngcontent-%COMP%]:hover{opacity:1}.count-pill[_ngcontent-%COMP%]{margin:0 20px}.expand-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-top:1rem}.expand-btn[_ngcontent-%COMP%]{background:#ffffff08;border:1px solid #222;color:#666;padding:.6rem 1.5rem;border-radius:12px;cursor:pointer;font-size:.9rem;display:flex;align-items:center;gap:.8rem;transition:.2s}.expand-btn[_ngcontent-%COMP%]:hover{color:#fff;background:#ffffff0f}@media (max-width: 768px){.charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};var g5=0,oP=1,_5=2;var aP=1,y5=2,Io=3,Aa=0,_r=1,Co=2,Pa=0,ku=1,cP=2,lP=3,uP=4,v5=5,tl=100,b5=101,E5=102,w5=103,x5=104,S5=200,T5=201,I5=202,C5=203,QE=204,ew=205,M5=206,A5=207,D5=208,R5=209,P5=210,N5=211,O5=212,k5=213,L5=214,xw=0,Sw=1,Tw=2,Lu=3,Iw=4,Cw=5,Mw=6,Aw=7,dP=0,F5=1,V5=2,Na=0,U5=1,B5=2,z5=3,H5=4,j5=5,G5=6,W5=7;var KR=300,zu=301,Hu=302,Dw=303,Rw=304,Gg=306,tw=1e3,el=1001,nw=1002,ls=1003,$5=1004;var Wg=1005;var ks=1006,Pw=1007;var cl=1008;var Fs=1009,hP=1010,fP=1011,wf=1012,Nw=1013,ll=1014,Mo=1015,xf=1016,Ow=1017,kw=1018,Sf=1020,pP=35902,mP=35899,gP=1021,_P=1022,ds=1023,gf=1026,Tf=1027,yP=1028,Lw=1029,vP=1030,Fw=1031;var Vw=1033,$g=33776,qg=33777,Xg=33778,Yg=33779,Uw=35840,Bw=35841,zw=35842,Hw=35843,jw=36196,Gw=37492,Ww=37496,$w=37808,qw=37809,Xw=37810,Yw=37811,Kw=37812,Zw=37813,Jw=37814,Qw=37815,ex=37816,tx=37817,nx=37818,ix=37819,rx=37820,sx=37821,ox=36492,ax=36494,cx=36495,lx=36283,ux=36284,dx=36285,hx=36286;var Sg=2300,iw=2301,JE=2302,ZR=2400,JR=2401,QR=2402;var q5=3200,X5=3201;var Y5=0,K5=1,Oa="",Hr="srgb",Fu="srgb-linear",Tg="linear",fn="srgb";var Nu=7680;var eP=519,Z5=512,J5=513,Q5=514,bP=515,ej=516,tj=517,nj=518,ij=519,tP=35044;var EP="300 es",Os=2e3,Ig=2001;var Da=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){let i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){let i=this._listeners;if(i===void 0)return;let r=i[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){let t=this._listeners;if(t===void 0)return;let i=t[e.type];if(i!==void 0){e.target=this;let r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},Qi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];var TR=Math.PI/180,rw=180/Math.PI;function Kg(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Qi[n&255]+Qi[n>>8&255]+Qi[n>>16&255]+Qi[n>>24&255]+"-"+Qi[e&255]+Qi[e>>8&255]+"-"+Qi[e>>16&15|64]+Qi[e>>24&255]+"-"+Qi[t&63|128]+Qi[t>>8&255]+"-"+Qi[t>>16&255]+Qi[t>>24&255]+Qi[i&255]+Qi[i>>8&255]+Qi[i>>16&255]+Qi[i>>24&255]).toLowerCase()}function Ht(n,e,t){return Math.max(e,Math.min(t,n))}function bae(n,e){return(n%e+e)%e}function IR(n,e,t){return(1-t)*n+t*e}function yg(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ir(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var Zt=class n{constructor(e=0,t=0){n.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Ht(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ra=class{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],d=i[r+3],h=s[o+0],p=s[o+1],g=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d;return}if(a===1){e[t+0]=h,e[t+1]=p,e[t+2]=g,e[t+3]=y;return}if(d!==y||c!==h||l!==p||u!==g){let m=1-a,_=c*h+l*p+u*g+d*y,I=_>=0?1:-1,M=1-_*_;if(M>Number.EPSILON){let P=Math.sqrt(M),N=Math.atan2(P,_*I);m=Math.sin(m*N)/P,a=Math.sin(a*N)/P}let C=a*I;if(c=c*m+h*C,l=l*m+p*C,u=u*m+g*C,d=d*m+y*C,m===1-a){let P=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=P,l*=P,u*=P,d*=P}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){let a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],d=s[o],h=s[o+1],p=s[o+2],g=s[o+3];return e[t]=a*g+u*d+c*p-l*h,e[t+1]=c*g+u*h+l*d-a*p,e[t+2]=l*g+u*p+a*h-c*d,e[t+3]=u*g-a*d-c*h-l*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),d=a(s/2),h=c(i/2),p=c(r/2),g=c(s/2);switch(o){case"XYZ":this._x=h*u*d+l*p*g,this._y=l*p*d-h*u*g,this._z=l*u*g+h*p*d,this._w=l*u*d-h*p*g;break;case"YXZ":this._x=h*u*d+l*p*g,this._y=l*p*d-h*u*g,this._z=l*u*g-h*p*d,this._w=l*u*d+h*p*g;break;case"ZXY":this._x=h*u*d-l*p*g,this._y=l*p*d+h*u*g,this._z=l*u*g+h*p*d,this._w=l*u*d-h*p*g;break;case"ZYX":this._x=h*u*d-l*p*g,this._y=l*p*d+h*u*g,this._z=l*u*g-h*p*d,this._w=l*u*d+h*p*g;break;case"YZX":this._x=h*u*d+l*p*g,this._y=l*p*d+h*u*g,this._z=l*u*g-h*p*d,this._w=l*u*d-h*p*g;break;case"XZY":this._x=h*u*d-l*p*g,this._y=l*p*d-h*u*g,this._z=l*u*g+h*p*d,this._w=l*u*d+h*p*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){let p=.5/Math.sqrt(h+1);this._w=.25/p,this._x=(u-c)*p,this._y=(s-l)*p,this._z=(o-r)*p}else if(i>a&&i>d){let p=2*Math.sqrt(1+i-a-d);this._w=(u-c)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(s+l)/p}else if(a>d){let p=2*Math.sqrt(1+a-i-d);this._w=(s-l)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(c+u)/p}else{let p=2*Math.sqrt(1+d-i-a);this._w=(o-r)/p,this._x=(s+l)/p,this._y=(c+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ht(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;let c=1-a*a;if(c<=Number.EPSILON){let p=1-t;return this._w=p*o+t*this._w,this._x=p*i+t*this._x,this._y=p*r+t*this._y,this._z=p*s+t*this._z,this.normalize(),this}let l=Math.sqrt(c),u=Math.atan2(l,a),d=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},q=class n{constructor(e=0,t=0,i=0){n.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(X4.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(X4.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=2*(o*r-a*i),u=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+c*l+o*d-a*u,this.y=i+c*u+a*l-s*d,this.z=r+c*d+s*u-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this.z=Ht(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this.z=Ht(this.z,e,t),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return CR.copy(this).projectOnVector(e),this.sub(CR)}reflect(e){return this.sub(CR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(Ht(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},CR=new q,X4=new Ra,Mt=class n{constructor(e,t,i,r,s,o,a,c,l){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,l)}set(e,t,i,r,s,o,a,c,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],d=i[7],h=i[2],p=i[5],g=i[8],y=r[0],m=r[3],_=r[6],I=r[1],M=r[4],C=r[7],P=r[2],N=r[5],S=r[8];return s[0]=o*y+a*I+c*P,s[3]=o*m+a*M+c*N,s[6]=o*_+a*C+c*S,s[1]=l*y+u*I+d*P,s[4]=l*m+u*M+d*N,s[7]=l*_+u*C+d*S,s[2]=h*y+p*I+g*P,s[5]=h*m+p*M+g*N,s[8]=h*_+p*C+g*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*o-a*l,h=a*c-u*s,p=l*s-o*c,g=t*d+i*h+r*p;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let y=1/g;return e[0]=d*y,e[1]=(r*l-u*i)*y,e[2]=(a*i-r*o)*y,e[3]=h*y,e[4]=(u*t-r*c)*y,e[5]=(r*s-a*t)*y,e[6]=p*y,e[7]=(i*c-l*t)*y,e[8]=(o*t-i*s)*y,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){let c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(MR.makeScale(e,t)),this}rotate(e){return this.premultiply(MR.makeRotation(-e)),this}translate(e,t){return this.premultiply(MR.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},MR=new Mt;function wP(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Cg(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function rj(){let n=Cg("canvas");return n.style.display="block",n}var Y4={};function _f(n){n in Y4||(Y4[n]=!0,console.warn(n))}function sj(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}var K4=new Mt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Z4=new Mt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Eae(){let n={enabled:!0,workingColorSpace:Fu,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===fn&&(r.r=Ma(r.r),r.g=Ma(r.g),r.b=Ma(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===fn&&(r.r=mf(r.r),r.g=mf(r.g),r.b=mf(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Oa?Tg:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return _f("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return _f("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Fu]:{primaries:e,whitePoint:i,transfer:Tg,toXYZ:K4,fromXYZ:Z4,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Hr},outputColorSpaceConfig:{drawingBufferColorSpace:Hr}},[Hr]:{primaries:e,whitePoint:i,transfer:fn,toXYZ:K4,fromXYZ:Z4,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Hr}}}),n}var Kt=Eae();function Ma(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function mf(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}var nf,sw=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{nf===void 0&&(nf=Cg("canvas")),nf.width=e.width,nf.height=e.height;let r=nf.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=nf}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Cg("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Ma(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Ma(t[i]/255)*255):t[i]=Ma(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},wae=0,yf=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:wae++}),this.uuid=Kg(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){let t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(AR(r[o].image)):s.push(AR(r[o]))}else s=AR(r);i.url=s}return t||(e.images[this.uuid]=i),i}};function AR(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?sw.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var xae=0,DR=new q,ul=(()=>{class n extends Da{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=el,s=el,o=ks,a=cl,c=ds,l=Fs,u=n.DEFAULT_ANISOTROPY,d=Oa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:xae++}),this.uuid=Kg(),this.name="",this.source=new yf(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new Zt(0,0),this.repeat=new Zt(1,1),this.center=new Zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(DR).x}get height(){return this.source.getSize(DR).y}get depth(){return this.source.getSize(DR).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,i){this.updateRanges.push({start:t,count:i})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(let i in t){let r=t[i];if(r===void 0){console.warn(`THREE.Texture.setValues(): parameter '${i}' has value of undefined.`);continue}let s=this[i];if(s===void 0){console.warn(`THREE.Texture.setValues(): property '${i}' does not exist.`);continue}s&&r&&s.isVector2&&r.isVector2||s&&r&&s.isVector3&&r.isVector3||s&&r&&s.isMatrix3&&r.isMatrix3?s.copy(r):this[i]=r}}toJSON(t){let i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==KR)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case tw:t.x=t.x-Math.floor(t.x);break;case el:t.x=t.x<0?0:1;break;case nw:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case tw:t.y=t.y-Math.floor(t.y);break;case el:t.y=t.y<0?0:1;break;case nw:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=KR,n.DEFAULT_ANISOTROPY=1,n})(),hn=class n{constructor(e=0,t=0,i=0,r=1){n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s,c=e.elements,l=c[0],u=c[4],d=c[8],h=c[1],p=c[5],g=c[9],y=c[2],m=c[6],_=c[10];if(Math.abs(u-h)<.01&&Math.abs(d-y)<.01&&Math.abs(g-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+y)<.1&&Math.abs(g+m)<.1&&Math.abs(l+p+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let M=(l+1)/2,C=(p+1)/2,P=(_+1)/2,N=(u+h)/4,S=(d+y)/4,w=(g+m)/4;return M>C&&M>P?M<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(M),r=N/i,s=S/i):C>P?C<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(C),i=N/r,s=w/r):P<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(P),i=S/s,r=w/s),this.set(i,r,s,t),this}let I=Math.sqrt((m-g)*(m-g)+(d-y)*(d-y)+(h-u)*(h-u));return Math.abs(I)<.001&&(I=1),this.x=(m-g)/I,this.y=(d-y)/I,this.z=(h-u)/I,this.w=Math.acos((l+p+_-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ht(this.x,e.x,t.x),this.y=Ht(this.y,e.y,t.y),this.z=Ht(this.z,e.z,t.z),this.w=Ht(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ht(this.x,e,t),this.y=Ht(this.y,e,t),this.z=Ht(this.z,e,t),this.w=Ht(this.w,e,t),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Ht(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},ow=class extends Da{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ks,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new hn(0,0,e,t),this.scissorTest=!1,this.viewport=new hn(0,0,e,t);let r={width:e,height:t,depth:i.depth},s=new ul(r);this.textures=[];let o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){let t={minFilter:ks,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;let r=Object.assign({},e.textures[t].image);this.textures[t].source=new yf(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},To=class extends ow{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},Mg=class extends ul{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ls,this.minFilter=ls,this.wrapR=el,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};var aw=class extends ul{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ls,this.minFilter=ls,this.wrapR=el,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var nl=class{constructor(e=new q(1/0,1/0,1/0),t=new q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Rs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Rs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Rs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Rs):Rs.fromBufferAttribute(s,o),Rs.applyMatrix4(e.matrixWorld),this.expandByPoint(Rs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),PE.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),PE.copy(i.boundingBox)),PE.applyMatrix4(e.matrixWorld),this.union(PE)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Rs),Rs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(vg),NE.subVectors(this.max,vg),rf.subVectors(e.a,vg),sf.subVectors(e.b,vg),of.subVectors(e.c,vg),qc.subVectors(sf,rf),Xc.subVectors(of,sf),Au.subVectors(rf,of);let t=[0,-qc.z,qc.y,0,-Xc.z,Xc.y,0,-Au.z,Au.y,qc.z,0,-qc.x,Xc.z,0,-Xc.x,Au.z,0,-Au.x,-qc.y,qc.x,0,-Xc.y,Xc.x,0,-Au.y,Au.x,0];return!RR(t,rf,sf,of,NE)||(t=[1,0,0,0,1,0,0,0,1],!RR(t,rf,sf,of,NE))?!1:(OE.crossVectors(qc,Xc),t=[OE.x,OE.y,OE.z],RR(t,rf,sf,of,NE))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Rs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Rs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xa),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}},xa=[new q,new q,new q,new q,new q,new q,new q,new q],Rs=new q,PE=new nl,rf=new q,sf=new q,of=new q,qc=new q,Xc=new q,Au=new q,vg=new q,NE=new q,OE=new q,Du=new q;function RR(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Du.fromArray(n,s);let a=r.x*Math.abs(Du.x)+r.y*Math.abs(Du.y)+r.z*Math.abs(Du.z),c=e.dot(Du),l=t.dot(Du),u=i.dot(Du);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}var Sae=new nl,bg=new q,PR=new q,Vu=class{constructor(e=new q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):Sae.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;bg.subVectors(e,this.center);let t=bg.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(bg,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(PR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(bg.copy(e.center).add(PR)),this.expandByPoint(bg.copy(e.center).sub(PR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}},Sa=new q,NR=new q,kE=new q,Yc=new q,OR=new q,LE=new q,kR=new q,Ag=class{constructor(e=new q,t=new q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Sa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Sa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Sa.copy(this.origin).addScaledVector(this.direction,t),Sa.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){NR.copy(e).add(t).multiplyScalar(.5),kE.copy(t).sub(e).normalize(),Yc.copy(this.origin).sub(NR);let s=e.distanceTo(t)*.5,o=-this.direction.dot(kE),a=Yc.dot(this.direction),c=-Yc.dot(kE),l=Yc.lengthSq(),u=Math.abs(1-o*o),d,h,p,g;if(u>0)if(d=o*c-a,h=o*a-c,g=s*u,d>=0)if(h>=-g)if(h<=g){let y=1/u;d*=y,h*=y,p=d*(d+o*h+2*a)+h*(o*d+h+2*c)+l}else h=s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+l;else h=-s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+l;else h<=-g?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-c),s),p=-d*d+h*(h+2*c)+l):h<=g?(d=0,h=Math.min(Math.max(-s,-c),s),p=h*(h+2*c)+l):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-c),s),p=-d*d+h*(h+2*c)+l);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(NR).addScaledVector(kE,h),p}intersectSphere(e,t){Sa.subVectors(e.center,this.origin);let i=Sa.dot(this.direction),r=Sa.dot(Sa)-i*i,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c,l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,c=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,c=(e.min.z-h.z)*d),i>c||a>r)||((a>i||i!==i)&&(i=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Sa)!==null}intersectTriangle(e,t,i,r,s){OR.subVectors(t,e),LE.subVectors(i,e),kR.crossVectors(OR,LE);let o=this.direction.dot(kR),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Yc.subVectors(this.origin,e);let c=a*this.direction.dot(LE.crossVectors(Yc,LE));if(c<0)return null;let l=a*this.direction.dot(OR.cross(Yc));if(l<0||c+l>o)return null;let u=-a*Yc.dot(kR);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Vn=class n{constructor(e,t,i,r,s,o,a,c,l,u,d,h,p,g,y,m){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,l,u,d,h,p,g,y,m)}set(e,t,i,r,s,o,a,c,l,u,d,h,p,g,y,m){let _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=c,_[2]=l,_[6]=u,_[10]=d,_[14]=h,_[3]=p,_[7]=g,_[11]=y,_[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,r=1/af.setFromMatrixColumn(e,0).length(),s=1/af.setFromMatrixColumn(e,1).length(),o=1/af.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){let h=o*u,p=o*d,g=a*u,y=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=p+g*l,t[5]=h-y*l,t[9]=-a*c,t[2]=y-h*l,t[6]=g+p*l,t[10]=o*c}else if(e.order==="YXZ"){let h=c*u,p=c*d,g=l*u,y=l*d;t[0]=h+y*a,t[4]=g*a-p,t[8]=o*l,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=p*a-g,t[6]=y+h*a,t[10]=o*c}else if(e.order==="ZXY"){let h=c*u,p=c*d,g=l*u,y=l*d;t[0]=h-y*a,t[4]=-o*d,t[8]=g+p*a,t[1]=p+g*a,t[5]=o*u,t[9]=y-h*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){let h=o*u,p=o*d,g=a*u,y=a*d;t[0]=c*u,t[4]=g*l-p,t[8]=h*l+y,t[1]=c*d,t[5]=y*l+h,t[9]=p*l-g,t[2]=-l,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){let h=o*c,p=o*l,g=a*c,y=a*l;t[0]=c*u,t[4]=y-h*d,t[8]=g*d+p,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=p*d+g,t[10]=h-y*d}else if(e.order==="XZY"){let h=o*c,p=o*l,g=a*c,y=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=h*d+y,t[5]=o*u,t[9]=p*d-g,t[2]=g*d-p,t[6]=a*u,t[10]=y*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Tae,e,Iae)}lookAt(e,t,i){let r=this.elements;return Br.subVectors(e,t),Br.lengthSq()===0&&(Br.z=1),Br.normalize(),Kc.crossVectors(i,Br),Kc.lengthSq()===0&&(Math.abs(i.z)===1?Br.x+=1e-4:Br.z+=1e-4,Br.normalize(),Kc.crossVectors(i,Br)),Kc.normalize(),FE.crossVectors(Br,Kc),r[0]=Kc.x,r[4]=FE.x,r[8]=Br.x,r[1]=Kc.y,r[5]=FE.y,r[9]=Br.y,r[2]=Kc.z,r[6]=FE.z,r[10]=Br.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],d=i[5],h=i[9],p=i[13],g=i[2],y=i[6],m=i[10],_=i[14],I=i[3],M=i[7],C=i[11],P=i[15],N=r[0],S=r[4],w=r[8],b=r[12],E=r[1],T=r[5],R=r[9],A=r[13],ne=r[2],Y=r[6],J=r[10],re=r[14],K=r[3],fe=r[7],Se=r[11],Ge=r[15];return s[0]=o*N+a*E+c*ne+l*K,s[4]=o*S+a*T+c*Y+l*fe,s[8]=o*w+a*R+c*J+l*Se,s[12]=o*b+a*A+c*re+l*Ge,s[1]=u*N+d*E+h*ne+p*K,s[5]=u*S+d*T+h*Y+p*fe,s[9]=u*w+d*R+h*J+p*Se,s[13]=u*b+d*A+h*re+p*Ge,s[2]=g*N+y*E+m*ne+_*K,s[6]=g*S+y*T+m*Y+_*fe,s[10]=g*w+y*R+m*J+_*Se,s[14]=g*b+y*A+m*re+_*Ge,s[3]=I*N+M*E+C*ne+P*K,s[7]=I*S+M*T+C*Y+P*fe,s[11]=I*w+M*R+C*J+P*Se,s[15]=I*b+M*A+C*re+P*Ge,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],h=e[10],p=e[14],g=e[3],y=e[7],m=e[11],_=e[15];return g*(+s*c*d-r*l*d-s*a*h+i*l*h+r*a*p-i*c*p)+y*(+t*c*p-t*l*h+s*o*h-r*o*p+r*l*u-s*c*u)+m*(+t*l*d-t*a*p-s*o*d+i*o*p+s*a*u-i*l*u)+_*(-r*a*u-t*c*d+t*a*h+r*o*d-i*o*h+i*c*u)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],p=e[11],g=e[12],y=e[13],m=e[14],_=e[15],I=d*m*l-y*h*l+y*c*p-a*m*p-d*c*_+a*h*_,M=g*h*l-u*m*l-g*c*p+o*m*p+u*c*_-o*h*_,C=u*y*l-g*d*l+g*a*p-o*y*p-u*a*_+o*d*_,P=g*d*c-u*y*c-g*a*h+o*y*h+u*a*m-o*d*m,N=t*I+i*M+r*C+s*P;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/N;return e[0]=I*S,e[1]=(y*h*s-d*m*s-y*r*p+i*m*p+d*r*_-i*h*_)*S,e[2]=(a*m*s-y*c*s+y*r*l-i*m*l-a*r*_+i*c*_)*S,e[3]=(d*c*s-a*h*s-d*r*l+i*h*l+a*r*p-i*c*p)*S,e[4]=M*S,e[5]=(u*m*s-g*h*s+g*r*p-t*m*p-u*r*_+t*h*_)*S,e[6]=(g*c*s-o*m*s-g*r*l+t*m*l+o*r*_-t*c*_)*S,e[7]=(o*h*s-u*c*s+u*r*l-t*h*l-o*r*p+t*c*p)*S,e[8]=C*S,e[9]=(g*d*s-u*y*s-g*i*p+t*y*p+u*i*_-t*d*_)*S,e[10]=(o*y*s-g*a*s+g*i*l-t*y*l-o*i*_+t*a*_)*S,e[11]=(u*a*s-o*d*s-u*i*l+t*d*l+o*i*p-t*a*p)*S,e[12]=P*S,e[13]=(u*y*r-g*d*r+g*i*h-t*y*h-u*i*m+t*d*m)*S,e[14]=(g*a*r-o*y*r-g*i*c+t*y*c+o*i*m-t*a*m)*S,e[15]=(o*d*r-u*a*r+u*i*c-t*d*c-o*i*h+t*a*h)*S,this}scale(e){let t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){let r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,d=a+a,h=s*l,p=s*u,g=s*d,y=o*u,m=o*d,_=a*d,I=c*l,M=c*u,C=c*d,P=i.x,N=i.y,S=i.z;return r[0]=(1-(y+_))*P,r[1]=(p+C)*P,r[2]=(g-M)*P,r[3]=0,r[4]=(p-C)*N,r[5]=(1-(h+_))*N,r[6]=(m+I)*N,r[7]=0,r[8]=(g+M)*S,r[9]=(m-I)*S,r[10]=(1-(h+y))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){let r=this.elements,s=af.set(r[0],r[1],r[2]).length(),o=af.set(r[4],r[5],r[6]).length(),a=af.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ps.copy(this);let l=1/s,u=1/o,d=1/a;return Ps.elements[0]*=l,Ps.elements[1]*=l,Ps.elements[2]*=l,Ps.elements[4]*=u,Ps.elements[5]*=u,Ps.elements[6]*=u,Ps.elements[8]*=d,Ps.elements[9]*=d,Ps.elements[10]*=d,t.setFromRotationMatrix(Ps),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Os,c=!1){let l=this.elements,u=2*s/(t-e),d=2*s/(i-r),h=(t+e)/(t-e),p=(i+r)/(i-r),g,y;if(c)g=s/(o-s),y=o*s/(o-s);else if(a===Os)g=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===Ig)g=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Os,c=!1){let l=this.elements,u=2/(t-e),d=2/(i-r),h=-(t+e)/(t-e),p=-(i+r)/(i-r),g,y;if(c)g=1/(o-s),y=o/(o-s);else if(a===Os)g=-2/(o-s),y=-(o+s)/(o-s);else if(a===Ig)g=-1/(o-s),y=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=d,l[9]=0,l[13]=p,l[2]=0,l[6]=0,l[10]=g,l[14]=y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},af=new q,Ps=new Vn,Tae=new q(0,0,0),Iae=new q(1,1,1),Kc=new q,FE=new q,Br=new q,J4=new Vn,Q4=new Ra,Uu=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){let s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],d=s[9],h=s[2],p=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(Ht(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Ht(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,g),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Ht(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,g),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Ht(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Ht(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(c,g));break;case"XZY":this._z=Math.asin(-Ht(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-d,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return J4.makeRotationFromQuaternion(t),this.setFromRotationMatrix(J4,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Q4.setFromEuler(this),this.setFromQuaternion(Q4,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})(),Dg=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Cae=0,e5=new q,cf=new Ra,Ta=new Vn,VE=new q,Eg=new q,Mae=new q,Aae=new Ra,t5=new q(1,0,0),n5=new q(0,1,0),i5=new q(0,0,1),r5={type:"added"},Dae={type:"removed"},lf={type:"childadded",child:null},LR={type:"childremoved",child:null},ka=(()=>{class n extends Da{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Cae++}),this.uuid=Kg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let t=new q,i=new Uu,r=new Ra,s=new q(1,1,1);function o(){r.setFromEuler(i,!1)}function a(){i.setFromQuaternion(r,void 0,!1)}i._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Vn},normalMatrix:{value:new Mt}}),this.matrix=new Vn,this.matrixWorld=new Vn,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Dg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return cf.setFromAxisAngle(t,i),this.quaternion.multiply(cf),this}rotateOnWorldAxis(t,i){return cf.setFromAxisAngle(t,i),this.quaternion.premultiply(cf),this}rotateX(t){return this.rotateOnAxis(t5,t)}rotateY(t){return this.rotateOnAxis(n5,t)}rotateZ(t){return this.rotateOnAxis(i5,t)}translateOnAxis(t,i){return e5.copy(t).applyQuaternion(this.quaternion),this.position.add(e5.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(t5,t)}translateY(t){return this.translateOnAxis(n5,t)}translateZ(t){return this.translateOnAxis(i5,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ta.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?VE.copy(t):VE.set(t,i,r);let s=this.parent;this.updateWorldMatrix(!0,!1),Eg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ta.lookAt(Eg,VE,this.up):Ta.lookAt(VE,Eg,this.up),this.quaternion.setFromRotationMatrix(Ta),s&&(Ta.extractRotation(s.matrixWorld),cf.setFromRotationMatrix(Ta),this.quaternion.premultiply(cf.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(r5),lf.child=t,this.dispatchEvent(lf),lf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Dae),LR.child=t,this.dispatchEvent(LR),LR.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Ta.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Ta.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ta),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(r5),lf.child=t,this.dispatchEvent(lf),lf.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(t,i);if(a!==void 0)return a}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Eg,t,Mae),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Eg,Aae,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){let i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){let r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){let i=t===void 0||typeof t=="string",r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(c=>je(ae({},c),{boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(c=>ae({},c)),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(t),s.indirectTexture=this._indirectTexture.toJSON(t),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function o(c,l){return c[l.uuid]===void 0&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){let h=l[u];o(t.shapes,h)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){let l=this.animations[c];s.animations.push(o(t.animations,l))}}if(i){let c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),p=a(t.skeletons),g=a(t.animations),y=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),p.length>0&&(r.skeletons=p),g.length>0&&(r.animations=g),y.length>0&&(r.nodes=y)}return r.object=s,r;function a(c){let l=[];for(let u in c){let d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let r=0;r<t.children.length;r++){let s=t.children[r];this.add(s.clone())}return this}}return n.DEFAULT_UP=new q(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})(),Ns=new q,Ia=new q,FR=new q,Ca=new q,uf=new q,df=new q,s5=new q,VR=new q,UR=new q,BR=new q,zR=new hn,HR=new hn,jR=new hn,Qc=class n{constructor(e=new q,t=new q,i=new q){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Ns.subVectors(e,t),r.cross(Ns);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Ns.subVectors(r,t),Ia.subVectors(i,t),FR.subVectors(e,t);let o=Ns.dot(Ns),a=Ns.dot(Ia),c=Ns.dot(FR),l=Ia.dot(Ia),u=Ia.dot(FR),d=o*l-a*a;if(d===0)return s.set(0,0,0),null;let h=1/d,p=(l*c-a*u)*h,g=(o*u-a*c)*h;return s.set(1-p-g,g,p)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ca)===null?!1:Ca.x>=0&&Ca.y>=0&&Ca.x+Ca.y<=1}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,Ca)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Ca.x),c.addScaledVector(o,Ca.y),c.addScaledVector(a,Ca.z),c)}static getInterpolatedAttribute(e,t,i,r,s,o){return zR.setScalar(0),HR.setScalar(0),jR.setScalar(0),zR.fromBufferAttribute(e,t),HR.fromBufferAttribute(e,i),jR.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(zR,s.x),o.addScaledVector(HR,s.y),o.addScaledVector(jR,s.z),o}static isFrontFacing(e,t,i,r){return Ns.subVectors(i,t),Ia.subVectors(e,t),Ns.cross(Ia).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ns.subVectors(this.c,this.b),Ia.subVectors(this.a,this.b),Ns.cross(Ia).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return n.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return n.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,r=this.b,s=this.c,o,a;uf.subVectors(r,i),df.subVectors(s,i),VR.subVectors(e,i);let c=uf.dot(VR),l=df.dot(VR);if(c<=0&&l<=0)return t.copy(i);UR.subVectors(e,r);let u=uf.dot(UR),d=df.dot(UR);if(u>=0&&d<=u)return t.copy(r);let h=c*d-u*l;if(h<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(uf,o);BR.subVectors(e,s);let p=uf.dot(BR),g=df.dot(BR);if(g>=0&&p<=g)return t.copy(s);let y=p*l-c*g;if(y<=0&&l>=0&&g<=0)return a=l/(l-g),t.copy(i).addScaledVector(df,a);let m=u*g-p*d;if(m<=0&&d-u>=0&&p-g>=0)return s5.subVectors(s,r),a=(d-u)/(d-u+(p-g)),t.copy(r).addScaledVector(s5,a);let _=1/(m+y+h);return o=y*_,a=h*_,t.copy(i).addScaledVector(uf,o).addScaledVector(df,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},oj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zc={h:0,s:0,l:0},UE={h:0,s:0,l:0};function GR(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}var qt=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Hr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Kt.colorSpaceToWorking(this,t),this}setRGB(e,t,i,r=Kt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Kt.colorSpaceToWorking(this,r),this}setHSL(e,t,i,r=Kt.workingColorSpace){if(e=bae(e,1),t=Ht(t,0,1),i=Ht(i,0,1),t===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=GR(o,s,e+1/3),this.g=GR(o,s,e),this.b=GR(o,s,e-1/3)}return Kt.colorSpaceToWorking(this,r),this}setStyle(e,t=Hr){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Hr){let i=oj[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ma(e.r),this.g=Ma(e.g),this.b=Ma(e.b),this}copyLinearToSRGB(e){return this.r=mf(e.r),this.g=mf(e.g),this.b=mf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hr){return Kt.workingToColorSpace(er.copy(this),e),Math.round(Ht(er.r*255,0,255))*65536+Math.round(Ht(er.g*255,0,255))*256+Math.round(Ht(er.b*255,0,255))}getHexString(e=Hr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Kt.workingColorSpace){Kt.workingToColorSpace(er.copy(this),t);let i=er.r,r=er.g,s=er.b,o=Math.max(i,r,s),a=Math.min(i,r,s),c,l,u=(a+o)/2;if(a===o)c=0,l=0;else{let d=o-a;switch(l=u<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=Kt.workingColorSpace){return Kt.workingToColorSpace(er.copy(this),t),e.r=er.r,e.g=er.g,e.b=er.b,e}getStyle(e=Hr){Kt.workingToColorSpace(er.copy(this),e);let t=er.r,i=er.g,r=er.b;return e!==Hr?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(Zc),this.setHSL(Zc.h+e,Zc.s+t,Zc.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Zc),e.getHSL(UE);let i=IR(Zc.h,UE.h,t),r=IR(Zc.s,UE.s,t),s=IR(Zc.l,UE.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},er=new qt;qt.NAMES=oj;var Rae=0,il=class extends Da{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Rae++}),this.uuid=Kg(),this.name="",this.type="Material",this.blending=ku,this.side=Aa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=QE,this.blendDst=ew,this.blendEquation=tl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new qt(0,0,0),this.blendAlpha=0,this.depthFunc=Lu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=eP,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nu,this.stencilZFail=Nu,this.stencilZPass=Nu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==ku&&(i.blending=this.blending),this.side!==Aa&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==QE&&(i.blendSrc=this.blendSrc),this.blendDst!==ew&&(i.blendDst=this.blendDst),this.blendEquation!==tl&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Lu&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==eP&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Nu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Nu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Nu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){let o=[];for(let a in s){let c=s[a];delete c.metadata,o.push(c)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},rl=class extends il{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Uu,this.combine=dP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var di=new q,BE=new Zt,Pae=0,jr=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Pae++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=tP,this.updateRanges=[],this.gpuType=Mo,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)BE.fromBufferAttribute(this,t),BE.applyMatrix3(e),this.setXY(t,BE.x,BE.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.applyMatrix3(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.applyMatrix4(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.applyNormalMatrix(e),this.setXYZ(t,di.x,di.y,di.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.transformDirection(e),this.setXYZ(t,di.x,di.y,di.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=yg(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ir(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=yg(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ir(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=yg(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ir(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=yg(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ir(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=yg(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ir(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ir(t,this.array),i=Ir(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ir(t,this.array),i=Ir(i,this.array),r=Ir(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ir(t,this.array),i=Ir(i,this.array),r=Ir(r,this.array),s=Ir(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==tP&&(e.usage=this.usage),e}};var Rg=class extends jr{constructor(e,t,i){super(new Uint16Array(e),t,i)}};var Pg=class extends jr{constructor(e,t,i){super(new Uint32Array(e),t,i)}};var mr=class extends jr{constructor(e,t,i){super(new Float32Array(e),t,i)}},Nae=0,cs=new Vn,WR=new ka,hf=new q,zr=new nl,wg=new nl,Ci=new q,us=class n extends Da{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Nae++}),this.uuid=Kg(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(wP(e)?Pg:Rg)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Mt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return cs.makeRotationFromQuaternion(e),this.applyMatrix4(cs),this}rotateX(e){return cs.makeRotationX(e),this.applyMatrix4(cs),this}rotateY(e){return cs.makeRotationY(e),this.applyMatrix4(cs),this}rotateZ(e){return cs.makeRotationZ(e),this.applyMatrix4(cs),this}translate(e,t,i){return cs.makeTranslation(e,t,i),this.applyMatrix4(cs),this}scale(e,t,i){return cs.makeScale(e,t,i),this.applyMatrix4(cs),this}lookAt(e){return WR.lookAt(e),WR.updateMatrix(),this.applyMatrix4(WR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(hf).negate(),this.translate(hf.x,hf.y,hf.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let i=[];for(let r=0,s=e.length;r<s;r++){let o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new mr(i,3))}else{let i=Math.min(e.length,t.count);for(let r=0;r<i;r++){let s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new nl);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new q(-1/0,-1/0,-1/0),new q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){let s=t[i];zr.setFromBufferAttribute(s),this.morphTargetsRelative?(Ci.addVectors(this.boundingBox.min,zr.min),this.boundingBox.expandByPoint(Ci),Ci.addVectors(this.boundingBox.max,zr.max),this.boundingBox.expandByPoint(Ci)):(this.boundingBox.expandByPoint(zr.min),this.boundingBox.expandByPoint(zr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vu);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new q,1/0);return}if(e){let i=this.boundingSphere.center;if(zr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];wg.setFromBufferAttribute(a),this.morphTargetsRelative?(Ci.addVectors(zr.min,wg.min),zr.expandByPoint(Ci),Ci.addVectors(zr.max,wg.max),zr.expandByPoint(Ci)):(zr.expandByPoint(wg.min),zr.expandByPoint(wg.max))}zr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ci.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ci));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Ci.fromBufferAttribute(a,l),c&&(hf.fromBufferAttribute(e,l),Ci.add(hf)),r=Math.max(r,i.distanceToSquared(Ci))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new jr(new Float32Array(4*i.count),4));let o=this.getAttribute("tangent"),a=[],c=[];for(let w=0;w<i.count;w++)a[w]=new q,c[w]=new q;let l=new q,u=new q,d=new q,h=new Zt,p=new Zt,g=new Zt,y=new q,m=new q;function _(w,b,E){l.fromBufferAttribute(i,w),u.fromBufferAttribute(i,b),d.fromBufferAttribute(i,E),h.fromBufferAttribute(s,w),p.fromBufferAttribute(s,b),g.fromBufferAttribute(s,E),u.sub(l),d.sub(l),p.sub(h),g.sub(h);let T=1/(p.x*g.y-g.x*p.y);isFinite(T)&&(y.copy(u).multiplyScalar(g.y).addScaledVector(d,-p.y).multiplyScalar(T),m.copy(d).multiplyScalar(p.x).addScaledVector(u,-g.x).multiplyScalar(T),a[w].add(y),a[b].add(y),a[E].add(y),c[w].add(m),c[b].add(m),c[E].add(m))}let I=this.groups;I.length===0&&(I=[{start:0,count:e.count}]);for(let w=0,b=I.length;w<b;++w){let E=I[w],T=E.start,R=E.count;for(let A=T,ne=T+R;A<ne;A+=3)_(e.getX(A+0),e.getX(A+1),e.getX(A+2))}let M=new q,C=new q,P=new q,N=new q;function S(w){P.fromBufferAttribute(r,w),N.copy(P);let b=a[w];M.copy(b),M.sub(P.multiplyScalar(P.dot(b))).normalize(),C.crossVectors(N,b);let T=C.dot(c[w])<0?-1:1;o.setXYZW(w,M.x,M.y,M.z,T)}for(let w=0,b=I.length;w<b;++w){let E=I[w],T=E.start,R=E.count;for(let A=T,ne=T+R;A<ne;A+=3)S(e.getX(A+0)),S(e.getX(A+1)),S(e.getX(A+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new jr(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let h=0,p=i.count;h<p;h++)i.setXYZ(h,0,0,0);let r=new q,s=new q,o=new q,a=new q,c=new q,l=new q,u=new q,d=new q;if(e)for(let h=0,p=e.count;h<p;h+=3){let g=e.getX(h+0),y=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,m),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,g),c.fromBufferAttribute(i,y),l.fromBufferAttribute(i,m),a.add(u),c.add(u),l.add(u),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(y,c.x,c.y,c.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let h=0,p=t.count;h<p;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ci.fromBufferAttribute(e,t),Ci.normalize(),e.setXYZ(t,Ci.x,Ci.y,Ci.z)}toNonIndexed(){function e(a,c){let l=a.array,u=a.itemSize,d=a.normalized,h=new l.constructor(c.length*u),p=0,g=0;for(let y=0,m=c.length;y<m;y++){a.isInterleavedBufferAttribute?p=c[y]*a.data.stride+a.offset:p=c[y]*u;for(let _=0;_<u;_++)h[g++]=l[p++]}return new jr(h,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new n,i=this.index.array,r=this.attributes;for(let a in r){let c=r[a],l=e(c,i);t.setAttribute(a,l)}let s=this.morphAttributes;for(let a in s){let c=[],l=s[a];for(let u=0,d=l.length;u<d;u++){let h=l[u],p=e(h,i);c.push(p)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,c=o.length;a<c;a++){let l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let c=this.parameters;for(let l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let c in i){let l=i[c];e.data.attributes[c]=l.toJSON(e.data)}let r={},s=!1;for(let c in this.morphAttributes){let l=this.morphAttributes[c],u=[];for(let d=0,h=l.length;d<h;d++){let p=l[d];u.push(p.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone());let r=e.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(t))}let s=e.morphAttributes;for(let l in s){let u=[],d=s[l];for(let h=0,p=d.length;h<p;h++)u.push(d[h].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let l=0,u=o.length;l<u;l++){let d=o[l];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},o5=new Vn,Ru=new Ag,zE=new Vu,a5=new q,HE=new q,jE=new q,GE=new q,$R=new q,WE=new q,c5=new q,$E=new q,gr=class extends ka{constructor(e=new us,t=new rl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){let i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){WE.set(0,0,0);for(let c=0,l=s.length;c<l;c++){let u=a[c],d=s[c];u!==0&&($R.fromBufferAttribute(d,e),o?WE.addScaledVector($R,u):WE.addScaledVector($R.sub(t),u))}t.add(WE)}return t}raycast(e,t){let i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),zE.copy(i.boundingSphere),zE.applyMatrix4(s),Ru.copy(e.ray).recast(e.near),!(zE.containsPoint(Ru.origin)===!1&&(Ru.intersectSphere(zE,a5)===null||Ru.origin.distanceToSquared(a5)>(e.far-e.near)**2))&&(o5.copy(s).invert(),Ru.copy(e.ray).applyMatrix4(o5),!(i.boundingBox!==null&&Ru.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Ru)))}_computeIntersections(e,t,i){let r,s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,p=s.drawRange;if(a!==null)if(Array.isArray(o))for(let g=0,y=h.length;g<y;g++){let m=h[g],_=o[m.materialIndex],I=Math.max(m.start,p.start),M=Math.min(a.count,Math.min(m.start+m.count,p.start+p.count));for(let C=I,P=M;C<P;C+=3){let N=a.getX(C),S=a.getX(C+1),w=a.getX(C+2);r=qE(this,_,e,i,l,u,d,N,S,w),r&&(r.faceIndex=Math.floor(C/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{let g=Math.max(0,p.start),y=Math.min(a.count,p.start+p.count);for(let m=g,_=y;m<_;m+=3){let I=a.getX(m),M=a.getX(m+1),C=a.getX(m+2);r=qE(this,o,e,i,l,u,d,I,M,C),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let g=0,y=h.length;g<y;g++){let m=h[g],_=o[m.materialIndex],I=Math.max(m.start,p.start),M=Math.min(c.count,Math.min(m.start+m.count,p.start+p.count));for(let C=I,P=M;C<P;C+=3){let N=C,S=C+1,w=C+2;r=qE(this,_,e,i,l,u,d,N,S,w),r&&(r.faceIndex=Math.floor(C/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{let g=Math.max(0,p.start),y=Math.min(c.count,p.start+p.count);for(let m=g,_=y;m<_;m+=3){let I=m,M=m+1,C=m+2;r=qE(this,o,e,i,l,u,d,I,M,C),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}};function Oae(n,e,t,i,r,s,o,a){let c;if(e.side===_r?c=i.intersectTriangle(o,s,r,!0,a):c=i.intersectTriangle(r,s,o,e.side===Aa,a),c===null)return null;$E.copy(a),$E.applyMatrix4(n.matrixWorld);let l=t.ray.origin.distanceTo($E);return l<t.near||l>t.far?null:{distance:l,point:$E.clone(),object:n}}function qE(n,e,t,i,r,s,o,a,c,l){n.getVertexPosition(a,HE),n.getVertexPosition(c,jE),n.getVertexPosition(l,GE);let u=Oae(n,e,t,i,HE,jE,GE,c5);if(u){let d=new q;Qc.getBarycoord(c5,HE,jE,GE,d),r&&(u.uv=Qc.getInterpolatedAttribute(r,a,c,l,d,new Zt)),s&&(u.uv1=Qc.getInterpolatedAttribute(s,a,c,l,d,new Zt)),o&&(u.normal=Qc.getInterpolatedAttribute(o,a,c,l,d,new q),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));let h={a,b:c,c:l,normal:new q,materialIndex:0};Qc.getNormal(HE,jE,GE,h.normal),u.face=h,u.barycoord=d}return u}var sl=class n extends us{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let c=[],l=[],u=[],d=[],h=0,p=0;g("z","y","x",-1,-1,i,t,e,o,s,0),g("z","y","x",1,-1,i,t,-e,o,s,1),g("x","z","y",1,1,e,i,t,r,o,2),g("x","z","y",1,-1,e,i,-t,r,o,3),g("x","y","z",1,-1,e,t,i,r,s,4),g("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new mr(l,3)),this.setAttribute("normal",new mr(u,3)),this.setAttribute("uv",new mr(d,2));function g(y,m,_,I,M,C,P,N,S,w,b){let E=C/S,T=P/w,R=C/2,A=P/2,ne=N/2,Y=S+1,J=w+1,re=0,K=0,fe=new q;for(let Se=0;Se<J;Se++){let Ge=Se*T-A;for(let nt=0;nt<Y;nt++){let ct=nt*E-R;fe[y]=ct*I,fe[m]=Ge*M,fe[_]=ne,l.push(fe.x,fe.y,fe.z),fe[y]=0,fe[m]=0,fe[_]=N>0?1:-1,u.push(fe.x,fe.y,fe.z),d.push(nt/S),d.push(1-Se/w),re+=1}}for(let Se=0;Se<w;Se++)for(let Ge=0;Ge<S;Ge++){let nt=h+Ge+Y*Se,ct=h+Ge+Y*(Se+1),jt=h+(Ge+1)+Y*(Se+1),Ct=h+(Ge+1)+Y*Se;c.push(nt,ct,Ct),c.push(ct,jt,Ct),K+=6}a.addGroup(p,K,b),p+=K,h+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function ju(n){let e={};for(let t in n){e[t]={};for(let i in n[t]){let r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function tr(n){let e={};for(let t=0;t<n.length;t++){let i=ju(n[t]);for(let r in i)e[r]=i[r]}return e}function kae(n){let e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function xP(n){let e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Kt.workingColorSpace}var aj={clone:ju,merge:tr},Lae=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Fae=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Ls=class extends il{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Lae,this.fragmentShader=Fae,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ju(e.uniforms),this.uniformsGroups=kae(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},Ng=class extends ka{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Vn,this.projectionMatrix=new Vn,this.projectionMatrixInverse=new Vn,this.coordinateSystem=Os,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Jc=new q,l5=new Zt,u5=new Zt,Ui=class extends Ng{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=rw*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(TR*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return rw*2*Math.atan(Math.tan(TR*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Jc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Jc.x,Jc.y).multiplyScalar(-e/Jc.z),Jc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Jc.x,Jc.y).multiplyScalar(-e/Jc.z)}getViewSize(e,t){return this.getViewBounds(e,l5,u5),t.subVectors(u5,l5)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(TR*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},ff=-90,pf=1,cw=class extends ka{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Ui(ff,pf,e,t);r.layers=this.layers,this.add(r);let s=new Ui(ff,pf,e,t);s.layers=this.layers,this.add(s);let o=new Ui(ff,pf,e,t);o.layers=this.layers,this.add(o);let a=new Ui(ff,pf,e,t);a.layers=this.layers,this.add(a);let c=new Ui(ff,pf,e,t);c.layers=this.layers,this.add(c);let l=new Ui(ff,pf,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(let l of t)this.remove(l);if(e===Os)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Ig)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let l of t)this.add(l),l.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,c,l,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let y=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,l),i.texture.generateMipmaps=y,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,h,p),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}},Og=class extends ul{constructor(e=[],t=zu,i,r,s,o,a,c,l,u){super(e,t,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},lw=class extends To{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new Og(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new sl(5,5,5),s=new Ls({name:"CubemapFromEquirect",uniforms:ju(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:_r,blending:Pa});s.uniforms.tEquirect.value=t;let o=new gr(r,s),a=t.minFilter;return t.minFilter===cl&&(t.minFilter=ks),new cw(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}},Ou=class extends ka{constructor(){super(),this.isGroup=!0,this.type="Group"}},Vae={type:"move"},vf=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ou,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ou,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ou,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){o=!0;for(let y of e.hand.values()){let m=t.getJointPose(y,i),_=this._getHandJoint(l,y);m!==null&&(_.matrix.fromArray(m.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.matrixWorldNeedsUpdate=!0,_.jointRadius=m.radius),_.visible=m!==null}let u=l.joints["index-finger-tip"],d=l.joints["thumb-tip"],h=u.position.distanceTo(d.position),p=.02,g=.005;l.inputState.pinching&&h>p+g?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=p-g&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Vae)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new Ou;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}};var kg=class n{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new qt(e),this.near=t,this.far=i}clone(){return new n(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}},Lg=class extends ka{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Uu,this.environmentIntensity=1,this.environmentRotation=new Uu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};var qR=new q,Uae=new q,Bae=new Mt,So=class{constructor(e=new q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let r=qR.subVectors(i,t).cross(Uae.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta(qR),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||Bae.getNormalMatrix(e),r=this.coplanarPoint(qR).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Pu=new Vu,zae=new Zt(.5,.5),XE=new q,bf=class{constructor(e=new So,t=new So,i=new So,r=new So,s=new So,o=new So){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Os,i=!1){let r=this.planes,s=e.elements,o=s[0],a=s[1],c=s[2],l=s[3],u=s[4],d=s[5],h=s[6],p=s[7],g=s[8],y=s[9],m=s[10],_=s[11],I=s[12],M=s[13],C=s[14],P=s[15];if(r[0].setComponents(l-o,p-u,_-g,P-I).normalize(),r[1].setComponents(l+o,p+u,_+g,P+I).normalize(),r[2].setComponents(l+a,p+d,_+y,P+M).normalize(),r[3].setComponents(l-a,p-d,_-y,P-M).normalize(),i)r[4].setComponents(c,h,m,C).normalize(),r[5].setComponents(l-c,p-h,_-m,P-C).normalize();else if(r[4].setComponents(l-c,p-h,_-m,P-C).normalize(),t===Os)r[5].setComponents(l+c,p+h,_+m,P+C).normalize();else if(t===Ig)r[5].setComponents(c,h,m,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Pu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Pu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Pu)}intersectsSprite(e){Pu.center.set(0,0,0);let t=zae.distanceTo(e.center);return Pu.radius=.7071067811865476+t,Pu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Pu)}intersectsSphere(e){let t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let r=t[i];if(XE.x=r.normal.x>0?e.max.x:e.min.x,XE.y=r.normal.y>0?e.max.y:e.min.y,XE.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(XE)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};var Ef=class extends il{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},d5=new Vn,nP=new Ag,YE=new Vu,KE=new q,Fg=class extends ka{constructor(e=new us,t=new Ef){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),YE.copy(i.boundingSphere),YE.applyMatrix4(r),YE.radius+=s,e.ray.intersectsSphere(YE)===!1)return;d5.copy(r).invert(),nP.copy(e.ray).applyMatrix4(d5);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=i.index,d=i.attributes.position;if(l!==null){let h=Math.max(0,o.start),p=Math.min(l.count,o.start+o.count);for(let g=h,y=p;g<y;g++){let m=l.getX(g);KE.fromBufferAttribute(d,m),h5(KE,m,c,r,e,t,this)}}else{let h=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);for(let g=h,y=p;g<y;g++)KE.fromBufferAttribute(d,g),h5(KE,g,c,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function h5(n,e,t,i,r,s,o){let a=nP.distanceSqToPoint(n);if(a<t){let c=new q;nP.closestPointToPoint(n,c),c.applyMatrix4(i);let l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}var Vg=class extends ul{constructor(e,t,i=ll,r,s,o,a=ls,c=ls,l,u=gf,d=1){if(u!==gf&&u!==Tf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");let h={width:e,height:t,depth:d};super(h,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new yf(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},Ug=class extends ul{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}};var uw=class n extends us{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};let l=this;r=Math.floor(r),s=Math.floor(s);let u=[],d=[],h=[],p=[],g=0,y=[],m=i/2,_=0;I(),o===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(u),this.setAttribute("position",new mr(d,3)),this.setAttribute("normal",new mr(h,3)),this.setAttribute("uv",new mr(p,2));function I(){let C=new q,P=new q,N=0,S=(t-e)/i;for(let w=0;w<=s;w++){let b=[],E=w/s,T=E*(t-e)+e;for(let R=0;R<=r;R++){let A=R/r,ne=A*c+a,Y=Math.sin(ne),J=Math.cos(ne);P.x=T*Y,P.y=-E*i+m,P.z=T*J,d.push(P.x,P.y,P.z),C.set(Y,S,J).normalize(),h.push(C.x,C.y,C.z),p.push(A,1-E),b.push(g++)}y.push(b)}for(let w=0;w<r;w++)for(let b=0;b<s;b++){let E=y[b][w],T=y[b+1][w],R=y[b+1][w+1],A=y[b][w+1];(e>0||b!==0)&&(u.push(E,T,A),N+=3),(t>0||b!==s-1)&&(u.push(T,R,A),N+=3)}l.addGroup(_,N,0),_+=N}function M(C){let P=g,N=new Zt,S=new q,w=0,b=C===!0?e:t,E=C===!0?1:-1;for(let R=1;R<=r;R++)d.push(0,m*E,0),h.push(0,E,0),p.push(.5,.5),g++;let T=g;for(let R=0;R<=r;R++){let ne=R/r*c+a,Y=Math.cos(ne),J=Math.sin(ne);S.x=b*J,S.y=m*E,S.z=b*Y,d.push(S.x,S.y,S.z),h.push(0,E,0),N.x=Y*.5+.5,N.y=J*.5*E+.5,p.push(N.x,N.y),g++}for(let R=0;R<r;R++){let A=P+R,ne=T+R;C===!0?u.push(ne,ne+1,A):u.push(ne+1,ne,A),w+=3}l.addGroup(_,w,C===!0?1:2),_+=w}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},Bg=class n extends uw{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new n(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var zg=class n extends us{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,d=e/a,h=t/c,p=[],g=[],y=[],m=[];for(let _=0;_<u;_++){let I=_*h-o;for(let M=0;M<l;M++){let C=M*d-s;g.push(C,-I,0),y.push(0,0,1),m.push(M/a),m.push(1-_/c)}}for(let _=0;_<c;_++)for(let I=0;I<a;I++){let M=I+l*_,C=I+l*(_+1),P=I+1+l*(_+1),N=I+1+l*_;p.push(M,C,N),p.push(C,P,N)}this.setIndex(p),this.setAttribute("position",new mr(g,3)),this.setAttribute("normal",new mr(y,3)),this.setAttribute("uv",new mr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}};var dw=class extends il{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=q5,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},hw=class extends il{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function ZE(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Hae(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}var Bu=class{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){let a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){let a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},fw=class extends Bu{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZR,endingEnd:ZR}}intervalChanged_(e,t,i){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case JR:s=e,a=2*t-i;break;case QR:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case JR:o=e,c=2*i-t;break;case QR:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}let l=(i-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,p=this._weightNext,g=(i-t)/(r-t),y=g*g,m=y*g,_=-h*m+2*h*y-h*g,I=(1+h)*m+(-1.5-2*h)*y+(-.5+h)*g+1,M=(-1-p)*m+(1.5+p)*y+.5*g,C=p*m-p*y;for(let P=0;P!==a;++P)s[P]=_*o[u+P]+I*o[l+P]+M*o[c+P]+C*o[d+P];return s}},pw=class extends Bu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[l+h]*d+o[c+h]*u;return s}},mw=class extends Bu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},Gr=class{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ZE(t,this.TimeBufferType),this.values=ZE(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ZE(e.times,Array),values:ZE(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new mw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fw(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Sg:t=this.InterpolantFactoryMethodDiscrete;break;case iw:t=this.InterpolantFactoryMethodLinear;break;case JE:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Sg;case this.InterpolantFactoryMethodLinear:return iw;case this.InterpolantFactoryMethodSmooth:return JE}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){let i=this.times,r=i.length,s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let c=i[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&Hae(r))for(let a=0,c=r.length;a!==c;++a){let l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===JE,s=e.length-1,o=1;for(let a=1;a<s;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(r)c=!0;else{let d=a*i,h=d-i,p=d+i;for(let g=0;g!==i;++g){let y=t[d+g];if(y!==t[h+g]||y!==t[p+g]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];let d=a*i,h=o*i;for(let p=0;p!==i;++p)t[h+p]=t[d+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};Gr.prototype.ValueTypeName="";Gr.prototype.TimeBufferType=Float32Array;Gr.prototype.ValueBufferType=Float32Array;Gr.prototype.DefaultInterpolation=iw;var ol=class extends Gr{constructor(e,t,i){super(e,t,i)}};ol.prototype.ValueTypeName="bool";ol.prototype.ValueBufferType=Array;ol.prototype.DefaultInterpolation=Sg;ol.prototype.InterpolantFactoryMethodLinear=void 0;ol.prototype.InterpolantFactoryMethodSmooth=void 0;var gw=class extends Gr{constructor(e,t,i,r){super(e,t,i,r)}};gw.prototype.ValueTypeName="color";var _w=class extends Gr{constructor(e,t,i,r){super(e,t,i,r)}};_w.prototype.ValueTypeName="number";var yw=class extends Bu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t),l=e*a;for(let u=l+a;l!==u;l+=4)Ra.slerpFlat(s,0,o,l-a,o,l,c);return s}},Hg=class extends Gr{constructor(e,t,i,r){super(e,t,i,r)}InterpolantFactoryMethodLinear(e){return new yw(this.times,this.values,this.getValueSize(),e)}};Hg.prototype.ValueTypeName="quaternion";Hg.prototype.InterpolantFactoryMethodSmooth=void 0;var al=class extends Gr{constructor(e,t,i){super(e,t,i)}};al.prototype.ValueTypeName="string";al.prototype.ValueBufferType=Array;al.prototype.DefaultInterpolation=Sg;al.prototype.InterpolantFactoryMethodLinear=void 0;al.prototype.InterpolantFactoryMethodSmooth=void 0;var vw=class extends Gr{constructor(e,t,i,r){super(e,t,i,r)}};vw.prototype.ValueTypeName="vector";var bw=class extends ka{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new qt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}};var XR=new Vn,f5=new q,p5=new q,iP=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Zt(512,512),this.mapType=Fs,this.map=null,this.mapPass=null,this.matrix=new Vn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new bf,this._frameExtents=new Zt(1,1),this._viewportCount=1,this._viewports=[new hn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;f5.setFromMatrixPosition(e.matrixWorld),t.position.copy(f5),p5.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(p5),t.updateMatrixWorld(),XR.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(XR,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(XR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};var m5=new Vn,xg=new q,YR=new q,rP=class extends iP{constructor(){super(new Ui(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Zt(4,2),this._viewportCount=6,this._viewports=[new hn(2,1,1,1),new hn(0,1,1,1),new hn(3,1,1,1),new hn(1,1,1,1),new hn(3,0,1,1),new hn(1,0,1,1)],this._cubeDirections=[new q(1,0,0),new q(-1,0,0),new q(0,0,1),new q(0,0,-1),new q(0,1,0),new q(0,-1,0)],this._cubeUps=[new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,0,1),new q(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),xg.setFromMatrixPosition(e.matrixWorld),i.position.copy(xg),YR.copy(i.position),YR.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(YR),i.updateMatrixWorld(),r.makeTranslation(-xg.x,-xg.y,-xg.z),m5.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(m5,i.coordinateSystem,i.reversedDepth)}},jg=class extends bw{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new rP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Ew=class extends Ng{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=i-e,o=i+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};var ww=class extends Ui{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}};var SP="\\[\\]\\.:\\/",jae=new RegExp("["+SP+"]","g"),TP="[^"+SP+"]",Gae="[^"+SP.replace("\\.","")+"]",Wae=/((?:WC+[\/:])*)/.source.replace("WC",TP),$ae=/(WCOD+)?/.source.replace("WCOD",Gae),qae=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",TP),Xae=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",TP),Yae=new RegExp("^"+Wae+$ae+qae+Xae+"$"),Kae=["material","materials","bones","map"],sP=class{constructor(e,t,i){let r=i||qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},qn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(jae,"")}static parseTrackName(t){let i=Yae.exec(t);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);Kae.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(i===void 0||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(i);if(r!==void 0)return r}if(t.children){let r=function(o){for(let a=0;a<o.length;a++){let c=o[a];if(c.name===i||c.uuid===i)return c;let l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node,i=this.parsedPath,r=i.objectName,s=i.propertyName,o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(u!==void 0){if(t[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[u]}}let a=t[s];if(a===void 0){let u=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",t);return}let c=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?c=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=sP,n})();qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qn.prototype.GetterByBindingType=[qn.prototype._getValue_direct,qn.prototype._getValue_array,qn.prototype._getValue_arrayElement,qn.prototype._getValue_toArray];qn.prototype.SetterByBindingTypeAndVersioning=[[qn.prototype._setValue_direct,qn.prototype._setValue_direct_setNeedsUpdate,qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_array,qn.prototype._setValue_array_setNeedsUpdate,qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_arrayElement,qn.prototype._setValue_arrayElement_setNeedsUpdate,qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_fromArray,qn.prototype._setValue_fromArray_setNeedsUpdate,qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var SOe=new Float32Array(1);function IP(n,e,t,i){let r=Zae(i);switch(t){case gP:return n*e;case yP:return n*e/r.components*r.byteLength;case Lw:return n*e/r.components*r.byteLength;case vP:return n*e*2/r.components*r.byteLength;case Fw:return n*e*2/r.components*r.byteLength;case _P:return n*e*3/r.components*r.byteLength;case ds:return n*e*4/r.components*r.byteLength;case Vw:return n*e*4/r.components*r.byteLength;case $g:case qg:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Xg:case Yg:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Bw:case Hw:return Math.max(n,16)*Math.max(e,8)/4;case Uw:case zw:return Math.max(n,8)*Math.max(e,8)/2;case jw:case Gw:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Ww:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case $w:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case qw:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case Xw:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case Yw:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case Kw:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case Zw:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case Jw:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case Qw:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case ex:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case tx:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case nx:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case ix:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case rx:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case sx:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case ox:case ax:case cx:return Math.ceil(n/4)*Math.ceil(e/4)*16;case lx:case ux:return Math.ceil(n/4)*Math.ceil(e/4)*8;case dx:case hx:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Zae(n){switch(n){case Fs:case hP:return{byteLength:1,components:1};case wf:case fP:case xf:return{byteLength:2,components:1};case Ow:case kw:return{byteLength:2,components:4};case ll:case Nw:case Mo:return{byteLength:4,components:1};case pP:case mP:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"180"}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="180");function Rj(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Qae(n){let e=new WeakMap;function t(a,c){let l=a.array,u=a.usage,d=l.byteLength,h=n.createBuffer();n.bindBuffer(c,h),n.bufferData(c,l,u),a.onUploadCallback();let p;if(l instanceof Float32Array)p=n.FLOAT;else if(typeof Float16Array<"u"&&l instanceof Float16Array)p=n.HALF_FLOAT;else if(l instanceof Uint16Array)a.isFloat16BufferAttribute?p=n.HALF_FLOAT:p=n.UNSIGNED_SHORT;else if(l instanceof Int16Array)p=n.SHORT;else if(l instanceof Uint32Array)p=n.UNSIGNED_INT;else if(l instanceof Int32Array)p=n.INT;else if(l instanceof Int8Array)p=n.BYTE;else if(l instanceof Uint8Array)p=n.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)p=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:h,type:p,bytesPerElement:l.BYTES_PER_ELEMENT,version:a.version,size:d}}function i(a,c,l){let u=c.array,d=c.updateRanges;if(n.bindBuffer(l,a),d.length===0)n.bufferSubData(l,0,u);else{d.sort((p,g)=>p.start-g.start);let h=0;for(let p=1;p<d.length;p++){let g=d[h],y=d[p];y.start<=g.start+g.count+1?g.count=Math.max(g.count,y.start+y.count-g.start):(++h,d[h]=y)}d.length=h+1;for(let p=0,g=d.length;p<g;p++){let y=d[p];n.bufferSubData(l,y.start*u.BYTES_PER_ELEMENT,u,y.start,y.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let c=e.get(a);c&&(n.deleteBuffer(c.buffer),e.delete(a))}function o(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let l=e.get(a);if(l===void 0)e.set(a,t(a,c));else if(l.version<a.version){if(l.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(l.buffer,a,c),l.version=a.version}}return{get:r,remove:s,update:o}}var ece=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,tce=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,nce=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ice=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rce=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,sce=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,oce=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,ace=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cce=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,lce=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,uce=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,dce=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hce=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,fce=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,pce=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,mce=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,gce=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_ce=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,yce=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,vce=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bce=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ece=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,wce=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,xce=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Sce=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Tce=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Ice=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Cce=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Mce=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ace=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Dce="gl_FragColor = linearToOutputTexel( gl_FragColor );",Rce=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Pce=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Nce=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Oce=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,kce=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Lce=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Fce=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Vce=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Uce=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Bce=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,zce=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Hce=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,jce=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Gce=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Wce=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,$ce=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,qce=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Xce=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Yce=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kce=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Zce=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Jce=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Qce=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,ele=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,tle=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,nle=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ile=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rle=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sle=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,ole=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ale=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cle=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,lle=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ule=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dle=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,hle=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,fle=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ple=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,mle=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,gle=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_le=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,yle=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,vle=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ble=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Ele=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,wle=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,xle=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Sle=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Tle=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Ile=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Cle=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Mle=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Ale=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Dle=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Rle=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Ple=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Nle=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Ole=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,kle=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Lle=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Fle=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Vle=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Ule=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Ble=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,zle=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Hle=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,jle=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Gle=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Wle=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,$le=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,qle=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Xle=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Yle=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Kle=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Zle=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Jle=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Qle=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eue=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nue=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rue=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sue=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,oue=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,aue=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,cue=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,lue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,uue=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,due=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hue=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,fue=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pue=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mue=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gue=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_ue=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,yue=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vue=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,bue=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Eue=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wue=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xue=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Sue=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tue=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Iue=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Cue=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Mue=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Aue=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Due=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Rue=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pue=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Rt={alphahash_fragment:ece,alphahash_pars_fragment:tce,alphamap_fragment:nce,alphamap_pars_fragment:ice,alphatest_fragment:rce,alphatest_pars_fragment:sce,aomap_fragment:oce,aomap_pars_fragment:ace,batching_pars_vertex:cce,batching_vertex:lce,begin_vertex:uce,beginnormal_vertex:dce,bsdfs:hce,iridescence_fragment:fce,bumpmap_pars_fragment:pce,clipping_planes_fragment:mce,clipping_planes_pars_fragment:gce,clipping_planes_pars_vertex:_ce,clipping_planes_vertex:yce,color_fragment:vce,color_pars_fragment:bce,color_pars_vertex:Ece,color_vertex:wce,common:xce,cube_uv_reflection_fragment:Sce,defaultnormal_vertex:Tce,displacementmap_pars_vertex:Ice,displacementmap_vertex:Cce,emissivemap_fragment:Mce,emissivemap_pars_fragment:Ace,colorspace_fragment:Dce,colorspace_pars_fragment:Rce,envmap_fragment:Pce,envmap_common_pars_fragment:Nce,envmap_pars_fragment:Oce,envmap_pars_vertex:kce,envmap_physical_pars_fragment:$ce,envmap_vertex:Lce,fog_vertex:Fce,fog_pars_vertex:Vce,fog_fragment:Uce,fog_pars_fragment:Bce,gradientmap_pars_fragment:zce,lightmap_pars_fragment:Hce,lights_lambert_fragment:jce,lights_lambert_pars_fragment:Gce,lights_pars_begin:Wce,lights_toon_fragment:qce,lights_toon_pars_fragment:Xce,lights_phong_fragment:Yce,lights_phong_pars_fragment:Kce,lights_physical_fragment:Zce,lights_physical_pars_fragment:Jce,lights_fragment_begin:Qce,lights_fragment_maps:ele,lights_fragment_end:tle,logdepthbuf_fragment:nle,logdepthbuf_pars_fragment:ile,logdepthbuf_pars_vertex:rle,logdepthbuf_vertex:sle,map_fragment:ole,map_pars_fragment:ale,map_particle_fragment:cle,map_particle_pars_fragment:lle,metalnessmap_fragment:ule,metalnessmap_pars_fragment:dle,morphinstance_vertex:hle,morphcolor_vertex:fle,morphnormal_vertex:ple,morphtarget_pars_vertex:mle,morphtarget_vertex:gle,normal_fragment_begin:_le,normal_fragment_maps:yle,normal_pars_fragment:vle,normal_pars_vertex:ble,normal_vertex:Ele,normalmap_pars_fragment:wle,clearcoat_normal_fragment_begin:xle,clearcoat_normal_fragment_maps:Sle,clearcoat_pars_fragment:Tle,iridescence_pars_fragment:Ile,opaque_fragment:Cle,packing:Mle,premultiplied_alpha_fragment:Ale,project_vertex:Dle,dithering_fragment:Rle,dithering_pars_fragment:Ple,roughnessmap_fragment:Nle,roughnessmap_pars_fragment:Ole,shadowmap_pars_fragment:kle,shadowmap_pars_vertex:Lle,shadowmap_vertex:Fle,shadowmask_pars_fragment:Vle,skinbase_vertex:Ule,skinning_pars_vertex:Ble,skinning_vertex:zle,skinnormal_vertex:Hle,specularmap_fragment:jle,specularmap_pars_fragment:Gle,tonemapping_fragment:Wle,tonemapping_pars_fragment:$le,transmission_fragment:qle,transmission_pars_fragment:Xle,uv_pars_fragment:Yle,uv_pars_vertex:Kle,uv_vertex:Zle,worldpos_vertex:Jle,background_vert:Qle,background_frag:eue,backgroundCube_vert:tue,backgroundCube_frag:nue,cube_vert:iue,cube_frag:rue,depth_vert:sue,depth_frag:oue,distanceRGBA_vert:aue,distanceRGBA_frag:cue,equirect_vert:lue,equirect_frag:uue,linedashed_vert:due,linedashed_frag:hue,meshbasic_vert:fue,meshbasic_frag:pue,meshlambert_vert:mue,meshlambert_frag:gue,meshmatcap_vert:_ue,meshmatcap_frag:yue,meshnormal_vert:vue,meshnormal_frag:bue,meshphong_vert:Eue,meshphong_frag:wue,meshphysical_vert:xue,meshphysical_frag:Sue,meshtoon_vert:Tue,meshtoon_frag:Iue,points_vert:Cue,points_frag:Mue,shadow_vert:Aue,shadow_frag:Due,sprite_vert:Rue,sprite_frag:Pue},Me={common:{diffuse:{value:new qt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Mt},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Mt}},envmap:{envMap:{value:null},envMapRotation:{value:new Mt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Mt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Mt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Mt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Mt},normalScale:{value:new Zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Mt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Mt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Mt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Mt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0},uvTransform:{value:new Mt}},sprite:{diffuse:{value:new qt(16777215)},opacity:{value:1},center:{value:new Zt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Mt},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0}}},Ao={basic:{uniforms:tr([Me.common,Me.specularmap,Me.envmap,Me.aomap,Me.lightmap,Me.fog]),vertexShader:Rt.meshbasic_vert,fragmentShader:Rt.meshbasic_frag},lambert:{uniforms:tr([Me.common,Me.specularmap,Me.envmap,Me.aomap,Me.lightmap,Me.emissivemap,Me.bumpmap,Me.normalmap,Me.displacementmap,Me.fog,Me.lights,{emissive:{value:new qt(0)}}]),vertexShader:Rt.meshlambert_vert,fragmentShader:Rt.meshlambert_frag},phong:{uniforms:tr([Me.common,Me.specularmap,Me.envmap,Me.aomap,Me.lightmap,Me.emissivemap,Me.bumpmap,Me.normalmap,Me.displacementmap,Me.fog,Me.lights,{emissive:{value:new qt(0)},specular:{value:new qt(1118481)},shininess:{value:30}}]),vertexShader:Rt.meshphong_vert,fragmentShader:Rt.meshphong_frag},standard:{uniforms:tr([Me.common,Me.envmap,Me.aomap,Me.lightmap,Me.emissivemap,Me.bumpmap,Me.normalmap,Me.displacementmap,Me.roughnessmap,Me.metalnessmap,Me.fog,Me.lights,{emissive:{value:new qt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rt.meshphysical_vert,fragmentShader:Rt.meshphysical_frag},toon:{uniforms:tr([Me.common,Me.aomap,Me.lightmap,Me.emissivemap,Me.bumpmap,Me.normalmap,Me.displacementmap,Me.gradientmap,Me.fog,Me.lights,{emissive:{value:new qt(0)}}]),vertexShader:Rt.meshtoon_vert,fragmentShader:Rt.meshtoon_frag},matcap:{uniforms:tr([Me.common,Me.bumpmap,Me.normalmap,Me.displacementmap,Me.fog,{matcap:{value:null}}]),vertexShader:Rt.meshmatcap_vert,fragmentShader:Rt.meshmatcap_frag},points:{uniforms:tr([Me.points,Me.fog]),vertexShader:Rt.points_vert,fragmentShader:Rt.points_frag},dashed:{uniforms:tr([Me.common,Me.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rt.linedashed_vert,fragmentShader:Rt.linedashed_frag},depth:{uniforms:tr([Me.common,Me.displacementmap]),vertexShader:Rt.depth_vert,fragmentShader:Rt.depth_frag},normal:{uniforms:tr([Me.common,Me.bumpmap,Me.normalmap,Me.displacementmap,{opacity:{value:1}}]),vertexShader:Rt.meshnormal_vert,fragmentShader:Rt.meshnormal_frag},sprite:{uniforms:tr([Me.sprite,Me.fog]),vertexShader:Rt.sprite_vert,fragmentShader:Rt.sprite_frag},background:{uniforms:{uvTransform:{value:new Mt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Rt.background_vert,fragmentShader:Rt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Mt}},vertexShader:Rt.backgroundCube_vert,fragmentShader:Rt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Rt.cube_vert,fragmentShader:Rt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rt.equirect_vert,fragmentShader:Rt.equirect_frag},distanceRGBA:{uniforms:tr([Me.common,Me.displacementmap,{referencePosition:{value:new q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rt.distanceRGBA_vert,fragmentShader:Rt.distanceRGBA_frag},shadow:{uniforms:tr([Me.lights,Me.fog,{color:{value:new qt(0)},opacity:{value:1}}]),vertexShader:Rt.shadow_vert,fragmentShader:Rt.shadow_frag}};Ao.physical={uniforms:tr([Ao.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Mt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Mt},clearcoatNormalScale:{value:new Zt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Mt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Mt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Mt},sheen:{value:0},sheenColor:{value:new qt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Mt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Mt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Mt},transmissionSamplerSize:{value:new Zt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Mt},attenuationDistance:{value:0},attenuationColor:{value:new qt(0)},specularColor:{value:new qt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Mt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Mt},anisotropyVector:{value:new Zt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Mt}}]),vertexShader:Rt.meshphysical_vert,fragmentShader:Rt.meshphysical_frag};var fx={r:0,b:0,g:0},Gu=new Uu,Nue=new Vn;function Oue(n,e,t,i,r,s,o){let a=new qt(0),c=s===!0?0:1,l,u,d=null,h=0,p=null;function g(M){let C=M.isScene===!0?M.background:null;return C&&C.isTexture&&(C=(M.backgroundBlurriness>0?t:e).get(C)),C}function y(M){let C=!1,P=g(M);P===null?_(a,c):P&&P.isColor&&(_(P,1),C=!0);let N=n.xr.getEnvironmentBlendMode();N==="additive"?i.buffers.color.setClear(0,0,0,1,o):N==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||C)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function m(M,C){let P=g(C);P&&(P.isCubeTexture||P.mapping===Gg)?(u===void 0&&(u=new gr(new sl(1,1,1),new Ls({name:"BackgroundCubeMaterial",uniforms:ju(Ao.backgroundCube.uniforms),vertexShader:Ao.backgroundCube.vertexShader,fragmentShader:Ao.backgroundCube.fragmentShader,side:_r,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(N,S,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),Gu.copy(C.backgroundRotation),Gu.x*=-1,Gu.y*=-1,Gu.z*=-1,P.isCubeTexture&&P.isRenderTargetTexture===!1&&(Gu.y*=-1,Gu.z*=-1),u.material.uniforms.envMap.value=P,u.material.uniforms.flipEnvMap.value=P.isCubeTexture&&P.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=C.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(Nue.makeRotationFromEuler(Gu)),u.material.toneMapped=Kt.getTransfer(P.colorSpace)!==fn,(d!==P||h!==P.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,d=P,h=P.version,p=n.toneMapping),u.layers.enableAll(),M.unshift(u,u.geometry,u.material,0,0,null)):P&&P.isTexture&&(l===void 0&&(l=new gr(new zg(2,2),new Ls({name:"BackgroundMaterial",uniforms:ju(Ao.background.uniforms),vertexShader:Ao.background.vertexShader,fragmentShader:Ao.background.fragmentShader,side:Aa,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=P,l.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,l.material.toneMapped=Kt.getTransfer(P.colorSpace)!==fn,P.matrixAutoUpdate===!0&&P.updateMatrix(),l.material.uniforms.uvTransform.value.copy(P.matrix),(d!==P||h!==P.version||p!==n.toneMapping)&&(l.material.needsUpdate=!0,d=P,h=P.version,p=n.toneMapping),l.layers.enableAll(),M.unshift(l,l.geometry,l.material,0,0,null))}function _(M,C){M.getRGB(fx,xP(n)),i.buffers.color.setClear(fx.r,fx.g,fx.b,C,o)}function I(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),l!==void 0&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}return{getClearColor:function(){return a},setClearColor:function(M,C=1){a.set(M),c=C,_(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(M){c=M,_(a,c)},render:y,addToRenderList:m,dispose:I}}function kue(n,e){let t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=h(null),s=r,o=!1;function a(E,T,R,A,ne){let Y=!1,J=d(A,R,T);s!==J&&(s=J,l(s.object)),Y=p(E,A,R,ne),Y&&g(E,A,R,ne),ne!==null&&e.update(ne,n.ELEMENT_ARRAY_BUFFER),(Y||o)&&(o=!1,C(E,T,R,A),ne!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(ne).buffer))}function c(){return n.createVertexArray()}function l(E){return n.bindVertexArray(E)}function u(E){return n.deleteVertexArray(E)}function d(E,T,R){let A=R.wireframe===!0,ne=i[E.id];ne===void 0&&(ne={},i[E.id]=ne);let Y=ne[T.id];Y===void 0&&(Y={},ne[T.id]=Y);let J=Y[A];return J===void 0&&(J=h(c()),Y[A]=J),J}function h(E){let T=[],R=[],A=[];for(let ne=0;ne<t;ne++)T[ne]=0,R[ne]=0,A[ne]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:T,enabledAttributes:R,attributeDivisors:A,object:E,attributes:{},index:null}}function p(E,T,R,A){let ne=s.attributes,Y=T.attributes,J=0,re=R.getAttributes();for(let K in re)if(re[K].location>=0){let Se=ne[K],Ge=Y[K];if(Ge===void 0&&(K==="instanceMatrix"&&E.instanceMatrix&&(Ge=E.instanceMatrix),K==="instanceColor"&&E.instanceColor&&(Ge=E.instanceColor)),Se===void 0||Se.attribute!==Ge||Ge&&Se.data!==Ge.data)return!0;J++}return s.attributesNum!==J||s.index!==A}function g(E,T,R,A){let ne={},Y=T.attributes,J=0,re=R.getAttributes();for(let K in re)if(re[K].location>=0){let Se=Y[K];Se===void 0&&(K==="instanceMatrix"&&E.instanceMatrix&&(Se=E.instanceMatrix),K==="instanceColor"&&E.instanceColor&&(Se=E.instanceColor));let Ge={};Ge.attribute=Se,Se&&Se.data&&(Ge.data=Se.data),ne[K]=Ge,J++}s.attributes=ne,s.attributesNum=J,s.index=A}function y(){let E=s.newAttributes;for(let T=0,R=E.length;T<R;T++)E[T]=0}function m(E){_(E,0)}function _(E,T){let R=s.newAttributes,A=s.enabledAttributes,ne=s.attributeDivisors;R[E]=1,A[E]===0&&(n.enableVertexAttribArray(E),A[E]=1),ne[E]!==T&&(n.vertexAttribDivisor(E,T),ne[E]=T)}function I(){let E=s.newAttributes,T=s.enabledAttributes;for(let R=0,A=T.length;R<A;R++)T[R]!==E[R]&&(n.disableVertexAttribArray(R),T[R]=0)}function M(E,T,R,A,ne,Y,J){J===!0?n.vertexAttribIPointer(E,T,R,ne,Y):n.vertexAttribPointer(E,T,R,A,ne,Y)}function C(E,T,R,A){y();let ne=A.attributes,Y=R.getAttributes(),J=T.defaultAttributeValues;for(let re in Y){let K=Y[re];if(K.location>=0){let fe=ne[re];if(fe===void 0&&(re==="instanceMatrix"&&E.instanceMatrix&&(fe=E.instanceMatrix),re==="instanceColor"&&E.instanceColor&&(fe=E.instanceColor)),fe!==void 0){let Se=fe.normalized,Ge=fe.itemSize,nt=e.get(fe);if(nt===void 0)continue;let ct=nt.buffer,jt=nt.type,Ct=nt.bytesPerElement,oe=jt===n.INT||jt===n.UNSIGNED_INT||fe.gpuType===Nw;if(fe.isInterleavedBufferAttribute){let de=fe.data,Be=de.stride,dt=fe.offset;if(de.isInstancedInterleavedBuffer){for(let Xe=0;Xe<K.locationSize;Xe++)_(K.location+Xe,de.meshPerAttribute);E.isInstancedMesh!==!0&&A._maxInstanceCount===void 0&&(A._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Xe=0;Xe<K.locationSize;Xe++)m(K.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let Xe=0;Xe<K.locationSize;Xe++)M(K.location+Xe,Ge/K.locationSize,jt,Se,Be*Ct,(dt+Ge/K.locationSize*Xe)*Ct,oe)}else{if(fe.isInstancedBufferAttribute){for(let de=0;de<K.locationSize;de++)_(K.location+de,fe.meshPerAttribute);E.isInstancedMesh!==!0&&A._maxInstanceCount===void 0&&(A._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let de=0;de<K.locationSize;de++)m(K.location+de);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let de=0;de<K.locationSize;de++)M(K.location+de,Ge/K.locationSize,jt,Se,Ge*Ct,Ge/K.locationSize*de*Ct,oe)}}else if(J!==void 0){let Se=J[re];if(Se!==void 0)switch(Se.length){case 2:n.vertexAttrib2fv(K.location,Se);break;case 3:n.vertexAttrib3fv(K.location,Se);break;case 4:n.vertexAttrib4fv(K.location,Se);break;default:n.vertexAttrib1fv(K.location,Se)}}}}I()}function P(){w();for(let E in i){let T=i[E];for(let R in T){let A=T[R];for(let ne in A)u(A[ne].object),delete A[ne];delete T[R]}delete i[E]}}function N(E){if(i[E.id]===void 0)return;let T=i[E.id];for(let R in T){let A=T[R];for(let ne in A)u(A[ne].object),delete A[ne];delete T[R]}delete i[E.id]}function S(E){for(let T in i){let R=i[T];if(R[E.id]===void 0)continue;let A=R[E.id];for(let ne in A)u(A[ne].object),delete A[ne];delete R[E.id]}}function w(){b(),o=!0,s!==r&&(s=r,l(s.object))}function b(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:w,resetDefaultState:b,dispose:P,releaseStatesOfGeometry:N,releaseStatesOfProgram:S,initAttributes:y,enableAttribute:m,disableUnusedAttributes:I}}function Lue(n,e,t){let i;function r(l){i=l}function s(l,u){n.drawArrays(i,l,u),t.update(u,i,1)}function o(l,u,d){d!==0&&(n.drawArraysInstanced(i,l,u,d),t.update(u,i,d))}function a(l,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,l,0,u,0,d);let p=0;for(let g=0;g<d;g++)p+=u[g];t.update(p,i,1)}function c(l,u,d,h){if(d===0)return;let p=e.get("WEBGL_multi_draw");if(p===null)for(let g=0;g<l.length;g++)o(l[g],u[g],h[g]);else{p.multiDrawArraysInstancedWEBGL(i,l,0,u,0,h,0,d);let g=0;for(let y=0;y<d;y++)g+=u[y]*h[y];t.update(g,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function Fue(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let S=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(S){return!(S!==ds&&i.convert(S)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(S){let w=S===xf&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(S!==Fs&&i.convert(S)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&S!==Mo&&!w)}function c(S){if(S==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";S="mediump"}return S==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=t.precision!==void 0?t.precision:"highp",u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let d=t.logarithmicDepthBuffer===!0,h=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),p=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),g=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_TEXTURE_SIZE),m=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),_=n.getParameter(n.MAX_VERTEX_ATTRIBS),I=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),M=n.getParameter(n.MAX_VARYING_VECTORS),C=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),P=g>0,N=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:a,precision:l,logarithmicDepthBuffer:d,reversedDepthBuffer:h,maxTextures:p,maxVertexTextures:g,maxTextureSize:y,maxCubemapSize:m,maxAttributes:_,maxVertexUniforms:I,maxVaryings:M,maxFragmentUniforms:C,vertexTextures:P,maxSamples:N}}function Vue(n){let e=this,t=null,i=0,r=!1,s=!1,o=new So,a=new Mt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){let p=d.length!==0||h||i!==0||r;return r=h,i=d.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,p){let g=d.clippingPlanes,y=d.clipIntersection,m=d.clipShadows,_=n.get(d);if(!r||g===null||g.length===0||s&&!m)s?u(null):l();else{let I=s?0:i,M=I*4,C=_.clippingState||null;c.value=C,C=u(g,h,M,p);for(let P=0;P!==M;++P)C[P]=t[P];_.clippingState=C,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=I}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,h,p,g){let y=d!==null?d.length:0,m=null;if(y!==0){if(m=c.value,g!==!0||m===null){let _=p+y*4,I=h.matrixWorldInverse;a.getNormalMatrix(I),(m===null||m.length<_)&&(m=new Float32Array(_));for(let M=0,C=p;M!==y;++M,C+=4)o.copy(d[M]).applyMatrix4(I,a),o.normal.toArray(m,C),m[C+3]=o.constant}c.value=m,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,m}}function Uue(n){let e=new WeakMap;function t(o,a){return a===Dw?o.mapping=zu:a===Rw&&(o.mapping=Hu),o}function i(o){if(o&&o.isTexture){let a=o.mapping;if(a===Dw||a===Rw)if(e.has(o)){let c=e.get(o).texture;return t(c,o.mapping)}else{let c=o.image;if(c&&c.height>0){let l=new lw(c.height);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}var Cf=4,cj=[.125,.215,.35,.446,.526,.582],qu=20,CP=new Ew,lj=new qt,MP=null,AP=0,DP=0,RP=!1,$u=(1+Math.sqrt(5))/2,If=1/$u,uj=[new q(-$u,If,0),new q($u,If,0),new q(-If,0,$u),new q(If,0,$u),new q(0,$u,-If),new q(0,$u,If),new q(-1,1,-1),new q(1,1,-1),new q(-1,1,1),new q(1,1,1)],Bue=new q,gx=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100,s={}){let{size:o=256,position:a=Bue}=s;MP=this._renderer.getRenderTarget(),AP=this._renderer.getActiveCubeFace(),DP=this._renderer.getActiveMipmapLevel(),RP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);let c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,a),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=fj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=hj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(MP,AP,DP),this._renderer.xr.enabled=RP,e.scissorTest=!1,px(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===zu||e.mapping===Hu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),MP=this._renderer.getRenderTarget(),AP=this._renderer.getActiveCubeFace(),DP=this._renderer.getActiveMipmapLevel(),RP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:ks,minFilter:ks,generateMipmaps:!1,type:xf,format:ds,colorSpace:Fu,depthBuffer:!1},r=dj(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=dj(e,t,i);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=zue(s)),this._blurMaterial=Hue(s,e,t)}return r}_compileMaterial(e){let t=new gr(this._lodPlanes[0],e);this._renderer.compile(t,CP)}_sceneToCubeUV(e,t,i,r,s){let c=new Ui(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,p=d.toneMapping;d.getClearColor(lj),d.toneMapping=Na,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null));let y=new rl({name:"PMREM.Background",side:_r,depthWrite:!1,depthTest:!1}),m=new gr(new sl,y),_=!1,I=e.background;I?I.isColor&&(y.color.copy(I),e.background=null,_=!0):(y.color.copy(lj),_=!0);for(let M=0;M<6;M++){let C=M%3;C===0?(c.up.set(0,l[M],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+u[M],s.y,s.z)):C===1?(c.up.set(0,0,l[M]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+u[M],s.z)):(c.up.set(0,l[M],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+u[M]));let P=this._cubeSize;px(r,C*P,M>2?P:0,P,P),d.setRenderTarget(r),_&&d.render(m,c),d.render(e,c)}m.geometry.dispose(),m.material.dispose(),d.toneMapping=p,d.autoClear=h,e.background=I}_textureToCubeUV(e,t){let i=this._renderer,r=e.mapping===zu||e.mapping===Hu;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=fj()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=hj());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new gr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let c=this._cubeSize;px(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,CP)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let s=1;s<r;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=uj[(r-s-1)%uj.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){let c=this._renderer,l=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,d=new gr(this._lodPlanes[r],l),h=l.uniforms,p=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*qu-1),y=s/g,m=isFinite(s)?1+Math.floor(u*y):qu;m>qu&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${qu}`);let _=[],I=0;for(let S=0;S<qu;++S){let w=S/y,b=Math.exp(-w*w/2);_.push(b),S===0?I+=b:S<m&&(I+=2*b)}for(let S=0;S<_.length;S++)_[S]=_[S]/I;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=_,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:M}=this;h.dTheta.value=g,h.mipInt.value=M-i;let C=this._sizeLods[r],P=3*C*(r>M-Cf?r-M+Cf:0),N=4*(this._cubeSize-C);px(t,P,N,3*C,2*C),c.setRenderTarget(t),c.render(d,CP)}};function zue(n){let e=[],t=[],i=[],r=n,s=n-Cf+1+cj.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let c=1/a;o>n-Cf?c=cj[o-n+Cf-1]:o===0&&(c=0),i.push(c);let l=1/(a-2),u=-l,d=1+l,h=[u,u,d,u,d,d,u,u,d,d,u,d],p=6,g=6,y=3,m=2,_=1,I=new Float32Array(y*g*p),M=new Float32Array(m*g*p),C=new Float32Array(_*g*p);for(let N=0;N<p;N++){let S=N%3*2/3-1,w=N>2?0:-1,b=[S,w,0,S+2/3,w,0,S+2/3,w+1,0,S,w,0,S+2/3,w+1,0,S,w+1,0];I.set(b,y*g*N),M.set(h,m*g*N);let E=[N,N,N,N,N,N];C.set(E,_*g*N)}let P=new us;P.setAttribute("position",new jr(I,y)),P.setAttribute("uv",new jr(M,m)),P.setAttribute("faceIndex",new jr(C,_)),e.push(P),r>Cf&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function dj(n,e,t){let i=new To(n,e,t);return i.texture.mapping=Gg,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function px(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Hue(n,e,t){let i=new Float32Array(qu),r=new q(0,1,0);return new Ls({name:"SphericalGaussianBlur",defines:{n:qu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:zP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Pa,depthTest:!1,depthWrite:!1})}function hj(){return new Ls({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:zP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Pa,depthTest:!1,depthWrite:!1})}function fj(){return new Ls({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:zP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Pa,depthTest:!1,depthWrite:!1})}function zP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function jue(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){let c=a.mapping,l=c===Dw||c===Rw,u=c===zu||c===Hu;if(l||u){let d=e.get(a),h=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return t===null&&(t=new gx(n)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{let p=a.image;return l&&p&&p.height>0||u&&p&&r(p)?(t===null&&(t=new gx(n)),d=l?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function s(a){let c=a.target;c.removeEventListener("dispose",s);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function Gue(n){let e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){let r=t(i);return r===null&&_f("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Wue(n,e,t,i){let r={},s=new WeakMap;function o(d){let h=d.target;h.index!==null&&e.remove(h.index);for(let g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",o),delete r[h.id];let p=s.get(h);p&&(e.remove(p),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(d,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h}function c(d){let h=d.attributes;for(let p in h)e.update(h[p],n.ARRAY_BUFFER)}function l(d){let h=[],p=d.index,g=d.attributes.position,y=0;if(p!==null){let I=p.array;y=p.version;for(let M=0,C=I.length;M<C;M+=3){let P=I[M+0],N=I[M+1],S=I[M+2];h.push(P,N,N,S,S,P)}}else if(g!==void 0){let I=g.array;y=g.version;for(let M=0,C=I.length/3-1;M<C;M+=3){let P=M+0,N=M+1,S=M+2;h.push(P,N,N,S,S,P)}}else return;let m=new(wP(h)?Pg:Rg)(h,1);m.version=y;let _=s.get(d);_&&e.remove(_),s.set(d,m)}function u(d){let h=s.get(d);if(h){let p=d.index;p!==null&&h.version<p.version&&l(d)}else l(d);return s.get(d)}return{get:a,update:c,getWireframeAttribute:u}}function $ue(n,e,t){let i;function r(h){i=h}let s,o;function a(h){s=h.type,o=h.bytesPerElement}function c(h,p){n.drawElements(i,p,s,h*o),t.update(p,i,1)}function l(h,p,g){g!==0&&(n.drawElementsInstanced(i,p,s,h*o,g),t.update(p,i,g))}function u(h,p,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,p,0,s,h,0,g);let m=0;for(let _=0;_<g;_++)m+=p[_];t.update(m,i,1)}function d(h,p,g,y){if(g===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let _=0;_<h.length;_++)l(h[_]/o,p[_],y[_]);else{m.multiDrawElementsInstancedWEBGL(i,p,0,s,h,0,y,0,g);let _=0;for(let I=0;I<g;I++)_+=p[I]*y[I];t.update(_,i,1)}}this.setMode=r,this.setIndex=a,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function que(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function Xue(n,e,t){let i=new WeakMap,r=new hn;function s(o,a,c){let l=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0,h=i.get(a);if(h===void 0||h.count!==d){let E=function(){w.dispose(),i.delete(a),a.removeEventListener("dispose",E)};var p=E;h!==void 0&&h.texture.dispose();let g=a.morphAttributes.position!==void 0,y=a.morphAttributes.normal!==void 0,m=a.morphAttributes.color!==void 0,_=a.morphAttributes.position||[],I=a.morphAttributes.normal||[],M=a.morphAttributes.color||[],C=0;g===!0&&(C=1),y===!0&&(C=2),m===!0&&(C=3);let P=a.attributes.position.count*C,N=1;P>e.maxTextureSize&&(N=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);let S=new Float32Array(P*N*4*d),w=new Mg(S,P,N,d);w.type=Mo,w.needsUpdate=!0;let b=C*4;for(let T=0;T<d;T++){let R=_[T],A=I[T],ne=M[T],Y=P*N*4*T;for(let J=0;J<R.count;J++){let re=J*b;g===!0&&(r.fromBufferAttribute(R,J),S[Y+re+0]=r.x,S[Y+re+1]=r.y,S[Y+re+2]=r.z,S[Y+re+3]=0),y===!0&&(r.fromBufferAttribute(A,J),S[Y+re+4]=r.x,S[Y+re+5]=r.y,S[Y+re+6]=r.z,S[Y+re+7]=0),m===!0&&(r.fromBufferAttribute(ne,J),S[Y+re+8]=r.x,S[Y+re+9]=r.y,S[Y+re+10]=r.z,S[Y+re+11]=ne.itemSize===4?r.w:1)}}h={count:d,texture:w,size:new Zt(P,N)},i.set(a,h),a.addEventListener("dispose",E)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let g=0;for(let m=0;m<l.length;m++)g+=l[m];let y=a.morphTargetsRelative?1:1-g;c.getUniforms().setValue(n,"morphTargetBaseInfluence",y),c.getUniforms().setValue(n,"morphTargetInfluences",l)}c.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),c.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}return{update:s}}function Yue(n,e,t,i){let r=new WeakMap;function s(c){let l=i.render.frame,u=c.geometry,d=e.get(c,u);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){let h=c.skeleton;r.get(h)!==l&&(h.update(),r.set(h,l))}return d}function o(){r=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:s,dispose:o}}var Pj=new ul,pj=new Vg(1,1),Nj=new Mg,Oj=new aw,kj=new Og,mj=[],gj=[],_j=new Float32Array(16),yj=new Float32Array(9),vj=new Float32Array(4);function Af(n,e,t){let i=n[0];if(i<=0||i>0)return n;let r=e*t,s=mj[r];if(s===void 0&&(s=new Float32Array(r),mj[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function gi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function _i(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function yx(n,e){let t=gj[e];t===void 0&&(t=new Int32Array(e),gj[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Kue(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Zue(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;n.uniform2fv(this.addr,e),_i(t,e)}}function Jue(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(gi(t,e))return;n.uniform3fv(this.addr,e),_i(t,e)}}function Que(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;n.uniform4fv(this.addr,e),_i(t,e)}}function ede(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(gi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),_i(t,e)}else{if(gi(t,i))return;vj.set(i),n.uniformMatrix2fv(this.addr,!1,vj),_i(t,i)}}function tde(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(gi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),_i(t,e)}else{if(gi(t,i))return;yj.set(i),n.uniformMatrix3fv(this.addr,!1,yj),_i(t,i)}}function nde(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(gi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),_i(t,e)}else{if(gi(t,i))return;_j.set(i),n.uniformMatrix4fv(this.addr,!1,_j),_i(t,i)}}function ide(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function rde(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;n.uniform2iv(this.addr,e),_i(t,e)}}function sde(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(gi(t,e))return;n.uniform3iv(this.addr,e),_i(t,e)}}function ode(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;n.uniform4iv(this.addr,e),_i(t,e)}}function ade(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function cde(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(gi(t,e))return;n.uniform2uiv(this.addr,e),_i(t,e)}}function lde(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(gi(t,e))return;n.uniform3uiv(this.addr,e),_i(t,e)}}function ude(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(gi(t,e))return;n.uniform4uiv(this.addr,e),_i(t,e)}}function dde(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(pj.compareFunction=bP,s=pj):s=Pj,t.setTexture2D(e||s,r)}function hde(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Oj,r)}function fde(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||kj,r)}function pde(n,e,t){let i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Nj,r)}function mde(n){switch(n){case 5126:return Kue;case 35664:return Zue;case 35665:return Jue;case 35666:return Que;case 35674:return ede;case 35675:return tde;case 35676:return nde;case 5124:case 35670:return ide;case 35667:case 35671:return rde;case 35668:case 35672:return sde;case 35669:case 35673:return ode;case 5125:return ade;case 36294:return cde;case 36295:return lde;case 36296:return ude;case 35678:case 36198:case 36298:case 36306:case 35682:return dde;case 35679:case 36299:case 36307:return hde;case 35680:case 36300:case 36308:case 36293:return fde;case 36289:case 36303:case 36311:case 36292:return pde}}function gde(n,e){n.uniform1fv(this.addr,e)}function _de(n,e){let t=Af(e,this.size,2);n.uniform2fv(this.addr,t)}function yde(n,e){let t=Af(e,this.size,3);n.uniform3fv(this.addr,t)}function vde(n,e){let t=Af(e,this.size,4);n.uniform4fv(this.addr,t)}function bde(n,e){let t=Af(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Ede(n,e){let t=Af(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function wde(n,e){let t=Af(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function xde(n,e){n.uniform1iv(this.addr,e)}function Sde(n,e){n.uniform2iv(this.addr,e)}function Tde(n,e){n.uniform3iv(this.addr,e)}function Ide(n,e){n.uniform4iv(this.addr,e)}function Cde(n,e){n.uniform1uiv(this.addr,e)}function Mde(n,e){n.uniform2uiv(this.addr,e)}function Ade(n,e){n.uniform3uiv(this.addr,e)}function Dde(n,e){n.uniform4uiv(this.addr,e)}function Rde(n,e,t){let i=this.cache,r=e.length,s=yx(t,r);gi(i,s)||(n.uniform1iv(this.addr,s),_i(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||Pj,s[o])}function Pde(n,e,t){let i=this.cache,r=e.length,s=yx(t,r);gi(i,s)||(n.uniform1iv(this.addr,s),_i(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Oj,s[o])}function Nde(n,e,t){let i=this.cache,r=e.length,s=yx(t,r);gi(i,s)||(n.uniform1iv(this.addr,s),_i(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||kj,s[o])}function Ode(n,e,t){let i=this.cache,r=e.length,s=yx(t,r);gi(i,s)||(n.uniform1iv(this.addr,s),_i(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Nj,s[o])}function kde(n){switch(n){case 5126:return gde;case 35664:return _de;case 35665:return yde;case 35666:return vde;case 35674:return bde;case 35675:return Ede;case 35676:return wde;case 5124:case 35670:return xde;case 35667:case 35671:return Sde;case 35668:case 35672:return Tde;case 35669:case 35673:return Ide;case 5125:return Cde;case 36294:return Mde;case 36295:return Ade;case 36296:return Dde;case 35678:case 36198:case 36298:case 36306:case 35682:return Rde;case 35679:case 36299:case 36307:return Pde;case 35680:case 36300:case 36308:case 36293:return Nde;case 36289:case 36303:case 36311:case 36292:return Ode}}var NP=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=mde(t.type)}},OP=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=kde(t.type)}},kP=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],i)}}},PP=/(\w+)(\])?(\[|\.)?/g;function bj(n,e){n.seq.push(e),n.map[e.id]=e}function Lde(n,e,t){let i=n.name,r=i.length;for(PP.lastIndex=0;;){let s=PP.exec(i),o=PP.lastIndex,a=s[1],c=s[2]==="]",l=s[3];if(c&&(a=a|0),l===void 0||l==="["&&o+2===r){bj(t,l===void 0?new NP(a,n,e):new OP(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new kP(a),bj(t,d)),t=d}}}var Mf=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);Lde(s,o,this)}}setValue(e,t,i,r){let s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){let r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],c=i[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){let i=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&i.push(o)}return i}};function Ej(n,e,t){let i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}var Fde=37297,Vde=0;function Ude(n,e){let t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}var wj=new Mt;function Bde(n){Kt._getMatrix(wj,Kt.workingColorSpace,n);let e=`mat3( ${wj.elements.map(t=>t.toFixed(4))} )`;switch(Kt.getTransfer(n)){case Tg:return[e,"LinearTransferOETF"];case fn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function xj(n,e,t){let i=n.getShaderParameter(e,n.COMPILE_STATUS),s=(n.getShaderInfoLog(e)||"").trim();if(i&&s==="")return"";let o=/ERROR: 0:(\d+)/.exec(s);if(o){let a=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+Ude(n.getShaderSource(e),a)}else return s}function zde(n,e){let t=Bde(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function Hde(n,e){let t;switch(e){case U5:t="Linear";break;case B5:t="Reinhard";break;case z5:t="Cineon";break;case H5:t="ACESFilmic";break;case G5:t="AgX";break;case W5:t="Neutral";break;case j5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var mx=new q;function jde(){Kt.getLuminanceCoefficients(mx);let n=mx.x.toFixed(4),e=mx.y.toFixed(4),t=mx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Gde(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Zg).join(`
`)}function Wde(n){let e=[];for(let t in n){let i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function $de(n,e){let t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let s=n.getActiveAttrib(e,r),o=s.name,a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Zg(n){return n!==""}function Sj(n,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Tj(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var qde=/^[ \t]*#include +<([\w\d./]+)>/gm;function LP(n){return n.replace(qde,Yde)}var Xde=new Map;function Yde(n,e){let t=Rt[e];if(t===void 0){let i=Xde.get(e);if(i!==void 0)t=Rt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return LP(t)}var Kde=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ij(n){return n.replace(Kde,Zde)}function Zde(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Cj(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Jde(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===aP?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===y5?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Io&&(e="SHADOWMAP_TYPE_VSM"),e}function Qde(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case zu:case Hu:e="ENVMAP_TYPE_CUBE";break;case Gg:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ehe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Hu:e="ENVMAP_MODE_REFRACTION";break}return e}function the(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case dP:e="ENVMAP_BLENDING_MULTIPLY";break;case F5:e="ENVMAP_BLENDING_MIX";break;case V5:e="ENVMAP_BLENDING_ADD";break}return e}function nhe(n){let e=n.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}function ihe(n,e,t,i){let r=n.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,c=Jde(t),l=Qde(t),u=ehe(t),d=the(t),h=nhe(t),p=Gde(t),g=Wde(s),y=r.createProgram(),m,_,I=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Zg).join(`
`),m.length>0&&(m+=`
`),_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Zg).join(`
`),_.length>0&&(_+=`
`)):(m=[Cj(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zg).join(`
`),_=[Cj(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Na?"#define TONE_MAPPING":"",t.toneMapping!==Na?Rt.tonemapping_pars_fragment:"",t.toneMapping!==Na?Hde("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Rt.colorspace_pars_fragment,zde("linearToOutputTexel",t.outputColorSpace),jde(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Zg).join(`
`)),o=LP(o),o=Sj(o,t),o=Tj(o,t),a=LP(a),a=Sj(a,t),a=Tj(a,t),o=Ij(o),a=Ij(a),t.isRawShaderMaterial!==!0&&(I=`#version 300 es
`,m=[p,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,_=["#define varying in",t.glslVersion===EP?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===EP?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);let M=I+m+o,C=I+_+a,P=Ej(r,r.VERTEX_SHADER,M),N=Ej(r,r.FRAGMENT_SHADER,C);r.attachShader(y,P),r.attachShader(y,N),t.index0AttributeName!==void 0?r.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);function S(T){if(n.debug.checkShaderErrors){let R=r.getProgramInfoLog(y)||"",A=r.getShaderInfoLog(P)||"",ne=r.getShaderInfoLog(N)||"",Y=R.trim(),J=A.trim(),re=ne.trim(),K=!0,fe=!0;if(r.getProgramParameter(y,r.LINK_STATUS)===!1)if(K=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,y,P,N);else{let Se=xj(r,P,"vertex"),Ge=xj(r,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,r.VALIDATE_STATUS)+`

Material Name: `+T.name+`
Material Type: `+T.type+`

Program Info Log: `+Y+`
`+Se+`
`+Ge)}else Y!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Y):(J===""||re==="")&&(fe=!1);fe&&(T.diagnostics={runnable:K,programLog:Y,vertexShader:{log:J,prefix:m},fragmentShader:{log:re,prefix:_}})}r.deleteShader(P),r.deleteShader(N),w=new Mf(r,y),b=$de(r,y)}let w;this.getUniforms=function(){return w===void 0&&S(this),w};let b;this.getAttributes=function(){return b===void 0&&S(this),b};let E=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return E===!1&&(E=r.getProgramParameter(y,Fde)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Vde++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=P,this.fragmentShader=N,this}var rhe=0,FP=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new VP(e),t.set(e,i)),i}},VP=class{constructor(e){this.id=rhe++,this.code=e,this.usedTimes=0}};function she(n,e,t,i,r,s,o){let a=new Dg,c=new FP,l=new Set,u=[],d=r.logarithmicDepthBuffer,h=r.vertexTextures,p=r.precision,g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(b){return l.add(b),b===0?"uv":`uv${b}`}function m(b,E,T,R,A){let ne=R.fog,Y=A.geometry,J=b.isMeshStandardMaterial?R.environment:null,re=(b.isMeshStandardMaterial?t:e).get(b.envMap||J),K=re&&re.mapping===Gg?re.image.height:null,fe=g[b.type];b.precision!==null&&(p=r.getMaxPrecision(b.precision),p!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",p,"instead."));let Se=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,Ge=Se!==void 0?Se.length:0,nt=0;Y.morphAttributes.position!==void 0&&(nt=1),Y.morphAttributes.normal!==void 0&&(nt=2),Y.morphAttributes.color!==void 0&&(nt=3);let ct,jt,Ct,oe;if(fe){let Xt=Ao[fe];ct=Xt.vertexShader,jt=Xt.fragmentShader}else ct=b.vertexShader,jt=b.fragmentShader,c.update(b),Ct=c.getVertexShaderID(b),oe=c.getFragmentShaderID(b);let de=n.getRenderTarget(),Be=n.state.buffers.depth.getReversed(),dt=A.isInstancedMesh===!0,Xe=A.isBatchedMesh===!0,Pt=!!b.map,Qn=!!b.matcap,V=!!re,pn=!!b.aoMap,pt=!!b.lightMap,ot=!!b.bumpMap,ze=!!b.normalMap,En=!!b.displacementMap,He=!!b.emissiveMap,xt=!!b.metalnessMap,Un=!!b.roughnessMap,Mn=b.anisotropy>0,L=b.clearcoat>0,D=b.dispersion>0,X=b.iridescence>0,se=b.sheen>0,ce=b.transmission>0,ee=Mn&&!!b.anisotropyMap,We=L&&!!b.clearcoatMap,ve=L&&!!b.clearcoatNormalMap,$e=L&&!!b.clearcoatRoughnessMap,Ye=X&&!!b.iridescenceMap,ge=X&&!!b.iridescenceThicknessMap,Ae=se&&!!b.sheenColorMap,rt=se&&!!b.sheenRoughnessMap,qe=!!b.specularMap,Te=!!b.specularColorMap,St=!!b.specularIntensityMap,z=ce&&!!b.transmissionMap,_e=ce&&!!b.thicknessMap,be=!!b.gradientMap,Oe=!!b.alphaMap,pe=b.alphaTest>0,le=!!b.alphaHash,Fe=!!b.extensions,mt=Na;b.toneMapped&&(de===null||de.isXRRenderTarget===!0)&&(mt=n.toneMapping);let Qt={shaderID:fe,shaderType:b.type,shaderName:b.name,vertexShader:ct,fragmentShader:jt,defines:b.defines,customVertexShaderID:Ct,customFragmentShaderID:oe,isRawShaderMaterial:b.isRawShaderMaterial===!0,glslVersion:b.glslVersion,precision:p,batching:Xe,batchingColor:Xe&&A._colorsTexture!==null,instancing:dt,instancingColor:dt&&A.instanceColor!==null,instancingMorph:dt&&A.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:de===null?n.outputColorSpace:de.isXRRenderTarget===!0?de.texture.colorSpace:Fu,alphaToCoverage:!!b.alphaToCoverage,map:Pt,matcap:Qn,envMap:V,envMapMode:V&&re.mapping,envMapCubeUVHeight:K,aoMap:pn,lightMap:pt,bumpMap:ot,normalMap:ze,displacementMap:h&&En,emissiveMap:He,normalMapObjectSpace:ze&&b.normalMapType===K5,normalMapTangentSpace:ze&&b.normalMapType===Y5,metalnessMap:xt,roughnessMap:Un,anisotropy:Mn,anisotropyMap:ee,clearcoat:L,clearcoatMap:We,clearcoatNormalMap:ve,clearcoatRoughnessMap:$e,dispersion:D,iridescence:X,iridescenceMap:Ye,iridescenceThicknessMap:ge,sheen:se,sheenColorMap:Ae,sheenRoughnessMap:rt,specularMap:qe,specularColorMap:Te,specularIntensityMap:St,transmission:ce,transmissionMap:z,thicknessMap:_e,gradientMap:be,opaque:b.transparent===!1&&b.blending===ku&&b.alphaToCoverage===!1,alphaMap:Oe,alphaTest:pe,alphaHash:le,combine:b.combine,mapUv:Pt&&y(b.map.channel),aoMapUv:pn&&y(b.aoMap.channel),lightMapUv:pt&&y(b.lightMap.channel),bumpMapUv:ot&&y(b.bumpMap.channel),normalMapUv:ze&&y(b.normalMap.channel),displacementMapUv:En&&y(b.displacementMap.channel),emissiveMapUv:He&&y(b.emissiveMap.channel),metalnessMapUv:xt&&y(b.metalnessMap.channel),roughnessMapUv:Un&&y(b.roughnessMap.channel),anisotropyMapUv:ee&&y(b.anisotropyMap.channel),clearcoatMapUv:We&&y(b.clearcoatMap.channel),clearcoatNormalMapUv:ve&&y(b.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$e&&y(b.clearcoatRoughnessMap.channel),iridescenceMapUv:Ye&&y(b.iridescenceMap.channel),iridescenceThicknessMapUv:ge&&y(b.iridescenceThicknessMap.channel),sheenColorMapUv:Ae&&y(b.sheenColorMap.channel),sheenRoughnessMapUv:rt&&y(b.sheenRoughnessMap.channel),specularMapUv:qe&&y(b.specularMap.channel),specularColorMapUv:Te&&y(b.specularColorMap.channel),specularIntensityMapUv:St&&y(b.specularIntensityMap.channel),transmissionMapUv:z&&y(b.transmissionMap.channel),thicknessMapUv:_e&&y(b.thicknessMap.channel),alphaMapUv:Oe&&y(b.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(ze||Mn),vertexColors:b.vertexColors,vertexAlphas:b.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:A.isPoints===!0&&!!Y.attributes.uv&&(Pt||Oe),fog:!!ne,useFog:b.fog===!0,fogExp2:!!ne&&ne.isFogExp2,flatShading:b.flatShading===!0&&b.wireframe===!1,sizeAttenuation:b.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:Be,skinning:A.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:Ge,morphTextureStride:nt,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&T.length>0,shadowMapType:n.shadowMap.type,toneMapping:mt,decodeVideoTexture:Pt&&b.map.isVideoTexture===!0&&Kt.getTransfer(b.map.colorSpace)===fn,decodeVideoTextureEmissive:He&&b.emissiveMap.isVideoTexture===!0&&Kt.getTransfer(b.emissiveMap.colorSpace)===fn,premultipliedAlpha:b.premultipliedAlpha,doubleSided:b.side===Co,flipSided:b.side===_r,useDepthPacking:b.depthPacking>=0,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionClipCullDistance:Fe&&b.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Fe&&b.extensions.multiDraw===!0||Xe)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:b.customProgramCacheKey()};return Qt.vertexUv1s=l.has(1),Qt.vertexUv2s=l.has(2),Qt.vertexUv3s=l.has(3),l.clear(),Qt}function _(b){let E=[];if(b.shaderID?E.push(b.shaderID):(E.push(b.customVertexShaderID),E.push(b.customFragmentShaderID)),b.defines!==void 0)for(let T in b.defines)E.push(T),E.push(b.defines[T]);return b.isRawShaderMaterial===!1&&(I(E,b),M(E,b),E.push(n.outputColorSpace)),E.push(b.customProgramCacheKey),E.join()}function I(b,E){b.push(E.precision),b.push(E.outputColorSpace),b.push(E.envMapMode),b.push(E.envMapCubeUVHeight),b.push(E.mapUv),b.push(E.alphaMapUv),b.push(E.lightMapUv),b.push(E.aoMapUv),b.push(E.bumpMapUv),b.push(E.normalMapUv),b.push(E.displacementMapUv),b.push(E.emissiveMapUv),b.push(E.metalnessMapUv),b.push(E.roughnessMapUv),b.push(E.anisotropyMapUv),b.push(E.clearcoatMapUv),b.push(E.clearcoatNormalMapUv),b.push(E.clearcoatRoughnessMapUv),b.push(E.iridescenceMapUv),b.push(E.iridescenceThicknessMapUv),b.push(E.sheenColorMapUv),b.push(E.sheenRoughnessMapUv),b.push(E.specularMapUv),b.push(E.specularColorMapUv),b.push(E.specularIntensityMapUv),b.push(E.transmissionMapUv),b.push(E.thicknessMapUv),b.push(E.combine),b.push(E.fogExp2),b.push(E.sizeAttenuation),b.push(E.morphTargetsCount),b.push(E.morphAttributeCount),b.push(E.numDirLights),b.push(E.numPointLights),b.push(E.numSpotLights),b.push(E.numSpotLightMaps),b.push(E.numHemiLights),b.push(E.numRectAreaLights),b.push(E.numDirLightShadows),b.push(E.numPointLightShadows),b.push(E.numSpotLightShadows),b.push(E.numSpotLightShadowsWithMaps),b.push(E.numLightProbes),b.push(E.shadowMapType),b.push(E.toneMapping),b.push(E.numClippingPlanes),b.push(E.numClipIntersection),b.push(E.depthPacking)}function M(b,E){a.disableAll(),E.supportsVertexTextures&&a.enable(0),E.instancing&&a.enable(1),E.instancingColor&&a.enable(2),E.instancingMorph&&a.enable(3),E.matcap&&a.enable(4),E.envMap&&a.enable(5),E.normalMapObjectSpace&&a.enable(6),E.normalMapTangentSpace&&a.enable(7),E.clearcoat&&a.enable(8),E.iridescence&&a.enable(9),E.alphaTest&&a.enable(10),E.vertexColors&&a.enable(11),E.vertexAlphas&&a.enable(12),E.vertexUv1s&&a.enable(13),E.vertexUv2s&&a.enable(14),E.vertexUv3s&&a.enable(15),E.vertexTangents&&a.enable(16),E.anisotropy&&a.enable(17),E.alphaHash&&a.enable(18),E.batching&&a.enable(19),E.dispersion&&a.enable(20),E.batchingColor&&a.enable(21),E.gradientMap&&a.enable(22),b.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.reversedDepthBuffer&&a.enable(4),E.skinning&&a.enable(5),E.morphTargets&&a.enable(6),E.morphNormals&&a.enable(7),E.morphColors&&a.enable(8),E.premultipliedAlpha&&a.enable(9),E.shadowMapEnabled&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.transmission&&a.enable(15),E.sheen&&a.enable(16),E.opaque&&a.enable(17),E.pointsUvs&&a.enable(18),E.decodeVideoTexture&&a.enable(19),E.decodeVideoTextureEmissive&&a.enable(20),E.alphaToCoverage&&a.enable(21),b.push(a.mask)}function C(b){let E=g[b.type],T;if(E){let R=Ao[E];T=aj.clone(R.uniforms)}else T=b.uniforms;return T}function P(b,E){let T;for(let R=0,A=u.length;R<A;R++){let ne=u[R];if(ne.cacheKey===E){T=ne,++T.usedTimes;break}}return T===void 0&&(T=new ihe(n,E,b,s),u.push(T)),T}function N(b){if(--b.usedTimes===0){let E=u.indexOf(b);u[E]=u[u.length-1],u.pop(),b.destroy()}}function S(b){c.remove(b)}function w(){c.dispose()}return{getParameters:m,getProgramCacheKey:_,getUniforms:C,acquireProgram:P,releaseProgram:N,releaseShaderCache:S,programs:u,dispose:w}}function ohe(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,c){n.get(o)[a]=c}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function ahe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Mj(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Aj(){let n=[],e=0,t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,h,p,g,y,m){let _=n[e];return _===void 0?(_={id:d.id,object:d,geometry:h,material:p,groupOrder:g,renderOrder:d.renderOrder,z:y,group:m},n[e]=_):(_.id=d.id,_.object=d,_.geometry=h,_.material=p,_.groupOrder=g,_.renderOrder=d.renderOrder,_.z=y,_.group=m),e++,_}function a(d,h,p,g,y,m){let _=o(d,h,p,g,y,m);p.transmission>0?i.push(_):p.transparent===!0?r.push(_):t.push(_)}function c(d,h,p,g,y,m){let _=o(d,h,p,g,y,m);p.transmission>0?i.unshift(_):p.transparent===!0?r.unshift(_):t.unshift(_)}function l(d,h){t.length>1&&t.sort(d||ahe),i.length>1&&i.sort(h||Mj),r.length>1&&r.sort(h||Mj)}function u(){for(let d=e,h=n.length;d<h;d++){let p=n[d];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:c,finish:u,sort:l}}function che(){let n=new WeakMap;function e(i,r){let s=n.get(i),o;return s===void 0?(o=new Aj,n.set(i,[o])):r>=s.length?(o=new Aj,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function lhe(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new q,color:new qt};break;case"SpotLight":t={position:new q,direction:new q,color:new qt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new q,color:new qt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new q,skyColor:new qt,groundColor:new qt};break;case"RectAreaLight":t={color:new qt,position:new q,halfWidth:new q,halfHeight:new q};break}return n[e.id]=t,t}}}function uhe(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}var dhe=0;function hhe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function fhe(n){let e=new lhe,t=uhe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)i.probe.push(new q);let r=new q,s=new Vn,o=new Vn;function a(l){let u=0,d=0,h=0;for(let b=0;b<9;b++)i.probe[b].set(0,0,0);let p=0,g=0,y=0,m=0,_=0,I=0,M=0,C=0,P=0,N=0,S=0;l.sort(hhe);for(let b=0,E=l.length;b<E;b++){let T=l[b],R=T.color,A=T.intensity,ne=T.distance,Y=T.shadow&&T.shadow.map?T.shadow.map.texture:null;if(T.isAmbientLight)u+=R.r*A,d+=R.g*A,h+=R.b*A;else if(T.isLightProbe){for(let J=0;J<9;J++)i.probe[J].addScaledVector(T.sh.coefficients[J],A);S++}else if(T.isDirectionalLight){let J=e.get(T);if(J.color.copy(T.color).multiplyScalar(T.intensity),T.castShadow){let re=T.shadow,K=t.get(T);K.shadowIntensity=re.intensity,K.shadowBias=re.bias,K.shadowNormalBias=re.normalBias,K.shadowRadius=re.radius,K.shadowMapSize=re.mapSize,i.directionalShadow[p]=K,i.directionalShadowMap[p]=Y,i.directionalShadowMatrix[p]=T.shadow.matrix,I++}i.directional[p]=J,p++}else if(T.isSpotLight){let J=e.get(T);J.position.setFromMatrixPosition(T.matrixWorld),J.color.copy(R).multiplyScalar(A),J.distance=ne,J.coneCos=Math.cos(T.angle),J.penumbraCos=Math.cos(T.angle*(1-T.penumbra)),J.decay=T.decay,i.spot[y]=J;let re=T.shadow;if(T.map&&(i.spotLightMap[P]=T.map,P++,re.updateMatrices(T),T.castShadow&&N++),i.spotLightMatrix[y]=re.matrix,T.castShadow){let K=t.get(T);K.shadowIntensity=re.intensity,K.shadowBias=re.bias,K.shadowNormalBias=re.normalBias,K.shadowRadius=re.radius,K.shadowMapSize=re.mapSize,i.spotShadow[y]=K,i.spotShadowMap[y]=Y,C++}y++}else if(T.isRectAreaLight){let J=e.get(T);J.color.copy(R).multiplyScalar(A),J.halfWidth.set(T.width*.5,0,0),J.halfHeight.set(0,T.height*.5,0),i.rectArea[m]=J,m++}else if(T.isPointLight){let J=e.get(T);if(J.color.copy(T.color).multiplyScalar(T.intensity),J.distance=T.distance,J.decay=T.decay,T.castShadow){let re=T.shadow,K=t.get(T);K.shadowIntensity=re.intensity,K.shadowBias=re.bias,K.shadowNormalBias=re.normalBias,K.shadowRadius=re.radius,K.shadowMapSize=re.mapSize,K.shadowCameraNear=re.camera.near,K.shadowCameraFar=re.camera.far,i.pointShadow[g]=K,i.pointShadowMap[g]=Y,i.pointShadowMatrix[g]=T.shadow.matrix,M++}i.point[g]=J,g++}else if(T.isHemisphereLight){let J=e.get(T);J.skyColor.copy(T.color).multiplyScalar(A),J.groundColor.copy(T.groundColor).multiplyScalar(A),i.hemi[_]=J,_++}}m>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Me.LTC_FLOAT_1,i.rectAreaLTC2=Me.LTC_FLOAT_2):(i.rectAreaLTC1=Me.LTC_HALF_1,i.rectAreaLTC2=Me.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=d,i.ambient[2]=h;let w=i.hash;(w.directionalLength!==p||w.pointLength!==g||w.spotLength!==y||w.rectAreaLength!==m||w.hemiLength!==_||w.numDirectionalShadows!==I||w.numPointShadows!==M||w.numSpotShadows!==C||w.numSpotMaps!==P||w.numLightProbes!==S)&&(i.directional.length=p,i.spot.length=y,i.rectArea.length=m,i.point.length=g,i.hemi.length=_,i.directionalShadow.length=I,i.directionalShadowMap.length=I,i.pointShadow.length=M,i.pointShadowMap.length=M,i.spotShadow.length=C,i.spotShadowMap.length=C,i.directionalShadowMatrix.length=I,i.pointShadowMatrix.length=M,i.spotLightMatrix.length=C+P-N,i.spotLightMap.length=P,i.numSpotLightShadowsWithMaps=N,i.numLightProbes=S,w.directionalLength=p,w.pointLength=g,w.spotLength=y,w.rectAreaLength=m,w.hemiLength=_,w.numDirectionalShadows=I,w.numPointShadows=M,w.numSpotShadows=C,w.numSpotMaps=P,w.numLightProbes=S,i.version=dhe++)}function c(l,u){let d=0,h=0,p=0,g=0,y=0,m=u.matrixWorldInverse;for(let _=0,I=l.length;_<I;_++){let M=l[_];if(M.isDirectionalLight){let C=i.directional[d];C.direction.setFromMatrixPosition(M.matrixWorld),r.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(r),C.direction.transformDirection(m),d++}else if(M.isSpotLight){let C=i.spot[p];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(m),C.direction.setFromMatrixPosition(M.matrixWorld),r.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(r),C.direction.transformDirection(m),p++}else if(M.isRectAreaLight){let C=i.rectArea[g];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(m),o.identity(),s.copy(M.matrixWorld),s.premultiply(m),o.extractRotation(s),C.halfWidth.set(M.width*.5,0,0),C.halfHeight.set(0,M.height*.5,0),C.halfWidth.applyMatrix4(o),C.halfHeight.applyMatrix4(o),g++}else if(M.isPointLight){let C=i.point[h];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(m),h++}else if(M.isHemisphereLight){let C=i.hemi[y];C.direction.setFromMatrixPosition(M.matrixWorld),C.direction.transformDirection(m),y++}}}return{setup:a,setupView:c,state:i}}function Dj(n){let e=new fhe(n),t=[],i=[];function r(u){l.camera=u,t.length=0,i.length=0}function s(u){t.push(u)}function o(u){i.push(u)}function a(){e.setup(t)}function c(u){e.setupView(t,u)}let l={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:a,setupLightsView:c,pushLight:s,pushShadow:o}}function phe(n){let e=new WeakMap;function t(r,s=0){let o=e.get(r),a;return o===void 0?(a=new Dj(n),e.set(r,[a])):s>=o.length?(a=new Dj(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}var mhe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ghe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function _he(n,e,t){let i=new bf,r=new Zt,s=new Zt,o=new hn,a=new dw({depthPacking:X5}),c=new hw,l={},u=t.maxTextureSize,d={[Aa]:_r,[_r]:Aa,[Co]:Co},h=new Ls({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Zt},radius:{value:4}},vertexShader:mhe,fragmentShader:ghe}),p=h.clone();p.defines.HORIZONTAL_PASS=1;let g=new us;g.setAttribute("position",new jr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let y=new gr(g,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aP;let _=this.type;this.render=function(N,S,w){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||N.length===0)return;let b=n.getRenderTarget(),E=n.getActiveCubeFace(),T=n.getActiveMipmapLevel(),R=n.state;R.setBlending(Pa),R.buffers.depth.getReversed()===!0?R.buffers.color.setClear(0,0,0,0):R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);let A=_!==Io&&this.type===Io,ne=_===Io&&this.type!==Io;for(let Y=0,J=N.length;Y<J;Y++){let re=N[Y],K=re.shadow;if(K===void 0){console.warn("THREE.WebGLShadowMap:",re,"has no shadow.");continue}if(K.autoUpdate===!1&&K.needsUpdate===!1)continue;r.copy(K.mapSize);let fe=K.getFrameExtents();if(r.multiply(fe),s.copy(K.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/fe.x),r.x=s.x*fe.x,K.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/fe.y),r.y=s.y*fe.y,K.mapSize.y=s.y)),K.map===null||A===!0||ne===!0){let Ge=this.type!==Io?{minFilter:ls,magFilter:ls}:{};K.map!==null&&K.map.dispose(),K.map=new To(r.x,r.y,Ge),K.map.texture.name=re.name+".shadowMap",K.camera.updateProjectionMatrix()}n.setRenderTarget(K.map),n.clear();let Se=K.getViewportCount();for(let Ge=0;Ge<Se;Ge++){let nt=K.getViewport(Ge);o.set(s.x*nt.x,s.y*nt.y,s.x*nt.z,s.y*nt.w),R.viewport(o),K.updateMatrices(re,Ge),i=K.getFrustum(),C(S,w,K.camera,re,this.type)}K.isPointLightShadow!==!0&&this.type===Io&&I(K,w),K.needsUpdate=!1}_=this.type,m.needsUpdate=!1,n.setRenderTarget(b,E,T)};function I(N,S){let w=e.update(y);h.defines.VSM_SAMPLES!==N.blurSamples&&(h.defines.VSM_SAMPLES=N.blurSamples,p.defines.VSM_SAMPLES=N.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new To(r.x,r.y)),h.uniforms.shadow_pass.value=N.map.texture,h.uniforms.resolution.value=N.mapSize,h.uniforms.radius.value=N.radius,n.setRenderTarget(N.mapPass),n.clear(),n.renderBufferDirect(S,null,w,h,y,null),p.uniforms.shadow_pass.value=N.mapPass.texture,p.uniforms.resolution.value=N.mapSize,p.uniforms.radius.value=N.radius,n.setRenderTarget(N.map),n.clear(),n.renderBufferDirect(S,null,w,p,y,null)}function M(N,S,w,b){let E=null,T=w.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(T!==void 0)E=T;else if(E=w.isPointLight===!0?c:a,n.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0||S.alphaToCoverage===!0){let R=E.uuid,A=S.uuid,ne=l[R];ne===void 0&&(ne={},l[R]=ne);let Y=ne[A];Y===void 0&&(Y=E.clone(),ne[A]=Y,S.addEventListener("dispose",P)),E=Y}if(E.visible=S.visible,E.wireframe=S.wireframe,b===Io?E.side=S.shadowSide!==null?S.shadowSide:S.side:E.side=S.shadowSide!==null?S.shadowSide:d[S.side],E.alphaMap=S.alphaMap,E.alphaTest=S.alphaToCoverage===!0?.5:S.alphaTest,E.map=S.map,E.clipShadows=S.clipShadows,E.clippingPlanes=S.clippingPlanes,E.clipIntersection=S.clipIntersection,E.displacementMap=S.displacementMap,E.displacementScale=S.displacementScale,E.displacementBias=S.displacementBias,E.wireframeLinewidth=S.wireframeLinewidth,E.linewidth=S.linewidth,w.isPointLight===!0&&E.isMeshDistanceMaterial===!0){let R=n.properties.get(E);R.light=w}return E}function C(N,S,w,b,E){if(N.visible===!1)return;if(N.layers.test(S.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&E===Io)&&(!N.frustumCulled||i.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,N.matrixWorld);let A=e.update(N),ne=N.material;if(Array.isArray(ne)){let Y=A.groups;for(let J=0,re=Y.length;J<re;J++){let K=Y[J],fe=ne[K.materialIndex];if(fe&&fe.visible){let Se=M(N,fe,b,E);N.onBeforeShadow(n,N,S,w,A,Se,K),n.renderBufferDirect(w,null,A,Se,N,K),N.onAfterShadow(n,N,S,w,A,Se,K)}}}else if(ne.visible){let Y=M(N,ne,b,E);N.onBeforeShadow(n,N,S,w,A,Y,null),n.renderBufferDirect(w,null,A,Y,N,null),N.onAfterShadow(n,N,S,w,A,Y,null)}}let R=N.children;for(let A=0,ne=R.length;A<ne;A++)C(R[A],S,w,b,E)}function P(N){N.target.removeEventListener("dispose",P);for(let w in l){let b=l[w],E=N.target.uuid;E in b&&(b[E].dispose(),delete b[E])}}}var yhe={[xw]:Sw,[Tw]:Mw,[Iw]:Aw,[Lu]:Cw,[Sw]:xw,[Mw]:Tw,[Aw]:Iw,[Cw]:Lu};function vhe(n,e){function t(){let z=!1,_e=new hn,be=null,Oe=new hn(0,0,0,0);return{setMask:function(pe){be!==pe&&!z&&(n.colorMask(pe,pe,pe,pe),be=pe)},setLocked:function(pe){z=pe},setClear:function(pe,le,Fe,mt,Qt){Qt===!0&&(pe*=mt,le*=mt,Fe*=mt),_e.set(pe,le,Fe,mt),Oe.equals(_e)===!1&&(n.clearColor(pe,le,Fe,mt),Oe.copy(_e))},reset:function(){z=!1,be=null,Oe.set(-1,0,0,0)}}}function i(){let z=!1,_e=!1,be=null,Oe=null,pe=null;return{setReversed:function(le){if(_e!==le){let Fe=e.get("EXT_clip_control");le?Fe.clipControlEXT(Fe.LOWER_LEFT_EXT,Fe.ZERO_TO_ONE_EXT):Fe.clipControlEXT(Fe.LOWER_LEFT_EXT,Fe.NEGATIVE_ONE_TO_ONE_EXT),_e=le;let mt=pe;pe=null,this.setClear(mt)}},getReversed:function(){return _e},setTest:function(le){le?de(n.DEPTH_TEST):Be(n.DEPTH_TEST)},setMask:function(le){be!==le&&!z&&(n.depthMask(le),be=le)},setFunc:function(le){if(_e&&(le=yhe[le]),Oe!==le){switch(le){case xw:n.depthFunc(n.NEVER);break;case Sw:n.depthFunc(n.ALWAYS);break;case Tw:n.depthFunc(n.LESS);break;case Lu:n.depthFunc(n.LEQUAL);break;case Iw:n.depthFunc(n.EQUAL);break;case Cw:n.depthFunc(n.GEQUAL);break;case Mw:n.depthFunc(n.GREATER);break;case Aw:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Oe=le}},setLocked:function(le){z=le},setClear:function(le){pe!==le&&(_e&&(le=1-le),n.clearDepth(le),pe=le)},reset:function(){z=!1,be=null,Oe=null,pe=null,_e=!1}}}function r(){let z=!1,_e=null,be=null,Oe=null,pe=null,le=null,Fe=null,mt=null,Qt=null;return{setTest:function(Xt){z||(Xt?de(n.STENCIL_TEST):Be(n.STENCIL_TEST))},setMask:function(Xt){_e!==Xt&&!z&&(n.stencilMask(Xt),_e=Xt)},setFunc:function(Xt,nr,Cr){(be!==Xt||Oe!==nr||pe!==Cr)&&(n.stencilFunc(Xt,nr,Cr),be=Xt,Oe=nr,pe=Cr)},setOp:function(Xt,nr,Cr){(le!==Xt||Fe!==nr||mt!==Cr)&&(n.stencilOp(Xt,nr,Cr),le=Xt,Fe=nr,mt=Cr)},setLocked:function(Xt){z=Xt},setClear:function(Xt){Qt!==Xt&&(n.clearStencil(Xt),Qt=Xt)},reset:function(){z=!1,_e=null,be=null,Oe=null,pe=null,le=null,Fe=null,mt=null,Qt=null}}}let s=new t,o=new i,a=new r,c=new WeakMap,l=new WeakMap,u={},d={},h=new WeakMap,p=[],g=null,y=!1,m=null,_=null,I=null,M=null,C=null,P=null,N=null,S=new qt(0,0,0),w=0,b=!1,E=null,T=null,R=null,A=null,ne=null,Y=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),J=!1,re=0,K=n.getParameter(n.VERSION);K.indexOf("WebGL")!==-1?(re=parseFloat(/^WebGL (\d)/.exec(K)[1]),J=re>=1):K.indexOf("OpenGL ES")!==-1&&(re=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),J=re>=2);let fe=null,Se={},Ge=n.getParameter(n.SCISSOR_BOX),nt=n.getParameter(n.VIEWPORT),ct=new hn().fromArray(Ge),jt=new hn().fromArray(nt);function Ct(z,_e,be,Oe){let pe=new Uint8Array(4),le=n.createTexture();n.bindTexture(z,le),n.texParameteri(z,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(z,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Fe=0;Fe<be;Fe++)z===n.TEXTURE_3D||z===n.TEXTURE_2D_ARRAY?n.texImage3D(_e,0,n.RGBA,1,1,Oe,0,n.RGBA,n.UNSIGNED_BYTE,pe):n.texImage2D(_e+Fe,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,pe);return le}let oe={};oe[n.TEXTURE_2D]=Ct(n.TEXTURE_2D,n.TEXTURE_2D,1),oe[n.TEXTURE_CUBE_MAP]=Ct(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),oe[n.TEXTURE_2D_ARRAY]=Ct(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),oe[n.TEXTURE_3D]=Ct(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),de(n.DEPTH_TEST),o.setFunc(Lu),ot(!1),ze(oP),de(n.CULL_FACE),pn(Pa);function de(z){u[z]!==!0&&(n.enable(z),u[z]=!0)}function Be(z){u[z]!==!1&&(n.disable(z),u[z]=!1)}function dt(z,_e){return d[z]!==_e?(n.bindFramebuffer(z,_e),d[z]=_e,z===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=_e),z===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=_e),!0):!1}function Xe(z,_e){let be=p,Oe=!1;if(z){be=h.get(_e),be===void 0&&(be=[],h.set(_e,be));let pe=z.textures;if(be.length!==pe.length||be[0]!==n.COLOR_ATTACHMENT0){for(let le=0,Fe=pe.length;le<Fe;le++)be[le]=n.COLOR_ATTACHMENT0+le;be.length=pe.length,Oe=!0}}else be[0]!==n.BACK&&(be[0]=n.BACK,Oe=!0);Oe&&n.drawBuffers(be)}function Pt(z){return g!==z?(n.useProgram(z),g=z,!0):!1}let Qn={[tl]:n.FUNC_ADD,[b5]:n.FUNC_SUBTRACT,[E5]:n.FUNC_REVERSE_SUBTRACT};Qn[w5]=n.MIN,Qn[x5]=n.MAX;let V={[S5]:n.ZERO,[T5]:n.ONE,[I5]:n.SRC_COLOR,[QE]:n.SRC_ALPHA,[P5]:n.SRC_ALPHA_SATURATE,[D5]:n.DST_COLOR,[M5]:n.DST_ALPHA,[C5]:n.ONE_MINUS_SRC_COLOR,[ew]:n.ONE_MINUS_SRC_ALPHA,[R5]:n.ONE_MINUS_DST_COLOR,[A5]:n.ONE_MINUS_DST_ALPHA,[N5]:n.CONSTANT_COLOR,[O5]:n.ONE_MINUS_CONSTANT_COLOR,[k5]:n.CONSTANT_ALPHA,[L5]:n.ONE_MINUS_CONSTANT_ALPHA};function pn(z,_e,be,Oe,pe,le,Fe,mt,Qt,Xt){if(z===Pa){y===!0&&(Be(n.BLEND),y=!1);return}if(y===!1&&(de(n.BLEND),y=!0),z!==v5){if(z!==m||Xt!==b){if((_!==tl||C!==tl)&&(n.blendEquation(n.FUNC_ADD),_=tl,C=tl),Xt)switch(z){case ku:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case cP:n.blendFunc(n.ONE,n.ONE);break;case lP:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case uP:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}else switch(z){case ku:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case cP:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case lP:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case uP:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}I=null,M=null,P=null,N=null,S.set(0,0,0),w=0,m=z,b=Xt}return}pe=pe||_e,le=le||be,Fe=Fe||Oe,(_e!==_||pe!==C)&&(n.blendEquationSeparate(Qn[_e],Qn[pe]),_=_e,C=pe),(be!==I||Oe!==M||le!==P||Fe!==N)&&(n.blendFuncSeparate(V[be],V[Oe],V[le],V[Fe]),I=be,M=Oe,P=le,N=Fe),(mt.equals(S)===!1||Qt!==w)&&(n.blendColor(mt.r,mt.g,mt.b,Qt),S.copy(mt),w=Qt),m=z,b=!1}function pt(z,_e){z.side===Co?Be(n.CULL_FACE):de(n.CULL_FACE);let be=z.side===_r;_e&&(be=!be),ot(be),z.blending===ku&&z.transparent===!1?pn(Pa):pn(z.blending,z.blendEquation,z.blendSrc,z.blendDst,z.blendEquationAlpha,z.blendSrcAlpha,z.blendDstAlpha,z.blendColor,z.blendAlpha,z.premultipliedAlpha),o.setFunc(z.depthFunc),o.setTest(z.depthTest),o.setMask(z.depthWrite),s.setMask(z.colorWrite);let Oe=z.stencilWrite;a.setTest(Oe),Oe&&(a.setMask(z.stencilWriteMask),a.setFunc(z.stencilFunc,z.stencilRef,z.stencilFuncMask),a.setOp(z.stencilFail,z.stencilZFail,z.stencilZPass)),He(z.polygonOffset,z.polygonOffsetFactor,z.polygonOffsetUnits),z.alphaToCoverage===!0?de(n.SAMPLE_ALPHA_TO_COVERAGE):Be(n.SAMPLE_ALPHA_TO_COVERAGE)}function ot(z){E!==z&&(z?n.frontFace(n.CW):n.frontFace(n.CCW),E=z)}function ze(z){z!==g5?(de(n.CULL_FACE),z!==T&&(z===oP?n.cullFace(n.BACK):z===_5?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Be(n.CULL_FACE),T=z}function En(z){z!==R&&(J&&n.lineWidth(z),R=z)}function He(z,_e,be){z?(de(n.POLYGON_OFFSET_FILL),(A!==_e||ne!==be)&&(n.polygonOffset(_e,be),A=_e,ne=be)):Be(n.POLYGON_OFFSET_FILL)}function xt(z){z?de(n.SCISSOR_TEST):Be(n.SCISSOR_TEST)}function Un(z){z===void 0&&(z=n.TEXTURE0+Y-1),fe!==z&&(n.activeTexture(z),fe=z)}function Mn(z,_e,be){be===void 0&&(fe===null?be=n.TEXTURE0+Y-1:be=fe);let Oe=Se[be];Oe===void 0&&(Oe={type:void 0,texture:void 0},Se[be]=Oe),(Oe.type!==z||Oe.texture!==_e)&&(fe!==be&&(n.activeTexture(be),fe=be),n.bindTexture(z,_e||oe[z]),Oe.type=z,Oe.texture=_e)}function L(){let z=Se[fe];z!==void 0&&z.type!==void 0&&(n.bindTexture(z.type,null),z.type=void 0,z.texture=void 0)}function D(){try{n.compressedTexImage2D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function X(){try{n.compressedTexImage3D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function se(){try{n.texSubImage2D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ce(){try{n.texSubImage3D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ee(){try{n.compressedTexSubImage2D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function We(){try{n.compressedTexSubImage3D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ve(){try{n.texStorage2D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function $e(){try{n.texStorage3D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Ye(){try{n.texImage2D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ge(){try{n.texImage3D(...arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Ae(z){ct.equals(z)===!1&&(n.scissor(z.x,z.y,z.z,z.w),ct.copy(z))}function rt(z){jt.equals(z)===!1&&(n.viewport(z.x,z.y,z.z,z.w),jt.copy(z))}function qe(z,_e){let be=l.get(_e);be===void 0&&(be=new WeakMap,l.set(_e,be));let Oe=be.get(z);Oe===void 0&&(Oe=n.getUniformBlockIndex(_e,z.name),be.set(z,Oe))}function Te(z,_e){let Oe=l.get(_e).get(z);c.get(_e)!==Oe&&(n.uniformBlockBinding(_e,Oe,z.__bindingPointIndex),c.set(_e,Oe))}function St(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},fe=null,Se={},d={},h=new WeakMap,p=[],g=null,y=!1,m=null,_=null,I=null,M=null,C=null,P=null,N=null,S=new qt(0,0,0),w=0,b=!1,E=null,T=null,R=null,A=null,ne=null,ct.set(0,0,n.canvas.width,n.canvas.height),jt.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:de,disable:Be,bindFramebuffer:dt,drawBuffers:Xe,useProgram:Pt,setBlending:pn,setMaterial:pt,setFlipSided:ot,setCullFace:ze,setLineWidth:En,setPolygonOffset:He,setScissorTest:xt,activeTexture:Un,bindTexture:Mn,unbindTexture:L,compressedTexImage2D:D,compressedTexImage3D:X,texImage2D:Ye,texImage3D:ge,updateUBOMapping:qe,uniformBlockBinding:Te,texStorage2D:ve,texStorage3D:$e,texSubImage2D:se,texSubImage3D:ce,compressedTexSubImage2D:ee,compressedTexSubImage3D:We,scissor:Ae,viewport:rt,reset:St}}function bhe(n,e,t,i,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new Zt,u=new WeakMap,d,h=new WeakMap,p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(L,D){return p?new OffscreenCanvas(L,D):Cg("canvas")}function y(L,D,X){let se=1,ce=Mn(L);if((ce.width>X||ce.height>X)&&(se=X/Math.max(ce.width,ce.height)),se<1)if(typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&L instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&L instanceof ImageBitmap||typeof VideoFrame<"u"&&L instanceof VideoFrame){let ee=Math.floor(se*ce.width),We=Math.floor(se*ce.height);d===void 0&&(d=g(ee,We));let ve=D?g(ee,We):d;return ve.width=ee,ve.height=We,ve.getContext("2d").drawImage(L,0,0,ee,We),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+ee+"x"+We+")."),ve}else return"data"in L&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),L;return L}function m(L){return L.generateMipmaps}function _(L){n.generateMipmap(L)}function I(L){return L.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:L.isWebGL3DRenderTarget?n.TEXTURE_3D:L.isWebGLArrayRenderTarget||L.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function M(L,D,X,se,ce=!1){if(L!==null){if(n[L]!==void 0)return n[L];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+L+"'")}let ee=D;if(D===n.RED&&(X===n.FLOAT&&(ee=n.R32F),X===n.HALF_FLOAT&&(ee=n.R16F),X===n.UNSIGNED_BYTE&&(ee=n.R8)),D===n.RED_INTEGER&&(X===n.UNSIGNED_BYTE&&(ee=n.R8UI),X===n.UNSIGNED_SHORT&&(ee=n.R16UI),X===n.UNSIGNED_INT&&(ee=n.R32UI),X===n.BYTE&&(ee=n.R8I),X===n.SHORT&&(ee=n.R16I),X===n.INT&&(ee=n.R32I)),D===n.RG&&(X===n.FLOAT&&(ee=n.RG32F),X===n.HALF_FLOAT&&(ee=n.RG16F),X===n.UNSIGNED_BYTE&&(ee=n.RG8)),D===n.RG_INTEGER&&(X===n.UNSIGNED_BYTE&&(ee=n.RG8UI),X===n.UNSIGNED_SHORT&&(ee=n.RG16UI),X===n.UNSIGNED_INT&&(ee=n.RG32UI),X===n.BYTE&&(ee=n.RG8I),X===n.SHORT&&(ee=n.RG16I),X===n.INT&&(ee=n.RG32I)),D===n.RGB_INTEGER&&(X===n.UNSIGNED_BYTE&&(ee=n.RGB8UI),X===n.UNSIGNED_SHORT&&(ee=n.RGB16UI),X===n.UNSIGNED_INT&&(ee=n.RGB32UI),X===n.BYTE&&(ee=n.RGB8I),X===n.SHORT&&(ee=n.RGB16I),X===n.INT&&(ee=n.RGB32I)),D===n.RGBA_INTEGER&&(X===n.UNSIGNED_BYTE&&(ee=n.RGBA8UI),X===n.UNSIGNED_SHORT&&(ee=n.RGBA16UI),X===n.UNSIGNED_INT&&(ee=n.RGBA32UI),X===n.BYTE&&(ee=n.RGBA8I),X===n.SHORT&&(ee=n.RGBA16I),X===n.INT&&(ee=n.RGBA32I)),D===n.RGB&&(X===n.UNSIGNED_INT_5_9_9_9_REV&&(ee=n.RGB9_E5),X===n.UNSIGNED_INT_10F_11F_11F_REV&&(ee=n.R11F_G11F_B10F)),D===n.RGBA){let We=ce?Tg:Kt.getTransfer(se);X===n.FLOAT&&(ee=n.RGBA32F),X===n.HALF_FLOAT&&(ee=n.RGBA16F),X===n.UNSIGNED_BYTE&&(ee=We===fn?n.SRGB8_ALPHA8:n.RGBA8),X===n.UNSIGNED_SHORT_4_4_4_4&&(ee=n.RGBA4),X===n.UNSIGNED_SHORT_5_5_5_1&&(ee=n.RGB5_A1)}return(ee===n.R16F||ee===n.R32F||ee===n.RG16F||ee===n.RG32F||ee===n.RGBA16F||ee===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ee}function C(L,D){let X;return L?D===null||D===ll||D===Sf?X=n.DEPTH24_STENCIL8:D===Mo?X=n.DEPTH32F_STENCIL8:D===wf&&(X=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):D===null||D===ll||D===Sf?X=n.DEPTH_COMPONENT24:D===Mo?X=n.DEPTH_COMPONENT32F:D===wf&&(X=n.DEPTH_COMPONENT16),X}function P(L,D){return m(L)===!0||L.isFramebufferTexture&&L.minFilter!==ls&&L.minFilter!==ks?Math.log2(Math.max(D.width,D.height))+1:L.mipmaps!==void 0&&L.mipmaps.length>0?L.mipmaps.length:L.isCompressedTexture&&Array.isArray(L.image)?D.mipmaps.length:1}function N(L){let D=L.target;D.removeEventListener("dispose",N),w(D),D.isVideoTexture&&u.delete(D)}function S(L){let D=L.target;D.removeEventListener("dispose",S),E(D)}function w(L){let D=i.get(L);if(D.__webglInit===void 0)return;let X=L.source,se=h.get(X);if(se){let ce=se[D.__cacheKey];ce.usedTimes--,ce.usedTimes===0&&b(L),Object.keys(se).length===0&&h.delete(X)}i.remove(L)}function b(L){let D=i.get(L);n.deleteTexture(D.__webglTexture);let X=L.source,se=h.get(X);delete se[D.__cacheKey],o.memory.textures--}function E(L){let D=i.get(L);if(L.depthTexture&&(L.depthTexture.dispose(),i.remove(L.depthTexture)),L.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(D.__webglFramebuffer[se]))for(let ce=0;ce<D.__webglFramebuffer[se].length;ce++)n.deleteFramebuffer(D.__webglFramebuffer[se][ce]);else n.deleteFramebuffer(D.__webglFramebuffer[se]);D.__webglDepthbuffer&&n.deleteRenderbuffer(D.__webglDepthbuffer[se])}else{if(Array.isArray(D.__webglFramebuffer))for(let se=0;se<D.__webglFramebuffer.length;se++)n.deleteFramebuffer(D.__webglFramebuffer[se]);else n.deleteFramebuffer(D.__webglFramebuffer);if(D.__webglDepthbuffer&&n.deleteRenderbuffer(D.__webglDepthbuffer),D.__webglMultisampledFramebuffer&&n.deleteFramebuffer(D.__webglMultisampledFramebuffer),D.__webglColorRenderbuffer)for(let se=0;se<D.__webglColorRenderbuffer.length;se++)D.__webglColorRenderbuffer[se]&&n.deleteRenderbuffer(D.__webglColorRenderbuffer[se]);D.__webglDepthRenderbuffer&&n.deleteRenderbuffer(D.__webglDepthRenderbuffer)}let X=L.textures;for(let se=0,ce=X.length;se<ce;se++){let ee=i.get(X[se]);ee.__webglTexture&&(n.deleteTexture(ee.__webglTexture),o.memory.textures--),i.remove(X[se])}i.remove(L)}let T=0;function R(){T=0}function A(){let L=T;return L>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+L+" texture units while this GPU supports only "+r.maxTextures),T+=1,L}function ne(L){let D=[];return D.push(L.wrapS),D.push(L.wrapT),D.push(L.wrapR||0),D.push(L.magFilter),D.push(L.minFilter),D.push(L.anisotropy),D.push(L.internalFormat),D.push(L.format),D.push(L.type),D.push(L.generateMipmaps),D.push(L.premultiplyAlpha),D.push(L.flipY),D.push(L.unpackAlignment),D.push(L.colorSpace),D.join()}function Y(L,D){let X=i.get(L);if(L.isVideoTexture&&xt(L),L.isRenderTargetTexture===!1&&L.isExternalTexture!==!0&&L.version>0&&X.__version!==L.version){let se=L.image;if(se===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(se.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(X,L,D);return}}else L.isExternalTexture&&(X.__webglTexture=L.sourceTexture?L.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,X.__webglTexture,n.TEXTURE0+D)}function J(L,D){let X=i.get(L);if(L.isRenderTargetTexture===!1&&L.version>0&&X.__version!==L.version){oe(X,L,D);return}t.bindTexture(n.TEXTURE_2D_ARRAY,X.__webglTexture,n.TEXTURE0+D)}function re(L,D){let X=i.get(L);if(L.isRenderTargetTexture===!1&&L.version>0&&X.__version!==L.version){oe(X,L,D);return}t.bindTexture(n.TEXTURE_3D,X.__webglTexture,n.TEXTURE0+D)}function K(L,D){let X=i.get(L);if(L.version>0&&X.__version!==L.version){de(X,L,D);return}t.bindTexture(n.TEXTURE_CUBE_MAP,X.__webglTexture,n.TEXTURE0+D)}let fe={[tw]:n.REPEAT,[el]:n.CLAMP_TO_EDGE,[nw]:n.MIRRORED_REPEAT},Se={[ls]:n.NEAREST,[$5]:n.NEAREST_MIPMAP_NEAREST,[Wg]:n.NEAREST_MIPMAP_LINEAR,[ks]:n.LINEAR,[Pw]:n.LINEAR_MIPMAP_NEAREST,[cl]:n.LINEAR_MIPMAP_LINEAR},Ge={[Z5]:n.NEVER,[ij]:n.ALWAYS,[J5]:n.LESS,[bP]:n.LEQUAL,[Q5]:n.EQUAL,[nj]:n.GEQUAL,[ej]:n.GREATER,[tj]:n.NOTEQUAL};function nt(L,D){if(D.type===Mo&&e.has("OES_texture_float_linear")===!1&&(D.magFilter===ks||D.magFilter===Pw||D.magFilter===Wg||D.magFilter===cl||D.minFilter===ks||D.minFilter===Pw||D.minFilter===Wg||D.minFilter===cl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(L,n.TEXTURE_WRAP_S,fe[D.wrapS]),n.texParameteri(L,n.TEXTURE_WRAP_T,fe[D.wrapT]),(L===n.TEXTURE_3D||L===n.TEXTURE_2D_ARRAY)&&n.texParameteri(L,n.TEXTURE_WRAP_R,fe[D.wrapR]),n.texParameteri(L,n.TEXTURE_MAG_FILTER,Se[D.magFilter]),n.texParameteri(L,n.TEXTURE_MIN_FILTER,Se[D.minFilter]),D.compareFunction&&(n.texParameteri(L,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(L,n.TEXTURE_COMPARE_FUNC,Ge[D.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(D.magFilter===ls||D.minFilter!==Wg&&D.minFilter!==cl||D.type===Mo&&e.has("OES_texture_float_linear")===!1)return;if(D.anisotropy>1||i.get(D).__currentAnisotropy){let X=e.get("EXT_texture_filter_anisotropic");n.texParameterf(L,X.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,r.getMaxAnisotropy())),i.get(D).__currentAnisotropy=D.anisotropy}}}function ct(L,D){let X=!1;L.__webglInit===void 0&&(L.__webglInit=!0,D.addEventListener("dispose",N));let se=D.source,ce=h.get(se);ce===void 0&&(ce={},h.set(se,ce));let ee=ne(D);if(ee!==L.__cacheKey){ce[ee]===void 0&&(ce[ee]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,X=!0),ce[ee].usedTimes++;let We=ce[L.__cacheKey];We!==void 0&&(ce[L.__cacheKey].usedTimes--,We.usedTimes===0&&b(D)),L.__cacheKey=ee,L.__webglTexture=ce[ee].texture}return X}function jt(L,D,X){return Math.floor(Math.floor(L/X)/D)}function Ct(L,D,X,se){let ee=L.updateRanges;if(ee.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,D.width,D.height,X,se,D.data);else{ee.sort((ge,Ae)=>ge.start-Ae.start);let We=0;for(let ge=1;ge<ee.length;ge++){let Ae=ee[We],rt=ee[ge],qe=Ae.start+Ae.count,Te=jt(rt.start,D.width,4),St=jt(Ae.start,D.width,4);rt.start<=qe+1&&Te===St&&jt(rt.start+rt.count-1,D.width,4)===Te?Ae.count=Math.max(Ae.count,rt.start+rt.count-Ae.start):(++We,ee[We]=rt)}ee.length=We+1;let ve=n.getParameter(n.UNPACK_ROW_LENGTH),$e=n.getParameter(n.UNPACK_SKIP_PIXELS),Ye=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,D.width);for(let ge=0,Ae=ee.length;ge<Ae;ge++){let rt=ee[ge],qe=Math.floor(rt.start/4),Te=Math.ceil(rt.count/4),St=qe%D.width,z=Math.floor(qe/D.width),_e=Te,be=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,St),n.pixelStorei(n.UNPACK_SKIP_ROWS,z),t.texSubImage2D(n.TEXTURE_2D,0,St,z,_e,be,X,se,D.data)}L.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,ve),n.pixelStorei(n.UNPACK_SKIP_PIXELS,$e),n.pixelStorei(n.UNPACK_SKIP_ROWS,Ye)}}function oe(L,D,X){let se=n.TEXTURE_2D;(D.isDataArrayTexture||D.isCompressedArrayTexture)&&(se=n.TEXTURE_2D_ARRAY),D.isData3DTexture&&(se=n.TEXTURE_3D);let ce=ct(L,D),ee=D.source;t.bindTexture(se,L.__webglTexture,n.TEXTURE0+X);let We=i.get(ee);if(ee.version!==We.__version||ce===!0){t.activeTexture(n.TEXTURE0+X);let ve=Kt.getPrimaries(Kt.workingColorSpace),$e=D.colorSpace===Oa?null:Kt.getPrimaries(D.colorSpace),Ye=D.colorSpace===Oa||ve===$e?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,D.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,D.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ye);let ge=y(D.image,!1,r.maxTextureSize);ge=Un(D,ge);let Ae=s.convert(D.format,D.colorSpace),rt=s.convert(D.type),qe=M(D.internalFormat,Ae,rt,D.colorSpace,D.isVideoTexture);nt(se,D);let Te,St=D.mipmaps,z=D.isVideoTexture!==!0,_e=We.__version===void 0||ce===!0,be=ee.dataReady,Oe=P(D,ge);if(D.isDepthTexture)qe=C(D.format===Tf,D.type),_e&&(z?t.texStorage2D(n.TEXTURE_2D,1,qe,ge.width,ge.height):t.texImage2D(n.TEXTURE_2D,0,qe,ge.width,ge.height,0,Ae,rt,null));else if(D.isDataTexture)if(St.length>0){z&&_e&&t.texStorage2D(n.TEXTURE_2D,Oe,qe,St[0].width,St[0].height);for(let pe=0,le=St.length;pe<le;pe++)Te=St[pe],z?be&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,Te.width,Te.height,Ae,rt,Te.data):t.texImage2D(n.TEXTURE_2D,pe,qe,Te.width,Te.height,0,Ae,rt,Te.data);D.generateMipmaps=!1}else z?(_e&&t.texStorage2D(n.TEXTURE_2D,Oe,qe,ge.width,ge.height),be&&Ct(D,ge,Ae,rt)):t.texImage2D(n.TEXTURE_2D,0,qe,ge.width,ge.height,0,Ae,rt,ge.data);else if(D.isCompressedTexture)if(D.isCompressedArrayTexture){z&&_e&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,qe,St[0].width,St[0].height,ge.depth);for(let pe=0,le=St.length;pe<le;pe++)if(Te=St[pe],D.format!==ds)if(Ae!==null)if(z){if(be)if(D.layerUpdates.size>0){let Fe=IP(Te.width,Te.height,D.format,D.type);for(let mt of D.layerUpdates){let Qt=Te.data.subarray(mt*Fe/Te.data.BYTES_PER_ELEMENT,(mt+1)*Fe/Te.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,mt,Te.width,Te.height,1,Ae,Qt)}D.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,0,Te.width,Te.height,ge.depth,Ae,Te.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,pe,qe,Te.width,Te.height,ge.depth,0,Te.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else z?be&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,0,Te.width,Te.height,ge.depth,Ae,rt,Te.data):t.texImage3D(n.TEXTURE_2D_ARRAY,pe,qe,Te.width,Te.height,ge.depth,0,Ae,rt,Te.data)}else{z&&_e&&t.texStorage2D(n.TEXTURE_2D,Oe,qe,St[0].width,St[0].height);for(let pe=0,le=St.length;pe<le;pe++)Te=St[pe],D.format!==ds?Ae!==null?z?be&&t.compressedTexSubImage2D(n.TEXTURE_2D,pe,0,0,Te.width,Te.height,Ae,Te.data):t.compressedTexImage2D(n.TEXTURE_2D,pe,qe,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):z?be&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,Te.width,Te.height,Ae,rt,Te.data):t.texImage2D(n.TEXTURE_2D,pe,qe,Te.width,Te.height,0,Ae,rt,Te.data)}else if(D.isDataArrayTexture)if(z){if(_e&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Oe,qe,ge.width,ge.height,ge.depth),be)if(D.layerUpdates.size>0){let pe=IP(ge.width,ge.height,D.format,D.type);for(let le of D.layerUpdates){let Fe=ge.data.subarray(le*pe/ge.data.BYTES_PER_ELEMENT,(le+1)*pe/ge.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,le,ge.width,ge.height,1,Ae,rt,Fe)}D.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ge.width,ge.height,ge.depth,Ae,rt,ge.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,qe,ge.width,ge.height,ge.depth,0,Ae,rt,ge.data);else if(D.isData3DTexture)z?(_e&&t.texStorage3D(n.TEXTURE_3D,Oe,qe,ge.width,ge.height,ge.depth),be&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ge.width,ge.height,ge.depth,Ae,rt,ge.data)):t.texImage3D(n.TEXTURE_3D,0,qe,ge.width,ge.height,ge.depth,0,Ae,rt,ge.data);else if(D.isFramebufferTexture){if(_e)if(z)t.texStorage2D(n.TEXTURE_2D,Oe,qe,ge.width,ge.height);else{let pe=ge.width,le=ge.height;for(let Fe=0;Fe<Oe;Fe++)t.texImage2D(n.TEXTURE_2D,Fe,qe,pe,le,0,Ae,rt,null),pe>>=1,le>>=1}}else if(St.length>0){if(z&&_e){let pe=Mn(St[0]);t.texStorage2D(n.TEXTURE_2D,Oe,qe,pe.width,pe.height)}for(let pe=0,le=St.length;pe<le;pe++)Te=St[pe],z?be&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,Ae,rt,Te):t.texImage2D(n.TEXTURE_2D,pe,qe,Ae,rt,Te);D.generateMipmaps=!1}else if(z){if(_e){let pe=Mn(ge);t.texStorage2D(n.TEXTURE_2D,Oe,qe,pe.width,pe.height)}be&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ae,rt,ge)}else t.texImage2D(n.TEXTURE_2D,0,qe,Ae,rt,ge);m(D)&&_(se),We.__version=ee.version,D.onUpdate&&D.onUpdate(D)}L.__version=D.version}function de(L,D,X){if(D.image.length!==6)return;let se=ct(L,D),ce=D.source;t.bindTexture(n.TEXTURE_CUBE_MAP,L.__webglTexture,n.TEXTURE0+X);let ee=i.get(ce);if(ce.version!==ee.__version||se===!0){t.activeTexture(n.TEXTURE0+X);let We=Kt.getPrimaries(Kt.workingColorSpace),ve=D.colorSpace===Oa?null:Kt.getPrimaries(D.colorSpace),$e=D.colorSpace===Oa||We===ve?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,D.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,D.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$e);let Ye=D.isCompressedTexture||D.image[0].isCompressedTexture,ge=D.image[0]&&D.image[0].isDataTexture,Ae=[];for(let le=0;le<6;le++)!Ye&&!ge?Ae[le]=y(D.image[le],!0,r.maxCubemapSize):Ae[le]=ge?D.image[le].image:D.image[le],Ae[le]=Un(D,Ae[le]);let rt=Ae[0],qe=s.convert(D.format,D.colorSpace),Te=s.convert(D.type),St=M(D.internalFormat,qe,Te,D.colorSpace),z=D.isVideoTexture!==!0,_e=ee.__version===void 0||se===!0,be=ce.dataReady,Oe=P(D,rt);nt(n.TEXTURE_CUBE_MAP,D);let pe;if(Ye){z&&_e&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Oe,St,rt.width,rt.height);for(let le=0;le<6;le++){pe=Ae[le].mipmaps;for(let Fe=0;Fe<pe.length;Fe++){let mt=pe[Fe];D.format!==ds?qe!==null?z?be&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe,0,0,mt.width,mt.height,qe,mt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe,St,mt.width,mt.height,0,mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):z?be&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe,0,0,mt.width,mt.height,qe,Te,mt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe,St,mt.width,mt.height,0,qe,Te,mt.data)}}}else{if(pe=D.mipmaps,z&&_e){pe.length>0&&Oe++;let le=Mn(Ae[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Oe,St,le.width,le.height)}for(let le=0;le<6;le++)if(ge){z?be&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,0,0,Ae[le].width,Ae[le].height,qe,Te,Ae[le].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,St,Ae[le].width,Ae[le].height,0,qe,Te,Ae[le].data);for(let Fe=0;Fe<pe.length;Fe++){let Qt=pe[Fe].image[le].image;z?be&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe+1,0,0,Qt.width,Qt.height,qe,Te,Qt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe+1,St,Qt.width,Qt.height,0,qe,Te,Qt.data)}}else{z?be&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,0,0,qe,Te,Ae[le]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,St,qe,Te,Ae[le]);for(let Fe=0;Fe<pe.length;Fe++){let mt=pe[Fe];z?be&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe+1,0,0,qe,Te,mt.image[le]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+le,Fe+1,St,qe,Te,mt.image[le])}}}m(D)&&_(n.TEXTURE_CUBE_MAP),ee.__version=ce.version,D.onUpdate&&D.onUpdate(D)}L.__version=D.version}function Be(L,D,X,se,ce,ee){let We=s.convert(X.format,X.colorSpace),ve=s.convert(X.type),$e=M(X.internalFormat,We,ve,X.colorSpace),Ye=i.get(D),ge=i.get(X);if(ge.__renderTarget=D,!Ye.__hasExternalTextures){let Ae=Math.max(1,D.width>>ee),rt=Math.max(1,D.height>>ee);ce===n.TEXTURE_3D||ce===n.TEXTURE_2D_ARRAY?t.texImage3D(ce,ee,$e,Ae,rt,D.depth,0,We,ve,null):t.texImage2D(ce,ee,$e,Ae,rt,0,We,ve,null)}t.bindFramebuffer(n.FRAMEBUFFER,L),He(D)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,se,ce,ge.__webglTexture,0,En(D)):(ce===n.TEXTURE_2D||ce>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ce<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,se,ce,ge.__webglTexture,ee),t.bindFramebuffer(n.FRAMEBUFFER,null)}function dt(L,D,X){if(n.bindRenderbuffer(n.RENDERBUFFER,L),D.depthBuffer){let se=D.depthTexture,ce=se&&se.isDepthTexture?se.type:null,ee=C(D.stencilBuffer,ce),We=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ve=En(D);He(D)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ve,ee,D.width,D.height):X?n.renderbufferStorageMultisample(n.RENDERBUFFER,ve,ee,D.width,D.height):n.renderbufferStorage(n.RENDERBUFFER,ee,D.width,D.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,We,n.RENDERBUFFER,L)}else{let se=D.textures;for(let ce=0;ce<se.length;ce++){let ee=se[ce],We=s.convert(ee.format,ee.colorSpace),ve=s.convert(ee.type),$e=M(ee.internalFormat,We,ve,ee.colorSpace),Ye=En(D);X&&He(D)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ye,$e,D.width,D.height):He(D)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ye,$e,D.width,D.height):n.renderbufferStorage(n.RENDERBUFFER,$e,D.width,D.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Xe(L,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,L),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let se=i.get(D.depthTexture);se.__renderTarget=D,(!se.__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),Y(D.depthTexture,0);let ce=se.__webglTexture,ee=En(D);if(D.depthTexture.format===gf)He(D)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ce,0,ee):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ce,0);else if(D.depthTexture.format===Tf)He(D)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ce,0,ee):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ce,0);else throw new Error("Unknown depthTexture format")}function Pt(L){let D=i.get(L),X=L.isWebGLCubeRenderTarget===!0;if(D.__boundDepthTexture!==L.depthTexture){let se=L.depthTexture;if(D.__depthDisposeCallback&&D.__depthDisposeCallback(),se){let ce=()=>{delete D.__boundDepthTexture,delete D.__depthDisposeCallback,se.removeEventListener("dispose",ce)};se.addEventListener("dispose",ce),D.__depthDisposeCallback=ce}D.__boundDepthTexture=se}if(L.depthTexture&&!D.__autoAllocateDepthBuffer){if(X)throw new Error("target.depthTexture not supported in Cube render targets");let se=L.texture.mipmaps;se&&se.length>0?Xe(D.__webglFramebuffer[0],L):Xe(D.__webglFramebuffer,L)}else if(X){D.__webglDepthbuffer=[];for(let se=0;se<6;se++)if(t.bindFramebuffer(n.FRAMEBUFFER,D.__webglFramebuffer[se]),D.__webglDepthbuffer[se]===void 0)D.__webglDepthbuffer[se]=n.createRenderbuffer(),dt(D.__webglDepthbuffer[se],L,!1);else{let ce=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ee=D.__webglDepthbuffer[se];n.bindRenderbuffer(n.RENDERBUFFER,ee),n.framebufferRenderbuffer(n.FRAMEBUFFER,ce,n.RENDERBUFFER,ee)}}else{let se=L.texture.mipmaps;if(se&&se.length>0?t.bindFramebuffer(n.FRAMEBUFFER,D.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,D.__webglFramebuffer),D.__webglDepthbuffer===void 0)D.__webglDepthbuffer=n.createRenderbuffer(),dt(D.__webglDepthbuffer,L,!1);else{let ce=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ee=D.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ee),n.framebufferRenderbuffer(n.FRAMEBUFFER,ce,n.RENDERBUFFER,ee)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qn(L,D,X){let se=i.get(L);D!==void 0&&Be(se.__webglFramebuffer,L,L.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),X!==void 0&&Pt(L)}function V(L){let D=L.texture,X=i.get(L),se=i.get(D);L.addEventListener("dispose",S);let ce=L.textures,ee=L.isWebGLCubeRenderTarget===!0,We=ce.length>1;if(We||(se.__webglTexture===void 0&&(se.__webglTexture=n.createTexture()),se.__version=D.version,o.memory.textures++),ee){X.__webglFramebuffer=[];for(let ve=0;ve<6;ve++)if(D.mipmaps&&D.mipmaps.length>0){X.__webglFramebuffer[ve]=[];for(let $e=0;$e<D.mipmaps.length;$e++)X.__webglFramebuffer[ve][$e]=n.createFramebuffer()}else X.__webglFramebuffer[ve]=n.createFramebuffer()}else{if(D.mipmaps&&D.mipmaps.length>0){X.__webglFramebuffer=[];for(let ve=0;ve<D.mipmaps.length;ve++)X.__webglFramebuffer[ve]=n.createFramebuffer()}else X.__webglFramebuffer=n.createFramebuffer();if(We)for(let ve=0,$e=ce.length;ve<$e;ve++){let Ye=i.get(ce[ve]);Ye.__webglTexture===void 0&&(Ye.__webglTexture=n.createTexture(),o.memory.textures++)}if(L.samples>0&&He(L)===!1){X.__webglMultisampledFramebuffer=n.createFramebuffer(),X.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,X.__webglMultisampledFramebuffer);for(let ve=0;ve<ce.length;ve++){let $e=ce[ve];X.__webglColorRenderbuffer[ve]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,X.__webglColorRenderbuffer[ve]);let Ye=s.convert($e.format,$e.colorSpace),ge=s.convert($e.type),Ae=M($e.internalFormat,Ye,ge,$e.colorSpace,L.isXRRenderTarget===!0),rt=En(L);n.renderbufferStorageMultisample(n.RENDERBUFFER,rt,Ae,L.width,L.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ve,n.RENDERBUFFER,X.__webglColorRenderbuffer[ve])}n.bindRenderbuffer(n.RENDERBUFFER,null),L.depthBuffer&&(X.__webglDepthRenderbuffer=n.createRenderbuffer(),dt(X.__webglDepthRenderbuffer,L,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ee){t.bindTexture(n.TEXTURE_CUBE_MAP,se.__webglTexture),nt(n.TEXTURE_CUBE_MAP,D);for(let ve=0;ve<6;ve++)if(D.mipmaps&&D.mipmaps.length>0)for(let $e=0;$e<D.mipmaps.length;$e++)Be(X.__webglFramebuffer[ve][$e],L,D,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,$e);else Be(X.__webglFramebuffer[ve],L,D,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0);m(D)&&_(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(We){for(let ve=0,$e=ce.length;ve<$e;ve++){let Ye=ce[ve],ge=i.get(Ye),Ae=n.TEXTURE_2D;(L.isWebGL3DRenderTarget||L.isWebGLArrayRenderTarget)&&(Ae=L.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ae,ge.__webglTexture),nt(Ae,Ye),Be(X.__webglFramebuffer,L,Ye,n.COLOR_ATTACHMENT0+ve,Ae,0),m(Ye)&&_(Ae)}t.unbindTexture()}else{let ve=n.TEXTURE_2D;if((L.isWebGL3DRenderTarget||L.isWebGLArrayRenderTarget)&&(ve=L.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(ve,se.__webglTexture),nt(ve,D),D.mipmaps&&D.mipmaps.length>0)for(let $e=0;$e<D.mipmaps.length;$e++)Be(X.__webglFramebuffer[$e],L,D,n.COLOR_ATTACHMENT0,ve,$e);else Be(X.__webglFramebuffer,L,D,n.COLOR_ATTACHMENT0,ve,0);m(D)&&_(ve),t.unbindTexture()}L.depthBuffer&&Pt(L)}function pn(L){let D=L.textures;for(let X=0,se=D.length;X<se;X++){let ce=D[X];if(m(ce)){let ee=I(L),We=i.get(ce).__webglTexture;t.bindTexture(ee,We),_(ee),t.unbindTexture()}}}let pt=[],ot=[];function ze(L){if(L.samples>0){if(He(L)===!1){let D=L.textures,X=L.width,se=L.height,ce=n.COLOR_BUFFER_BIT,ee=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,We=i.get(L),ve=D.length>1;if(ve)for(let Ye=0;Ye<D.length;Ye++)t.bindFramebuffer(n.FRAMEBUFFER,We.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ye,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,We.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ye,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,We.__webglMultisampledFramebuffer);let $e=L.texture.mipmaps;$e&&$e.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,We.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,We.__webglFramebuffer);for(let Ye=0;Ye<D.length;Ye++){if(L.resolveDepthBuffer&&(L.depthBuffer&&(ce|=n.DEPTH_BUFFER_BIT),L.stencilBuffer&&L.resolveStencilBuffer&&(ce|=n.STENCIL_BUFFER_BIT)),ve){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,We.__webglColorRenderbuffer[Ye]);let ge=i.get(D[Ye]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ge,0)}n.blitFramebuffer(0,0,X,se,0,0,X,se,ce,n.NEAREST),c===!0&&(pt.length=0,ot.length=0,pt.push(n.COLOR_ATTACHMENT0+Ye),L.depthBuffer&&L.resolveDepthBuffer===!1&&(pt.push(ee),ot.push(ee),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,ot)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,pt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ve)for(let Ye=0;Ye<D.length;Ye++){t.bindFramebuffer(n.FRAMEBUFFER,We.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ye,n.RENDERBUFFER,We.__webglColorRenderbuffer[Ye]);let ge=i.get(D[Ye]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,We.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ye,n.TEXTURE_2D,ge,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,We.__webglMultisampledFramebuffer)}else if(L.depthBuffer&&L.resolveDepthBuffer===!1&&c){let D=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[D])}}}function En(L){return Math.min(r.maxSamples,L.samples)}function He(L){let D=i.get(L);return L.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&D.__useRenderToTexture!==!1}function xt(L){let D=o.render.frame;u.get(L)!==D&&(u.set(L,D),L.update())}function Un(L,D){let X=L.colorSpace,se=L.format,ce=L.type;return L.isCompressedTexture===!0||L.isVideoTexture===!0||X!==Fu&&X!==Oa&&(Kt.getTransfer(X)===fn?(se!==ds||ce!==Fs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",X)),D}function Mn(L){return typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement?(l.width=L.naturalWidth||L.width,l.height=L.naturalHeight||L.height):typeof VideoFrame<"u"&&L instanceof VideoFrame?(l.width=L.displayWidth,l.height=L.displayHeight):(l.width=L.width,l.height=L.height),l}this.allocateTextureUnit=A,this.resetTextureUnits=R,this.setTexture2D=Y,this.setTexture2DArray=J,this.setTexture3D=re,this.setTextureCube=K,this.rebindTextures=Qn,this.setupRenderTarget=V,this.updateRenderTargetMipmap=pn,this.updateMultisampleRenderTarget=ze,this.setupDepthRenderbuffer=Pt,this.setupFrameBufferTexture=Be,this.useMultisampledRTT=He}function Ehe(n,e){function t(i,r=Oa){let s,o=Kt.getTransfer(r);if(i===Fs)return n.UNSIGNED_BYTE;if(i===Ow)return n.UNSIGNED_SHORT_4_4_4_4;if(i===kw)return n.UNSIGNED_SHORT_5_5_5_1;if(i===pP)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===mP)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===hP)return n.BYTE;if(i===fP)return n.SHORT;if(i===wf)return n.UNSIGNED_SHORT;if(i===Nw)return n.INT;if(i===ll)return n.UNSIGNED_INT;if(i===Mo)return n.FLOAT;if(i===xf)return n.HALF_FLOAT;if(i===gP)return n.ALPHA;if(i===_P)return n.RGB;if(i===ds)return n.RGBA;if(i===gf)return n.DEPTH_COMPONENT;if(i===Tf)return n.DEPTH_STENCIL;if(i===yP)return n.RED;if(i===Lw)return n.RED_INTEGER;if(i===vP)return n.RG;if(i===Fw)return n.RG_INTEGER;if(i===Vw)return n.RGBA_INTEGER;if(i===$g||i===qg||i===Xg||i===Yg)if(o===fn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===$g)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===qg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Xg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Yg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===$g)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===qg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Xg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Yg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===Uw||i===Bw||i===zw||i===Hw)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===Uw)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Bw)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===zw)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Hw)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===jw||i===Gw||i===Ww)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===jw||i===Gw)return o===fn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===Ww)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===$w||i===qw||i===Xw||i===Yw||i===Kw||i===Zw||i===Jw||i===Qw||i===ex||i===tx||i===nx||i===ix||i===rx||i===sx)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===$w)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===qw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Xw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Yw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Kw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===Zw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Jw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Qw)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===ex)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===tx)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===nx)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===ix)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===rx)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===sx)return o===fn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===ox||i===ax||i===cx)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===ox)return o===fn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===ax)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===cx)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===lx||i===ux||i===dx||i===hx)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===lx)return s.COMPRESSED_RED_RGTC1_EXT;if(i===ux)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===dx)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===hx)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===Sf?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}var whe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,xhe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,UP=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){let i=new Ug(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,i=new Ls({vertexShader:whe,fragmentShader:xhe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new gr(new zg(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},BP=class extends Da{constructor(e,t){super();let i=this,r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,d=null,h=null,p=null,g=null,y=typeof XRWebGLBinding<"u",m=new UP,_={},I=t.getContextAttributes(),M=null,C=null,P=[],N=[],S=new Zt,w=null,b=new Ui;b.viewport=new hn;let E=new Ui;E.viewport=new hn;let T=[b,E],R=new ww,A=null,ne=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){let de=P[oe];return de===void 0&&(de=new vf,P[oe]=de),de.getTargetRaySpace()},this.getControllerGrip=function(oe){let de=P[oe];return de===void 0&&(de=new vf,P[oe]=de),de.getGripSpace()},this.getHand=function(oe){let de=P[oe];return de===void 0&&(de=new vf,P[oe]=de),de.getHandSpace()};function Y(oe){let de=N.indexOf(oe.inputSource);if(de===-1)return;let Be=P[de];Be!==void 0&&(Be.update(oe.inputSource,oe.frame,l||o),Be.dispatchEvent({type:oe.type,data:oe.inputSource}))}function J(){r.removeEventListener("select",Y),r.removeEventListener("selectstart",Y),r.removeEventListener("selectend",Y),r.removeEventListener("squeeze",Y),r.removeEventListener("squeezestart",Y),r.removeEventListener("squeezeend",Y),r.removeEventListener("end",J),r.removeEventListener("inputsourceschange",re);for(let oe=0;oe<P.length;oe++){let de=N[oe];de!==null&&(N[oe]=null,P[oe].disconnect(de))}A=null,ne=null,m.reset();for(let oe in _)delete _[oe];e.setRenderTarget(M),p=null,h=null,d=null,r=null,C=null,Ct.stop(),i.isPresenting=!1,e.setPixelRatio(w),e.setSize(S.width,S.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(oe){s=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){a=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(oe){l=oe},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return d===null&&y&&(d=new XRWebGLBinding(r,t)),d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(oe){return U(this,null,function*(){if(r=oe,r!==null){if(M=e.getRenderTarget(),r.addEventListener("select",Y),r.addEventListener("selectstart",Y),r.addEventListener("selectend",Y),r.addEventListener("squeeze",Y),r.addEventListener("squeezestart",Y),r.addEventListener("squeezeend",Y),r.addEventListener("end",J),r.addEventListener("inputsourceschange",re),I.xrCompatible!==!0&&(yield t.makeXRCompatible()),w=e.getPixelRatio(),e.getSize(S),y&&"createProjectionLayer"in XRWebGLBinding.prototype){let Be=null,dt=null,Xe=null;I.depth&&(Xe=I.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Be=I.stencil?Tf:gf,dt=I.stencil?Sf:ll);let Pt={colorFormat:t.RGBA8,depthFormat:Xe,scaleFactor:s};d=this.getBinding(),h=d.createProjectionLayer(Pt),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),C=new To(h.textureWidth,h.textureHeight,{format:ds,type:Fs,depthTexture:new Vg(h.textureWidth,h.textureHeight,dt,void 0,void 0,void 0,void 0,void 0,void 0,Be),stencilBuffer:I.stencil,colorSpace:e.outputColorSpace,samples:I.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{let Be={antialias:I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,t,Be),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),C=new To(p.framebufferWidth,p.framebufferHeight,{format:ds,type:Fs,colorSpace:e.outputColorSpace,stencilBuffer:I.stencil,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}C.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),Ct.setContext(r),Ct.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};function re(oe){for(let de=0;de<oe.removed.length;de++){let Be=oe.removed[de],dt=N.indexOf(Be);dt>=0&&(N[dt]=null,P[dt].disconnect(Be))}for(let de=0;de<oe.added.length;de++){let Be=oe.added[de],dt=N.indexOf(Be);if(dt===-1){for(let Pt=0;Pt<P.length;Pt++)if(Pt>=N.length){N.push(Be),dt=Pt;break}else if(N[Pt]===null){N[Pt]=Be,dt=Pt;break}if(dt===-1)break}let Xe=P[dt];Xe&&Xe.connect(Be)}}let K=new q,fe=new q;function Se(oe,de,Be){K.setFromMatrixPosition(de.matrixWorld),fe.setFromMatrixPosition(Be.matrixWorld);let dt=K.distanceTo(fe),Xe=de.projectionMatrix.elements,Pt=Be.projectionMatrix.elements,Qn=Xe[14]/(Xe[10]-1),V=Xe[14]/(Xe[10]+1),pn=(Xe[9]+1)/Xe[5],pt=(Xe[9]-1)/Xe[5],ot=(Xe[8]-1)/Xe[0],ze=(Pt[8]+1)/Pt[0],En=Qn*ot,He=Qn*ze,xt=dt/(-ot+ze),Un=xt*-ot;if(de.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(Un),oe.translateZ(xt),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.copy(oe.matrixWorld).invert(),Xe[10]===-1)oe.projectionMatrix.copy(de.projectionMatrix),oe.projectionMatrixInverse.copy(de.projectionMatrixInverse);else{let Mn=Qn+xt,L=V+xt,D=En-Un,X=He+(dt-Un),se=pn*V/L*Mn,ce=pt*V/L*Mn;oe.projectionMatrix.makePerspective(D,X,se,ce,Mn,L),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert()}}function Ge(oe,de){de===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(de.matrixWorld,oe.matrix),oe.matrixWorldInverse.copy(oe.matrixWorld).invert()}this.updateCamera=function(oe){if(r===null)return;let de=oe.near,Be=oe.far;m.texture!==null&&(m.depthNear>0&&(de=m.depthNear),m.depthFar>0&&(Be=m.depthFar)),R.near=E.near=b.near=de,R.far=E.far=b.far=Be,(A!==R.near||ne!==R.far)&&(r.updateRenderState({depthNear:R.near,depthFar:R.far}),A=R.near,ne=R.far),R.layers.mask=oe.layers.mask|6,b.layers.mask=R.layers.mask&3,E.layers.mask=R.layers.mask&5;let dt=oe.parent,Xe=R.cameras;Ge(R,dt);for(let Pt=0;Pt<Xe.length;Pt++)Ge(Xe[Pt],dt);Xe.length===2?Se(R,b,E):R.projectionMatrix.copy(b.projectionMatrix),nt(oe,R,dt)};function nt(oe,de,Be){Be===null?oe.matrix.copy(de.matrixWorld):(oe.matrix.copy(Be.matrixWorld),oe.matrix.invert(),oe.matrix.multiply(de.matrixWorld)),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.updateMatrixWorld(!0),oe.projectionMatrix.copy(de.projectionMatrix),oe.projectionMatrixInverse.copy(de.projectionMatrixInverse),oe.isPerspectiveCamera&&(oe.fov=rw*2*Math.atan(1/oe.projectionMatrix.elements[5]),oe.zoom=1)}this.getCamera=function(){return R},this.getFoveation=function(){if(!(h===null&&p===null))return c},this.setFoveation=function(oe){c=oe,h!==null&&(h.fixedFoveation=oe),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=oe)},this.hasDepthSensing=function(){return m.texture!==null},this.getDepthSensingMesh=function(){return m.getMesh(R)},this.getCameraTexture=function(oe){return _[oe]};let ct=null;function jt(oe,de){if(u=de.getViewerPose(l||o),g=de,u!==null){let Be=u.views;p!==null&&(e.setRenderTargetFramebuffer(C,p.framebuffer),e.setRenderTarget(C));let dt=!1;Be.length!==R.cameras.length&&(R.cameras.length=0,dt=!0);for(let V=0;V<Be.length;V++){let pn=Be[V],pt=null;if(p!==null)pt=p.getViewport(pn);else{let ze=d.getViewSubImage(h,pn);pt=ze.viewport,V===0&&(e.setRenderTargetTextures(C,ze.colorTexture,ze.depthStencilTexture),e.setRenderTarget(C))}let ot=T[V];ot===void 0&&(ot=new Ui,ot.layers.enable(V),ot.viewport=new hn,T[V]=ot),ot.matrix.fromArray(pn.transform.matrix),ot.matrix.decompose(ot.position,ot.quaternion,ot.scale),ot.projectionMatrix.fromArray(pn.projectionMatrix),ot.projectionMatrixInverse.copy(ot.projectionMatrix).invert(),ot.viewport.set(pt.x,pt.y,pt.width,pt.height),V===0&&(R.matrix.copy(ot.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),dt===!0&&R.cameras.push(ot)}let Xe=r.enabledFeatures;if(Xe&&Xe.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&y){d=i.getBinding();let V=d.getDepthInformation(Be[0]);V&&V.isValid&&V.texture&&m.init(V,r.renderState)}if(Xe&&Xe.includes("camera-access")&&y){e.state.unbindTexture(),d=i.getBinding();for(let V=0;V<Be.length;V++){let pn=Be[V].camera;if(pn){let pt=_[pn];pt||(pt=new Ug,_[pn]=pt);let ot=d.getCameraImage(pn);pt.sourceTexture=ot}}}}for(let Be=0;Be<P.length;Be++){let dt=N[Be],Xe=P[Be];dt!==null&&Xe!==void 0&&Xe.update(dt,de,l||o)}ct&&ct(oe,de),de.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:de}),g=null}let Ct=new Rj;Ct.setAnimationLoop(jt),this.setAnimationLoop=function(oe){ct=oe},this.dispose=function(){}}},Wu=new Uu,She=new Vn;function The(n,e){function t(m,_){m.matrixAutoUpdate===!0&&m.updateMatrix(),_.value.copy(m.matrix)}function i(m,_){_.color.getRGB(m.fogColor.value,xP(n)),_.isFog?(m.fogNear.value=_.near,m.fogFar.value=_.far):_.isFogExp2&&(m.fogDensity.value=_.density)}function r(m,_,I,M,C){_.isMeshBasicMaterial||_.isMeshLambertMaterial?s(m,_):_.isMeshToonMaterial?(s(m,_),d(m,_)):_.isMeshPhongMaterial?(s(m,_),u(m,_)):_.isMeshStandardMaterial?(s(m,_),h(m,_),_.isMeshPhysicalMaterial&&p(m,_,C)):_.isMeshMatcapMaterial?(s(m,_),g(m,_)):_.isMeshDepthMaterial?s(m,_):_.isMeshDistanceMaterial?(s(m,_),y(m,_)):_.isMeshNormalMaterial?s(m,_):_.isLineBasicMaterial?(o(m,_),_.isLineDashedMaterial&&a(m,_)):_.isPointsMaterial?c(m,_,I,M):_.isSpriteMaterial?l(m,_):_.isShadowMaterial?(m.color.value.copy(_.color),m.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function s(m,_){m.opacity.value=_.opacity,_.color&&m.diffuse.value.copy(_.color),_.emissive&&m.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(m.map.value=_.map,t(_.map,m.mapTransform)),_.alphaMap&&(m.alphaMap.value=_.alphaMap,t(_.alphaMap,m.alphaMapTransform)),_.bumpMap&&(m.bumpMap.value=_.bumpMap,t(_.bumpMap,m.bumpMapTransform),m.bumpScale.value=_.bumpScale,_.side===_r&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,t(_.normalMap,m.normalMapTransform),m.normalScale.value.copy(_.normalScale),_.side===_r&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,t(_.displacementMap,m.displacementMapTransform),m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap,t(_.emissiveMap,m.emissiveMapTransform)),_.specularMap&&(m.specularMap.value=_.specularMap,t(_.specularMap,m.specularMapTransform)),_.alphaTest>0&&(m.alphaTest.value=_.alphaTest);let I=e.get(_),M=I.envMap,C=I.envMapRotation;M&&(m.envMap.value=M,Wu.copy(C),Wu.x*=-1,Wu.y*=-1,Wu.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(Wu.y*=-1,Wu.z*=-1),m.envMapRotation.value.setFromMatrix4(She.makeRotationFromEuler(Wu)),m.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=_.reflectivity,m.ior.value=_.ior,m.refractionRatio.value=_.refractionRatio),_.lightMap&&(m.lightMap.value=_.lightMap,m.lightMapIntensity.value=_.lightMapIntensity,t(_.lightMap,m.lightMapTransform)),_.aoMap&&(m.aoMap.value=_.aoMap,m.aoMapIntensity.value=_.aoMapIntensity,t(_.aoMap,m.aoMapTransform))}function o(m,_){m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,_.map&&(m.map.value=_.map,t(_.map,m.mapTransform))}function a(m,_){m.dashSize.value=_.dashSize,m.totalSize.value=_.dashSize+_.gapSize,m.scale.value=_.scale}function c(m,_,I,M){m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.size.value=_.size*I,m.scale.value=M*.5,_.map&&(m.map.value=_.map,t(_.map,m.uvTransform)),_.alphaMap&&(m.alphaMap.value=_.alphaMap,t(_.alphaMap,m.alphaMapTransform)),_.alphaTest>0&&(m.alphaTest.value=_.alphaTest)}function l(m,_){m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.rotation.value=_.rotation,_.map&&(m.map.value=_.map,t(_.map,m.mapTransform)),_.alphaMap&&(m.alphaMap.value=_.alphaMap,t(_.alphaMap,m.alphaMapTransform)),_.alphaTest>0&&(m.alphaTest.value=_.alphaTest)}function u(m,_){m.specular.value.copy(_.specular),m.shininess.value=Math.max(_.shininess,1e-4)}function d(m,_){_.gradientMap&&(m.gradientMap.value=_.gradientMap)}function h(m,_){m.metalness.value=_.metalness,_.metalnessMap&&(m.metalnessMap.value=_.metalnessMap,t(_.metalnessMap,m.metalnessMapTransform)),m.roughness.value=_.roughness,_.roughnessMap&&(m.roughnessMap.value=_.roughnessMap,t(_.roughnessMap,m.roughnessMapTransform)),_.envMap&&(m.envMapIntensity.value=_.envMapIntensity)}function p(m,_,I){m.ior.value=_.ior,_.sheen>0&&(m.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),m.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(m.sheenColorMap.value=_.sheenColorMap,t(_.sheenColorMap,m.sheenColorMapTransform)),_.sheenRoughnessMap&&(m.sheenRoughnessMap.value=_.sheenRoughnessMap,t(_.sheenRoughnessMap,m.sheenRoughnessMapTransform))),_.clearcoat>0&&(m.clearcoat.value=_.clearcoat,m.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(m.clearcoatMap.value=_.clearcoatMap,t(_.clearcoatMap,m.clearcoatMapTransform)),_.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap,t(_.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),_.clearcoatNormalMap&&(m.clearcoatNormalMap.value=_.clearcoatNormalMap,t(_.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),_.side===_r&&m.clearcoatNormalScale.value.negate())),_.dispersion>0&&(m.dispersion.value=_.dispersion),_.iridescence>0&&(m.iridescence.value=_.iridescence,m.iridescenceIOR.value=_.iridescenceIOR,m.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(m.iridescenceMap.value=_.iridescenceMap,t(_.iridescenceMap,m.iridescenceMapTransform)),_.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=_.iridescenceThicknessMap,t(_.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),_.transmission>0&&(m.transmission.value=_.transmission,m.transmissionSamplerMap.value=I.texture,m.transmissionSamplerSize.value.set(I.width,I.height),_.transmissionMap&&(m.transmissionMap.value=_.transmissionMap,t(_.transmissionMap,m.transmissionMapTransform)),m.thickness.value=_.thickness,_.thicknessMap&&(m.thicknessMap.value=_.thicknessMap,t(_.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=_.attenuationDistance,m.attenuationColor.value.copy(_.attenuationColor)),_.anisotropy>0&&(m.anisotropyVector.value.set(_.anisotropy*Math.cos(_.anisotropyRotation),_.anisotropy*Math.sin(_.anisotropyRotation)),_.anisotropyMap&&(m.anisotropyMap.value=_.anisotropyMap,t(_.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=_.specularIntensity,m.specularColor.value.copy(_.specularColor),_.specularColorMap&&(m.specularColorMap.value=_.specularColorMap,t(_.specularColorMap,m.specularColorMapTransform)),_.specularIntensityMap&&(m.specularIntensityMap.value=_.specularIntensityMap,t(_.specularIntensityMap,m.specularIntensityMapTransform))}function g(m,_){_.matcap&&(m.matcap.value=_.matcap)}function y(m,_){let I=e.get(_).light;m.referencePosition.value.setFromMatrixPosition(I.matrixWorld),m.nearDistance.value=I.shadow.camera.near,m.farDistance.value=I.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Ihe(n,e,t,i){let r={},s={},o=[],a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function c(I,M){let C=M.program;i.uniformBlockBinding(I,C)}function l(I,M){let C=r[I.id];C===void 0&&(g(I),C=u(I),r[I.id]=C,I.addEventListener("dispose",m));let P=M.program;i.updateUBOMapping(I,P);let N=e.render.frame;s[I.id]!==N&&(h(I),s[I.id]=N)}function u(I){let M=d();I.__bindingPointIndex=M;let C=n.createBuffer(),P=I.__size,N=I.usage;return n.bindBuffer(n.UNIFORM_BUFFER,C),n.bufferData(n.UNIFORM_BUFFER,P,N),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,C),C}function d(){for(let I=0;I<a;I++)if(o.indexOf(I)===-1)return o.push(I),I;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(I){let M=r[I.id],C=I.uniforms,P=I.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let N=0,S=C.length;N<S;N++){let w=Array.isArray(C[N])?C[N]:[C[N]];for(let b=0,E=w.length;b<E;b++){let T=w[b];if(p(T,N,b,P)===!0){let R=T.__offset,A=Array.isArray(T.value)?T.value:[T.value],ne=0;for(let Y=0;Y<A.length;Y++){let J=A[Y],re=y(J);typeof J=="number"||typeof J=="boolean"?(T.__data[0]=J,n.bufferSubData(n.UNIFORM_BUFFER,R+ne,T.__data)):J.isMatrix3?(T.__data[0]=J.elements[0],T.__data[1]=J.elements[1],T.__data[2]=J.elements[2],T.__data[3]=0,T.__data[4]=J.elements[3],T.__data[5]=J.elements[4],T.__data[6]=J.elements[5],T.__data[7]=0,T.__data[8]=J.elements[6],T.__data[9]=J.elements[7],T.__data[10]=J.elements[8],T.__data[11]=0):(J.toArray(T.__data,ne),ne+=re.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,R,T.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function p(I,M,C,P){let N=I.value,S=M+"_"+C;if(P[S]===void 0)return typeof N=="number"||typeof N=="boolean"?P[S]=N:P[S]=N.clone(),!0;{let w=P[S];if(typeof N=="number"||typeof N=="boolean"){if(w!==N)return P[S]=N,!0}else if(w.equals(N)===!1)return w.copy(N),!0}return!1}function g(I){let M=I.uniforms,C=0,P=16;for(let S=0,w=M.length;S<w;S++){let b=Array.isArray(M[S])?M[S]:[M[S]];for(let E=0,T=b.length;E<T;E++){let R=b[E],A=Array.isArray(R.value)?R.value:[R.value];for(let ne=0,Y=A.length;ne<Y;ne++){let J=A[ne],re=y(J),K=C%P,fe=K%re.boundary,Se=K+fe;C+=fe,Se!==0&&P-Se<re.storage&&(C+=P-Se),R.__data=new Float32Array(re.storage/Float32Array.BYTES_PER_ELEMENT),R.__offset=C,C+=re.storage}}}let N=C%P;return N>0&&(C+=P-N),I.__size=C,I.__cache={},this}function y(I){let M={boundary:0,storage:0};return typeof I=="number"||typeof I=="boolean"?(M.boundary=4,M.storage=4):I.isVector2?(M.boundary=8,M.storage=8):I.isVector3||I.isColor?(M.boundary=16,M.storage=12):I.isVector4?(M.boundary=16,M.storage=16):I.isMatrix3?(M.boundary=48,M.storage=48):I.isMatrix4?(M.boundary=64,M.storage=64):I.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",I),M}function m(I){let M=I.target;M.removeEventListener("dispose",m);let C=o.indexOf(M.__bindingPointIndex);o.splice(C,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete s[M.id]}function _(){for(let I in r)n.deleteBuffer(r[I]);o=[],r={},s={}}return{bind:c,update:l,dispose:_}}var _x=class{constructor(e={}){let{canvas:t=rj(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let p;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=i.getContextAttributes().alpha}else p=o;let g=new Uint32Array(4),y=new Int32Array(4),m=null,_=null,I=[],M=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Na,this.toneMappingExposure=1,this.transmissionResolutionScale=1;let C=this,P=!1;this._outputColorSpace=Hr;let N=0,S=0,w=null,b=-1,E=null,T=new hn,R=new hn,A=null,ne=new qt(0),Y=0,J=t.width,re=t.height,K=1,fe=null,Se=null,Ge=new hn(0,0,J,re),nt=new hn(0,0,J,re),ct=!1,jt=new bf,Ct=!1,oe=!1,de=new Vn,Be=new q,dt=new hn,Xe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},Pt=!1;function Qn(){return w===null?K:1}let V=i;function pn(O,H){return t.getContext(O,H)}try{let O={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${"180"}`),t.addEventListener("webglcontextlost",be,!1),t.addEventListener("webglcontextrestored",Oe,!1),t.addEventListener("webglcontextcreationerror",pe,!1),V===null){let H="webgl2";if(V=pn(H,O),V===null)throw pn(H)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let pt,ot,ze,En,He,xt,Un,Mn,L,D,X,se,ce,ee,We,ve,$e,Ye,ge,Ae,rt,qe,Te,St;function z(){pt=new Gue(V),pt.init(),qe=new Ehe(V,pt),ot=new Fue(V,pt,e,qe),ze=new vhe(V,pt),ot.reversedDepthBuffer&&h&&ze.buffers.depth.setReversed(!0),En=new que(V),He=new ohe,xt=new bhe(V,pt,ze,He,ot,qe,En),Un=new Uue(C),Mn=new jue(C),L=new Qae(V),Te=new kue(V,L),D=new Wue(V,L,En,Te),X=new Yue(V,D,L,En),ge=new Xue(V,ot,xt),ve=new Vue(He),se=new she(C,Un,Mn,pt,ot,Te,ve),ce=new The(C,He),ee=new che,We=new phe(pt),Ye=new Oue(C,Un,Mn,ze,X,p,c),$e=new _he(C,X,ot),St=new Ihe(V,En,ot,ze),Ae=new Lue(V,pt,En),rt=new $ue(V,pt,En),En.programs=se.programs,C.capabilities=ot,C.extensions=pt,C.properties=He,C.renderLists=ee,C.shadowMap=$e,C.state=ze,C.info=En}z();let _e=new BP(C,V);this.xr=_e,this.getContext=function(){return V},this.getContextAttributes=function(){return V.getContextAttributes()},this.forceContextLoss=function(){let O=pt.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){let O=pt.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(O){O!==void 0&&(K=O,this.setSize(J,re,!1))},this.getSize=function(O){return O.set(J,re)},this.setSize=function(O,H,Z=!0){if(_e.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}J=O,re=H,t.width=Math.floor(O*K),t.height=Math.floor(H*K),Z===!0&&(t.style.width=O+"px",t.style.height=H+"px"),this.setViewport(0,0,O,H)},this.getDrawingBufferSize=function(O){return O.set(J*K,re*K).floor()},this.setDrawingBufferSize=function(O,H,Z){J=O,re=H,K=Z,t.width=Math.floor(O*Z),t.height=Math.floor(H*Z),this.setViewport(0,0,O,H)},this.getCurrentViewport=function(O){return O.copy(T)},this.getViewport=function(O){return O.copy(Ge)},this.setViewport=function(O,H,Z,Q){O.isVector4?Ge.set(O.x,O.y,O.z,O.w):Ge.set(O,H,Z,Q),ze.viewport(T.copy(Ge).multiplyScalar(K).round())},this.getScissor=function(O){return O.copy(nt)},this.setScissor=function(O,H,Z,Q){O.isVector4?nt.set(O.x,O.y,O.z,O.w):nt.set(O,H,Z,Q),ze.scissor(R.copy(nt).multiplyScalar(K).round())},this.getScissorTest=function(){return ct},this.setScissorTest=function(O){ze.setScissorTest(ct=O)},this.setOpaqueSort=function(O){fe=O},this.setTransparentSort=function(O){Se=O},this.getClearColor=function(O){return O.copy(Ye.getClearColor())},this.setClearColor=function(){Ye.setClearColor(...arguments)},this.getClearAlpha=function(){return Ye.getClearAlpha()},this.setClearAlpha=function(){Ye.setClearAlpha(...arguments)},this.clear=function(O=!0,H=!0,Z=!0){let Q=0;if(O){let G=!1;if(w!==null){let me=w.texture.format;G=me===Vw||me===Fw||me===Lw}if(G){let me=w.texture.type,Ie=me===Fs||me===ll||me===wf||me===Sf||me===Ow||me===kw,Ve=Ye.getClearColor(),De=Ye.getClearAlpha(),Ke=Ve.r,st=Ve.g,et=Ve.b;Ie?(g[0]=Ke,g[1]=st,g[2]=et,g[3]=De,V.clearBufferuiv(V.COLOR,0,g)):(y[0]=Ke,y[1]=st,y[2]=et,y[3]=De,V.clearBufferiv(V.COLOR,0,y))}else Q|=V.COLOR_BUFFER_BIT}H&&(Q|=V.DEPTH_BUFFER_BIT),Z&&(Q|=V.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),V.clear(Q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",be,!1),t.removeEventListener("webglcontextrestored",Oe,!1),t.removeEventListener("webglcontextcreationerror",pe,!1),Ye.dispose(),ee.dispose(),We.dispose(),He.dispose(),Un.dispose(),Mn.dispose(),X.dispose(),Te.dispose(),St.dispose(),se.dispose(),_e.dispose(),_e.removeEventListener("sessionstart",Cr),_e.removeEventListener("sessionend",yi),Vs.stop()};function be(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),P=!0}function Oe(){console.log("THREE.WebGLRenderer: Context Restored."),P=!1;let O=En.autoReset,H=$e.enabled,Z=$e.autoUpdate,Q=$e.needsUpdate,G=$e.type;z(),En.autoReset=O,$e.enabled=H,$e.autoUpdate=Z,$e.needsUpdate=Q,$e.type=G}function pe(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function le(O){let H=O.target;H.removeEventListener("dispose",le),Fe(H)}function Fe(O){mt(O),He.remove(O)}function mt(O){let H=He.get(O).programs;H!==void 0&&(H.forEach(function(Z){se.releaseProgram(Z)}),O.isShaderMaterial&&se.releaseShaderCache(O))}this.renderBufferDirect=function(O,H,Z,Q,G,me){H===null&&(H=Xe);let Ie=G.isMesh&&G.matrixWorld.determinant()<0,Ve=e_(O,H,Z,Q,G);ze.setMaterial(Q,Ie);let De=Z.index,Ke=1;if(Q.wireframe===!0){if(De=D.getWireframeAttribute(Z),De===void 0)return;Ke=2}let st=Z.drawRange,et=Z.attributes.position,Nt=st.start*Ke,en=(st.start+st.count)*Ke;me!==null&&(Nt=Math.max(Nt,me.start*Ke),en=Math.min(en,(me.start+me.count)*Ke)),De!==null?(Nt=Math.max(Nt,0),en=Math.min(en,De.count)):et!=null&&(Nt=Math.max(Nt,0),en=Math.min(en,et.count));let In=en-Nt;if(In<0||In===1/0)return;Te.setup(G,Q,Ve,Z,De);let ln,tn=Ae;if(De!==null&&(ln=L.get(De),tn=rt,tn.setIndex(ln)),G.isMesh)Q.wireframe===!0?(ze.setLineWidth(Q.wireframeLinewidth*Qn()),tn.setMode(V.LINES)):tn.setMode(V.TRIANGLES);else if(G.isLine){let tt=Q.linewidth;tt===void 0&&(tt=1),ze.setLineWidth(tt*Qn()),G.isLineSegments?tn.setMode(V.LINES):G.isLineLoop?tn.setMode(V.LINE_LOOP):tn.setMode(V.LINE_STRIP)}else G.isPoints?tn.setMode(V.POINTS):G.isSprite&&tn.setMode(V.TRIANGLES);if(G.isBatchedMesh)if(G._multiDrawInstances!==null)_f("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),tn.renderMultiDrawInstances(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount,G._multiDrawInstances);else if(pt.get("WEBGL_multi_draw"))tn.renderMultiDraw(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount);else{let tt=G._multiDrawStarts,wn=G._multiDrawCounts,Gt=G._multiDrawCount,ir=De?L.get(De).bytesPerElement:1,Po=He.get(Q).currentProgram.getUniforms();for(let Bi=0;Bi<Gt;Bi++)Po.setValue(V,"_gl_DrawID",Bi),tn.render(tt[Bi]/ir,wn[Bi])}else if(G.isInstancedMesh)tn.renderInstances(Nt,In,G.count);else if(Z.isInstancedBufferGeometry){let tt=Z._maxInstanceCount!==void 0?Z._maxInstanceCount:1/0,wn=Math.min(Z.instanceCount,tt);tn.renderInstances(Nt,In,wn)}else tn.render(Nt,In)};function Qt(O,H,Z){O.transparent===!0&&O.side===Co&&O.forceSinglePass===!1?(O.side=_r,O.needsUpdate=!0,Yu(O,H,Z),O.side=Aa,O.needsUpdate=!0,Yu(O,H,Z),O.side=Co):Yu(O,H,Z)}this.compile=function(O,H,Z=null){Z===null&&(Z=O),_=We.get(Z),_.init(H),M.push(_),Z.traverseVisible(function(G){G.isLight&&G.layers.test(H.layers)&&(_.pushLight(G),G.castShadow&&_.pushShadow(G))}),O!==Z&&O.traverseVisible(function(G){G.isLight&&G.layers.test(H.layers)&&(_.pushLight(G),G.castShadow&&_.pushShadow(G))}),_.setupLights();let Q=new Set;return O.traverse(function(G){if(!(G.isMesh||G.isPoints||G.isLine||G.isSprite))return;let me=G.material;if(me)if(Array.isArray(me))for(let Ie=0;Ie<me.length;Ie++){let Ve=me[Ie];Qt(Ve,Z,G),Q.add(Ve)}else Qt(me,Z,G),Q.add(me)}),_=M.pop(),Q},this.compileAsync=function(O,H,Z=null){let Q=this.compile(O,H,Z);return new Promise(G=>{function me(){if(Q.forEach(function(Ie){He.get(Ie).currentProgram.isReady()&&Q.delete(Ie)}),Q.size===0){G(O);return}setTimeout(me,10)}pt.get("KHR_parallel_shader_compile")!==null?me():setTimeout(me,10)})};let Xt=null;function nr(O){Xt&&Xt(O)}function Cr(){Vs.stop()}function yi(){Vs.start()}let Vs=new Rj;Vs.setAnimationLoop(nr),typeof self<"u"&&Vs.setContext(self),this.setAnimationLoop=function(O){Xt=O,_e.setAnimationLoop(O),O===null?Vs.stop():Vs.start()},_e.addEventListener("sessionstart",Cr),_e.addEventListener("sessionend",yi),this.render=function(O,H){if(H!==void 0&&H.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(P===!0)return;if(O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld(),H.parent===null&&H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),_e.enabled===!0&&_e.isPresenting===!0&&(_e.cameraAutoUpdate===!0&&_e.updateCamera(H),H=_e.getCamera()),O.isScene===!0&&O.onBeforeRender(C,O,H,w),_=We.get(O,M.length),_.init(H),M.push(_),de.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse),jt.setFromProjectionMatrix(de,Os,H.reversedDepth),oe=this.localClippingEnabled,Ct=ve.init(this.clippingPlanes,oe),m=ee.get(O,I.length),m.init(),I.push(m),_e.enabled===!0&&_e.isPresenting===!0){let me=C.xr.getDepthSensingMesh();me!==null&&Do(me,H,-1/0,C.sortObjects)}Do(O,H,0,C.sortObjects),m.finish(),C.sortObjects===!0&&m.sort(fe,Se),Pt=_e.enabled===!1||_e.isPresenting===!1||_e.hasDepthSensing()===!1,Pt&&Ye.addToRenderList(m,O),this.info.render.frame++,Ct===!0&&ve.beginShadows();let Z=_.state.shadowsArray;$e.render(Z,O,H),Ct===!0&&ve.endShadows(),this.info.autoReset===!0&&this.info.reset();let Q=m.opaque,G=m.transmissive;if(_.setupLights(),H.isArrayCamera){let me=H.cameras;if(G.length>0)for(let Ie=0,Ve=me.length;Ie<Ve;Ie++){let De=me[Ie];Jg(Q,G,O,De)}Pt&&Ye.render(O);for(let Ie=0,Ve=me.length;Ie<Ve;Ie++){let De=me[Ie];La(m,O,De,De.viewport)}}else G.length>0&&Jg(Q,G,O,H),Pt&&Ye.render(O),La(m,O,H);w!==null&&S===0&&(xt.updateMultisampleRenderTarget(w),xt.updateRenderTargetMipmap(w)),O.isScene===!0&&O.onAfterRender(C,O,H),Te.resetDefaultState(),b=-1,E=null,M.pop(),M.length>0?(_=M[M.length-1],Ct===!0&&ve.setGlobalState(C.clippingPlanes,_.state.camera)):_=null,I.pop(),I.length>0?m=I[I.length-1]:m=null};function Do(O,H,Z,Q){if(O.visible===!1)return;if(O.layers.test(H.layers)){if(O.isGroup)Z=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(H);else if(O.isLight)_.pushLight(O),O.castShadow&&_.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||jt.intersectsSprite(O)){Q&&dt.setFromMatrixPosition(O.matrixWorld).applyMatrix4(de);let Ie=X.update(O),Ve=O.material;Ve.visible&&m.push(O,Ie,Ve,Z,dt.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(!O.frustumCulled||jt.intersectsObject(O))){let Ie=X.update(O),Ve=O.material;if(Q&&(O.boundingSphere!==void 0?(O.boundingSphere===null&&O.computeBoundingSphere(),dt.copy(O.boundingSphere.center)):(Ie.boundingSphere===null&&Ie.computeBoundingSphere(),dt.copy(Ie.boundingSphere.center)),dt.applyMatrix4(O.matrixWorld).applyMatrix4(de)),Array.isArray(Ve)){let De=Ie.groups;for(let Ke=0,st=De.length;Ke<st;Ke++){let et=De[Ke],Nt=Ve[et.materialIndex];Nt&&Nt.visible&&m.push(O,Ie,Nt,Z,dt.z,et)}}else Ve.visible&&m.push(O,Ie,Ve,Z,dt.z,null)}}let me=O.children;for(let Ie=0,Ve=me.length;Ie<Ve;Ie++)Do(me[Ie],H,Z,Q)}function La(O,H,Z,Q){let G=O.opaque,me=O.transmissive,Ie=O.transparent;_.setupLightsView(Z),Ct===!0&&ve.setGlobalState(C.clippingPlanes,Z),Q&&ze.viewport(T.copy(Q)),G.length>0&&Xu(G,H,Z),me.length>0&&Xu(me,H,Z),Ie.length>0&&Xu(Ie,H,Z),ze.buffers.depth.setTest(!0),ze.buffers.depth.setMask(!0),ze.buffers.color.setMask(!0),ze.setPolygonOffset(!1)}function Jg(O,H,Z,Q){if((Z.isScene===!0?Z.overrideMaterial:null)!==null)return;_.state.transmissionRenderTarget[Q.id]===void 0&&(_.state.transmissionRenderTarget[Q.id]=new To(1,1,{generateMipmaps:!0,type:pt.has("EXT_color_buffer_half_float")||pt.has("EXT_color_buffer_float")?xf:Fs,minFilter:cl,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Kt.workingColorSpace}));let me=_.state.transmissionRenderTarget[Q.id],Ie=Q.viewport||T;me.setSize(Ie.z*C.transmissionResolutionScale,Ie.w*C.transmissionResolutionScale);let Ve=C.getRenderTarget(),De=C.getActiveCubeFace(),Ke=C.getActiveMipmapLevel();C.setRenderTarget(me),C.getClearColor(ne),Y=C.getClearAlpha(),Y<1&&C.setClearColor(16777215,.5),C.clear(),Pt&&Ye.render(Z);let st=C.toneMapping;C.toneMapping=Na;let et=Q.viewport;if(Q.viewport!==void 0&&(Q.viewport=void 0),_.setupLightsView(Q),Ct===!0&&ve.setGlobalState(C.clippingPlanes,Q),Xu(O,Z,Q),xt.updateMultisampleRenderTarget(me),xt.updateRenderTargetMipmap(me),pt.has("WEBGL_multisampled_render_to_texture")===!1){let Nt=!1;for(let en=0,In=H.length;en<In;en++){let ln=H[en],tn=ln.object,tt=ln.geometry,wn=ln.material,Gt=ln.group;if(wn.side===Co&&tn.layers.test(Q.layers)){let ir=wn.side;wn.side=_r,wn.needsUpdate=!0,Ro(tn,Z,Q,tt,wn,Gt),wn.side=ir,wn.needsUpdate=!0,Nt=!0}}Nt===!0&&(xt.updateMultisampleRenderTarget(me),xt.updateRenderTargetMipmap(me))}C.setRenderTarget(Ve,De,Ke),C.setClearColor(ne,Y),et!==void 0&&(Q.viewport=et),C.toneMapping=st}function Xu(O,H,Z){let Q=H.isScene===!0?H.overrideMaterial:null;for(let G=0,me=O.length;G<me;G++){let Ie=O[G],Ve=Ie.object,De=Ie.geometry,Ke=Ie.group,st=Ie.material;st.allowOverride===!0&&Q!==null&&(st=Q),Ve.layers.test(Z.layers)&&Ro(Ve,H,Z,De,st,Ke)}}function Ro(O,H,Z,Q,G,me){O.onBeforeRender(C,H,Z,Q,G,me),O.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),G.onBeforeRender(C,H,Z,Q,O,me),G.transparent===!0&&G.side===Co&&G.forceSinglePass===!1?(G.side=_r,G.needsUpdate=!0,C.renderBufferDirect(Z,H,Q,G,O,me),G.side=Aa,G.needsUpdate=!0,C.renderBufferDirect(Z,H,Q,G,O,me),G.side=Co):C.renderBufferDirect(Z,H,Q,G,O,me),O.onAfterRender(C,H,Z,Q,G,me)}function Yu(O,H,Z){H.isScene!==!0&&(H=Xe);let Q=He.get(O),G=_.state.lights,me=_.state.shadowsArray,Ie=G.state.version,Ve=se.getParameters(O,G.state,me,H,Z),De=se.getProgramCacheKey(Ve),Ke=Q.programs;Q.environment=O.isMeshStandardMaterial?H.environment:null,Q.fog=H.fog,Q.envMap=(O.isMeshStandardMaterial?Mn:Un).get(O.envMap||Q.environment),Q.envMapRotation=Q.environment!==null&&O.envMap===null?H.environmentRotation:O.envMapRotation,Ke===void 0&&(O.addEventListener("dispose",le),Ke=new Map,Q.programs=Ke);let st=Ke.get(De);if(st!==void 0){if(Q.currentProgram===st&&Q.lightsStateVersion===Ie)return dl(O,Ve),st}else Ve.uniforms=se.getUniforms(O),O.onBeforeCompile(Ve,C),st=se.acquireProgram(Ve,De),Ke.set(De,st),Q.uniforms=Ve.uniforms;let et=Q.uniforms;return(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(et.clippingPlanes=ve.uniform),dl(O,Ve),Q.needsLights=Ku(O),Q.lightsStateVersion=Ie,Q.needsLights&&(et.ambientLightColor.value=G.state.ambient,et.lightProbe.value=G.state.probe,et.directionalLights.value=G.state.directional,et.directionalLightShadows.value=G.state.directionalShadow,et.spotLights.value=G.state.spot,et.spotLightShadows.value=G.state.spotShadow,et.rectAreaLights.value=G.state.rectArea,et.ltc_1.value=G.state.rectAreaLTC1,et.ltc_2.value=G.state.rectAreaLTC2,et.pointLights.value=G.state.point,et.pointLightShadows.value=G.state.pointShadow,et.hemisphereLights.value=G.state.hemi,et.directionalShadowMap.value=G.state.directionalShadowMap,et.directionalShadowMatrix.value=G.state.directionalShadowMatrix,et.spotShadowMap.value=G.state.spotShadowMap,et.spotLightMatrix.value=G.state.spotLightMatrix,et.spotLightMap.value=G.state.spotLightMap,et.pointShadowMap.value=G.state.pointShadowMap,et.pointShadowMatrix.value=G.state.pointShadowMatrix),Q.currentProgram=st,Q.uniformsList=null,st}function Qg(O){if(O.uniformsList===null){let H=O.currentProgram.getUniforms();O.uniformsList=Mf.seqWithValue(H.seq,O.uniforms)}return O.uniformsList}function dl(O,H){let Z=He.get(O);Z.outputColorSpace=H.outputColorSpace,Z.batching=H.batching,Z.batchingColor=H.batchingColor,Z.instancing=H.instancing,Z.instancingColor=H.instancingColor,Z.instancingMorph=H.instancingMorph,Z.skinning=H.skinning,Z.morphTargets=H.morphTargets,Z.morphNormals=H.morphNormals,Z.morphColors=H.morphColors,Z.morphTargetsCount=H.morphTargetsCount,Z.numClippingPlanes=H.numClippingPlanes,Z.numIntersection=H.numClipIntersection,Z.vertexAlphas=H.vertexAlphas,Z.vertexTangents=H.vertexTangents,Z.toneMapping=H.toneMapping}function e_(O,H,Z,Q,G){H.isScene!==!0&&(H=Xe),xt.resetTextureUnits();let me=H.fog,Ie=Q.isMeshStandardMaterial?H.environment:null,Ve=w===null?C.outputColorSpace:w.isXRRenderTarget===!0?w.texture.colorSpace:Fu,De=(Q.isMeshStandardMaterial?Mn:Un).get(Q.envMap||Ie),Ke=Q.vertexColors===!0&&!!Z.attributes.color&&Z.attributes.color.itemSize===4,st=!!Z.attributes.tangent&&(!!Q.normalMap||Q.anisotropy>0),et=!!Z.morphAttributes.position,Nt=!!Z.morphAttributes.normal,en=!!Z.morphAttributes.color,In=Na;Q.toneMapped&&(w===null||w.isXRRenderTarget===!0)&&(In=C.toneMapping);let ln=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,tn=ln!==void 0?ln.length:0,tt=He.get(Q),wn=_.state.lights;if(Ct===!0&&(oe===!0||O!==E)){let ei=O===E&&Q.id===b;ve.setState(Q,O,ei)}let Gt=!1;Q.version===tt.__version?(tt.needsLights&&tt.lightsStateVersion!==wn.state.version||tt.outputColorSpace!==Ve||G.isBatchedMesh&&tt.batching===!1||!G.isBatchedMesh&&tt.batching===!0||G.isBatchedMesh&&tt.batchingColor===!0&&G.colorTexture===null||G.isBatchedMesh&&tt.batchingColor===!1&&G.colorTexture!==null||G.isInstancedMesh&&tt.instancing===!1||!G.isInstancedMesh&&tt.instancing===!0||G.isSkinnedMesh&&tt.skinning===!1||!G.isSkinnedMesh&&tt.skinning===!0||G.isInstancedMesh&&tt.instancingColor===!0&&G.instanceColor===null||G.isInstancedMesh&&tt.instancingColor===!1&&G.instanceColor!==null||G.isInstancedMesh&&tt.instancingMorph===!0&&G.morphTexture===null||G.isInstancedMesh&&tt.instancingMorph===!1&&G.morphTexture!==null||tt.envMap!==De||Q.fog===!0&&tt.fog!==me||tt.numClippingPlanes!==void 0&&(tt.numClippingPlanes!==ve.numPlanes||tt.numIntersection!==ve.numIntersection)||tt.vertexAlphas!==Ke||tt.vertexTangents!==st||tt.morphTargets!==et||tt.morphNormals!==Nt||tt.morphColors!==en||tt.toneMapping!==In||tt.morphTargetsCount!==tn)&&(Gt=!0):(Gt=!0,tt.__version=Q.version);let ir=tt.currentProgram;Gt===!0&&(ir=Yu(Q,H,G));let Po=!1,Bi=!1,hl=!1,nn=ir.getUniforms(),Bn=tt.uniforms;if(ze.useProgram(ir.program)&&(Po=!0,Bi=!0,hl=!0),Q.id!==b&&(b=Q.id,Bi=!0),Po||E!==O){ze.buffers.depth.getReversed()&&O.reversedDepth!==!0&&(O._reversedDepth=!0,O.updateProjectionMatrix()),nn.setValue(V,"projectionMatrix",O.projectionMatrix),nn.setValue(V,"viewMatrix",O.matrixWorldInverse);let Ai=nn.map.cameraPosition;Ai!==void 0&&Ai.setValue(V,Be.setFromMatrixPosition(O.matrixWorld)),ot.logarithmicDepthBuffer&&nn.setValue(V,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),(Q.isMeshPhongMaterial||Q.isMeshToonMaterial||Q.isMeshLambertMaterial||Q.isMeshBasicMaterial||Q.isMeshStandardMaterial||Q.isShaderMaterial)&&nn.setValue(V,"isOrthographic",O.isOrthographicCamera===!0),E!==O&&(E=O,Bi=!0,hl=!0)}if(G.isSkinnedMesh){nn.setOptional(V,G,"bindMatrix"),nn.setOptional(V,G,"bindMatrixInverse");let ei=G.skeleton;ei&&(ei.boneTexture===null&&ei.computeBoneTexture(),nn.setValue(V,"boneTexture",ei.boneTexture,xt))}G.isBatchedMesh&&(nn.setOptional(V,G,"batchingTexture"),nn.setValue(V,"batchingTexture",G._matricesTexture,xt),nn.setOptional(V,G,"batchingIdTexture"),nn.setValue(V,"batchingIdTexture",G._indirectTexture,xt),nn.setOptional(V,G,"batchingColorTexture"),G._colorsTexture!==null&&nn.setValue(V,"batchingColorTexture",G._colorsTexture,xt));let Mi=Z.morphAttributes;if((Mi.position!==void 0||Mi.normal!==void 0||Mi.color!==void 0)&&ge.update(G,Z,ir),(Bi||tt.receiveShadow!==G.receiveShadow)&&(tt.receiveShadow=G.receiveShadow,nn.setValue(V,"receiveShadow",G.receiveShadow)),Q.isMeshGouraudMaterial&&Q.envMap!==null&&(Bn.envMap.value=De,Bn.flipEnvMap.value=De.isCubeTexture&&De.isRenderTargetTexture===!1?-1:1),Q.isMeshStandardMaterial&&Q.envMap===null&&H.environment!==null&&(Bn.envMapIntensity.value=H.environmentIntensity),Bi&&(nn.setValue(V,"toneMappingExposure",C.toneMappingExposure),tt.needsLights&&Df(Bn,hl),me&&Q.fog===!0&&ce.refreshFogUniforms(Bn,me),ce.refreshMaterialUniforms(Bn,Q,K,re,_.state.transmissionRenderTarget[O.id]),Mf.upload(V,Qg(tt),Bn,xt)),Q.isShaderMaterial&&Q.uniformsNeedUpdate===!0&&(Mf.upload(V,Qg(tt),Bn,xt),Q.uniformsNeedUpdate=!1),Q.isSpriteMaterial&&nn.setValue(V,"center",G.center),nn.setValue(V,"modelViewMatrix",G.modelViewMatrix),nn.setValue(V,"normalMatrix",G.normalMatrix),nn.setValue(V,"modelMatrix",G.matrixWorld),Q.isShaderMaterial||Q.isRawShaderMaterial){let ei=Q.uniformsGroups;for(let Ai=0,un=ei.length;Ai<un;Ai++){let Wr=ei[Ai];St.update(Wr,ir),St.bind(Wr,ir)}}return ir}function Df(O,H){O.ambientLightColor.needsUpdate=H,O.lightProbe.needsUpdate=H,O.directionalLights.needsUpdate=H,O.directionalLightShadows.needsUpdate=H,O.pointLights.needsUpdate=H,O.pointLightShadows.needsUpdate=H,O.spotLights.needsUpdate=H,O.spotLightShadows.needsUpdate=H,O.rectAreaLights.needsUpdate=H,O.hemisphereLights.needsUpdate=H}function Ku(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(O,H,Z){let Q=He.get(O);Q.__autoAllocateDepthBuffer=O.resolveDepthBuffer===!1,Q.__autoAllocateDepthBuffer===!1&&(Q.__useRenderToTexture=!1),He.get(O.texture).__webglTexture=H,He.get(O.depthTexture).__webglTexture=Q.__autoAllocateDepthBuffer?void 0:Z,Q.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(O,H){let Z=He.get(O);Z.__webglFramebuffer=H,Z.__useDefaultFramebuffer=H===void 0};let Us=V.createFramebuffer();this.setRenderTarget=function(O,H=0,Z=0){w=O,N=H,S=Z;let Q=!0,G=null,me=!1,Ie=!1;if(O){let De=He.get(O);if(De.__useDefaultFramebuffer!==void 0)ze.bindFramebuffer(V.FRAMEBUFFER,null),Q=!1;else if(De.__webglFramebuffer===void 0)xt.setupRenderTarget(O);else if(De.__hasExternalTextures)xt.rebindTextures(O,He.get(O.texture).__webglTexture,He.get(O.depthTexture).__webglTexture);else if(O.depthBuffer){let et=O.depthTexture;if(De.__boundDepthTexture!==et){if(et!==null&&He.has(et)&&(O.width!==et.image.width||O.height!==et.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");xt.setupDepthRenderbuffer(O)}}let Ke=O.texture;(Ke.isData3DTexture||Ke.isDataArrayTexture||Ke.isCompressedArrayTexture)&&(Ie=!0);let st=He.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(Array.isArray(st[H])?G=st[H][Z]:G=st[H],me=!0):O.samples>0&&xt.useMultisampledRTT(O)===!1?G=He.get(O).__webglMultisampledFramebuffer:Array.isArray(st)?G=st[Z]:G=st,T.copy(O.viewport),R.copy(O.scissor),A=O.scissorTest}else T.copy(Ge).multiplyScalar(K).floor(),R.copy(nt).multiplyScalar(K).floor(),A=ct;if(Z!==0&&(G=Us),ze.bindFramebuffer(V.FRAMEBUFFER,G)&&Q&&ze.drawBuffers(O,G),ze.viewport(T),ze.scissor(R),ze.setScissorTest(A),me){let De=He.get(O.texture);V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_CUBE_MAP_POSITIVE_X+H,De.__webglTexture,Z)}else if(Ie){let De=H;for(let Ke=0;Ke<O.textures.length;Ke++){let st=He.get(O.textures[Ke]);V.framebufferTextureLayer(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0+Ke,st.__webglTexture,Z,De)}}else if(O!==null&&Z!==0){let De=He.get(O.texture);V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,De.__webglTexture,Z)}b=-1},this.readRenderTargetPixels=function(O,H,Z,Q,G,me,Ie,Ve=0){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let De=He.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Ie!==void 0&&(De=De[Ie]),De){ze.bindFramebuffer(V.FRAMEBUFFER,De);try{let Ke=O.textures[Ve],st=Ke.format,et=Ke.type;if(!ot.textureFormatReadable(st)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ot.textureTypeReadable(et)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}H>=0&&H<=O.width-Q&&Z>=0&&Z<=O.height-G&&(O.textures.length>1&&V.readBuffer(V.COLOR_ATTACHMENT0+Ve),V.readPixels(H,Z,Q,G,qe.convert(st),qe.convert(et),me))}finally{let Ke=w!==null?He.get(w).__webglFramebuffer:null;ze.bindFramebuffer(V.FRAMEBUFFER,Ke)}}},this.readRenderTargetPixelsAsync=function(O,H,Z,Q,G,me,Ie,Ve=0){return U(this,null,function*(){if(!(O&&O.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let De=He.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Ie!==void 0&&(De=De[Ie]),De)if(H>=0&&H<=O.width-Q&&Z>=0&&Z<=O.height-G){ze.bindFramebuffer(V.FRAMEBUFFER,De);let Ke=O.textures[Ve],st=Ke.format,et=Ke.type;if(!ot.textureFormatReadable(st))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ot.textureTypeReadable(et))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");let Nt=V.createBuffer();V.bindBuffer(V.PIXEL_PACK_BUFFER,Nt),V.bufferData(V.PIXEL_PACK_BUFFER,me.byteLength,V.STREAM_READ),O.textures.length>1&&V.readBuffer(V.COLOR_ATTACHMENT0+Ve),V.readPixels(H,Z,Q,G,qe.convert(st),qe.convert(et),0);let en=w!==null?He.get(w).__webglFramebuffer:null;ze.bindFramebuffer(V.FRAMEBUFFER,en);let In=V.fenceSync(V.SYNC_GPU_COMMANDS_COMPLETE,0);return V.flush(),yield sj(V,In,4),V.bindBuffer(V.PIXEL_PACK_BUFFER,Nt),V.getBufferSubData(V.PIXEL_PACK_BUFFER,0,me),V.deleteBuffer(Nt),V.deleteSync(In),me}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")})},this.copyFramebufferToTexture=function(O,H=null,Z=0){let Q=Math.pow(2,-Z),G=Math.floor(O.image.width*Q),me=Math.floor(O.image.height*Q),Ie=H!==null?H.x:0,Ve=H!==null?H.y:0;xt.setTexture2D(O,0),V.copyTexSubImage2D(V.TEXTURE_2D,Z,0,0,Ie,Ve,G,me),ze.unbindTexture()};let t_=V.createFramebuffer(),n_=V.createFramebuffer();this.copyTextureToTexture=function(O,H,Z=null,Q=null,G=0,me=null){me===null&&(G!==0?(_f("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),me=G,G=0):me=0);let Ie,Ve,De,Ke,st,et,Nt,en,In,ln=O.isCompressedTexture?O.mipmaps[me]:O.image;if(Z!==null)Ie=Z.max.x-Z.min.x,Ve=Z.max.y-Z.min.y,De=Z.isBox3?Z.max.z-Z.min.z:1,Ke=Z.min.x,st=Z.min.y,et=Z.isBox3?Z.min.z:0;else{let Mi=Math.pow(2,-G);Ie=Math.floor(ln.width*Mi),Ve=Math.floor(ln.height*Mi),O.isDataArrayTexture?De=ln.depth:O.isData3DTexture?De=Math.floor(ln.depth*Mi):De=1,Ke=0,st=0,et=0}Q!==null?(Nt=Q.x,en=Q.y,In=Q.z):(Nt=0,en=0,In=0);let tn=qe.convert(H.format),tt=qe.convert(H.type),wn;H.isData3DTexture?(xt.setTexture3D(H,0),wn=V.TEXTURE_3D):H.isDataArrayTexture||H.isCompressedArrayTexture?(xt.setTexture2DArray(H,0),wn=V.TEXTURE_2D_ARRAY):(xt.setTexture2D(H,0),wn=V.TEXTURE_2D),V.pixelStorei(V.UNPACK_FLIP_Y_WEBGL,H.flipY),V.pixelStorei(V.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),V.pixelStorei(V.UNPACK_ALIGNMENT,H.unpackAlignment);let Gt=V.getParameter(V.UNPACK_ROW_LENGTH),ir=V.getParameter(V.UNPACK_IMAGE_HEIGHT),Po=V.getParameter(V.UNPACK_SKIP_PIXELS),Bi=V.getParameter(V.UNPACK_SKIP_ROWS),hl=V.getParameter(V.UNPACK_SKIP_IMAGES);V.pixelStorei(V.UNPACK_ROW_LENGTH,ln.width),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,ln.height),V.pixelStorei(V.UNPACK_SKIP_PIXELS,Ke),V.pixelStorei(V.UNPACK_SKIP_ROWS,st),V.pixelStorei(V.UNPACK_SKIP_IMAGES,et);let nn=O.isDataArrayTexture||O.isData3DTexture,Bn=H.isDataArrayTexture||H.isData3DTexture;if(O.isDepthTexture){let Mi=He.get(O),ei=He.get(H),Ai=He.get(Mi.__renderTarget),un=He.get(ei.__renderTarget);ze.bindFramebuffer(V.READ_FRAMEBUFFER,Ai.__webglFramebuffer),ze.bindFramebuffer(V.DRAW_FRAMEBUFFER,un.__webglFramebuffer);for(let Wr=0;Wr<De;Wr++)nn&&(V.framebufferTextureLayer(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,He.get(O).__webglTexture,G,et+Wr),V.framebufferTextureLayer(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,He.get(H).__webglTexture,me,In+Wr)),V.blitFramebuffer(Ke,st,Ie,Ve,Nt,en,Ie,Ve,V.DEPTH_BUFFER_BIT,V.NEAREST);ze.bindFramebuffer(V.READ_FRAMEBUFFER,null),ze.bindFramebuffer(V.DRAW_FRAMEBUFFER,null)}else if(G!==0||O.isRenderTargetTexture||He.has(O)){let Mi=He.get(O),ei=He.get(H);ze.bindFramebuffer(V.READ_FRAMEBUFFER,t_),ze.bindFramebuffer(V.DRAW_FRAMEBUFFER,n_);for(let Ai=0;Ai<De;Ai++)nn?V.framebufferTextureLayer(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,Mi.__webglTexture,G,et+Ai):V.framebufferTexture2D(V.READ_FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,Mi.__webglTexture,G),Bn?V.framebufferTextureLayer(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,ei.__webglTexture,me,In+Ai):V.framebufferTexture2D(V.DRAW_FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,ei.__webglTexture,me),G!==0?V.blitFramebuffer(Ke,st,Ie,Ve,Nt,en,Ie,Ve,V.COLOR_BUFFER_BIT,V.NEAREST):Bn?V.copyTexSubImage3D(wn,me,Nt,en,In+Ai,Ke,st,Ie,Ve):V.copyTexSubImage2D(wn,me,Nt,en,Ke,st,Ie,Ve);ze.bindFramebuffer(V.READ_FRAMEBUFFER,null),ze.bindFramebuffer(V.DRAW_FRAMEBUFFER,null)}else Bn?O.isDataTexture||O.isData3DTexture?V.texSubImage3D(wn,me,Nt,en,In,Ie,Ve,De,tn,tt,ln.data):H.isCompressedArrayTexture?V.compressedTexSubImage3D(wn,me,Nt,en,In,Ie,Ve,De,tn,ln.data):V.texSubImage3D(wn,me,Nt,en,In,Ie,Ve,De,tn,tt,ln):O.isDataTexture?V.texSubImage2D(V.TEXTURE_2D,me,Nt,en,Ie,Ve,tn,tt,ln.data):O.isCompressedTexture?V.compressedTexSubImage2D(V.TEXTURE_2D,me,Nt,en,ln.width,ln.height,tn,ln.data):V.texSubImage2D(V.TEXTURE_2D,me,Nt,en,Ie,Ve,tn,tt,ln);V.pixelStorei(V.UNPACK_ROW_LENGTH,Gt),V.pixelStorei(V.UNPACK_IMAGE_HEIGHT,ir),V.pixelStorei(V.UNPACK_SKIP_PIXELS,Po),V.pixelStorei(V.UNPACK_SKIP_ROWS,Bi),V.pixelStorei(V.UNPACK_SKIP_IMAGES,hl),me===0&&H.generateMipmaps&&V.generateMipmap(wn),ze.unbindTexture()},this.initRenderTarget=function(O){He.get(O).__webglFramebuffer===void 0&&xt.setupRenderTarget(O)},this.initTexture=function(O){O.isCubeTexture?xt.setTextureCube(O,0):O.isData3DTexture?xt.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?xt.setTexture2DArray(O,0):xt.setTexture2D(O,0),ze.unbindTexture()},this.resetState=function(){N=0,S=0,w=null,ze.reset(),Te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Os}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=Kt._getDrawingBufferColorSpace(e),t.unpackColorSpace=Kt._getUnpackColorSpace()}};var Mhe=["gameCanvas"];function Ahe(n,e){if(n&1){let t=rn();F(0,"div",6)(1,"h1"),j(2,"CRITICAL COLLISION"),B(),F(3,"p"),j(4),B(),F(5,"button",7),Pe("click",function(){Ze(t);let r=xe();return Je(r.restart())}),j(6,"REBOOT SYSTEM"),B()()}if(n&2){let t=xe();$(4),vn("FINAL DISTANCE: ",t.scoreInKm,"m")}}var vx=class n{canvasRef;renderer;scene;camera;animationId;player;obstacles=[];stars;text;score=0;scoreInKm=0;gameOver=!1;playerPos=0;targetPlayerPos=0;speed=.5;isPause=!1;handleInpu(e){console.log("A key was pressed",e.key),!this.gameOver&&((e.key==="ArrowLeft"||e.key==="a")&&(this.targetPlayerPos=-4),(e.key==="ArrowRight"||e.key==="d")&&(this.targetPlayerPos=4),e.key==="Escape"&&(this.isPause=!this.isPause))}resetInput(){this.targetPlayerPos=0}ngAfterViewInit(){this.initGame()}initGame(){this.scene=new Lg,this.scene.fog=new kg(328965,10,50),this.camera=new Ui(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,3,10),this.camera.lookAt(0,0,0),this.renderer=new _x({canvas:this.canvasRef.nativeElement,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight);let e=new Bg(.5,1.5,3),t=new rl({color:16777215,wireframe:!0});this.player=new gr(e,t),this.player.rotation.x=Math.PI/2,this.scene.add(this.player);let i=new jg(65443,2,20);i.position.set(0,2,5),this.scene.add(i);let r=new us,s=[];for(let o=0;o<1e3;o++)s.push((Math.random()-.5)*100,(Math.random()-.5)*100,-Math.random()*100);r.setAttribute("position",new mr(s,3)),this.stars=new Fg(r,new Ef({color:16777215,size:.1})),this.scene.add(this.stars),this.animate()}spawnObstacle(){let e=new sl(2,2,2),t=new rl({color:65443,wireframe:!0}),i=new gr(e,t);i.position.set(Math.random()>.5?4:Math.random()>.5?0:-4,0,-50),this.scene.add(i),this.obstacles.push(i)}animate=()=>{if(!this.isPause&&!this.gameOver){this.animationId=requestAnimationFrame(this.animate),this.playerPos+=(this.targetPlayerPos-this.playerPos)*.1,this.player.position.x=this.playerPos,this.player.rotation.z=-this.playerPos*.1,this.speed+=1e-4,this.score+=1,this.scoreInKm=Math.floor(this.score/10),Math.random()<.01&&this.spawnObstacle();for(let e=this.obstacles.length-1;e>=0;e--){let t=this.obstacles[e];t.position.z+=this.speed,this.player.position.distanceTo(t.position)<1.5&&(this.gameOver=!0),t.position.z>15&&(this.scene.remove(t),this.obstacles.splice(e,1))}this.stars.rotation.z+=.001,this.renderer.render(this.scene,this.camera)}};restart(){this.gameOver=!1,this.score=0,this.speed=.5,this.obstacles.forEach(e=>this.scene.remove(e)),this.obstacles=[],this.animate()}ngOnDestroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.renderer.dispose()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=kn({type:n,selectors:[["app-void-dash"]],viewQuery:function(t,i){if(t&1&&Js(Mhe,5),t&2){let r;Qs(r=eo())&&(i.canvasRef=r.first)}},hostBindings:function(t,i){t&1&&Pe("keydown",function(s){return i.handleInpu(s)},kd)("keyup",function(){return i.resetInput()},kd)},decls:9,vars:2,consts:[["gameCanvas",""],[1,"game-viewport"],[1,"hud"],[1,"score"],[1,"controls-hint"],["class","overlay",4,"ngIf"],[1,"overlay"],[3,"click"]],template:function(t,i){t&1&&(F(0,"div",1),Ce(1,"canvas",null,0),F(3,"div",2)(4,"div",3),j(5),B(),F(6,"div",4),j(7,"USE ARROW KEYS OR A/D"),B()(),lt(8,Ahe,7,1,"div",5),B()),t&2&&($(5),vn("DISTANCE: ",i.scoreInKm,"m"),$(3),ye("ngIf",i.gameOver))},dependencies:[wi,dr],styles:[".game-viewport[_ngcontent-%COMP%]{position:absolute;width:100vw;height:100vh;background:#050505;overflow:hidden;color:#fff;font-family:Inter,sans-serif}canvas[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.hud[_ngcontent-%COMP%]{position:absolute;top:40px;left:40px;pointer-events:none}.score[_ngcontent-%COMP%]{font-size:2rem;font-weight:300;letter-spacing:4px;color:#00ffa3}.controls-hint[_ngcontent-%COMP%]{font-size:.8rem;opacity:.5;margin-top:10px;letter-spacing:2px}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#000000e6;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:10}h1[_ngcontent-%COMP%]{font-size:3rem;font-weight:300;letter-spacing:10px;color:#f44;margin-bottom:1rem}button[_ngcontent-%COMP%]{background:transparent;border:1px solid #00ffa3;color:#00ffa3;padding:1rem 3rem;cursor:pointer;letter-spacing:2px;transition:.3s}button[_ngcontent-%COMP%]:hover{background:#00ffa3;color:#000}"]})};var Lj=[{path:"landing",component:Zm},{path:"auth",component:Hb},{path:"",component:jb,children:[{path:"browse",component:Gb},{path:"details/:id",component:Bb},{path:"profile/:id",component:Wb},{path:"dashboard",component:RE}]},{path:"dashGame",component:vx},{path:"**",component:Zm}];var Fj={providers:[KS(),pI({eventCoalescing:!0}),mC(Lj),WI(),xV(()=>SV({apiKey:"AIzaSyD4gv6DZlZBQdn_Zme_ZPewkoZDcxGXOnk",authDomain:"tpfirebase-3814c.firebaseapp.com",projectId:"tpfirebase-3814c",storageBucket:"tpfirebase-3814c.firebasestorage.app",messagingSenderId:"493981537742",appId:"1:493981537742:web:ee6341aeb77680f36f079f"})),iz(()=>sz()),xU(()=>SU())]};var bx=class n{title=Kn("aethera");static \u0275fac=function(t){return new(t||n)};static \u0275cmp=kn({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){t&1&&Ce(0,"router-outlet")},dependencies:[Kl],encapsulation:2})};HI(bx,Fj).catch(n=>console.error(n));
